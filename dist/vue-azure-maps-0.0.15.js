/*! Vue Azure Maps v0.0.15, hash:a95f2992b9830961f10d.  Created by josealarconortega. License MIT */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.VueAzureMaps=t():e.VueAzureMaps=t()}(window,(function(){return function(e){var t={};function r(i){if(t[i])return t[i].exports;var n=t[i]={i:i,l:!1,exports:{}};return e[i].call(n.exports,n,n.exports,r),n.l=!0,n.exports}return r.m=e,r.c=t,r.d=function(e,t,i){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(i,n,function(t){return e[t]}.bind(null,n));return i},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="./dist",r(r.s=14)}([function(e,t,r){(function(e){!function(t){"use strict";var r="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==e?e:"undefined"!=typeof self?self:{};function i(e,t){return e(t={exports:{}},t.exports),t.exports}var n=i((function(e,t){function r(e,t){if(i)if(n){var r="var sharedChunk = {}; ("+i+")(sharedChunk); ("+n+")(sharedChunk);",a={};i(a),o=t(a),"undefined"!=typeof window&&(o.workerUrl=window.URL.createObjectURL(new Blob([r],{type:"text/javascript"})))}else n=t;else i=t}var i,n,o;e.exports=(r(0,(function(e){function t(e,t){return e(t={exports:{}},t.exports),t.exports}var r=i;function i(e,t,r,i){this.cx=3*e,this.bx=3*(r-e)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*t,this.by=3*(i-t)-this.cy,this.ay=1-this.cy-this.by,this.p1x=e,this.p1y=i,this.p2x=r,this.p2y=i}i.prototype.sampleCurveX=function(e){return((this.ax*e+this.bx)*e+this.cx)*e},i.prototype.sampleCurveY=function(e){return((this.ay*e+this.by)*e+this.cy)*e},i.prototype.sampleCurveDerivativeX=function(e){return(3*this.ax*e+2*this.bx)*e+this.cx},i.prototype.solveCurveX=function(e,t){var r,i,n,o,a;for(void 0===t&&(t=1e-6),n=e,a=0;a<8;a++){if(o=this.sampleCurveX(n)-e,Math.abs(o)<t)return n;var s=this.sampleCurveDerivativeX(n);if(Math.abs(s)<1e-6)break;n-=o/s}if((n=e)<(r=0))return r;if(n>(i=1))return i;for(;r<i;){if(o=this.sampleCurveX(n),Math.abs(o-e)<t)return n;o<e?r=n:i=n,n=.5*(i-r)+r}return n},i.prototype.solve=function(e,t){return this.sampleCurveY(this.solveCurveX(e,t))};var n=o;function o(e,t){this.x=e,this.y=t}o.prototype={clone:function(){return new o(this.x,this.y)},add:function(e){return this.clone()._add(e)},sub:function(e){return this.clone()._sub(e)},multByPoint:function(e){return this.clone()._multByPoint(e)},divByPoint:function(e){return this.clone()._divByPoint(e)},mult:function(e){return this.clone()._mult(e)},div:function(e){return this.clone()._div(e)},rotate:function(e){return this.clone()._rotate(e)},rotateAround:function(e,t){return this.clone()._rotateAround(e,t)},matMult:function(e){return this.clone()._matMult(e)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(e){return this.x===e.x&&this.y===e.y},dist:function(e){return Math.sqrt(this.distSqr(e))},distSqr:function(e){var t=e.x-this.x,r=e.y-this.y;return t*t+r*r},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(e){return Math.atan2(this.y-e.y,this.x-e.x)},angleWith:function(e){return this.angleWithSep(e.x,e.y)},angleWithSep:function(e,t){return Math.atan2(this.x*t-this.y*e,this.x*e+this.y*t)},_matMult:function(e){var t=e[2]*this.x+e[3]*this.y;return this.x=e[0]*this.x+e[1]*this.y,this.y=t,this},_add:function(e){return this.x+=e.x,this.y+=e.y,this},_sub:function(e){return this.x-=e.x,this.y-=e.y,this},_mult:function(e){return this.x*=e,this.y*=e,this},_div:function(e){return this.x/=e,this.y/=e,this},_multByPoint:function(e){return this.x*=e.x,this.y*=e.y,this},_divByPoint:function(e){return this.x/=e.x,this.y/=e.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var e=this.y;return this.y=this.x,this.x=-e,this},_rotate:function(e){var t=Math.cos(e),r=Math.sin(e),i=r*this.x+t*this.y;return this.x=t*this.x-r*this.y,this.y=i,this},_rotateAround:function(e,t){var r=Math.cos(e),i=Math.sin(e),n=t.y+i*(this.x-t.x)+r*(this.y-t.y);return this.x=t.x+r*(this.x-t.x)-i*(this.y-t.y),this.y=n,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},o.convert=function(e){return e instanceof o||!Array.isArray(e)?e:new o(e[0],e[1])};var a="undefined"!=typeof self?self:{};function s(e,t,i,n){var o=new r(e,t,i,n);return function(e){return o.solve(e)}}var l=s(.25,.1,.25,1);function u(e,t,r){return Math.min(r,Math.max(t,e))}function c(e,t,r){var i=r-t,n=((e-t)%i+i)%i+t;return n===t?r:n}function p(e){for(var t=[],r=arguments.length-1;0<r--;)t[r]=arguments[r+1];for(var i=0,n=t;i<n.length;i+=1){var o=n[i];for(var a in o)e[a]=o[a]}return e}var h=1;function d(){return h++}function m(){return function e(t){return t?(t^16*Math.random()>>t/4).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,e)}()}function f(e){return e&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e)}function y(e,t){e.forEach((function(e){t[e]&&(t[e]=t[e].bind(t))}))}function g(e,t){return-1!==e.indexOf(t,e.length-t.length)}function v(e,t,r){var i={};for(var n in e)i[n]=t.call(r||this,e[n],n,e);return i}function _(e,t,r){var i={};for(var n in e)t.call(r||this,e[n],n,e)&&(i[n]=e[n]);return i}function b(e){return Array.isArray(e)?e.map(b):"object"==typeof e&&e?v(e,b):e}var x={};function w(e){x[e]||("undefined"!=typeof console&&console.warn(e),x[e]=!0)}function S(e,t,r){return(r.y-e.y)*(t.x-e.x)>(t.y-e.y)*(r.x-e.x)}function T(e){for(var t=0,r=0,i=e.length,n=i-1,o=void 0,a=void 0;r<i;n=r++)t+=((a=e[n]).x-(o=e[r]).x)*(o.y+a.y);return t}function C(){return"undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof self&&self instanceof WorkerGlobalScope}function E(e){var t={};if(e.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(function(e,r,i,n){var o=i||n;return t[r]=!o||o.toLowerCase(),""})),t["max-age"]){var r=parseInt(t["max-age"],10);isNaN(r)?delete t["max-age"]:t["max-age"]=r}return t}var I=null;function P(e){if(null==I){var t=e.navigator?e.navigator.userAgent:null;I=!!e.safari||!(!t||!(/\b(iPad|iPhone|iPod)\b/.test(t)||t.match("Safari")&&!t.match("Chrome")))}return I}function R(e){try{var t=a[e];return t.setItem("_mapbox_test_",1),t.removeItem("_mapbox_test_"),!0}catch(e){return!1}}var N,A,z,M,k=a.performance&&a.performance.now?a.performance.now.bind(a.performance):Date.now.bind(Date),O=a.requestAnimationFrame||a.mozRequestAnimationFrame||a.webkitRequestAnimationFrame||a.msRequestAnimationFrame,L=a.cancelAnimationFrame||a.mozCancelAnimationFrame||a.webkitCancelAnimationFrame||a.msCancelAnimationFrame,D={now:k,frame:function(e){var t=O(e);return{cancel:function(){return L(t)}}},getImageData:function(e,t){void 0===t&&(t=0);var r=a.document.createElement("canvas"),i=r.getContext("2d");if(!i)throw new Error("failed to create canvas 2d context");return r.width=e.width,r.height=e.height,i.drawImage(e,0,0,e.width,e.height),i.getImageData(-t,-t,e.width+2*t,e.height+2*t)},resolveURL:function(e){return(N=N||a.document.createElement("a")).href=e,N.href},hardwareConcurrency:a.navigator&&a.navigator.hardwareConcurrency||4,get devicePixelRatio(){return a.devicePixelRatio},get prefersReducedMotion(){return!!a.matchMedia&&(null==A&&(A=a.matchMedia("(prefers-reduced-motion: reduce)")),A.matches)}},B={API_URL:"https://api.mapbox.com",get EVENTS_URL(){return this.API_URL?0===this.API_URL.indexOf("https://api.mapbox.cn")?"https://events.mapbox.cn/events/v2":0===this.API_URL.indexOf("https://api.mapbox.com")?"https://events.mapbox.com/events/v2":null:null},FEEDBACK_URL:"https://apps.mapbox.com/feedback",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},F={supported:!1,testSupport:function(e){!q&&M&&(U?j(e):z=e)}},q=!1,U=!1;function j(e){var t=e.createTexture();e.bindTexture(e.TEXTURE_2D,t);try{if(e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,M),e.isContextLost())return;F.supported=!0}catch(e){}e.deleteTexture(t),q=!0}function V(e,t){this._transformRequestFn=e,this._customAccessToken=t,this._createSkuToken()}a.document&&((M=a.document.createElement("img")).onload=function(){z&&j(z),U=!(z=null)},M.onerror=function(){q=!0,z=null},M.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");var G="01";function H(e){return 0===e.indexOf("mapbox:")}V.prototype._createSkuToken=function(){var e=function(){for(var e="",t=0;t<10;t++)e+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",G,e].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=e.token,this._skuTokenExpiresAt=e.tokenExpiresAt},V.prototype._isSkuTokenExpired=function(){return Date.now()>this._skuTokenExpiresAt},V.prototype.transformRequest=function(e,t){return this._transformRequestFn&&this._transformRequestFn(e,t)||{url:e}},V.prototype.normalizeStyleURL=function(e,t){if(!H(e))return e;var r=X(e);return r.path="/styles/v1"+r.path,this._makeAPIURL(r,this._customAccessToken||t)},V.prototype.normalizeGlyphsURL=function(e,t){if(!H(e))return e;var r=X(e);return r.path="/fonts/v1"+r.path,this._makeAPIURL(r,this._customAccessToken||t)},V.prototype.normalizeSourceURL=function(e,t){if(!H(e))return e;var r=X(e);return r.path="/v4/"+r.authority+".json",r.params.push("secure"),this._makeAPIURL(r,this._customAccessToken||t)},V.prototype.normalizeSpriteURL=function(e,t,r,i){var n=X(e);return H(e)?(n.path="/styles/v1"+n.path+"/sprite"+t+r,this._makeAPIURL(n,this._customAccessToken||i)):(n.path+=""+t+r,Y(n))},V.prototype.normalizeTileURL=function(e,t){if(this._isSkuTokenExpired()&&this._createSkuToken(),e&&!H(e))return e;var r=X(e);r.path=r.path.replace(/(\.(png|jpg)\d*)(?=$)/,(2<=D.devicePixelRatio||512===t?"@2x":"")+(F.supported?".webp":"$1")),r.path=r.path.replace(/^.+\/v4\//,"/"),r.path="/v4"+r.path;var i=this._customAccessToken||function(){for(var e=0,t=r.params;e<t.length;e+=1){var i=t[e].match(/^access_token=(.*)$/);if(i)return i[1]}return null}()||B.ACCESS_TOKEN;return B.REQUIRE_ACCESS_TOKEN&&i&&this._skuToken&&r.params.push("sku="+this._skuToken),this._makeAPIURL(r,i)},V.prototype.canonicalizeTileURL=function(e,t){var r=X(e);if(!r.path.match(/(^\/v4\/)/)||!r.path.match(/\.[\w]+$/))return e;var i="mapbox://tiles/";i+=r.path.replace("/v4/","");var n=r.params;return t&&(n=n.filter((function(e){return!e.match(/^access_token=/)}))),n.length&&(i+="?"+n.join("&")),i},V.prototype.canonicalizeTileset=function(e,t){for(var r=!!t&&H(t),i=[],n=0,o=e.tiles||[];n<o.length;n+=1){var a=o[n];W(a)?i.push(this.canonicalizeTileURL(a,r)):i.push(a)}return i},V.prototype._makeAPIURL=function(e,t){var r="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",i=X(B.API_URL);if(e.protocol=i.protocol,e.authority=i.authority,"/"!==i.path&&(e.path=""+i.path+e.path),!B.REQUIRE_ACCESS_TOKEN)return Y(e);if(!(t=t||B.ACCESS_TOKEN))throw new Error("An API access token is required to use Mapbox GL. "+r);if("s"===t[0])throw new Error("Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). "+r);return e.params=e.params.filter((function(e){return-1===e.indexOf("access_token")})),e.params.push("access_token="+t),Y(e)};var Z=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;function W(e){return Z.test(e)}var K=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function X(e){var t=e.match(K);if(!t)throw new Error("Unable to parse URL object");return{protocol:t[1],authority:t[2],path:t[3]||"/",params:t[4]?t[4].split("&"):[]}}function Y(e){var t=e.params.length?"?"+e.params.join("&"):"";return e.protocol+"://"+e.authority+e.path+t}function J(e){if(!e)return null;var t=e.split(".");if(!t||3!==t.length)return null;try{return JSON.parse(decodeURIComponent(a.atob(t[1]).split("").map((function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)})).join("")))}catch(e){return null}}function $(e){this.type=e,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}$.prototype.getStorageKey=function(e){var t,r=J(B.ACCESS_TOKEN);return t=r&&r.u?a.btoa(encodeURIComponent(r.u).replace(/%([0-9A-F]{2})/g,(function(e,t){return String.fromCharCode(Number("0x"+t))}))):B.ACCESS_TOKEN||"",e?"mapbox.eventData."+e+":"+t:"mapbox.eventData:"+t},$.prototype.fetchEventData=function(){var e=R("localStorage"),t=this.getStorageKey(),r=this.getStorageKey("uuid");if(e)try{var i=a.localStorage.getItem(t);i&&(this.eventData=JSON.parse(i));var n=a.localStorage.getItem(r);n&&(this.anonId=n)}catch(e){w("Unable to read from LocalStorage")}},$.prototype.saveEventData=function(){var e=R("localStorage"),t=this.getStorageKey(),r=this.getStorageKey("uuid");if(e)try{a.localStorage.setItem(r,this.anonId),1<=Object.keys(this.eventData).length&&a.localStorage.setItem(t,JSON.stringify(this.eventData))}catch(e){w("Unable to write to LocalStorage")}},$.prototype.processRequests=function(e){},$.prototype.postEvent=function(e,t,r,i){var n=this;if(B.EVENTS_URL){var o=X(B.EVENTS_URL);o.params.push("access_token="+(i||B.ACCESS_TOKEN||""));var a={event:this.type,created:new Date(e).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:"1.11.1",skuId:G,userId:this.anonId},s=t?p(a,t):a,l={url:Y(o),headers:{"Content-Type":"text/plain"},body:JSON.stringify([s])};this.pendingRequest=Ee(l,(function(e){n.pendingRequest=null,r(e),n.saveEventData(),n.processRequests(i)}))}},$.prototype.queueRequest=function(e,t){this.queue.push(e),this.processRequests(t)};var Q,ee,te,re,ie=(pe.__proto__=re=$,((pe.prototype=Object.create(re&&re.prototype)).constructor=pe).prototype.postMapLoadEvent=function(e,t,r,i){this.skuToken=r,(B.EVENTS_URL&&i||B.ACCESS_TOKEN&&Array.isArray(e)&&e.some((function(e){return H(e)||W(e)})))&&this.queueRequest({id:t,timestamp:Date.now()},i)},pe.prototype.processRequests=function(e){var t=this;if(!this.pendingRequest&&0!==this.queue.length){var r=this.queue.shift(),i=r.id,n=r.timestamp;i&&this.success[i]||(this.anonId||this.fetchEventData(),f(this.anonId)||(this.anonId=m()),this.postEvent(n,{skuToken:this.skuToken},(function(e){e||i&&(t.success[i]=!0)}),e))}},pe),ne=(ce.__proto__=te=$,((ce.prototype=Object.create(te&&te.prototype)).constructor=ce).prototype.postTurnstileEvent=function(e,t){B.EVENTS_URL&&B.ACCESS_TOKEN&&Array.isArray(e)&&e.some((function(e){return H(e)||W(e)}))&&this.queueRequest(Date.now(),t)},ce.prototype.processRequests=function(e){var t=this;if(!this.pendingRequest&&0!==this.queue.length){this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();var r=J(B.ACCESS_TOKEN),i=r?r.u:B.ACCESS_TOKEN,n=i!==this.eventData.tokenU;f(this.anonId)||(this.anonId=m(),n=!0);var o=this.queue.shift();if(this.eventData.lastSuccess){var a=new Date(this.eventData.lastSuccess),s=new Date(o),l=(o-this.eventData.lastSuccess)/864e5;n=n||1<=l||l<-1||a.getDate()!==s.getDate()}else n=!0;if(!n)return this.processRequests();this.postEvent(o,{"enabled.telemetry":!1},(function(e){e||(t.eventData.lastSuccess=o,t.eventData.tokenU=i)}),e)}},new ce),oe=ne.postTurnstileEvent.bind(ne),ae=new ie,se=ae.postMapLoadEvent.bind(ae),le=500,ue=50;function ce(e){te.call(this,"appUserTurnstile"),this._customAccessToken=e}function pe(){re.call(this,"map.load"),this.success={},this.skuToken=""}function he(){a.caches&&!Q&&(Q=a.caches.open("mapbox-tiles"))}function de(e){var t=e.indexOf("?");return t<0?e:e.slice(0,t)}var me,fe=1/0;function ye(){return null==me&&(me=a.OffscreenCanvas&&new a.OffscreenCanvas(1,1).getContext("2d")&&"function"==typeof a.createImageBitmap),me}var ge={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};"function"==typeof Object.freeze&&Object.freeze(ge);var ve,_e=((ve=Error)&&(xe.__proto__=ve),((xe.prototype=Object.create(ve&&ve.prototype)).constructor=xe).prototype.toString=function(){return this.name+": "+this.message+" ("+this.status+"): "+this.url},xe),be=C()?function(){return self.worker&&self.worker.referrer}:function(){return("blob:"===a.location.protocol?a.parent:a).location.href};function xe(e,t,r){401===t&&W(r)&&(e+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),ve.call(this,e),this.status=t,this.url=r,this.name=this.constructor.name,this.message=e}function we(e,t){if(!(/^file:/.test(r=e.url)||/^file:/.test(be())&&!/^\w+:/.test(r))){if(a.fetch&&a.Request&&a.AbortController&&a.Request.prototype.hasOwnProperty("signal"))return function(e,t){var r,i=new a.AbortController,n=new a.Request(e.url,{method:e.method||"GET",body:e.body,credentials:e.credentials,headers:e.headers,referrer:be(),signal:i.signal}),o=!1,s=!1,l=0<(r=n.url).indexOf("sku=")&&W(r);function u(r,i,o){if(!s){if(r&&"SecurityError"!==r.message&&w(r),i&&o)return c(i);var u=Date.now();a.fetch(n).then((function(r){if(r.ok){var i=l?r.clone():null;return c(r,i,u)}return t(new _e(r.statusText,r.status,e.url))})).catch((function(e){20!==e.code&&t(new Error(e.message))}))}}"json"===e.type&&n.headers.set("Accept","application/json");var c=function(r,i,l){("arrayBuffer"===e.type?r.arrayBuffer():"json"===e.type?r.json():r.text()).then((function(e){s||(i&&l&&function(e,t,r){if(he(),Q){var i={status:t.status,statusText:t.statusText,headers:new a.Headers};t.headers.forEach((function(e,t){return i.headers.set(t,e)}));var n=E(t.headers.get("Cache-Control")||"");n["no-store"]||(n["max-age"]&&i.headers.set("Expires",new Date(r+1e3*n["max-age"]).toUTCString()),new Date(i.headers.get("Expires")).getTime()-r<42e4||function(e,t){if(void 0===ee)try{new Response(new ReadableStream),ee=!0}catch(e){ee=!1}ee?t(e.body):e.blob().then(t)}(t,(function(t){var r=new a.Response(t,i);he(),Q&&Q.then((function(t){return t.put(de(e.url),r)})).catch((function(e){return w(e.message)}))})))}}(n,i,l),o=!0,t(null,e,r.headers.get("Cache-Control"),r.headers.get("Expires")))})).catch((function(e){s||t(new Error(e.message))}))};return l?function(e,t){if(he(),!Q)return t(null);var r=de(e.url);Q.then((function(e){e.match(r).then((function(i){var n=function(e){if(!e)return!1;var t=new Date(e.headers.get("Expires")||0),r=E(e.headers.get("Cache-Control")||"");return t>Date.now()&&!r["no-cache"]}(i);e.delete(r),n&&e.put(r,i.clone()),t(null,i,n)})).catch(t)})).catch(t)}(n,u):u(null,null),{cancel:function(){s=!0,o||i.abort()}}}(e,t);if(C()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",e,t,void 0,!0)}var r;return function(e,t){var r=new a.XMLHttpRequest;for(var i in r.open(e.method||"GET",e.url,!0),"arrayBuffer"===e.type&&(r.responseType="arraybuffer"),e.headers)r.setRequestHeader(i,e.headers[i]);return"json"===e.type&&(r.responseType="text",r.setRequestHeader("Accept","application/json")),r.withCredentials="include"===e.credentials,r.onerror=function(){t(new Error(r.statusText))},r.onload=function(){if((200<=r.status&&r.status<300||0===r.status)&&null!==r.response){var i=r.response;if("json"===e.type)try{i=JSON.parse(r.response)}catch(i){return t(i)}t(null,i,r.getResponseHeader("Cache-Control"),r.getResponseHeader("Expires"))}else t(new _e(r.statusText,r.status,e.url))},r.send(e.body),{cancel:function(){return r.abort()}}}(e,t)}function Se(e,t){return we(p(e,{type:"arrayBuffer"}),t)}var Te,Ce,Ee=function(e,t){return we(p(e,{method:"POST"}),t)};Te=[],Ce=0;var Ie=function(e,t){if(F.supported&&(e.headers||(e.headers={}),e.headers.accept="image/webp,*/*"),Ce>=B.MAX_PARALLEL_IMAGE_REQUESTS){var r={requestParameters:e,callback:t,cancelled:!1,cancel:function(){this.cancelled=!0}};return Te.push(r),r}function i(){if(!n)for(n=!0,Ce--;Te.length&&Ce<B.MAX_PARALLEL_IMAGE_REQUESTS;){var e=Te.shift();e.cancelled||(e.cancel=Ie(e.requestParameters,e.callback).cancel)}}Ce++;var n=!1,o=Se(e,(function(e,r,n,o){var s,l,u;i(),e?t(e):r&&(ye()?(s=r,l=t,u=new a.Blob([new Uint8Array(s)],{type:"image/png"}),a.createImageBitmap(u).then((function(e){l(null,e)})).catch((function(e){l(new Error("Could not load image because of "+e.message+". Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))}))):function(e,t,r,i){var n=new a.Image,o=a.URL;n.onload=function(){t(null,n),o.revokeObjectURL(n.src)},n.onerror=function(){return t(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))};var s=new a.Blob([new Uint8Array(e)],{type:"image/png"});n.cacheControl=r,n.expires=i,n.src=e.byteLength?o.createObjectURL(s):"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII="}(r,t,n,o))}));return{cancel:function(){o.cancel(),i()}}};function Pe(e,t,r){r[e]&&-1!==r[e].indexOf(t)||(r[e]=r[e]||[],r[e].push(t))}function Re(e,t,r){if(r&&r[e]){var i=r[e].indexOf(t);-1!==i&&r[e].splice(i,1)}}function Ne(e,t){void 0===t&&(t={}),p(this,t),this.type=e}function Ae(){}var ze,Me=(ke.__proto__=ze=Ne,(ke.prototype=Object.create(ze&&ze.prototype)).constructor=ke);function ke(e,t){void 0===t&&(t={}),ze.call(this,"error",p({error:e},t))}Ae.prototype.on=function(e,t){return this._listeners=this._listeners||{},Pe(e,t,this._listeners),this},Ae.prototype.off=function(e,t){return Re(e,t,this._listeners),Re(e,t,this._oneTimeListeners),this},Ae.prototype.once=function(e,t){return this._oneTimeListeners=this._oneTimeListeners||{},Pe(e,t,this._oneTimeListeners),this},Ae.prototype.fire=function(e,t){"string"==typeof e&&(e=new Ne(e,t||{}));var r=e.type;if(this.listens(r)){for(var i=0,n=(e.target=this)._listeners&&this._listeners[r]?this._listeners[r].slice():[];i<n.length;i+=1)n[i].call(this,e);for(var o=0,a=this._oneTimeListeners&&this._oneTimeListeners[r]?this._oneTimeListeners[r].slice():[];o<a.length;o+=1){var s=a[o];Re(r,s,this._oneTimeListeners),s.call(this,e)}var l=this._eventedParent;l&&(p(e,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData),l.fire(e))}else e instanceof Me&&console.error(e.error);return this},Ae.prototype.listens=function(e){return this._listeners&&this._listeners[e]&&0<this._listeners[e].length||this._oneTimeListeners&&this._oneTimeListeners[e]&&0<this._oneTimeListeners[e].length||this._eventedParent&&this._eventedParent.listens(e)};var Oe={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!(Ae.prototype.setEventedParent=function(e,t){return this._eventedParent=e,this._eventedParentData=t,this})},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},expression_name:{type:"enum",values:{let:{group:"Variable binding"},var:{group:"Variable binding"},literal:{group:"Types"},array:{group:"Types"},at:{group:"Lookup"},in:{group:"Lookup"},"index-of":{group:"Lookup"},slice:{group:"Lookup"},case:{group:"Decision"},match:{group:"Decision"},coalesce:{group:"Decision"},step:{group:"Ramps, scales, curves"},interpolate:{group:"Ramps, scales, curves"},"interpolate-hcl":{group:"Ramps, scales, curves"},"interpolate-lab":{group:"Ramps, scales, curves"},ln2:{group:"Math"},pi:{group:"Math"},e:{group:"Math"},typeof:{group:"Types"},string:{group:"Types"},number:{group:"Types"},boolean:{group:"Types"},object:{group:"Types"},collator:{group:"Types"},format:{group:"Types"},image:{group:"Types"},"number-format":{group:"Types"},"to-string":{group:"Types"},"to-number":{group:"Types"},"to-boolean":{group:"Types"},"to-rgba":{group:"Color"},"to-color":{group:"Types"},rgb:{group:"Color"},rgba:{group:"Color"},get:{group:"Lookup"},has:{group:"Lookup"},length:{group:"Lookup"},properties:{group:"Feature data"},"feature-state":{group:"Feature data"},"geometry-type":{group:"Feature data"},id:{group:"Feature data"},zoom:{group:"Zoom"},"heatmap-density":{group:"Heatmap"},"line-progress":{group:"Feature data"},accumulated:{group:"Feature data"},"+":{group:"Math"},"*":{group:"Math"},"-":{group:"Math"},"/":{group:"Math"},"%":{group:"Math"},"^":{group:"Math"},sqrt:{group:"Math"},log10:{group:"Math"},ln:{group:"Math"},log2:{group:"Math"},sin:{group:"Math"},cos:{group:"Math"},tan:{group:"Math"},asin:{group:"Math"},acos:{group:"Math"},atan:{group:"Math"},min:{group:"Math"},max:{group:"Math"},round:{group:"Math"},abs:{group:"Math"},ceil:{group:"Math"},floor:{group:"Math"},distance:{group:"Math"},"==":{group:"Decision"},"!=":{group:"Decision"},">":{group:"Decision"},"<":{group:"Decision"},">=":{group:"Decision"},"<=":{group:"Decision"},all:{group:"Decision"},any:{group:"Decision"},"!":{group:"Decision"},within:{group:"Decision"},"is-supported-script":{group:"String"},upcase:{group:"String"},downcase:{group:"String"},concat:{group:"String"},"resolved-locale":{group:"String"}}},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}},Le=function(e,t,r,i){this.message=(e?e+": ":"")+r,i&&(this.identifier=i),null!=t&&t.__line__&&(this.line=t.__line__)};function De(e){var t=e.value;return t?[new Le(e.key,t,"constants have been deprecated as of v8")]:[]}function Be(e){for(var t=[],r=arguments.length-1;0<r--;)t[r]=arguments[r+1];for(var i=0,n=t;i<n.length;i+=1){var o=n[i];for(var a in o)e[a]=o[a]}return e}function Fe(e){return e instanceof Number||e instanceof String||e instanceof Boolean?e.valueOf():e}function qe(e){if(Array.isArray(e))return e.map(qe);if(e instanceof Object&&!(e instanceof Number||e instanceof String||e instanceof Boolean)){var t={};for(var r in e)t[r]=qe(e[r]);return t}return Fe(e)}function Ue(e,t){void 0===t&&(t=[]),this.parent=e,this.bindings={};for(var r=0,i=t;r<i.length;r+=1){var n=i[r];this.bindings[n[0]]=n[1]}}var je,Ve=((je=Error)&&(Ge.__proto__=je),(Ge.prototype=Object.create(je&&je.prototype)).constructor=Ge);function Ge(e,t){je.call(this,t),this.message=t,this.key=e}Ue.prototype.concat=function(e){return new Ue(this,e)},Ue.prototype.get=function(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(e+" not found in scope.")},Ue.prototype.has=function(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)};var He={kind:"null"},Ze={kind:"number"},We={kind:"string"},Ke={kind:"boolean"},Xe={kind:"color"},Ye={kind:"object"},Je={kind:"value"},$e={kind:"collator"},Qe={kind:"formatted"},et={kind:"resolvedImage"};function tt(e,t){return{kind:"array",itemType:e,N:t}}function rt(e){if("array"!==e.kind)return e.kind;var t=rt(e.itemType);return"number"==typeof e.N?"array<"+t+", "+e.N+">":"value"===e.itemType.kind?"array":"array<"+t+">"}var it=[He,Ze,We,Ke,Xe,Qe,Ye,tt(Je),et];function nt(e,t){if("error"===t.kind)return null;if("array"===e.kind){if("array"===t.kind&&(0===t.N&&"value"===t.itemType.kind||!nt(e.itemType,t.itemType))&&("number"!=typeof e.N||e.N===t.N))return null}else{if(e.kind===t.kind)return null;if("value"===e.kind)for(var r=0,i=it;r<i.length;r+=1)if(!nt(i[r],t))return null}return"Expected "+rt(e)+" but found "+rt(t)+" instead."}function ot(e,t){return t.some((function(t){return t.kind===e.kind}))}function at(e,t){return t.some((function(t){return"null"===t?null===e:"array"===t?Array.isArray(e):"object"===t?e&&!Array.isArray(e)&&"object"==typeof e:t===typeof e}))}var st=t((function(e,t){var r={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function i(e){return(e=Math.round(e))<0?0:255<e?255:e}function n(e){return i("%"===e[e.length-1]?parseFloat(e)/100*255:parseInt(e))}function o(e){return(t="%"===e[e.length-1]?parseFloat(e)/100:parseFloat(e))<0?0:1<t?1:t;var t}function a(e,t,r){return r<0?r+=1:1<r&&--r,6*r<1?e+(t-e)*r*6:2*r<1?t:3*r<2?e+(t-e)*(2/3-r)*6:e}try{t.parseCSSColor=function(e){var t,s=e.replace(/ /g,"").toLowerCase();if(s in r)return r[s].slice();if("#"===s[0])return 4===s.length?0<=(t=parseInt(s.substr(1),16))&&t<=4095?[(3840&t)>>4|(3840&t)>>8,240&t|(240&t)>>4,15&t|(15&t)<<4,1]:null:7===s.length&&0<=(t=parseInt(s.substr(1),16))&&t<=16777215?[(16711680&t)>>16,(65280&t)>>8,255&t,1]:null;var l=s.indexOf("("),u=s.indexOf(")");if(-1!==l&&u+1===s.length){var c=s.substr(0,l),p=s.substr(l+1,u-(l+1)).split(","),h=1;switch(c){case"rgba":if(4!==p.length)return null;h=o(p.pop());case"rgb":return 3!==p.length?null:[n(p[0]),n(p[1]),n(p[2]),h];case"hsla":if(4!==p.length)return null;h=o(p.pop());case"hsl":if(3!==p.length)return null;var d=(parseFloat(p[0])%360+360)%360/360,m=o(p[1]),f=o(p[2]),y=f<=.5?f*(m+1):f+m-f*m,g=2*f-y;return[i(255*a(g,y,d+1/3)),i(255*a(g,y,d)),i(255*a(g,y,d-1/3)),h];default:return null}}return null}}catch(e){}})).parseCSSColor,lt=function(e,t,r,i){void 0===i&&(i=1),this.r=e,this.g=t,this.b=r,this.a=i};lt.parse=function(e){if(e){if(e instanceof lt)return e;if("string"==typeof e){var t=st(e);if(t)return new lt(t[0]/255*t[3],t[1]/255*t[3],t[2]/255*t[3],t[3])}}},lt.prototype.toString=function(){var e=this.toArray(),t=e[1],r=e[2],i=e[3];return"rgba("+Math.round(e[0])+","+Math.round(t)+","+Math.round(r)+","+i+")"},lt.prototype.toArray=function(){var e=this.a;return 0===e?[0,0,0,0]:[255*this.r/e,255*this.g/e,255*this.b/e,e]},lt.black=new lt(0,0,0,1),lt.white=new lt(1,1,1,1),lt.transparent=new lt(0,0,0,0),lt.red=new lt(1,0,0,1);var ut=function(e,t,r){this.sensitivity=e?t?"variant":"case":t?"accent":"base",this.locale=r,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})};function ct(e,t,r,i,n){this.text=e,this.image=t,this.scale=r,this.fontStack=i,this.textColor=n}ut.prototype.compare=function(e,t){return this.collator.compare(e,t)},ut.prototype.resolvedLocale=function(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale};var pt=function(e){this.sections=e};pt.fromString=function(e){return new pt([new ct(e,null,null,null,null)])},pt.prototype.isEmpty=function(){return 0===this.sections.length||!this.sections.some((function(e){return 0!==e.text.length||e.image&&0!==e.image.name.length}))},pt.factory=function(e){return e instanceof pt?e:pt.fromString(e)},pt.prototype.toString=function(){return 0===this.sections.length?"":this.sections.map((function(e){return e.text})).join("")},pt.prototype.serialize=function(){for(var e=["format"],t=0,r=this.sections;t<r.length;t+=1){var i=r[t];if(i.image)e.push(["image",i.image.name]);else{e.push(i.text);var n={};i.fontStack&&(n["text-font"]=["literal",i.fontStack.split(",")]),i.scale&&(n["font-scale"]=i.scale),i.textColor&&(n["text-color"]=["rgba"].concat(i.textColor.toArray())),e.push(n)}}return e};var ht=function(e){this.name=e.name,this.available=e.available};function dt(e,t,r,i){return"number"==typeof e&&0<=e&&e<=255&&"number"==typeof t&&0<=t&&t<=255&&"number"==typeof r&&0<=r&&r<=255?void 0===i||"number"==typeof i&&0<=i&&i<=1?null:"Invalid rgba value ["+[e,t,r,i].join(", ")+"]: 'a' must be between 0 and 1.":"Invalid rgba value ["+("number"==typeof i?[e,t,r,i]:[e,t,r]).join(", ")+"]: 'r', 'g', and 'b' must be between 0 and 255."}function mt(e){if(null===e)return 1;if("string"==typeof e)return 1;if("boolean"==typeof e)return 1;if("number"==typeof e)return 1;if(e instanceof lt)return 1;if(e instanceof ut)return 1;if(e instanceof pt)return 1;if(e instanceof ht)return 1;if(Array.isArray(e)){for(var t=0,r=e;t<r.length;t+=1)if(!mt(r[t]))return;return 1}if("object"==typeof e){for(var i in e)if(!mt(e[i]))return;return 1}}function ft(e){if(null===e)return He;if("string"==typeof e)return We;if("boolean"==typeof e)return Ke;if("number"==typeof e)return Ze;if(e instanceof lt)return Xe;if(e instanceof ut)return $e;if(e instanceof pt)return Qe;if(e instanceof ht)return et;if(Array.isArray(e)){for(var t,r=e.length,i=0,n=e;i<n.length;i+=1){var o=ft(n[i]);if(t){if(t===o)continue;t=Je;break}t=o}return tt(t||Je,r)}return Ye}function yt(e){var t=typeof e;return null===e?"":"string"==t||"number"==t||"boolean"==t?String(e):e instanceof lt||e instanceof pt||e instanceof ht?e.toString():JSON.stringify(e)}function gt(e,t){this.type=e,this.value=t}ht.prototype.toString=function(){return this.name},ht.fromString=function(e){return e?new ht({name:e,available:!1}):null},ht.prototype.serialize=function(){return["image",this.name]},gt.parse=function(e,t){if(2!==e.length)return t.error("'literal' expression requires exactly one argument, but found "+(e.length-1)+" instead.");if(!mt(e[1]))return t.error("invalid value");var r=e[1],i=ft(r),n=t.expectedType;return"array"!==i.kind||0!==i.N||!n||"array"!==n.kind||"number"==typeof n.N&&0!==n.N||(i=n),new gt(i,r)},gt.prototype.evaluate=function(){return this.value},gt.prototype.eachChild=function(){},gt.prototype.outputDefined=function(){return!0},gt.prototype.serialize=function(){return"array"===this.type.kind||"object"===this.type.kind?["literal",this.value]:this.value instanceof lt?["rgba"].concat(this.value.toArray()):this.value instanceof pt?this.value.serialize():this.value};var vt=function(e){this.name="ExpressionEvaluationError",this.message=e};function _t(e,t){this.type=e,this.args=t}vt.prototype.toJSON=function(){return this.message};var bt={string:We,number:Ze,boolean:Ke,object:Ye};function xt(e){this.type=Qe,this.sections=e}function wt(e){this.type=et,this.input=e}function St(e,t){this.type=e,this.args=t}_t.parse=function(e,t){if(e.length<2)return t.error("Expected at least one argument.");var r,i=1,n=e[0];if("array"===n){var o,a;if(2<e.length){var s=e[1];if("string"!=typeof s||!(s in bt)||"object"===s)return t.error('The item type argument of "array" must be one of string, number, boolean',1);o=bt[s],i++}else o=Je;if(3<e.length){if(null!==e[2]&&("number"!=typeof e[2]||e[2]<0||e[2]!==Math.floor(e[2])))return t.error('The length argument to "array" must be a positive integer literal',2);a=e[2],i++}r=tt(o,a)}else r=bt[n];for(var l=[];i<e.length;i++){var u=t.parse(e[i],i,Je);if(!u)return null;l.push(u)}return new _t(r,l)},_t.prototype.evaluate=function(e){for(var t=0;t<this.args.length;t++){var r=this.args[t].evaluate(e);if(!nt(this.type,ft(r)))return r;if(t===this.args.length-1)throw new vt("Expected value to be of type "+rt(this.type)+", but found "+rt(ft(r))+" instead.")}return null},_t.prototype.eachChild=function(e){this.args.forEach(e)},_t.prototype.outputDefined=function(){return this.args.every((function(e){return e.outputDefined()}))},_t.prototype.serialize=function(){var e=this.type,t=[e.kind];if("array"===e.kind){var r=e.itemType;if("string"===r.kind||"number"===r.kind||"boolean"===r.kind){t.push(r.kind);var i=e.N;("number"==typeof i||1<this.args.length)&&t.push(i)}}return t.concat(this.args.map((function(e){return e.serialize()})))},xt.parse=function(e,t){if(e.length<2)return t.error("Expected at least one argument.");var r=e[1];if(!Array.isArray(r)&&"object"==typeof r)return t.error("First argument must be an image or text section.");for(var i=[],n=!1,o=1;o<=e.length-1;++o){var a=e[o];if(n&&"object"==typeof a&&!Array.isArray(a)){n=!1;var s=null;if(a["font-scale"]&&!(s=t.parse(a["font-scale"],1,Ze)))return null;var l=null;if(a["text-font"]&&!(l=t.parse(a["text-font"],1,tt(We))))return null;var u=null;if(a["text-color"]&&!(u=t.parse(a["text-color"],1,Xe)))return null;var c=i[i.length-1];c.scale=s,c.font=l,c.textColor=u}else{var p=t.parse(e[o],1,Je);if(!p)return null;var h=p.type.kind;if("string"!==h&&"value"!==h&&"null"!==h&&"resolvedImage"!==h)return t.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");n=!0,i.push({content:p,scale:null,font:null,textColor:null})}}return new xt(i)},xt.prototype.evaluate=function(e){return new pt(this.sections.map((function(t){var r=t.content.evaluate(e);return ft(r)===et?new ct("",r,null,null,null):new ct(yt(r),null,t.scale?t.scale.evaluate(e):null,t.font?t.font.evaluate(e).join(","):null,t.textColor?t.textColor.evaluate(e):null)})))},xt.prototype.eachChild=function(e){for(var t=0,r=this.sections;t<r.length;t+=1){var i=r[t];e(i.content),i.scale&&e(i.scale),i.font&&e(i.font),i.textColor&&e(i.textColor)}},xt.prototype.outputDefined=function(){return!1},xt.prototype.serialize=function(){for(var e=["format"],t=0,r=this.sections;t<r.length;t+=1){var i=r[t];e.push(i.content.serialize());var n={};i.scale&&(n["font-scale"]=i.scale.serialize()),i.font&&(n["text-font"]=i.font.serialize()),i.textColor&&(n["text-color"]=i.textColor.serialize()),e.push(n)}return e},wt.parse=function(e,t){if(2!==e.length)return t.error("Expected two arguments.");var r=t.parse(e[1],1,We);return r?new wt(r):t.error("No image name provided.")},wt.prototype.evaluate=function(e){var t=this.input.evaluate(e),r=ht.fromString(t);return r&&e.availableImages&&(r.available=-1<e.availableImages.indexOf(t)),r},wt.prototype.eachChild=function(e){e(this.input)},wt.prototype.outputDefined=function(){return!1},wt.prototype.serialize=function(){return["image",this.input.serialize()]};var Tt={"to-boolean":Ke,"to-color":Xe,"to-number":Ze,"to-string":We};function Ct(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}St.parse=function(e,t){if(e.length<2)return t.error("Expected at least one argument.");var r=e[0];if(("to-boolean"===r||"to-string"===r)&&2!==e.length)return t.error("Expected one argument.");for(var i=Tt[r],n=[],o=1;o<e.length;o++){var a=t.parse(e[o],o,Je);if(!a)return null;n.push(a)}return new St(i,n)},St.prototype.evaluate=function(e){if("boolean"===this.type.kind)return Boolean(this.args[0].evaluate(e));if("color"===this.type.kind){for(var t,r,i=0,n=this.args;i<n.length;i+=1){if(r=null,(t=n[i].evaluate(e))instanceof lt)return t;if("string"==typeof t){var o=e.parseColor(t);if(o)return o}else if(Array.isArray(t)&&!(r=t.length<3||4<t.length?"Invalid rbga value "+JSON.stringify(t)+": expected an array containing either three or four numeric values.":dt(t[0],t[1],t[2],t[3])))return new lt(t[0]/255,t[1]/255,t[2]/255,t[3])}throw new vt(r||"Could not parse color from value '"+("string"==typeof t?t:String(JSON.stringify(t)))+"'")}if("number"!==this.type.kind)return"formatted"===this.type.kind?pt.fromString(yt(this.args[0].evaluate(e))):"resolvedImage"===this.type.kind?ht.fromString(yt(this.args[0].evaluate(e))):yt(this.args[0].evaluate(e));for(var a=null,s=0,l=this.args;s<l.length;s+=1){if(null===(a=l[s].evaluate(e)))return 0;var u=Number(a);if(!isNaN(u))return u}throw new vt("Could not convert "+JSON.stringify(a)+" to number.")},St.prototype.eachChild=function(e){this.args.forEach(e)},St.prototype.outputDefined=function(){return this.args.every((function(e){return e.outputDefined()}))},St.prototype.serialize=function(){if("formatted"===this.type.kind)return new xt([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if("resolvedImage"===this.type.kind)return new wt(this.args[0]).serialize();var e=["to-"+this.type.kind];return this.eachChild((function(t){e.push(t.serialize())})),e};var Et=["Unknown","Point","LineString","Polygon"];Ct.prototype.id=function(){return this.feature&&"id"in this.feature?this.feature.id:null},Ct.prototype.geometryType=function(){return this.feature?"number"==typeof this.feature.type?Et[this.feature.type]:this.feature.type:null},Ct.prototype.geometry=function(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null},Ct.prototype.canonicalID=function(){return this.canonical},Ct.prototype.properties=function(){return this.feature&&this.feature.properties||{}},Ct.prototype.parseColor=function(e){var t=this._parseColorCache[e];return t||(this._parseColorCache[e]=lt.parse(e))};var It=function(e,t,r,i){this.name=e,this.type=t,this._evaluate=r,this.args=i};function Pt(e,t,r){this.type=$e,this.locale=r,this.caseSensitive=e,this.diacriticSensitive=t}function Rt(e,t){e[0]=Math.min(e[0],t[0]),e[1]=Math.min(e[1],t[1]),e[2]=Math.max(e[2],t[0]),e[3]=Math.max(e[3],t[1])}function Nt(e,t){return!(e[0]<=t[0]||e[2]>=t[2]||e[1]<=t[1]||e[3]>=t[3])}function At(e,t){for(var r,i,n,o,a,s,l=!1,u=0,c=t.length;u<c;u++)for(var p=t[u],h=0,d=p.length;h<d-1;h++){if((n=e[0]-(r=p[h])[0])*(s=e[1]-(i=p[h+1])[1])-(a=e[0]-i[0])*(o=e[1]-r[1])==0&&n*a<=0&&o*s<=0)return;m=e,f=p[h],y=p[h+1],f[1]>m[1]!=y[1]>m[1]&&m[0]<(y[0]-f[0])*(m[1]-f[1])/(y[1]-f[1])+f[0]&&(l=!l)}var m,f,y;return l}function zt(e,t){for(var r=0;r<t.length;r++)if(At(e,t[r]))return 1}function Mt(e,t,r,i){var n=i[0]-r[0],o=i[1]-r[1],a=(e[0]-r[0])*o-n*(e[1]-r[1]),s=(t[0]-r[0])*o-n*(t[1]-r[1]);return 0<a&&s<0||a<0&&0<s}function kt(e,t,r){for(var i=0,n=r;i<n.length;i+=1)for(var o=n[i],a=0;a<o.length-1;++a)if(0!=(u=[(l=o[a+1])[0]-(s=o[a])[0],l[1]-s[1]])[0]*(c=[t[0]-e[0],t[1]-e[1]])[1]-u[1]*c[0]&&Mt(e,t,s,l)&&Mt(s,l,e,t))return 1;var s,l,u,c}function Ot(e,t){for(var r=0;r<e.length;++r)if(!At(e[r],t))return;for(var i=0;i<e.length-1;++i)if(kt(e[i],e[i+1],t))return;return 1}function Lt(e,t){for(var r=0;r<t.length;r++)if(Ot(e,t[r]))return 1}function Dt(e,t,r){for(var i=[],n=0;n<e.length;n++){for(var o=[],a=0;a<e[n].length;a++){var s=(u=r,c=(180+(l=e[n][a])[0])/360,p=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+l[1]*Math.PI/360)))/360,h=Math.pow(2,u.z),[Math.round(c*h*8192),Math.round(p*h*8192)]);Rt(t,s),o.push(s)}i.push(o)}var l,u,c,p,h;return i}function Bt(e,t,r){for(var i=[],n=0;n<e.length;n++){var o=Dt(e[n],t,r);i.push(o)}return i}function Ft(e,t,r,i){if(e[0]<r[0]||e[0]>r[2]){var n=.5*i,o=e[0]-r[0]>n?-i:r[0]-e[0]>n?i:0;0===o&&(o=e[0]-r[2]>n?-i:r[2]-e[0]>n?i:0),e[0]+=o}Rt(t,e)}function qt(e,t,r,i){for(var n=8192*Math.pow(2,i.z),o=[8192*i.x,8192*i.y],a=[],s=0,l=e;s<l.length;s+=1)for(var u=0,c=l[s];u<c.length;u+=1){var p=c[u],h=[p.x+o[0],p.y+o[1]];Ft(h,t,r,n),a.push(h)}return a}function Ut(e,t,r,i){for(var n,o=8192*Math.pow(2,i.z),a=[8192*i.x,8192*i.y],s=[],l=0,u=e;l<u.length;l+=1){for(var c=[],p=0,h=u[l];p<h.length;p+=1){var d=h[p],m=[d.x+a[0],d.y+a[1]];Rt(t,m),c.push(m)}s.push(c)}if(t[2]-t[0]<=o/2){(n=t)[0]=n[1]=1/0,n[2]=n[3]=-1/0;for(var f=0,y=s;f<y.length;f+=1)for(var g=0,v=y[f];g<v.length;g+=1)Ft(v[g],t,r,o)}return s}It.prototype.evaluate=function(e){return this._evaluate(e,this.args)},It.prototype.eachChild=function(e){this.args.forEach(e)},It.prototype.outputDefined=function(){return!1},It.prototype.serialize=function(){return[this.name].concat(this.args.map((function(e){return e.serialize()})))},It.parse=function(e,t){var r,i=e[0],n=It.definitions[i];if(!n)return t.error('Unknown expression "'+i+'". If you wanted a literal array, use ["literal", [...]].',0);for(var o=Array.isArray(n)?n[0]:n.type,a=Array.isArray(n)?[[n[1],n[2]]]:n.overloads,s=a.filter((function(t){var r=t[0];return!Array.isArray(r)||r.length===e.length-1})),l=null,u=0,c=s;u<c.length;u+=1){var p=c[u],h=p[0],d=p[1];l=new Wt(t.registry,t.path,null,t.scope);for(var m=[],f=!1,y=1;y<e.length;y++){var g=e[y],v=Array.isArray(h)?h[y-1]:h.type,_=l.parse(g,1+m.length,v);if(!_){f=!0;break}m.push(_)}if(!f)if(Array.isArray(h)&&h.length!==m.length)l.error("Expected "+h.length+" arguments, but found "+m.length+" instead.");else{for(var b=0;b<m.length;b++){var x=Array.isArray(h)?h[b]:h.type,w=m[b];l.concat(b+1).checkSubtype(x,w.type)}if(0===l.errors.length)return new It(i,o,d,m)}}if(1===s.length)(r=t.errors).push.apply(r,l.errors);else{for(var S=(s.length?s:a).map((function(e){var t;return t=e[0],Array.isArray(t)?"("+t.map(rt).join(", ")+")":"("+rt(t.type)+"...)"})).join(" | "),T=[],C=1;C<e.length;C++){var E=t.parse(e[C],1+T.length);if(!E)return null;T.push(rt(E.type))}t.error("Expected arguments of type "+S+", but found ("+T.join(", ")+") instead.")}return null},It.register=function(e,t){for(var r in It.definitions=t)e[r]=It},Pt.parse=function(e,t){if(2!==e.length)return t.error("Expected one argument.");var r=e[1];if("object"!=typeof r||Array.isArray(r))return t.error("Collator options argument must be an object.");var i=t.parse(void 0!==r["case-sensitive"]&&r["case-sensitive"],1,Ke);if(!i)return null;var n=t.parse(void 0!==r["diacritic-sensitive"]&&r["diacritic-sensitive"],1,Ke);if(!n)return null;var o=null;return r.locale&&!(o=t.parse(r.locale,1,We))?null:new Pt(i,n,o)},Pt.prototype.evaluate=function(e){return new ut(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)},Pt.prototype.eachChild=function(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)},Pt.prototype.outputDefined=function(){return!1},Pt.prototype.serialize=function(){var e={};return e["case-sensitive"]=this.caseSensitive.serialize(),e["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(e.locale=this.locale.serialize()),["collator",e]};var jt=function(e,t){this.type=Ke,this.geojson=e,this.geometries=t};function Vt(e){if(e instanceof It){if("get"===e.name&&1===e.args.length)return!1;if("feature-state"===e.name)return!1;if("has"===e.name&&1===e.args.length)return!1;if("properties"===e.name||"geometry-type"===e.name||"id"===e.name)return!1;if(/^filter-/.test(e.name))return!1}if(e instanceof jt)return!1;var t=!0;return e.eachChild((function(e){t&&!Vt(e)&&(t=!1)})),t}function Gt(e){if(!(e instanceof It&&"feature-state"===e.name)){var t=!0;return e.eachChild((function(e){t&&!Gt(e)&&(t=!1)})),t}}function Ht(e,t){if(e instanceof It&&0<=t.indexOf(e.name))return!1;var r=!0;return e.eachChild((function(e){r&&!Ht(e,t)&&(r=!1)})),r}function Zt(e,t){this.type=t.type,this.name=e,this.boundExpression=t}jt.parse=function(e,t){if(2!==e.length)return t.error("'within' expression requires exactly one argument, but found "+(e.length-1)+" instead.");if(mt(e[1])){var r=e[1];if("FeatureCollection"===r.type)for(var i=0;i<r.features.length;++i){var n=r.features[i].geometry.type;if("Polygon"===n||"MultiPolygon"===n)return new jt(r,r.features[i].geometry)}else if("Feature"===r.type){var o=r.geometry.type;if("Polygon"===o||"MultiPolygon"===o)return new jt(r,r.geometry)}else if("Polygon"===r.type||"MultiPolygon"===r.type)return new jt(r,r)}return t.error("'within' expression requires valid geojson object that contains polygon geometry type.")},jt.prototype.evaluate=function(e){if(null!=e.geometry()&&null!=e.canonicalID()){if("Point"===e.geometryType())return function(e,t){var r=[1/0,1/0,-1/0,-1/0],i=[1/0,1/0,-1/0,-1/0],n=e.canonicalID();if("Polygon"===t.type){var o=Dt(t.coordinates,i,n),a=qt(e.geometry(),r,i,n);if(!Nt(r,i))return!1;for(var s=0,l=a;s<l.length;s+=1)if(!At(l[s],o))return!1}if("MultiPolygon"===t.type){var u=Bt(t.coordinates,i,n),c=qt(e.geometry(),r,i,n);if(!Nt(r,i))return!1;for(var p=0,h=c;p<h.length;p+=1)if(!zt(h[p],u))return!1}return!0}(e,this.geometries);if("LineString"===e.geometryType())return function(e,t){var r=[1/0,1/0,-1/0,-1/0],i=[1/0,1/0,-1/0,-1/0],n=e.canonicalID();if("Polygon"===t.type){var o=Dt(t.coordinates,i,n),a=Ut(e.geometry(),r,i,n);if(!Nt(r,i))return!1;for(var s=0,l=a;s<l.length;s+=1)if(!Ot(l[s],o))return!1}if("MultiPolygon"===t.type){var u=Bt(t.coordinates,i,n),c=Ut(e.geometry(),r,i,n);if(!Nt(r,i))return!1;for(var p=0,h=c;p<h.length;p+=1)if(!Lt(h[p],u))return!1}return!0}(e,this.geometries)}return!1},jt.prototype.eachChild=function(){},jt.prototype.outputDefined=function(){return!0},jt.prototype.serialize=function(){return["within",this.geojson]},Zt.parse=function(e,t){if(2!==e.length||"string"!=typeof e[1])return t.error("'var' expression requires exactly one string literal argument.");var r=e[1];return t.scope.has(r)?new Zt(r,t.scope.get(r)):t.error('Unknown variable "'+r+'". Make sure "'+r+'" has been bound in an enclosing "let" expression before using it.',1)},Zt.prototype.evaluate=function(e){return this.boundExpression.evaluate(e)},Zt.prototype.eachChild=function(){},Zt.prototype.outputDefined=function(){return!1},Zt.prototype.serialize=function(){return["var",this.name]};var Wt=function(e,t,r,i,n){void 0===t&&(t=[]),void 0===i&&(i=new Ue),void 0===n&&(n=[]),this.registry=e,this.path=t,this.key=t.map((function(e){return"["+e+"]"})).join(""),this.scope=i,this.errors=n,this.expectedType=r};function Kt(e,t){for(var r,i=e.length-1,n=0,o=i,a=0;n<=o;)if((r=e[a=Math.floor((n+o)/2)])<=t){if(a===i||t<e[a+1])return a;n=a+1}else{if(!(t<r))throw new vt("Input is not a number.");o=a-1}return 0}Wt.prototype.parse=function(e,t,r,i,n){return void 0===n&&(n={}),t?this.concat(t,r,i)._parse(e,n):this._parse(e,n)},Wt.prototype._parse=function(e,t){function r(e,t,r){return"assert"===r?new _t(t,[e]):"coerce"===r?new St(t,[e]):e}if(null!==e&&"string"!=typeof e&&"boolean"!=typeof e&&"number"!=typeof e||(e=["literal",e]),Array.isArray(e)){if(0===e.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');var i=e[0];if("string"!=typeof i)return this.error("Expression name must be a string, but found "+typeof i+' instead. If you wanted a literal array, use ["literal", [...]].',0),null;var n=this.registry[i];if(n){var o=n.parse(e,this);if(!o)return null;if(this.expectedType){var a=this.expectedType,s=o.type;if("string"!==a.kind&&"number"!==a.kind&&"boolean"!==a.kind&&"object"!==a.kind&&"array"!==a.kind||"value"!==s.kind)if("color"!==a.kind&&"formatted"!==a.kind&&"resolvedImage"!==a.kind||"value"!==s.kind&&"string"!==s.kind){if(this.checkSubtype(a,s))return null}else o=r(o,a,t.typeAnnotation||"coerce");else o=r(o,a,t.typeAnnotation||"assert")}if(!(o instanceof gt)&&"resolvedImage"!==o.type.kind&&function e(t){if(t instanceof Zt)return e(t.boundExpression);if(t instanceof It&&"error"===t.name)return!1;if(t instanceof Pt)return!1;if(t instanceof jt)return!1;var r=t instanceof St||t instanceof _t,i=!0;return t.eachChild((function(t){i=r?i&&e(t):i&&t instanceof gt})),!!i&&Vt(t)&&Ht(t,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}(o)){var l=new Ct;try{o=new gt(o.type,o.evaluate(l))}catch(e){return this.error(e.message),null}}return o}return this.error('Unknown expression "'+i+'". If you wanted a literal array, use ["literal", [...]].',0)}return this.error(void 0===e?"'undefined' value invalid. Use null instead.":"object"==typeof e?'Bare objects invalid. Use ["literal", {...}] instead.':"Expected an array, but found "+typeof e+" instead.")},Wt.prototype.concat=function(e,t,r){var i="number"==typeof e?this.path.concat(e):this.path,n=r?this.scope.concat(r):this.scope;return new Wt(this.registry,i,t||null,n,this.errors)},Wt.prototype.error=function(e){for(var t=[],r=arguments.length-1;0<r--;)t[r]=arguments[r+1];var i=""+this.key+t.map((function(e){return"["+e+"]"})).join("");this.errors.push(new Ve(i,e))},Wt.prototype.checkSubtype=function(e,t){var r=nt(e,t);return r&&this.error(r),r};var Xt=function(e,t,r){this.type=e,this.input=t,this.labels=[],this.outputs=[];for(var i=0,n=r;i<n.length;i+=1){var o=n[i],a=o[1];this.labels.push(o[0]),this.outputs.push(a)}};function Yt(e,t,r){return e*(1-r)+t*r}Xt.parse=function(e,t){if(e.length-1<4)return t.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if((e.length-1)%2!=0)return t.error("Expected an even number of arguments.");var r=t.parse(e[1],1,Ze);if(!r)return null;var i=[],n=null;t.expectedType&&"value"!==t.expectedType.kind&&(n=t.expectedType);for(var o=1;o<e.length;o+=2){var a=1===o?-1/0:e[o],s=e[o+1],l=o,u=o+1;if("number"!=typeof a)return t.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',l);if(i.length&&i[i.length-1][0]>=a)return t.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',l);var c=t.parse(s,u,n);if(!c)return null;n=n||c.type,i.push([a,c])}return new Xt(n,r,i)},Xt.prototype.evaluate=function(e){var t=this.labels,r=this.outputs;if(1===t.length)return r[0].evaluate(e);var i=this.input.evaluate(e);if(i<=t[0])return r[0].evaluate(e);var n=t.length;return i>=t[n-1]?r[n-1].evaluate(e):r[Kt(t,i)].evaluate(e)},Xt.prototype.eachChild=function(e){e(this.input);for(var t=0,r=this.outputs;t<r.length;t+=1)e(r[t])},Xt.prototype.outputDefined=function(){return this.outputs.every((function(e){return e.outputDefined()}))},Xt.prototype.serialize=function(){for(var e=["step",this.input.serialize()],t=0;t<this.labels.length;t++)0<t&&e.push(this.labels[t]),e.push(this.outputs[t].serialize());return e};var Jt=Object.freeze({__proto__:null,number:Yt,color:function(e,t,r){return new lt(Yt(e.r,t.r,r),Yt(e.g,t.g,r),Yt(e.b,t.b,r),Yt(e.a,t.a,r))},array:function(e,t,r){return e.map((function(e,i){return Yt(e,t[i],r)}))}}),$t=6/29*3*(6/29),Qt=Math.PI/180,er=180/Math.PI;function tr(e){return.008856451679035631<e?Math.pow(e,1/3):e/$t+4/29}function rr(e){return 6/29<e?e*e*e:$t*(e-4/29)}function ir(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function nr(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function or(e){var t=nr(e.r),r=nr(e.g),i=nr(e.b),n=tr((.4124564*t+.3575761*r+.1804375*i)/.95047),o=tr(.2126729*t+.7151522*r+.072175*i);return{l:116*o-16,a:500*(n-o),b:200*(o-tr((.0193339*t+.119192*r+.9503041*i)/1.08883)),alpha:e.a}}function ar(e){var t=(e.l+16)/116,r=isNaN(e.a)?t:t+e.a/500,i=isNaN(e.b)?t:t-e.b/200;return t=+rr(t),r=.95047*rr(r),i=1.08883*rr(i),new lt(ir(3.2404542*r-1.5371385*t-.4985314*i),ir(-.969266*r+1.8760108*t+.041556*i),ir(.0556434*r-.2040259*t+1.0572252*i),e.alpha)}var sr={forward:or,reverse:ar,interpolate:function(e,t,r){return{l:Yt(e.l,t.l,r),a:Yt(e.a,t.a,r),b:Yt(e.b,t.b,r),alpha:Yt(e.alpha,t.alpha,r)}}},lr={forward:function(e){var t=or(e),r=t.l,i=t.a,n=t.b,o=Math.atan2(n,i)*er;return{h:o<0?360+o:o,c:Math.sqrt(i*i+n*n),l:r,alpha:e.a}},reverse:function(e){var t=e.h*Qt,r=e.c;return ar({l:e.l,a:Math.cos(t)*r,b:Math.sin(t)*r,alpha:e.alpha})},interpolate:function(e,t,r){return{h:(i=e.h,n=t.h,i+r*(180<(o=n-i)||o<-180?o-360*Math.round(o/360):o)),c:Yt(e.c,t.c,r),l:Yt(e.l,t.l,r),alpha:Yt(e.alpha,t.alpha,r)};var i,n,o}},ur=Object.freeze({__proto__:null,lab:sr,hcl:lr}),cr=function(e,t,r,i,n){this.type=e,this.operator=t,this.interpolation=r,this.input=i,this.labels=[],this.outputs=[];for(var o=0,a=n;o<a.length;o+=1){var s=a[o],l=s[1];this.labels.push(s[0]),this.outputs.push(l)}};function pr(e,t,r,i){var n=i-r,o=e-r;return 0==n?0:1===t?o/n:(Math.pow(t,o)-1)/(Math.pow(t,n)-1)}cr.interpolationFactor=function(e,t,i,n){var o=0;if("exponential"===e.name)o=pr(t,e.base,i,n);else if("linear"===e.name)o=pr(t,1,i,n);else if("cubic-bezier"===e.name){var a=e.controlPoints;o=new r(a[0],a[1],a[2],a[3]).solve(pr(t,1,i,n))}return o},cr.parse=function(e,t){var r=e[0],i=e[1],n=e[2],o=e.slice(3);if(!Array.isArray(i)||0===i.length)return t.error("Expected an interpolation type expression.",1);if("linear"===i[0])i={name:"linear"};else if("exponential"===i[0]){var a=i[1];if("number"!=typeof a)return t.error("Exponential interpolation requires a numeric base.",1,1);i={name:"exponential",base:a}}else{if("cubic-bezier"!==i[0])return t.error("Unknown interpolation type "+String(i[0]),1,0);var s=i.slice(1);if(4!==s.length||s.some((function(e){return"number"!=typeof e||e<0||1<e})))return t.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);i={name:"cubic-bezier",controlPoints:s}}if(e.length-1<4)return t.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if((e.length-1)%2!=0)return t.error("Expected an even number of arguments.");if(!(n=t.parse(n,2,Ze)))return null;var l=[],u=null;"interpolate-hcl"===r||"interpolate-lab"===r?u=Xe:t.expectedType&&"value"!==t.expectedType.kind&&(u=t.expectedType);for(var c=0;c<o.length;c+=2){var p=o[c],h=o[c+1],d=c+3,m=c+4;if("number"!=typeof p)return t.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',d);if(l.length&&l[l.length-1][0]>=p)return t.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',d);var f=t.parse(h,m,u);if(!f)return null;u=u||f.type,l.push([p,f])}return"number"===u.kind||"color"===u.kind||"array"===u.kind&&"number"===u.itemType.kind&&"number"==typeof u.N?new cr(u,r,i,n,l):t.error("Type "+rt(u)+" is not interpolatable.")},cr.prototype.evaluate=function(e){var t=this.labels,r=this.outputs;if(1===t.length)return r[0].evaluate(e);var i=this.input.evaluate(e);if(i<=t[0])return r[0].evaluate(e);var n=t.length;if(i>=t[n-1])return r[n-1].evaluate(e);var o=Kt(t,i),a=cr.interpolationFactor(this.interpolation,i,t[o],t[o+1]),s=r[o].evaluate(e),l=r[o+1].evaluate(e);return"interpolate"===this.operator?Jt[this.type.kind.toLowerCase()](s,l,a):"interpolate-hcl"===this.operator?lr.reverse(lr.interpolate(lr.forward(s),lr.forward(l),a)):sr.reverse(sr.interpolate(sr.forward(s),sr.forward(l),a))},cr.prototype.eachChild=function(e){e(this.input);for(var t=0,r=this.outputs;t<r.length;t+=1)e(r[t])},cr.prototype.outputDefined=function(){return this.outputs.every((function(e){return e.outputDefined()}))},cr.prototype.serialize=function(){var e;e="linear"===this.interpolation.name?["linear"]:"exponential"===this.interpolation.name?1===this.interpolation.base?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);for(var t=[this.operator,e,this.input.serialize()],r=0;r<this.labels.length;r++)t.push(this.labels[r],this.outputs[r].serialize());return t};var hr=function(e,t){this.type=e,this.args=t};hr.parse=function(e,t){if(e.length<2)return t.error("Expectected at least one argument.");var r=null,i=t.expectedType;i&&"value"!==i.kind&&(r=i);for(var n=[],o=0,a=e.slice(1);o<a.length;o+=1){var s=t.parse(a[o],1+n.length,r,void 0,{typeAnnotation:"omit"});if(!s)return null;r=r||s.type,n.push(s)}var l=i&&n.some((function(e){return nt(i,e.type)}));return new hr(l?Je:r,n)},hr.prototype.evaluate=function(e){for(var t,r=null,i=0,n=0,o=this.args;n<o.length&&(i++,(r=o[n].evaluate(e))&&r instanceof ht&&!r.available&&(t=t||r.name,r=null,i===this.args.length&&(r=t)),null===r);n+=1);return r},hr.prototype.eachChild=function(e){this.args.forEach(e)},hr.prototype.outputDefined=function(){return this.args.every((function(e){return e.outputDefined()}))},hr.prototype.serialize=function(){var e=["coalesce"];return this.eachChild((function(t){e.push(t.serialize())})),e};var dr=function(e,t){this.type=t.type,this.bindings=[].concat(e),this.result=t};function mr(e,t,r){this.type=e,this.index=t,this.input=r}function fr(e,t){this.type=Ke,this.needle=e,this.haystack=t}function yr(e,t,r){this.type=Ze,this.needle=e,this.haystack=t,this.fromIndex=r}function gr(e,t,r,i,n,o){this.inputType=e,this.type=t,this.input=r,this.cases=i,this.outputs=n,this.otherwise=o}function vr(e,t,r){this.type=e,this.branches=t,this.otherwise=r}function _r(e,t,r,i){this.type=e,this.input=t,this.beginIndex=r,this.endIndex=i}function br(e,t){return"=="===e||"!="===e?"boolean"===t.kind||"string"===t.kind||"number"===t.kind||"null"===t.kind||"value"===t.kind:"string"===t.kind||"number"===t.kind||"value"===t.kind}function xr(e,t,r,i){return 0===i.compare(t,r)}function wr(e,t,r){var i="=="!==e&&"!="!==e;return n.parse=function(e,t){if(3!==e.length&&4!==e.length)return t.error("Expected two or three arguments.");var r=e[0],o=t.parse(e[1],1,Je);if(!o)return null;if(!br(r,o.type))return t.concat(1).error('"'+r+"\" comparisons are not supported for type '"+rt(o.type)+"'.");var a=t.parse(e[2],2,Je);if(!a)return null;if(!br(r,a.type))return t.concat(2).error('"'+r+"\" comparisons are not supported for type '"+rt(a.type)+"'.");if(o.type.kind!==a.type.kind&&"value"!==o.type.kind&&"value"!==a.type.kind)return t.error("Cannot compare types '"+rt(o.type)+"' and '"+rt(a.type)+"'.");i&&("value"===o.type.kind&&"value"!==a.type.kind?o=new _t(a.type,[o]):"value"!==o.type.kind&&"value"===a.type.kind&&(a=new _t(o.type,[a])));var s=null;if(4===e.length){if("string"!==o.type.kind&&"string"!==a.type.kind&&"value"!==o.type.kind&&"value"!==a.type.kind)return t.error("Cannot use collator to compare non-string types.");if(!(s=t.parse(e[3],3,$e)))return null}return new n(o,a,s)},n.prototype.evaluate=function(n){var o=this.lhs.evaluate(n),a=this.rhs.evaluate(n);if(i&&this.hasUntypedArgument){var s=ft(o),l=ft(a);if(s.kind!==l.kind||"string"!==s.kind&&"number"!==s.kind)throw new vt('Expected arguments for "'+e+'" to be (string, string) or (number, number), but found ('+s.kind+", "+l.kind+") instead.")}if(this.collator&&!i&&this.hasUntypedArgument){var u=ft(o),c=ft(a);if("string"!==u.kind||"string"!==c.kind)return t(n,o,a)}return this.collator?r(n,o,a,this.collator.evaluate(n)):t(n,o,a)},n.prototype.eachChild=function(e){e(this.lhs),e(this.rhs),this.collator&&e(this.collator)},n.prototype.outputDefined=function(){return!0},n.prototype.serialize=function(){var t=[e];return this.eachChild((function(e){t.push(e.serialize())})),t},n;function n(e,t,r){this.type=Ke,this.lhs=e,this.rhs=t,this.collator=r,this.hasUntypedArgument="value"===e.type.kind||"value"===t.type.kind}}function Sr(e,t,r,i,n){this.type=We,this.number=e,this.locale=t,this.currency=r,this.minFractionDigits=i,this.maxFractionDigits=n}dr.prototype.evaluate=function(e){return this.result.evaluate(e)},dr.prototype.eachChild=function(e){for(var t=0,r=this.bindings;t<r.length;t+=1)e(r[t][1]);e(this.result)},dr.parse=function(e,t){if(e.length<4)return t.error("Expected at least 3 arguments, but found "+(e.length-1)+" instead.");for(var r=[],i=1;i<e.length-1;i+=2){var n=e[i];if("string"!=typeof n)return t.error("Expected string, but found "+typeof n+" instead.",i);if(/[^a-zA-Z0-9_]/.test(n))return t.error("Variable names must contain only alphanumeric characters or '_'.",i);var o=t.parse(e[i+1],i+1);if(!o)return null;r.push([n,o])}var a=t.parse(e[e.length-1],e.length-1,t.expectedType,r);return a?new dr(r,a):null},dr.prototype.outputDefined=function(){return this.result.outputDefined()},dr.prototype.serialize=function(){for(var e=["let"],t=0,r=this.bindings;t<r.length;t+=1){var i=r[t];e.push(i[0],i[1].serialize())}return e.push(this.result.serialize()),e},mr.parse=function(e,t){if(3!==e.length)return t.error("Expected 2 arguments, but found "+(e.length-1)+" instead.");var r=t.parse(e[1],1,Ze),i=t.parse(e[2],2,tt(t.expectedType||Je));return r&&i?new mr(i.type.itemType,r,i):null},mr.prototype.evaluate=function(e){var t=this.index.evaluate(e),r=this.input.evaluate(e);if(t<0)throw new vt("Array index out of bounds: "+t+" < 0.");if(t>=r.length)throw new vt("Array index out of bounds: "+t+" > "+(r.length-1)+".");if(t!==Math.floor(t))throw new vt("Array index must be an integer, but found "+t+" instead.");return r[t]},mr.prototype.eachChild=function(e){e(this.index),e(this.input)},mr.prototype.outputDefined=function(){return!1},mr.prototype.serialize=function(){return["at",this.index.serialize(),this.input.serialize()]},fr.parse=function(e,t){if(3!==e.length)return t.error("Expected 2 arguments, but found "+(e.length-1)+" instead.");var r=t.parse(e[1],1,Je),i=t.parse(e[2],2,Je);return r&&i?ot(r.type,[Ke,We,Ze,He,Je])?new fr(r,i):t.error("Expected first argument to be of type boolean, string, number or null, but found "+rt(r.type)+" instead"):null},fr.prototype.evaluate=function(e){var t=this.needle.evaluate(e),r=this.haystack.evaluate(e);if(!r)return!1;if(!at(t,["boolean","string","number","null"]))throw new vt("Expected first argument to be of type boolean, string, number or null, but found "+rt(ft(t))+" instead.");if(!at(r,["string","array"]))throw new vt("Expected second argument to be of type array or string, but found "+rt(ft(r))+" instead.");return 0<=r.indexOf(t)},fr.prototype.eachChild=function(e){e(this.needle),e(this.haystack)},fr.prototype.outputDefined=function(){return!0},fr.prototype.serialize=function(){return["in",this.needle.serialize(),this.haystack.serialize()]},yr.parse=function(e,t){if(e.length<=2||5<=e.length)return t.error("Expected 3 or 4 arguments, but found "+(e.length-1)+" instead.");var r=t.parse(e[1],1,Je),i=t.parse(e[2],2,Je);if(!r||!i)return null;if(!ot(r.type,[Ke,We,Ze,He,Je]))return t.error("Expected first argument to be of type boolean, string, number or null, but found "+rt(r.type)+" instead");if(4!==e.length)return new yr(r,i);var n=t.parse(e[3],3,Ze);return n?new yr(r,i,n):null},yr.prototype.evaluate=function(e){var t=this.needle.evaluate(e),r=this.haystack.evaluate(e);if(!at(t,["boolean","string","number","null"]))throw new vt("Expected first argument to be of type boolean, string, number or null, but found "+rt(ft(t))+" instead.");if(!at(r,["string","array"]))throw new vt("Expected second argument to be of type array or string, but found "+rt(ft(r))+" instead.");if(this.fromIndex){var i=this.fromIndex.evaluate(e);return r.indexOf(t,i)}return r.indexOf(t)},yr.prototype.eachChild=function(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)},yr.prototype.outputDefined=function(){return!1},yr.prototype.serialize=function(){if(null==this.fromIndex||void 0===this.fromIndex)return["index-of",this.needle.serialize(),this.haystack.serialize()];var e=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),e]},gr.parse=function(e,t){if(e.length<5)return t.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if(e.length%2!=1)return t.error("Expected an even number of arguments.");var r,i;t.expectedType&&"value"!==t.expectedType.kind&&(i=t.expectedType);for(var n={},o=[],a=2;a<e.length-1;a+=2){var s=e[a],l=e[a+1];Array.isArray(s)||(s=[s]);var u=t.concat(a);if(0===s.length)return u.error("Expected at least one branch label.");for(var c=0,p=s;c<p.length;c+=1){var h=p[c];if("number"!=typeof h&&"string"!=typeof h)return u.error("Branch labels must be numbers or strings.");if("number"==typeof h&&Math.abs(h)>Number.MAX_SAFE_INTEGER)return u.error("Branch labels must be integers no larger than "+Number.MAX_SAFE_INTEGER+".");if("number"==typeof h&&Math.floor(h)!==h)return u.error("Numeric branch labels must be integer values.");if(r){if(u.checkSubtype(r,ft(h)))return null}else r=ft(h);if(void 0!==n[String(h)])return u.error("Branch labels must be unique.");n[String(h)]=o.length}var d=t.parse(l,a,i);if(!d)return null;i=i||d.type,o.push(d)}var m=t.parse(e[1],1,Je);if(!m)return null;var f=t.parse(e[e.length-1],e.length-1,i);return!f||"value"!==m.type.kind&&t.concat(1).checkSubtype(r,m.type)?null:new gr(r,i,m,n,o,f)},gr.prototype.evaluate=function(e){var t=this.input.evaluate(e);return(ft(t)===this.inputType&&this.outputs[this.cases[t]]||this.otherwise).evaluate(e)},gr.prototype.eachChild=function(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)},gr.prototype.outputDefined=function(){return this.outputs.every((function(e){return e.outputDefined()}))&&this.otherwise.outputDefined()},gr.prototype.serialize=function(){for(var e=this,t=["match",this.input.serialize()],r=[],i={},n=0,o=Object.keys(this.cases).sort();n<o.length;n+=1){var a=o[n];void 0===(p=i[this.cases[a]])?(i[this.cases[a]]=r.length,r.push([this.cases[a],[a]])):r[p][1].push(a)}for(var s=function(t){return"number"===e.inputType.kind?Number(t):t},l=0,u=r;l<u.length;l+=1){var c=u[l],p=c[0],h=c[1];t.push(1===h.length?s(h[0]):h.map(s)),t.push(this.outputs[outputIndex$1].serialize())}return t.push(this.otherwise.serialize()),t},vr.parse=function(e,t){if(e.length<4)return t.error("Expected at least 3 arguments, but found only "+(e.length-1)+".");if(e.length%2!=0)return t.error("Expected an odd number of arguments.");var r;t.expectedType&&"value"!==t.expectedType.kind&&(r=t.expectedType);for(var i=[],n=1;n<e.length-1;n+=2){var o=t.parse(e[n],n,Ke);if(!o)return null;var a=t.parse(e[n+1],n+1,r);if(!a)return null;i.push([o,a]),r=r||a.type}var s=t.parse(e[e.length-1],e.length-1,r);return s?new vr(r,i,s):null},vr.prototype.evaluate=function(e){for(var t=0,r=this.branches;t<r.length;t+=1){var i=r[t],n=i[1];if(i[0].evaluate(e))return n.evaluate(e)}return this.otherwise.evaluate(e)},vr.prototype.eachChild=function(e){for(var t=0,r=this.branches;t<r.length;t+=1){var i=r[t],n=i[1];e(i[0]),e(n)}e(this.otherwise)},vr.prototype.outputDefined=function(){return this.branches.every((function(e){return e[1].outputDefined()}))&&this.otherwise.outputDefined()},vr.prototype.serialize=function(){var e=["case"];return this.eachChild((function(t){e.push(t.serialize())})),e},_r.parse=function(e,t){if(e.length<=2||5<=e.length)return t.error("Expected 3 or 4 arguments, but found "+(e.length-1)+" instead.");var r=t.parse(e[1],1,Je),i=t.parse(e[2],2,Ze);if(!r||!i)return null;if(!ot(r.type,[tt(Je),We,Je]))return t.error("Expected first argument to be of type array or string, but found "+rt(r.type)+" instead");if(4!==e.length)return new _r(r.type,r,i);var n=t.parse(e[3],3,Ze);return n?new _r(r.type,r,i,n):null},_r.prototype.evaluate=function(e){var t=this.input.evaluate(e),r=this.beginIndex.evaluate(e);if(!at(t,["string","array"]))throw new vt("Expected first argument to be of type array or string, but found "+rt(ft(t))+" instead.");if(this.endIndex){var i=this.endIndex.evaluate(e);return t.slice(r,i)}return t.slice(r)},_r.prototype.eachChild=function(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)},_r.prototype.outputDefined=function(){return!1},_r.prototype.serialize=function(){if(null==this.endIndex||void 0===this.endIndex)return["slice",this.input.serialize(),this.beginIndex.serialize()];var e=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),e]};var Tr=wr("==",(function(e,t,r){return t===r}),xr),Cr=wr("!=",(function(e,t,r){return t!==r}),(function(e,t,r,i){return!xr(0,t,r,i)})),Er=wr("<",(function(e,t,r){return t<r}),(function(e,t,r,i){return i.compare(t,r)<0})),Ir=wr(">",(function(e,t,r){return r<t}),(function(e,t,r,i){return 0<i.compare(t,r)})),Pr=wr("<=",(function(e,t,r){return t<=r}),(function(e,t,r,i){return i.compare(t,r)<=0})),Rr=wr(">=",(function(e,t,r){return r<=t}),(function(e,t,r,i){return 0<=i.compare(t,r)}));function Nr(e){this.type=Ze,this.input=e}Sr.parse=function(e,t){if(3!==e.length)return t.error("Expected two arguments.");var r=t.parse(e[1],1,Ze);if(!r)return null;var i=e[2];if("object"!=typeof i||Array.isArray(i))return t.error("NumberFormat options argument must be an object.");var n=null;if(i.locale&&!(n=t.parse(i.locale,1,We)))return null;var o=null;if(i.currency&&!(o=t.parse(i.currency,1,We)))return null;var a=null;if(i["min-fraction-digits"]&&!(a=t.parse(i["min-fraction-digits"],1,Ze)))return null;var s=null;return i["max-fraction-digits"]&&!(s=t.parse(i["max-fraction-digits"],1,Ze))?null:new Sr(r,n,o,a,s)},Sr.prototype.evaluate=function(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))},Sr.prototype.eachChild=function(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)},Sr.prototype.outputDefined=function(){return!1},Sr.prototype.serialize=function(){var e={};return this.locale&&(e.locale=this.locale.serialize()),this.currency&&(e.currency=this.currency.serialize()),this.minFractionDigits&&(e["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(e["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),e]},Nr.parse=function(e,t){if(2!==e.length)return t.error("Expected 1 argument, but found "+(e.length-1)+" instead.");var r=t.parse(e[1],1);return r?"array"!==r.type.kind&&"string"!==r.type.kind&&"value"!==r.type.kind?t.error("Expected argument of type string or array, but found "+rt(r.type)+" instead."):new Nr(r):null},Nr.prototype.evaluate=function(e){var t=this.input.evaluate(e);if("string"==typeof t)return t.length;if(Array.isArray(t))return t.length;throw new vt("Expected value to be of type string or array, but found "+rt(ft(t))+" instead.")},Nr.prototype.eachChild=function(e){e(this.input)},Nr.prototype.outputDefined=function(){return!1},Nr.prototype.serialize=function(){var e=["length"];return this.eachChild((function(t){e.push(t.serialize())})),e};var Ar={"==":Tr,"!=":Cr,">":Ir,"<":Er,">=":Rr,"<=":Pr,array:_t,at:mr,boolean:_t,case:vr,coalesce:hr,collator:Pt,format:xt,image:wt,in:fr,"index-of":yr,interpolate:cr,"interpolate-hcl":cr,"interpolate-lab":cr,length:Nr,let:dr,literal:gt,match:gr,number:_t,"number-format":Sr,object:_t,slice:_r,step:Xt,string:_t,"to-boolean":St,"to-color":St,"to-number":St,"to-string":St,var:Zt,within:jt};function zr(e,t){var r=t[0],i=t[1],n=t[2],o=t[3];r=r.evaluate(e),i=i.evaluate(e),n=n.evaluate(e);var a=o?o.evaluate(e):1,s=dt(r,i,n,a);if(s)throw new vt(s);return new lt(r/255*a,i/255*a,n/255*a,a)}function Mr(e,t){return e in t}function kr(e,t){var r=t[e];return void 0===r?null:r}function Or(e){return{type:e}}function Lr(e){return{result:"success",value:e}}function Dr(e){return{result:"error",value:e}}function Br(e){return"data-driven"===e["property-type"]||"cross-faded-data-driven"===e["property-type"]}function Fr(e){return e.expression&&-1<e.expression.parameters.indexOf("zoom")}function qr(e){return e.expression&&e.expression.interpolated}function Ur(e){return e instanceof Number?"number":e instanceof String?"string":e instanceof Boolean?"boolean":Array.isArray(e)?"array":null===e?"null":typeof e}function jr(e){return"object"==typeof e&&null!==e&&!Array.isArray(e)}function Vr(e){return e}function Gr(e,t,r){return void 0!==e?e:void 0!==t?t:void 0!==r?r:void 0}function Hr(e,t,r,i,n){return Gr(typeof r===n?i[r]:void 0,e.default,t.default)}function Zr(e,t,r){if("number"!==Ur(r))return Gr(e.default,t.default);var i=e.stops.length;if(1===i)return e.stops[0][1];if(r<=e.stops[0][0])return e.stops[0][1];if(r>=e.stops[i-1][0])return e.stops[i-1][1];var n=Kt(e.stops.map((function(e){return e[0]})),r);return e.stops[n][1]}function Wr(e,t,r){var i=void 0!==e.base?e.base:1;if("number"!==Ur(r))return Gr(e.default,t.default);var n=e.stops.length;if(1===n)return e.stops[0][1];if(r<=e.stops[0][0])return e.stops[0][1];if(r>=e.stops[n-1][0])return e.stops[n-1][1];var o,a,s,l,u=Kt(e.stops.map((function(e){return e[0]})),r),c=(o=i,l=r-(a=e.stops[u][0]),0==(s=e.stops[u+1][0]-a)?0:1===o?l/s:(Math.pow(o,l)-1)/(Math.pow(o,s)-1)),p=e.stops[u][1],h=e.stops[u+1][1],d=Jt[t.type]||Vr;if(e.colorSpace&&"rgb"!==e.colorSpace){var m=ur[e.colorSpace];d=function(e,t){return m.reverse(m.interpolate(m.forward(e),m.forward(t),c))}}return"function"==typeof p.evaluate?{evaluate:function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var r=p.evaluate.apply(void 0,e),i=h.evaluate.apply(void 0,e);if(void 0!==r&&void 0!==i)return d(r,i,c)}}:d(p,h,c)}function Kr(e,t,r){return"color"===t.type?r=lt.parse(r):"formatted"===t.type?r=pt.fromString(r.toString()):"resolvedImage"===t.type?r=ht.fromString(r.toString()):Ur(r)===t.type||"enum"===t.type&&t.values[r]||(r=void 0),Gr(r,e.default,t.default)}It.register(Ar,{error:[{kind:"error"},[We],function(e,t){throw new vt(t[0].evaluate(e))}],typeof:[We,[Je],function(e,t){return rt(ft(t[0].evaluate(e)))}],"to-rgba":[tt(Ze,4),[Xe],function(e,t){return t[0].evaluate(e).toArray()}],rgb:[Xe,[Ze,Ze,Ze],zr],rgba:[Xe,[Ze,Ze,Ze,Ze],zr],has:{type:Ke,overloads:[[[We],function(e,t){return Mr(t[0].evaluate(e),e.properties())}],[[We,Ye],function(e,t){var r=t[1];return Mr(t[0].evaluate(e),r.evaluate(e))}]]},get:{type:Je,overloads:[[[We],function(e,t){return kr(t[0].evaluate(e),e.properties())}],[[We,Ye],function(e,t){var r=t[1];return kr(t[0].evaluate(e),r.evaluate(e))}]]},"feature-state":[Je,[We],function(e,t){return kr(t[0].evaluate(e),e.featureState||{})}],properties:[Ye,[],function(e){return e.properties()}],"geometry-type":[We,[],function(e){return e.geometryType()}],id:[Je,[],function(e){return e.id()}],zoom:[Ze,[],function(e){return e.globals.zoom}],"heatmap-density":[Ze,[],function(e){return e.globals.heatmapDensity||0}],"line-progress":[Ze,[],function(e){return e.globals.lineProgress||0}],accumulated:[Je,[],function(e){return void 0===e.globals.accumulated?null:e.globals.accumulated}],"+":[Ze,Or(Ze),function(e,t){for(var r=0,i=0,n=t;i<n.length;i+=1)r+=n[i].evaluate(e);return r}],"*":[Ze,Or(Ze),function(e,t){for(var r=1,i=0,n=t;i<n.length;i+=1)r*=n[i].evaluate(e);return r}],"-":{type:Ze,overloads:[[[Ze,Ze],function(e,t){var r=t[1];return t[0].evaluate(e)-r.evaluate(e)}],[[Ze],function(e,t){return-t[0].evaluate(e)}]]},"/":[Ze,[Ze,Ze],function(e,t){var r=t[1];return t[0].evaluate(e)/r.evaluate(e)}],"%":[Ze,[Ze,Ze],function(e,t){var r=t[1];return t[0].evaluate(e)%r.evaluate(e)}],ln2:[Ze,[],function(){return Math.LN2}],pi:[Ze,[],function(){return Math.PI}],e:[Ze,[],function(){return Math.E}],"^":[Ze,[Ze,Ze],function(e,t){var r=t[1];return Math.pow(t[0].evaluate(e),r.evaluate(e))}],sqrt:[Ze,[Ze],function(e,t){return Math.sqrt(t[0].evaluate(e))}],log10:[Ze,[Ze],function(e,t){return Math.log(t[0].evaluate(e))/Math.LN10}],ln:[Ze,[Ze],function(e,t){return Math.log(t[0].evaluate(e))}],log2:[Ze,[Ze],function(e,t){return Math.log(t[0].evaluate(e))/Math.LN2}],sin:[Ze,[Ze],function(e,t){return Math.sin(t[0].evaluate(e))}],cos:[Ze,[Ze],function(e,t){return Math.cos(t[0].evaluate(e))}],tan:[Ze,[Ze],function(e,t){return Math.tan(t[0].evaluate(e))}],asin:[Ze,[Ze],function(e,t){return Math.asin(t[0].evaluate(e))}],acos:[Ze,[Ze],function(e,t){return Math.acos(t[0].evaluate(e))}],atan:[Ze,[Ze],function(e,t){return Math.atan(t[0].evaluate(e))}],min:[Ze,Or(Ze),function(e,t){return Math.min.apply(Math,t.map((function(t){return t.evaluate(e)})))}],max:[Ze,Or(Ze),function(e,t){return Math.max.apply(Math,t.map((function(t){return t.evaluate(e)})))}],abs:[Ze,[Ze],function(e,t){return Math.abs(t[0].evaluate(e))}],round:[Ze,[Ze],function(e,t){var r=t[0].evaluate(e);return r<0?-Math.round(-r):Math.round(r)}],floor:[Ze,[Ze],function(e,t){return Math.floor(t[0].evaluate(e))}],ceil:[Ze,[Ze],function(e,t){return Math.ceil(t[0].evaluate(e))}],"filter-==":[Ke,[We,Je],function(e,t){var r=t[0],i=t[1];return e.properties()[r.value]===i.value}],"filter-id-==":[Ke,[Je],function(e,t){var r=t[0];return e.id()===r.value}],"filter-type-==":[Ke,[We],function(e,t){var r=t[0];return e.geometryType()===r.value}],"filter-<":[Ke,[We,Je],function(e,t){var r=t[0],i=t[1],n=e.properties()[r.value],o=i.value;return typeof n==typeof o&&n<o}],"filter-id-<":[Ke,[Je],function(e,t){var r=t[0],i=e.id(),n=r.value;return typeof i==typeof n&&i<n}],"filter->":[Ke,[We,Je],function(e,t){var r=t[0],i=t[1],n=e.properties()[r.value],o=i.value;return typeof n==typeof o&&o<n}],"filter-id->":[Ke,[Je],function(e,t){var r=t[0],i=e.id(),n=r.value;return typeof i==typeof n&&n<i}],"filter-<=":[Ke,[We,Je],function(e,t){var r=t[0],i=t[1],n=e.properties()[r.value],o=i.value;return typeof n==typeof o&&n<=o}],"filter-id-<=":[Ke,[Je],function(e,t){var r=t[0],i=e.id(),n=r.value;return typeof i==typeof n&&i<=n}],"filter->=":[Ke,[We,Je],function(e,t){var r=t[0],i=t[1],n=e.properties()[r.value],o=i.value;return typeof n==typeof o&&o<=n}],"filter-id->=":[Ke,[Je],function(e,t){var r=t[0],i=e.id(),n=r.value;return typeof i==typeof n&&n<=i}],"filter-has":[Ke,[Je],function(e,t){return t[0].value in e.properties()}],"filter-has-id":[Ke,[],function(e){return null!==e.id()&&void 0!==e.id()}],"filter-type-in":[Ke,[tt(We)],function(e,t){return 0<=t[0].value.indexOf(e.geometryType())}],"filter-id-in":[Ke,[tt(Je)],function(e,t){return 0<=t[0].value.indexOf(e.id())}],"filter-in-small":[Ke,[We,tt(Je)],function(e,t){var r=t[0];return 0<=t[1].value.indexOf(e.properties()[r.value])}],"filter-in-large":[Ke,[We,tt(Je)],function(e,t){var r=t[0],i=t[1];return function(e,t,r,i){for(;r<=i;){var n=r+i>>1;if(t[n]===e)return!0;t[n]>e?i=n-1:r=1+n}return!1}(e.properties()[r.value],i.value,0,i.value.length-1)}],all:{type:Ke,overloads:[[[Ke,Ke],function(e,t){var r=t[1];return t[0].evaluate(e)&&r.evaluate(e)}],[Or(Ke),function(e,t){for(var r=0,i=t;r<i.length;r+=1)if(!i[r].evaluate(e))return!1;return!0}]]},any:{type:Ke,overloads:[[[Ke,Ke],function(e,t){var r=t[1];return t[0].evaluate(e)||r.evaluate(e)}],[Or(Ke),function(e,t){for(var r=0,i=t;r<i.length;r+=1)if(i[r].evaluate(e))return!0;return!1}]]},"!":[Ke,[Ke],function(e,t){return!t[0].evaluate(e)}],"is-supported-script":[Ke,[We],function(e,t){var r=e.globals&&e.globals.isSupportedScript;return!r||r(t[0].evaluate(e))}],upcase:[We,[We],function(e,t){return t[0].evaluate(e).toUpperCase()}],downcase:[We,[We],function(e,t){return t[0].evaluate(e).toLowerCase()}],concat:[We,Or(Je),function(e,t){return t.map((function(t){return yt(t.evaluate(e))})).join("")}],"resolved-locale":[We,[$e],function(e,t){return t[0].evaluate(e).resolvedLocale()}]});var Xr=function(e,t){var r;this.expression=e,this._warningHistory={},this._evaluator=new Ct,this._defaultValue=t?"color"===(r=t).type&&jr(r.default)?new lt(0,0,0,0):"color"===r.type?lt.parse(r.default)||null:void 0===r.default?null:r.default:null,this._enumValues=t&&"enum"===t.type?t.values:null};function Yr(e){return Array.isArray(e)&&0<e.length&&"string"==typeof e[0]&&e[0]in Ar}function Jr(e,t){var r,i=new Wt(Ar,[],t?(r={color:Xe,string:We,number:Ze,enum:We,boolean:Ke,formatted:Qe,resolvedImage:et},"array"===t.type?tt(r[t.value]||Je,t.length):r[t.type]):void 0),n=i.parse(e,void 0,void 0,void 0,t&&"string"===t.type?{typeAnnotation:"coerce"}:void 0);return n?Lr(new Xr(n,t)):Dr(i.errors)}Xr.prototype.evaluateWithoutErrorHandling=function(e,t,r,i,n,o){return this._evaluator.globals=e,this._evaluator.feature=t,this._evaluator.featureState=r,this._evaluator.canonical=i,this._evaluator.availableImages=n||null,this._evaluator.formattedSection=o,this.expression.evaluate(this._evaluator)},Xr.prototype.evaluate=function(e,t,r,i,n,o){this._evaluator.globals=e,this._evaluator.feature=t||null,this._evaluator.featureState=r||null,this._evaluator.canonical=i,this._evaluator.availableImages=n||null,this._evaluator.formattedSection=o||null;try{var a=this.expression.evaluate(this._evaluator);if(null==a||"number"==typeof a&&a!=a)return this._defaultValue;if(this._enumValues&&!(a in this._enumValues))throw new vt("Expected value to be one of "+Object.keys(this._enumValues).map((function(e){return JSON.stringify(e)})).join(", ")+", but found "+JSON.stringify(a)+" instead.");return a}catch(e){return this._warningHistory[e.message]||(this._warningHistory[e.message]=!0,"undefined"!=typeof console&&console.warn(e.message)),this._defaultValue}};var $r=function(e,t){this.kind=e,this._styleExpression=t,this.isStateDependent="constant"!==e&&!Gt(t.expression)};$r.prototype.evaluateWithoutErrorHandling=function(e,t,r,i,n,o){return this._styleExpression.evaluateWithoutErrorHandling(e,t,r,i,n,o)},$r.prototype.evaluate=function(e,t,r,i,n,o){return this._styleExpression.evaluate(e,t,r,i,n,o)};var Qr=function(e,t,r,i){this.kind=e,this.zoomStops=r,this._styleExpression=t,this.isStateDependent="camera"!==e&&!Gt(t.expression),this.interpolationType=i};function ei(e,t){if("error"===(e=Jr(e,t)).result)return e;var r=e.value.expression,i=Vt(r);if(!i&&!Br(t))return Dr([new Ve("","data expressions not supported")]);var n=Ht(r,["zoom"]);if(!n&&!Fr(t))return Dr([new Ve("","zoom expressions not supported")]);var o=function e(t){var r=null;if(t instanceof dr)r=e(t.result);else if(t instanceof hr)for(var i=0,n=t.args;i<n.length&&!(r=e(n[i]));i+=1);else(t instanceof Xt||t instanceof cr)&&t.input instanceof It&&"zoom"===t.input.name&&(r=t);return r instanceof Ve||t.eachChild((function(t){var i=e(t);i instanceof Ve?r=i:!r&&i?r=new Ve("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):r&&i&&r!==i&&(r=new Ve("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))})),r}(r);return o||n?o instanceof Ve?Dr([o]):o instanceof cr&&!qr(t)?Dr([new Ve("",'"interpolate" expressions cannot be used with this property')]):Lr(o?new Qr(i?"camera":"composite",e.value,o.labels,o instanceof cr?o.interpolation:void 0):new $r(i?"constant":"source",e.value)):Dr([new Ve("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}function ti(e,t){this._parameters=e,this._specification=t,Be(this,function e(t,r){var i,n,o,a="color"===r.type,s=t.stops&&"object"==typeof t.stops[0][0],l=s||!(s||void 0!==t.property),u=t.type||(qr(r)?"exponential":"interval");if(a&&((t=Be({},t)).stops&&(t.stops=t.stops.map((function(e){return[e[0],lt.parse(e[1])]}))),t.default=lt.parse(t.default?t.default:r.default)),t.colorSpace&&"rgb"!==t.colorSpace&&!ur[t.colorSpace])throw new Error("Unknown color space: "+t.colorSpace);if("exponential"===u)i=Wr;else if("interval"===u)i=Zr;else if("categorical"===u){i=Hr,n=Object.create(null);for(var c=0,p=t.stops;c<p.length;c+=1){var h=p[c];n[h[0]]=h[1]}o=typeof t.stops[0][0]}else{if("identity"!==u)throw new Error('Unknown function type "'+u+'"');i=Kr}if(s){for(var d={},m=[],f=0;f<t.stops.length;f++){var y=t.stops[f],g=y[0].zoom;void 0===d[g]&&(d[g]={zoom:g,type:t.type,property:t.property,default:t.default,stops:[]},m.push(g)),d[g].stops.push([y[0].value,y[1]])}for(var v=[],_=0,b=m;_<b.length;_+=1){var x=b[_];v.push([d[x].zoom,e(d[x],r)])}var w={name:"linear"};return{kind:"composite",interpolationType:w,interpolationFactor:cr.interpolationFactor.bind(void 0,w),zoomStops:v.map((function(e){return e[0]})),evaluate:function(e,i){var n=e.zoom;return Wr({stops:v,base:t.base},r,n).evaluate(n,i)}}}if(l){var S="exponential"===u?{name:"exponential",base:void 0!==t.base?t.base:1}:null;return{kind:"camera",interpolationType:S,interpolationFactor:cr.interpolationFactor.bind(void 0,S),zoomStops:t.stops.map((function(e){return e[0]})),evaluate:function(e){return i(t,r,e.zoom,n,o)}}}return{kind:"source",evaluate:function(e,a){var s=a&&a.properties?a.properties[t.property]:void 0;return void 0===s?Gr(t.default,r.default):i(t,r,s,n,o)}}}(this._parameters,this._specification))}function ri(e){var t=e.key,r=e.value,i=e.valueSpec||{},n=e.objectElementValidators||{},o=e.style,a=e.styleSpec,s=[],l=Ur(r);if("object"!==l)return[new Le(t,r,"object expected, "+l+" found")];for(var u in r){var c=u.split(".")[0],p=i[c]||i["*"],h=void 0;if(n[c])h=n[c];else if(i[c])h=Ii;else if(n["*"])h=n["*"];else{if(!i["*"]){s.push(new Le(t,r[u],'unknown property "'+u+'"'));continue}h=Ii}s=s.concat(h({key:(t?t+".":t)+u,value:r[u],valueSpec:p,style:o,styleSpec:a,object:r,objectKey:u},r))}for(var d in i)n[d]||i[d].required&&void 0===i[d].default&&void 0===r[d]&&s.push(new Le(t,r,'missing required property "'+d+'"'));return s}function ii(e){var t=e.value,r=e.valueSpec,i=e.style,n=e.styleSpec,o=e.key,a=e.arrayElementValidator||Ii;if("array"!==Ur(t))return[new Le(o,t,"array expected, "+Ur(t)+" found")];if(r.length&&t.length!==r.length)return[new Le(o,t,"array length "+r.length+" expected, length "+t.length+" found")];if(r["min-length"]&&t.length<r["min-length"])return[new Le(o,t,"array length at least "+r["min-length"]+" expected, length "+t.length+" found")];var s={type:r.value,values:r.values};n.$version<7&&(s.function=r.function),"object"===Ur(r.value)&&(s=r.value);for(var l=[],u=0;u<t.length;u++)l=l.concat(a({array:t,arrayIndex:u,value:t[u],valueSpec:s,style:i,styleSpec:n,key:o+"["+u+"]"}));return l}function ni(e){var t=e.key,r=e.value,i=e.valueSpec,n=Ur(r);return"number"===n&&r!=r&&(n="NaN"),"number"!==n?[new Le(t,r,"number expected, "+n+" found")]:"minimum"in i&&r<i.minimum?[new Le(t,r,r+" is less than the minimum value "+i.minimum)]:"maximum"in i&&r>i.maximum?[new Le(t,r,r+" is greater than the maximum value "+i.maximum)]:[]}function oi(e){var t,r,i,n=e.valueSpec,o=Fe(e.value.type),a={},s="categorical"!==o&&void 0===e.value.property,l=!s,u="array"===Ur(e.value.stops)&&"array"===Ur(e.value.stops[0])&&"object"===Ur(e.value.stops[0][0]),c=ri({key:e.key,value:e.value,valueSpec:e.styleSpec.function,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{stops:function(e){if("identity"===o)return[new Le(e.key,e.value,'identity function may not have a "stops" property')];var t=[],r=e.value;return t=t.concat(ii({key:e.key,value:r,valueSpec:e.valueSpec,style:e.style,styleSpec:e.styleSpec,arrayElementValidator:p})),"array"===Ur(r)&&0===r.length&&t.push(new Le(e.key,r,"array must have at least one stop")),t},default:function(e){return Ii({key:e.key,value:e.value,valueSpec:n,style:e.style,styleSpec:e.styleSpec})}}});return"identity"===o&&s&&c.push(new Le(e.key,e.value,'missing required property "property"')),"identity"===o||e.value.stops||c.push(new Le(e.key,e.value,'missing required property "stops"')),"exponential"===o&&e.valueSpec.expression&&!qr(e.valueSpec)&&c.push(new Le(e.key,e.value,"exponential functions not supported")),8<=e.styleSpec.$version&&(l&&!Br(e.valueSpec)?c.push(new Le(e.key,e.value,"property functions not supported")):s&&!Fr(e.valueSpec)&&c.push(new Le(e.key,e.value,"zoom functions not supported"))),"categorical"!==o&&!u||void 0!==e.value.property||c.push(new Le(e.key,e.value,'"property" property is required')),c;function p(e){var t=[],o=e.value,s=e.key;if("array"!==Ur(o))return[new Le(s,o,"array expected, "+Ur(o)+" found")];if(2!==o.length)return[new Le(s,o,"array length 2 expected, length "+o.length+" found")];if(u){if("object"!==Ur(o[0]))return[new Le(s,o,"object expected, "+Ur(o[0])+" found")];if(void 0===o[0].zoom)return[new Le(s,o,"object stop key must have zoom")];if(void 0===o[0].value)return[new Le(s,o,"object stop key must have value")];if(i&&i>Fe(o[0].zoom))return[new Le(s,o[0].zoom,"stop zoom values must appear in ascending order")];Fe(o[0].zoom)!==i&&(i=Fe(o[0].zoom),r=void 0,a={}),t=t.concat(ri({key:s+"[0]",value:o[0],valueSpec:{zoom:{}},style:e.style,styleSpec:e.styleSpec,objectElementValidators:{zoom:ni,value:h}}))}else t=t.concat(h({key:s+"[0]",value:o[0],valueSpec:{},style:e.style,styleSpec:e.styleSpec},o));return Yr(qe(o[1]))?t.concat([new Le(s+"[1]",o[1],"expressions are not allowed in function stops.")]):t.concat(Ii({key:s+"[1]",value:o[1],valueSpec:n,style:e.style,styleSpec:e.styleSpec}))}function h(e,i){var s=Ur(e.value),l=Fe(e.value),u=null!==e.value?e.value:i;if(t){if(s!==t)return[new Le(e.key,u,s+" stop domain type must match previous stop domain type "+t)]}else t=s;if("number"!==s&&"string"!==s&&"boolean"!==s)return[new Le(e.key,u,"stop domain value must be a number, string, or boolean")];if("number"===s||"categorical"===o)return"categorical"!==o||"number"!==s||isFinite(l)&&Math.floor(l)===l?"categorical"!==o&&"number"===s&&void 0!==r&&l<r?[new Le(e.key,u,"stop domain values must appear in ascending order")]:(r=l,"categorical"===o&&l in a?[new Le(e.key,u,"stop domain values must be unique")]:(a[l]=!0,[])):[new Le(e.key,u,"integer expected, found "+l)];var c="number expected, "+s+" found";return Br(n)&&void 0===o&&(c+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Le(e.key,u,c)]}}function ai(e){var t=("property"===e.expressionContext?ei:Jr)(qe(e.value),e.valueSpec);if("error"===t.result)return t.value.map((function(t){return new Le(""+e.key+t.key,e.value,t.message)}));var r=t.value.expression||t.value._styleExpression.expression;if("property"===e.expressionContext&&"text-font"===e.propertyKey&&!r.outputDefined())return[new Le(e.key,e.value,'Invalid data expression for "'+e.propertyKey+'". Output values must be contained as literals within the expression.')];if("property"===e.expressionContext&&"layout"===e.propertyType&&!Gt(r))return[new Le(e.key,e.value,'"feature-state" data expressions are not supported with layout properties.')];if("filter"===e.expressionContext&&!Gt(r))return[new Le(e.key,e.value,'"feature-state" data expressions are not supported with filters.')];if(e.expressionContext&&0===e.expressionContext.indexOf("cluster")){if(!Ht(r,["zoom","feature-state"]))return[new Le(e.key,e.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if("cluster-initial"===e.expressionContext&&!Vt(r))return[new Le(e.key,e.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function si(e){var t=e.key,r=e.value,i=e.valueSpec,n=[];return Array.isArray(i.values)?-1===i.values.indexOf(Fe(r))&&n.push(new Le(t,r,"expected one of ["+i.values.join(", ")+"], "+JSON.stringify(r)+" found")):-1===Object.keys(i.values).indexOf(Fe(r))&&n.push(new Le(t,r,"expected one of ["+Object.keys(i.values).join(", ")+"], "+JSON.stringify(r)+" found")),n}function li(e){if(!0===e||!1===e)return 1;if(Array.isArray(e)&&0!==e.length)switch(e[0]){case"has":return 2<=e.length&&"$id"!==e[1]&&"$type"!==e[1];case"in":return 3<=e.length&&("string"!=typeof e[1]||Array.isArray(e[2]));case"!in":case"!has":case"none":return;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==e.length||Array.isArray(e[1])||Array.isArray(e[2]);case"any":case"all":for(var t=0,r=e.slice(1);t<r.length;t+=1){var i=r[t];if(!li(i)&&"boolean"!=typeof i)return}return 1;default:return 1}}Qr.prototype.evaluateWithoutErrorHandling=function(e,t,r,i,n,o){return this._styleExpression.evaluateWithoutErrorHandling(e,t,r,i,n,o)},Qr.prototype.evaluate=function(e,t,r,i,n,o){return this._styleExpression.evaluate(e,t,r,i,n,o)},Qr.prototype.interpolationFactor=function(e,t,r){return this.interpolationType?cr.interpolationFactor(this.interpolationType,e,t,r):0},ti.deserialize=function(e){return new ti(e._parameters,e._specification)};var ui={type:"boolean",default:!(ti.serialize=function(e){return{_parameters:e._parameters,_specification:e._specification}}),transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function ci(e){if(null==e)return{filter:function(){return!0},needGeometry:!1};li(e)||(e=hi(e));var t=Jr(e,ui);if("error"===t.result)throw new Error(t.value.map((function(e){return e.key+": "+e.message})).join(", "));return{filter:function(e,r,i){return t.value.evaluate(e,r,{},i)},needGeometry:function e(t){if(!Array.isArray(t))return!1;if("within"===t[0])return!0;for(var r=1;r<t.length;r++)if(e(t[r]))return!0;return!1}(e)}}function pi(e,t){return e<t?-1:t<e?1:0}function hi(e){if(!e)return!0;var t,r=e[0];return e.length<=1?"any"!==r:"=="===r?di(e[1],e[2],"=="):"!="===r?yi(di(e[1],e[2],"==")):"<"===r||">"===r||"<="===r||">="===r?di(e[1],e[2],r):"any"===r?(t=e.slice(1),["any"].concat(t.map(hi))):"all"===r?["all"].concat(e.slice(1).map(hi)):"none"===r?["all"].concat(e.slice(1).map(hi).map(yi)):"in"===r?mi(e[1],e.slice(2)):"!in"===r?yi(mi(e[1],e.slice(2))):"has"===r?fi(e[1]):"!has"===r?yi(fi(e[1])):"within"!==r||e}function di(e,t,r){switch(e){case"$type":return["filter-type-"+r,t];case"$id":return["filter-id-"+r,t];default:return["filter-"+r,e,t]}}function mi(e,t){if(0===t.length)return!1;switch(e){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:return 200<t.length&&!t.some((function(e){return typeof e!=typeof t[0]}))?["filter-in-large",e,["literal",t.sort(pi)]]:["filter-in-small",e,["literal",t]]}}function fi(e){switch(e){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",e]}}function yi(e){return["!",e]}function gi(e){return li(qe(e.value))?ai(Be({},e,{expressionContext:"filter",valueSpec:{value:"boolean"}})):function e(t){var r=t.value,i=t.key;if("array"!==Ur(r))return[new Le(i,r,"array expected, "+Ur(r)+" found")];var n,o=t.styleSpec,a=[];if(r.length<1)return[new Le(i,r,"filter array must have at least 1 element")];switch(a=a.concat(si({key:i+"[0]",value:r[0],valueSpec:o.filter_operator,style:t.style,styleSpec:t.styleSpec})),Fe(r[0])){case"<":case"<=":case">":case">=":2<=r.length&&"$type"===Fe(r[1])&&a.push(new Le(i,r,'"$type" cannot be use with operator "'+r[0]+'"'));case"==":case"!=":3!==r.length&&a.push(new Le(i,r,'filter array for operator "'+r[0]+'" must have 3 elements'));case"in":case"!in":2<=r.length&&"string"!==(n=Ur(r[1]))&&a.push(new Le(i+"[1]",r[1],"string expected, "+n+" found"));for(var s=2;s<r.length;s++)n=Ur(r[s]),"$type"===Fe(r[1])?a=a.concat(si({key:i+"["+s+"]",value:r[s],valueSpec:o.geometry_type,style:t.style,styleSpec:t.styleSpec})):"string"!==n&&"number"!==n&&"boolean"!==n&&a.push(new Le(i+"["+s+"]",r[s],"string, number, or boolean expected, "+n+" found"));break;case"any":case"all":case"none":for(var l=1;l<r.length;l++)a=a.concat(e({key:i+"["+l+"]",value:r[l],style:t.style,styleSpec:t.styleSpec}));break;case"has":case"!has":n=Ur(r[1]),2!==r.length?a.push(new Le(i,r,'filter array for "'+r[0]+'" operator must have 2 elements')):"string"!==n&&a.push(new Le(i+"[1]",r[1],"string expected, "+n+" found"));break;case"within":n=Ur(r[1]),2!==r.length?a.push(new Le(i,r,'filter array for "'+r[0]+'" operator must have 2 elements')):"object"!==n&&a.push(new Le(i+"[1]",r[1],"object expected, "+n+" found"))}return a}(e)}function vi(e,t){var r=e.key,i=e.style,n=e.styleSpec,o=e.value,a=e.objectKey,s=n[t+"_"+e.layerType];if(!s)return[];var l=a.match(/^(.*)-transition$/);if("paint"===t&&l&&s[l[1]]&&s[l[1]].transition)return Ii({key:r,value:o,valueSpec:n.transition,style:i,styleSpec:n});var u,c=e.valueSpec||s[a];if(!c)return[new Le(r,o,'unknown property "'+a+'"')];if("string"===Ur(o)&&Br(c)&&!c.tokens&&(u=/^{([^}]+)}$/.exec(o)))return[new Le(r,o,'"'+a+'" does not support interpolation syntax\nUse an identity property function instead: `{ "type": "identity", "property": '+JSON.stringify(u[1])+" }`.")];var p=[];return"symbol"===e.layerType&&("text-field"===a&&i&&!i.glyphs&&p.push(new Le(r,o,'use of "text-field" requires a style "glyphs" property')),"text-font"===a&&jr(qe(o))&&"identity"===Fe(o.type)&&p.push(new Le(r,o,'"text-font" does not support identity functions'))),p.concat(Ii({key:e.key,value:o,valueSpec:c,style:i,styleSpec:n,expressionContext:"property",propertyType:t,propertyKey:a}))}function _i(e){return vi(e,"paint")}function bi(e){return vi(e,"layout")}function xi(e){var t=[],r=e.value,i=e.key,n=e.style,o=e.styleSpec;r.type||r.ref||t.push(new Le(i,r,'either "type" or "ref" is required'));var a,s=Fe(r.type),l=Fe(r.ref);if(r.id)for(var u=Fe(r.id),c=0;c<e.arrayIndex;c++){var p=n.layers[c];Fe(p.id)===u&&t.push(new Le(i,r.id,'duplicate layer id "'+r.id+'", previously used at line '+p.id.__line__))}if("ref"in r)["type","source","source-layer","filter","layout"].forEach((function(e){e in r&&t.push(new Le(i,r[e],'"'+e+'" is prohibited for ref layers'))})),n.layers.forEach((function(e){Fe(e.id)===l&&(a=e)})),a?a.ref?t.push(new Le(i,r.ref,"ref cannot reference another ref layer")):s=Fe(a.type):t.push(new Le(i,r.ref,'ref layer "'+l+'" not found'));else if("background"!==s)if(r.source){var h=n.sources&&n.sources[r.source],d=h&&Fe(h.type);h?"vector"===d&&"raster"===s?t.push(new Le(i,r.source,'layer "'+r.id+'" requires a raster source')):"raster"===d&&"raster"!==s?t.push(new Le(i,r.source,'layer "'+r.id+'" requires a vector source')):"vector"!==d||r["source-layer"]?"raster-dem"===d&&"hillshade"!==s?t.push(new Le(i,r.source,"raster-dem source can only be used with layer type 'hillshade'.")):"line"!==s||!r.paint||!r.paint["line-gradient"]||"geojson"===d&&h.lineMetrics||t.push(new Le(i,r,'layer "'+r.id+'" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled.')):t.push(new Le(i,r,'layer "'+r.id+'" must specify a "source-layer"')):t.push(new Le(i,r.source,'source "'+r.source+'" not found'))}else t.push(new Le(i,r,'missing required property "source"'));return t=t.concat(ri({key:i,value:r,valueSpec:o.layer,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{"*":function(){return[]},type:function(){return Ii({key:i+".type",value:r.type,valueSpec:o.layer.type,style:e.style,styleSpec:e.styleSpec,object:r,objectKey:"type"})},filter:gi,layout:function(e){return ri({layer:r,key:e.key,value:e.value,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{"*":function(e){return bi(Be({layerType:s},e))}}})},paint:function(e){return ri({layer:r,key:e.key,value:e.value,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{"*":function(e){return _i(Be({layerType:s},e))}}})}}}))}function wi(e){var t=e.value,r=e.key,i=Ur(t);return"string"!==i?[new Le(r,t,"string expected, "+i+" found")]:[]}var Si={promoteId:function(e){var t=e.key,r=e.value;if("string"===Ur(r))return wi({key:t,value:r});var i=[];for(var n in r)i.push.apply(i,wi({key:t+"."+n,value:r[n]}));return i}};function Ti(e){var t=e.value,r=e.key,i=e.styleSpec,n=e.style;if(!t.type)return[new Le(r,t,'"type" is required')];var o,a=Fe(t.type);switch(a){case"vector":case"raster":case"raster-dem":return ri({key:r,value:t,valueSpec:i["source_"+a.replace("-","_")],style:e.style,styleSpec:i,objectElementValidators:Si});case"geojson":if(o=ri({key:r,value:t,valueSpec:i.source_geojson,style:n,styleSpec:i,objectElementValidators:Si}),t.cluster)for(var s in t.clusterProperties){var l=t.clusterProperties[s],u=l[0],c="string"==typeof u?[u,["accumulated"],["get",s]]:u;o.push.apply(o,ai({key:r+"."+s+".map",value:l[1],expressionContext:"cluster-map"})),o.push.apply(o,ai({key:r+"."+s+".reduce",value:c,expressionContext:"cluster-reduce"}))}return o;case"video":return ri({key:r,value:t,valueSpec:i.source_video,style:n,styleSpec:i});case"image":return ri({key:r,value:t,valueSpec:i.source_image,style:n,styleSpec:i});case"canvas":return[new Le(r,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return si({key:r+".type",value:t.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:n,styleSpec:i})}}function Ci(e){var t=e.value,r=e.styleSpec,i=r.light,n=e.style,o=[],a=Ur(t);if(void 0===t)return o;if("object"!==a)return o.concat([new Le("light",t,"object expected, "+a+" found")]);for(var s in t){var l=s.match(/^(.*)-transition$/);o=o.concat(l&&i[l[1]]&&i[l[1]].transition?Ii({key:s,value:t[s],valueSpec:r.transition,style:n,styleSpec:r}):i[s]?Ii({key:s,value:t[s],valueSpec:i[s],style:n,styleSpec:r}):[new Le(s,t[s],'unknown property "'+s+'"')])}return o}var Ei={"*":function(){return[]},array:ii,boolean:function(e){var t=e.value,r=e.key,i=Ur(t);return"boolean"!==i?[new Le(r,t,"boolean expected, "+i+" found")]:[]},number:ni,color:function(e){var t=e.key,r=e.value,i=Ur(r);return"string"!==i?[new Le(t,r,"color expected, "+i+" found")]:null===st(r)?[new Le(t,r,'color expected, "'+r+'" found')]:[]},constants:De,enum:si,filter:gi,function:oi,layer:xi,object:ri,source:Ti,light:Ci,string:wi,formatted:function(e){return 0===wi(e).length?[]:ai(e)},resolvedImage:function(e){return 0===wi(e).length?[]:ai(e)}};function Ii(e){var t=e.value,r=e.valueSpec,i=e.styleSpec;return r.expression&&jr(Fe(t))?oi(e):r.expression&&Yr(qe(t))?ai(e):r.type&&Ei[r.type]?Ei[r.type](e):ri(Be({},e,{valueSpec:r.type?i[r.type]:r}))}function Pi(e){var t=e.value,r=e.key,i=wi(e);return i.length||(-1===t.indexOf("{fontstack}")&&i.push(new Le(r,t,'"glyphs" url must include a "{fontstack}" token')),-1===t.indexOf("{range}")&&i.push(new Le(r,t,'"glyphs" url must include a "{range}" token'))),i}function Ri(e,t){void 0===t&&(t=Oe);var r=[];return r=r.concat(Ii({key:"",value:e,valueSpec:t.$root,styleSpec:t,style:e,objectElementValidators:{glyphs:Pi,"*":function(){return[]}}})),e.constants&&(r=r.concat(De({key:"constants",value:e.constants,style:e,styleSpec:t}))),Ni(r)}function Ni(e){return[].concat(e).sort((function(e,t){return e.line-t.line}))}function Ai(e){return function(){for(var t=[],r=arguments.length;r--;)t[r]=arguments[r];return Ni(e.apply(this,t))}}Ri.source=Ai(Ti),Ri.light=Ai(Ci),Ri.layer=Ai(xi),Ri.filter=Ai(gi),Ri.paintProperty=Ai(_i),Ri.layoutProperty=Ai(bi);var zi=Ri,Mi=zi.light,ki=zi.paintProperty,Oi=zi.layoutProperty;function Li(e,t){var r=!1;if(t&&t.length)for(var i=0,n=t;i<n.length;i+=1)e.fire(new Me(new Error(n[i].message))),r=!0;return r}var Di=Bi;function Bi(e,t,r){var i=this.cells=[];if(e instanceof ArrayBuffer){this.arrayBuffer=e;var n=new Int32Array(this.arrayBuffer);e=n[0],this.d=(t=n[1])+2*(r=n[2]);for(var o=0;o<this.d*this.d;o++){var a=n[3+o],s=n[3+o+1];i.push(a===s?null:n.subarray(a,s))}var l=n[3+i.length+1];this.keys=n.subarray(n[3+i.length],l),this.bboxes=n.subarray(l),this.insert=this._insertReadonly}else{this.d=t+2*r;for(var u=0;u<this.d*this.d;u++)i.push([]);this.keys=[],this.bboxes=[]}this.n=t,this.extent=e,this.padding=r,this.scale=t/e,this.uid=0;var c=r/t*e;this.min=-c,this.max=e+c}Bi.prototype.insert=function(e,t,r,i,n){this._forEachCell(t,r,i,n,this._insertCell,this.uid++),this.keys.push(e),this.bboxes.push(t),this.bboxes.push(r),this.bboxes.push(i),this.bboxes.push(n)},Bi.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},Bi.prototype._insertCell=function(e,t,r,i,n,o){this.cells[n].push(o)},Bi.prototype.query=function(e,t,r,i,n){var o=this.min,a=this.max;if(e<=o&&t<=o&&a<=r&&a<=i&&!n)return Array.prototype.slice.call(this.keys);var s=[];return this._forEachCell(e,t,r,i,this._queryCell,s,{},n),s},Bi.prototype._queryCell=function(e,t,r,i,n,o,a,s){var l=this.cells[n];if(null!==l)for(var u=this.keys,c=this.bboxes,p=0;p<l.length;p++){var h=l[p];if(void 0===a[h]){var d=4*h;(s?s(c[0+d],c[1+d],c[2+d],c[3+d]):e<=c[2+d]&&t<=c[3+d]&&r>=c[0+d]&&i>=c[1+d])?(a[h]=!0,o.push(u[h])):a[h]=!1}}},Bi.prototype._forEachCell=function(e,t,r,i,n,o,a,s){for(var l=this._convertToCellCoord(e),u=this._convertToCellCoord(t),c=this._convertToCellCoord(r),p=this._convertToCellCoord(i),h=l;h<=c;h++)for(var d=u;d<=p;d++){var m=this.d*d+h;if((!s||s(this._convertFromCellCoord(h),this._convertFromCellCoord(d),this._convertFromCellCoord(h+1),this._convertFromCellCoord(d+1)))&&n.call(this,e,t,r,i,m,o,a,s))return}},Bi.prototype._convertFromCellCoord=function(e){return(e-this.padding)/this.scale},Bi.prototype._convertToCellCoord=function(e){return Math.max(0,Math.min(this.d-1,Math.floor(e*this.scale)+this.padding))},Bi.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var e=this.cells,t=3+this.cells.length+1+1,r=0,i=0;i<this.cells.length;i++)r+=this.cells[i].length;var n=new Int32Array(t+r+this.keys.length+this.bboxes.length);n[0]=this.extent,n[1]=this.n,n[2]=this.padding;for(var o=t,a=0;a<e.length;a++){var s=e[a];n[3+a]=o,n.set(s,o),o+=s.length}return n[3+e.length]=o,n.set(this.keys,o),n[3+e.length+1]=o+=this.keys.length,n.set(this.bboxes,o),o+=this.bboxes.length,n.buffer};var Fi=a.ImageData,qi=a.ImageBitmap,Ui={};function ji(e,t,r){void 0===r&&(r={}),Object.defineProperty(t,"_classRegistryKey",{value:e,writeable:!1}),Ui[e]={klass:t,omit:r.omit||[],shallow:r.shallow||[]}}for(var Vi in ji("Object",Object),Di.serialize=function(e,t){var r=e.toArrayBuffer();return t&&t.push(r),{buffer:r}},Di.deserialize=function(e){return new Di(e.buffer)},ji("Grid",Di),ji("Color",lt),ji("Error",Error),ji("ResolvedImage",ht),ji("StylePropertyFunction",ti),ji("StyleExpression",Xr,{omit:["_evaluator"]}),ji("ZoomDependentExpression",Qr),ji("ZoomConstantExpression",$r),ji("CompoundExpression",It,{omit:["_evaluate"]}),Ar)Ar[Vi]._classRegistryKey||ji("Expression_"+Vi,Ar[Vi]);function Gi(e){return e&&"undefined"!=typeof ArrayBuffer&&(e instanceof ArrayBuffer||e.constructor&&"ArrayBuffer"===e.constructor.name)}function Hi(e){return qi&&e instanceof qi}function Zi(e,t){if(null==e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||e instanceof Boolean||e instanceof Number||e instanceof String||e instanceof Date||e instanceof RegExp)return e;if(Gi(e)||Hi(e))return t&&t.push(e),e;if(ArrayBuffer.isView(e)){var r=e;return t&&t.push(r.buffer),r}if(e instanceof Fi)return t&&t.push(e.data.buffer),e;if(Array.isArray(e)){for(var i=[],n=0,o=e;n<o.length;n+=1)i.push(Zi(o[n],t));return i}if("object"!=typeof e)throw new Error("can't serialize object of type "+typeof e);var a=e.constructor,s=a._classRegistryKey;if(!s)throw new Error("can't serialize object of unregistered class");var l=a.serialize?a.serialize(e,t):{};if(!a.serialize){for(var u in e)if(e.hasOwnProperty(u)&&!(0<=Ui[s].omit.indexOf(u))){var c=e[u];l[u]=0<=Ui[s].shallow.indexOf(u)?c:Zi(c,t)}e instanceof Error&&(l.message=e.message)}if(l.$name)throw new Error("$name property is reserved for worker serialization logic.");return"Object"!==s&&(l.$name=s),l}function Wi(e){if(null==e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||e instanceof Boolean||e instanceof Number||e instanceof String||e instanceof Date||e instanceof RegExp||Gi(e)||Hi(e)||ArrayBuffer.isView(e)||e instanceof Fi)return e;if(Array.isArray(e))return e.map(Wi);if("object"!=typeof e)throw new Error("can't deserialize object of type "+typeof e);var t=e.$name||"Object",r=Ui[t].klass;if(!r)throw new Error("can't deserialize unregistered class "+t);if(r.deserialize)return r.deserialize(e);for(var i=Object.create(r.prototype),n=0,o=Object.keys(e);n<o.length;n+=1){var a=o[n];if("$name"!==a){var s=e[a];i[a]=0<=Ui[t].shallow.indexOf(a)?s:Wi(s)}}return i}function Ki(){this.first=!0}Ki.prototype.update=function(e,t){var r=Math.floor(e);return this.first?(this.first=!1,this.lastIntegerZoom=r,this.lastIntegerZoomTime=0,this.lastZoom=e,this.lastFloorZoom=r,!0):(this.lastFloorZoom>r?(this.lastIntegerZoom=r+1,this.lastIntegerZoomTime=t):this.lastFloorZoom<r&&(this.lastIntegerZoom=r,this.lastIntegerZoomTime=t),e!==this.lastZoom&&(this.lastZoom=e,this.lastFloorZoom=r,!0))};var Xi={"Latin-1 Supplement":function(e){return 128<=e&&e<=255},Arabic:function(e){return 1536<=e&&e<=1791},"Arabic Supplement":function(e){return 1872<=e&&e<=1919},"Arabic Extended-A":function(e){return 2208<=e&&e<=2303},"Hangul Jamo":function(e){return 4352<=e&&e<=4607},"Unified Canadian Aboriginal Syllabics":function(e){return 5120<=e&&e<=5759},Khmer:function(e){return 6016<=e&&e<=6143},"Unified Canadian Aboriginal Syllabics Extended":function(e){return 6320<=e&&e<=6399},"General Punctuation":function(e){return 8192<=e&&e<=8303},"Letterlike Symbols":function(e){return 8448<=e&&e<=8527},"Number Forms":function(e){return 8528<=e&&e<=8591},"Miscellaneous Technical":function(e){return 8960<=e&&e<=9215},"Control Pictures":function(e){return 9216<=e&&e<=9279},"Optical Character Recognition":function(e){return 9280<=e&&e<=9311},"Enclosed Alphanumerics":function(e){return 9312<=e&&e<=9471},"Geometric Shapes":function(e){return 9632<=e&&e<=9727},"Miscellaneous Symbols":function(e){return 9728<=e&&e<=9983},"Miscellaneous Symbols and Arrows":function(e){return 11008<=e&&e<=11263},"CJK Radicals Supplement":function(e){return 11904<=e&&e<=12031},"Kangxi Radicals":function(e){return 12032<=e&&e<=12255},"Ideographic Description Characters":function(e){return 12272<=e&&e<=12287},"CJK Symbols and Punctuation":function(e){return 12288<=e&&e<=12351},Hiragana:function(e){return 12352<=e&&e<=12447},Katakana:function(e){return 12448<=e&&e<=12543},Bopomofo:function(e){return 12544<=e&&e<=12591},"Hangul Compatibility Jamo":function(e){return 12592<=e&&e<=12687},Kanbun:function(e){return 12688<=e&&e<=12703},"Bopomofo Extended":function(e){return 12704<=e&&e<=12735},"CJK Strokes":function(e){return 12736<=e&&e<=12783},"Katakana Phonetic Extensions":function(e){return 12784<=e&&e<=12799},"Enclosed CJK Letters and Months":function(e){return 12800<=e&&e<=13055},"CJK Compatibility":function(e){return 13056<=e&&e<=13311},"CJK Unified Ideographs Extension A":function(e){return 13312<=e&&e<=19903},"Yijing Hexagram Symbols":function(e){return 19904<=e&&e<=19967},"CJK Unified Ideographs":function(e){return 19968<=e&&e<=40959},"Yi Syllables":function(e){return 40960<=e&&e<=42127},"Yi Radicals":function(e){return 42128<=e&&e<=42191},"Hangul Jamo Extended-A":function(e){return 43360<=e&&e<=43391},"Hangul Syllables":function(e){return 44032<=e&&e<=55215},"Hangul Jamo Extended-B":function(e){return 55216<=e&&e<=55295},"Private Use Area":function(e){return 57344<=e&&e<=63743},"CJK Compatibility Ideographs":function(e){return 63744<=e&&e<=64255},"Arabic Presentation Forms-A":function(e){return 64336<=e&&e<=65023},"Vertical Forms":function(e){return 65040<=e&&e<=65055},"CJK Compatibility Forms":function(e){return 65072<=e&&e<=65103},"Small Form Variants":function(e){return 65104<=e&&e<=65135},"Arabic Presentation Forms-B":function(e){return 65136<=e&&e<=65279},"Halfwidth and Fullwidth Forms":function(e){return 65280<=e&&e<=65519}};function Yi(e){for(var t=0,r=e;t<r.length;t+=1)if(Ji(r[t].charCodeAt(0)))return!0;return!1}function Ji(e){return 746===e||747===e||!(e<4352)&&(Xi["Bopomofo Extended"](e)||Xi.Bopomofo(e)||Xi["CJK Compatibility Forms"](e)&&!(65097<=e&&e<=65103)||Xi["CJK Compatibility Ideographs"](e)||Xi["CJK Compatibility"](e)||Xi["CJK Radicals Supplement"](e)||Xi["CJK Strokes"](e)||!(!Xi["CJK Symbols and Punctuation"](e)||12296<=e&&e<=12305||12308<=e&&e<=12319||12336===e)||Xi["CJK Unified Ideographs Extension A"](e)||Xi["CJK Unified Ideographs"](e)||Xi["Enclosed CJK Letters and Months"](e)||Xi["Hangul Compatibility Jamo"](e)||Xi["Hangul Jamo Extended-A"](e)||Xi["Hangul Jamo Extended-B"](e)||Xi["Hangul Jamo"](e)||Xi["Hangul Syllables"](e)||Xi.Hiragana(e)||Xi["Ideographic Description Characters"](e)||Xi.Kanbun(e)||Xi["Kangxi Radicals"](e)||Xi["Katakana Phonetic Extensions"](e)||Xi.Katakana(e)&&12540!==e||!(!Xi["Halfwidth and Fullwidth Forms"](e)||65288===e||65289===e||65293===e||65306<=e&&e<=65310||65339===e||65341===e||65343===e||65371<=e&&e<=65503||65507===e||65512<=e&&e<=65519)||!(!Xi["Small Form Variants"](e)||65112<=e&&e<=65118||65123<=e&&e<=65126)||Xi["Unified Canadian Aboriginal Syllabics"](e)||Xi["Unified Canadian Aboriginal Syllabics Extended"](e)||Xi["Vertical Forms"](e)||Xi["Yijing Hexagram Symbols"](e)||Xi["Yi Syllables"](e)||Xi["Yi Radicals"](e))}function $i(e){return!(Ji(e)||(t=e,Xi["Latin-1 Supplement"](t)&&(167===t||169===t||174===t||177===t||188===t||189===t||190===t||215===t||247===t)||Xi["General Punctuation"](t)&&(8214===t||8224===t||8225===t||8240===t||8241===t||8251===t||8252===t||8258===t||8263===t||8264===t||8265===t||8273===t)||Xi["Letterlike Symbols"](t)||Xi["Number Forms"](t)||Xi["Miscellaneous Technical"](t)&&(8960<=t&&t<=8967||8972<=t&&t<=8991||8996<=t&&t<=9e3||9003===t||9085<=t&&t<=9114||9150<=t&&t<=9165||9167===t||9169<=t&&t<=9179||9186<=t&&t<=9215)||Xi["Control Pictures"](t)&&9251!==t||Xi["Optical Character Recognition"](t)||Xi["Enclosed Alphanumerics"](t)||Xi["Geometric Shapes"](t)||Xi["Miscellaneous Symbols"](t)&&!(9754<=t&&t<=9759)||Xi["Miscellaneous Symbols and Arrows"](t)&&(11026<=t&&t<=11055||11088<=t&&t<=11097||11192<=t&&t<=11243)||Xi["CJK Symbols and Punctuation"](t)||Xi.Katakana(t)||Xi["Private Use Area"](t)||Xi["CJK Compatibility Forms"](t)||Xi["Small Form Variants"](t)||Xi["Halfwidth and Fullwidth Forms"](t)||8734===t||8756===t||8757===t||9984<=t&&t<=10087||10102<=t&&t<=10131||65532===t||65533===t));var t}function Qi(e){return 1424<=e&&e<=2303||Xi["Arabic Presentation Forms-A"](e)||Xi["Arabic Presentation Forms-B"](e)}function en(e){for(var t=0,r=e;t<r.length;t+=1)if(Qi(r[t].charCodeAt(0)))return 1}function tn(e){e&&"string"==typeof e&&-1<e.indexOf("NetworkError")&&(nn="error"),rn&&rn(e)}var rn=null,nn="unavailable",on=null;function an(){cn.fire(new Ne("pluginStateChange",{pluginStatus:nn,pluginURL:on}))}function sn(){return nn}function ln(){if("deferred"!==nn||!on)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");nn="loading",an(),on&&Se({url:on},(function(e){e?tn(e):(nn="loaded",an())}))}function un(e,t){this.zoom=e,t?(this.now=t.now,this.fadeDuration=t.fadeDuration,this.zoomHistory=t.zoomHistory,this.transition=t.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Ki,this.transition={})}var cn=new Ae,pn={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:function(){return"loaded"===nn||null!=pn.applyArabicShaping},isLoading:function(){return"loading"===nn},setState:function(e){nn=e.pluginStatus,on=e.pluginURL},isParsed:function(){return null!=pn.applyArabicShaping&&null!=pn.processBidirectionalText&&null!=pn.processStyledBidirectionalText},getPluginURL:function(){return on}};function hn(e,t){this.property=e,this.value=t,this.expression=function(e,t){if(jr(e))return new ti(e,t);if(Yr(e)){var r=ei(e,t);if("error"===r.result)throw new Error(r.value.map((function(e){return e.key+": "+e.message})).join(", "));return r.value}var i=e;return"string"==typeof e&&"color"===t.type&&(i=lt.parse(e)),{kind:"constant",evaluate:function(){return i}}}(void 0===t?e.specification.default:t,e.specification)}function dn(e){this.property=e,this.value=new hn(e,void 0)}function mn(e){this._properties=e,this._values=Object.create(e.defaultTransitionablePropertyValues)}un.prototype.isSupportedScript=function(e){return function(e,t){for(var r=0,i=e;r<i.length;r+=1)if(n=i[r].charCodeAt(0),!t&&Qi(n)||2304<=n&&n<=3583||3840<=n&&n<=4255||Xi.Khmer(n))return!1;var n;return!0}(e,pn.isLoaded())},un.prototype.crossFadingFactor=function(){return 0===this.fadeDuration?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)},un.prototype.getCrossfadeParameters=function(){var e=this.zoom,t=e-Math.floor(e),r=this.crossFadingFactor();return e>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:t+(1-t)*r}:{fromScale:.5,toScale:1,t:1-(1-r)*t}},hn.prototype.isDataDriven=function(){return"source"===this.expression.kind||"composite"===this.expression.kind},hn.prototype.possiblyEvaluate=function(e,t,r){return this.property.possiblyEvaluate(this,e,t,r)},dn.prototype.transitioned=function(e,t){return new fn(this.property,this.value,t,p({},e.transition,this.transition),e.now)},dn.prototype.untransitioned=function(){return new fn(this.property,this.value,null,{},0)},mn.prototype.getValue=function(e){return b(this._values[e].value.value)},mn.prototype.setValue=function(e,t){this._values.hasOwnProperty(e)||(this._values[e]=new dn(this._values[e].property)),this._values[e].value=new hn(this._values[e].property,null===t?void 0:b(t))},mn.prototype.getTransition=function(e){return b(this._values[e].transition)},mn.prototype.setTransition=function(e,t){this._values.hasOwnProperty(e)||(this._values[e]=new dn(this._values[e].property)),this._values[e].transition=b(t)||void 0},mn.prototype.serialize=function(){for(var e={},t=0,r=Object.keys(this._values);t<r.length;t+=1){var i=r[t],n=this.getValue(i);void 0!==n&&(e[i]=n);var o=this.getTransition(i);void 0!==o&&(e[i+"-transition"]=o)}return e},mn.prototype.transitioned=function(e,t){for(var r=new yn(this._properties),i=0,n=Object.keys(this._values);i<n.length;i+=1){var o=n[i];r._values[o]=this._values[o].transitioned(e,t._values[o])}return r},mn.prototype.untransitioned=function(){for(var e=new yn(this._properties),t=0,r=Object.keys(this._values);t<r.length;t+=1){var i=r[t];e._values[i]=this._values[i].untransitioned()}return e};var fn=function(e,t,r,i,n){this.property=e,this.value=t,this.begin=n+i.delay||0,this.end=this.begin+i.duration||0,e.specification.transition&&(i.delay||i.duration)&&(this.prior=r)};fn.prototype.possiblyEvaluate=function(e,t,r){var i=e.now||0,n=this.value.possiblyEvaluate(e,t,r),o=this.prior;if(o){if(i>this.end)return this.prior=null,n;if(this.value.isDataDriven())return this.prior=null,n;if(i<this.begin)return o.possiblyEvaluate(e,t,r);var a=(i-this.begin)/(this.end-this.begin);return this.property.interpolate(o.possiblyEvaluate(e,t,r),n,function(){if(a<=0)return 0;if(1<=a)return 1;var e=a*a,t=e*a;return 4*(a<.5?t:3*(a-e)+t-.75)}())}return n};var yn=function(e){this._properties=e,this._values=Object.create(e.defaultTransitioningPropertyValues)};function gn(e){this._properties=e,this._values=Object.create(e.defaultPropertyValues)}function vn(e,t,r){this.property=e,this.value=t,this.parameters=r}yn.prototype.possiblyEvaluate=function(e,t,r){for(var i=new _n(this._properties),n=0,o=Object.keys(this._values);n<o.length;n+=1){var a=o[n];i._values[a]=this._values[a].possiblyEvaluate(e,t,r)}return i},yn.prototype.hasTransition=function(){for(var e=0,t=Object.keys(this._values);e<t.length;e+=1)if(this._values[t[e]].prior)return!0;return!1},gn.prototype.getValue=function(e){return b(this._values[e].value)},gn.prototype.setValue=function(e,t){this._values[e]=new hn(this._values[e].property,null===t?void 0:b(t))},gn.prototype.serialize=function(){for(var e={},t=0,r=Object.keys(this._values);t<r.length;t+=1){var i=r[t],n=this.getValue(i);void 0!==n&&(e[i]=n)}return e},gn.prototype.possiblyEvaluate=function(e,t,r){for(var i=new _n(this._properties),n=0,o=Object.keys(this._values);n<o.length;n+=1){var a=o[n];i._values[a]=this._values[a].possiblyEvaluate(e,t,r)}return i},vn.prototype.isConstant=function(){return"constant"===this.value.kind},vn.prototype.constantOr=function(e){return"constant"===this.value.kind?this.value.value:e},vn.prototype.evaluate=function(e,t,r,i){return this.property.evaluate(this.value,this.parameters,e,t,r,i)};var _n=function(e){this._properties=e,this._values=Object.create(e.defaultPossiblyEvaluatedValues)};function bn(e){this.specification=e}function xn(e,t){this.specification=e,this.overrides=t}function wn(e){this.specification=e}_n.prototype.get=function(e){return this._values[e]},bn.prototype.possiblyEvaluate=function(e,t){return e.expression.evaluate(t)},bn.prototype.interpolate=function(e,t,r){var i=Jt[this.specification.type];return i?i(e,t,r):e},xn.prototype.possiblyEvaluate=function(e,t,r,i){return new vn(this,"constant"===e.expression.kind||"camera"===e.expression.kind?{kind:"constant",value:e.expression.evaluate(t,null,{},r,i)}:e.expression,t)},xn.prototype.interpolate=function(e,t,r){if("constant"!==e.value.kind||"constant"!==t.value.kind)return e;if(void 0===e.value.value||void 0===t.value.value)return new vn(this,{kind:"constant",value:void 0},e.parameters);var i=Jt[this.specification.type];return i?new vn(this,{kind:"constant",value:i(e.value.value,t.value.value,r)},e.parameters):e},xn.prototype.evaluate=function(e,t,r,i,n,o){return"constant"===e.kind?e.value:e.evaluate(t,r,i,n,o)};var Sn,Tn=(Cn.__proto__=Sn=xn,((Cn.prototype=Object.create(Sn&&Sn.prototype)).constructor=Cn).prototype.possiblyEvaluate=function(e,t,r,i){if(void 0===e.value)return new vn(this,{kind:"constant",value:void 0},t);if("constant"===e.expression.kind){var n=e.expression.evaluate(t,null,{},r,i),o="resolvedImage"===e.property.specification.type&&"string"!=typeof n?n.name:n;return new vn(this,{kind:"constant",value:this._calculate(o,o,o,t)},t)}return"camera"!==e.expression.kind?new vn(this,e.expression,t):new vn(this,{kind:"constant",value:this._calculate(e.expression.evaluate({zoom:t.zoom-1}),e.expression.evaluate({zoom:t.zoom}),e.expression.evaluate({zoom:t.zoom+1}),t)},t)},Cn.prototype.evaluate=function(e,t,r,i,n,o){if("source"!==e.kind)return"composite"===e.kind?this._calculate(e.evaluate({zoom:Math.floor(t.zoom)-1},r,i),e.evaluate({zoom:Math.floor(t.zoom)},r,i),e.evaluate({zoom:Math.floor(t.zoom)+1},r,i),t):e.value;var a=e.evaluate(t,r,i,n,o);return this._calculate(a,a,a,t)},Cn.prototype._calculate=function(e,t,r,i){return i.zoom>i.zoomHistory.lastIntegerZoom?{from:e,to:t}:{from:r,to:t}},Cn.prototype.interpolate=function(e){return e},Cn);function Cn(){Sn.apply(this,arguments)}function En(e){this.specification=e}function In(e){for(var t in this.properties=e,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[],e){var r=e[t];r.specification.overridable&&this.overridableProperties.push(t);var i=this.defaultPropertyValues[t]=new hn(r,void 0),n=this.defaultTransitionablePropertyValues[t]=new dn(r);this.defaultTransitioningPropertyValues[t]=n.untransitioned(),this.defaultPossiblyEvaluatedValues[t]=i.possiblyEvaluate({})}}function Pn(e,t){this._structArray=e,this._pos1=t*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}function Rn(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}wn.prototype.possiblyEvaluate=function(e,t,r,i){if(void 0!==e.value){if("constant"!==e.expression.kind)return this._calculate(e.expression.evaluate(new un(Math.floor(t.zoom-1),t)),e.expression.evaluate(new un(Math.floor(t.zoom),t)),e.expression.evaluate(new un(Math.floor(t.zoom+1),t)),t);var n=e.expression.evaluate(t,null,{},r,i);return this._calculate(n,n,n,t)}},wn.prototype._calculate=function(e,t,r,i){return i.zoom>i.zoomHistory.lastIntegerZoom?{from:e,to:t}:{from:r,to:t}},wn.prototype.interpolate=function(e){return e},En.prototype.possiblyEvaluate=function(e,t,r,i){return!!e.expression.evaluate(t,null,{},r,i)},En.prototype.interpolate=function(){return!1},ji("DataDrivenProperty",xn),ji("DataConstantProperty",bn),ji("CrossFadedDataDrivenProperty",Tn),ji("CrossFadedProperty",wn),ji("ColorRampProperty",En);var Nn,An=(Mn.__proto__=Nn=Ae,((Mn.prototype=Object.create(Nn&&Nn.prototype)).constructor=Mn).prototype.getCrossfadeParameters=function(){return this._crossfadeParameters},Mn.prototype.getLayoutProperty=function(e){return"visibility"===e?this.visibility:this._unevaluatedLayout.getValue(e)},Mn.prototype.setLayoutProperty=function(e,t,r){void 0===r&&(r={}),null!=t&&this._validate(Oi,"layers."+this.id+".layout."+e,e,t,r)||("visibility"!==e?this._unevaluatedLayout.setValue(e,t):this.visibility=t)},Mn.prototype.getPaintProperty=function(e){return g(e,"-transition")?this._transitionablePaint.getTransition(e.slice(0,-"-transition".length)):this._transitionablePaint.getValue(e)},Mn.prototype.setPaintProperty=function(e,t,r){if(void 0===r&&(r={}),null!=t&&this._validate(ki,"layers."+this.id+".paint."+e,e,t,r))return!1;if(g(e,"-transition"))return this._transitionablePaint.setTransition(e.slice(0,-"-transition".length),t||void 0),!1;var i=this._transitionablePaint._values[e],n="cross-faded-data-driven"===i.property.specification["property-type"],o=i.value.isDataDriven(),a=i.value;this._transitionablePaint.setValue(e,t),this._handleSpecialPaintPropertyUpdate(e);var s=this._transitionablePaint._values[e].value;return s.isDataDriven()||o||n||this._handleOverridablePaintPropertyUpdate(e,a,s)},Mn.prototype._handleSpecialPaintPropertyUpdate=function(e){},Mn.prototype._handleOverridablePaintPropertyUpdate=function(e,t,r){return!1},Mn.prototype.isHidden=function(e){return!!(this.minzoom&&e<this.minzoom)||!!(this.maxzoom&&e>=this.maxzoom)||"none"===this.visibility},Mn.prototype.updateTransitions=function(e){this._transitioningPaint=this._transitionablePaint.transitioned(e,this._transitioningPaint)},Mn.prototype.hasTransition=function(){return this._transitioningPaint.hasTransition()},Mn.prototype.recalculate=function(e,t){e.getCrossfadeParameters&&(this._crossfadeParameters=e.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(e,void 0,t)),this.paint=this._transitioningPaint.possiblyEvaluate(e,void 0,t)},Mn.prototype.serialize=function(){var e={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(e.layout=e.layout||{},e.layout.visibility=this.visibility),_(e,(function(e,t){return!(void 0===e||"layout"===t&&!Object.keys(e).length||"paint"===t&&!Object.keys(e).length)}))},Mn.prototype._validate=function(e,t,r,i,n){return void 0===n&&(n={}),(!n||!1!==n.validate)&&Li(this,e.call(zi,{key:t,layerType:this.type,objectKey:r,value:i,styleSpec:Oe,style:{glyphs:!0,sprite:!0}}))},Mn.prototype.is3D=function(){return!1},Mn.prototype.isTileClipped=function(){return!1},Mn.prototype.hasOffscreenPass=function(){return!1},Mn.prototype.resize=function(){},Mn.prototype.isStateDependent=function(){for(var e in this.paint._values){var t=this.paint.get(e);if(t instanceof vn&&Br(t.property.specification)&&("source"===t.value.kind||"composite"===t.value.kind)&&t.value.isStateDependent)return!0}return!1},Mn),zn={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};function Mn(e,t){if(Nn.call(this),this.id=e.id,this.type=e.type,this._featureFilter={filter:function(){return!0},needGeometry:!1},"custom"!==e.type&&(this.metadata=(e=e).metadata,this.minzoom=e.minzoom,this.maxzoom=e.maxzoom,"background"!==e.type&&(this.source=e.source,this.sourceLayer=e["source-layer"],this.filter=e.filter),t.layout&&(this._unevaluatedLayout=new gn(t.layout)),t.paint)){for(var r in this._transitionablePaint=new mn(t.paint),e.paint)this.setPaintProperty(r,e.paint[r],{validate:!1});for(var i in e.layout)this.setLayoutProperty(i,e.layout[i],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new _n(t.paint)}}function kn(e,t){void 0===t&&(t=1);var r=0,i=0;return{members:e.map((function(e){var n=zn[e.type].BYTES_PER_ELEMENT,o=r=On(r,Math.max(t,n)),a=e.components||1;return i=Math.max(i,n),r+=n*a,{name:e.name,type:e.type,components:a,offset:o}})),size:On(r,Math.max(i,t)),alignment:t}}function On(e,t){return Math.ceil(e/t)*t}Rn.serialize=function(e,t){return e._trim(),t&&(e.isTransferred=!0,t.push(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}},Rn.deserialize=function(e){var t=Object.create(this.prototype);return t.arrayBuffer=e.arrayBuffer,t.length=e.length,t.capacity=e.arrayBuffer.byteLength/t.bytesPerElement,t._refreshViews(),t},Rn.prototype._trim=function(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())},Rn.prototype.clear=function(){this.length=0},Rn.prototype.resize=function(e){this.reserve(e),this.length=e},Rn.prototype.reserve=function(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);var t=this.uint8;this._refreshViews(),t&&this.uint8.set(t)}},Rn.prototype._refreshViews=function(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")};var Ln,Dn=(Bn.__proto__=Ln=Rn,((Bn.prototype=Object.create(Ln&&Ln.prototype)).constructor=Bn).prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},Bn.prototype.emplaceBack=function(e,t){var r=this.length;return this.resize(r+1),this.emplace(r,e,t)},Bn.prototype.emplace=function(e,t,r){var i=2*e;return this.int16[0+i]=t,this.int16[1+i]=r,e},Bn);function Bn(){Ln.apply(this,arguments)}Dn.prototype.bytesPerElement=4,ji("StructArrayLayout2i4",Dn);var Fn,qn=(Un.__proto__=Fn=Rn,((Un.prototype=Object.create(Fn&&Fn.prototype)).constructor=Un).prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},Un.prototype.emplaceBack=function(e,t,r,i){var n=this.length;return this.resize(n+1),this.emplace(n,e,t,r,i)},Un.prototype.emplace=function(e,t,r,i,n){var o=4*e;return this.int16[0+o]=t,this.int16[1+o]=r,this.int16[2+o]=i,this.int16[3+o]=n,e},Un);function Un(){Fn.apply(this,arguments)}qn.prototype.bytesPerElement=8,ji("StructArrayLayout4i8",qn);var jn,Vn=(Gn.__proto__=jn=Rn,((Gn.prototype=Object.create(jn&&jn.prototype)).constructor=Gn).prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},Gn.prototype.emplaceBack=function(e,t,r,i,n,o){var a=this.length;return this.resize(a+1),this.emplace(a,e,t,r,i,n,o)},Gn.prototype.emplace=function(e,t,r,i,n,o,a){var s=6*e;return this.int16[0+s]=t,this.int16[1+s]=r,this.int16[2+s]=i,this.int16[3+s]=n,this.int16[4+s]=o,this.int16[5+s]=a,e},Gn);function Gn(){jn.apply(this,arguments)}Vn.prototype.bytesPerElement=12,ji("StructArrayLayout2i4i12",Vn);var Hn,Zn=(Wn.__proto__=Hn=Rn,((Wn.prototype=Object.create(Hn&&Hn.prototype)).constructor=Wn).prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},Wn.prototype.emplaceBack=function(e,t,r,i,n,o){var a=this.length;return this.resize(a+1),this.emplace(a,e,t,r,i,n,o)},Wn.prototype.emplace=function(e,t,r,i,n,o,a){var s=4*e,l=8*e;return this.int16[0+s]=t,this.int16[1+s]=r,this.uint8[4+l]=i,this.uint8[5+l]=n,this.uint8[6+l]=o,this.uint8[7+l]=a,e},Wn);function Wn(){Hn.apply(this,arguments)}Zn.prototype.bytesPerElement=8,ji("StructArrayLayout2i4ub8",Zn);var Kn,Xn=(Yn.__proto__=Kn=Rn,((Yn.prototype=Object.create(Kn&&Kn.prototype)).constructor=Yn).prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},Yn.prototype.emplaceBack=function(e,t,r,i,n,o,a,s,l,u){var c=this.length;return this.resize(c+1),this.emplace(c,e,t,r,i,n,o,a,s,l,u)},Yn.prototype.emplace=function(e,t,r,i,n,o,a,s,l,u,c){var p=10*e;return this.uint16[0+p]=t,this.uint16[1+p]=r,this.uint16[2+p]=i,this.uint16[3+p]=n,this.uint16[4+p]=o,this.uint16[5+p]=a,this.uint16[6+p]=s,this.uint16[7+p]=l,this.uint16[8+p]=u,this.uint16[9+p]=c,e},Yn);function Yn(){Kn.apply(this,arguments)}Xn.prototype.bytesPerElement=20,ji("StructArrayLayout10ui20",Xn);var Jn,$n=(Qn.__proto__=Jn=Rn,((Qn.prototype=Object.create(Jn&&Jn.prototype)).constructor=Qn).prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},Qn.prototype.emplaceBack=function(e,t,r,i,n,o,a,s,l,u,c,p){var h=this.length;return this.resize(h+1),this.emplace(h,e,t,r,i,n,o,a,s,l,u,c,p)},Qn.prototype.emplace=function(e,t,r,i,n,o,a,s,l,u,c,p,h){var d=12*e;return this.int16[0+d]=t,this.int16[1+d]=r,this.int16[2+d]=i,this.int16[3+d]=n,this.uint16[4+d]=o,this.uint16[5+d]=a,this.uint16[6+d]=s,this.uint16[7+d]=l,this.int16[8+d]=u,this.int16[9+d]=c,this.int16[10+d]=p,this.int16[11+d]=h,e},Qn);function Qn(){Jn.apply(this,arguments)}$n.prototype.bytesPerElement=24,ji("StructArrayLayout4i4ui4i24",$n);var eo,to=(ro.__proto__=eo=Rn,((ro.prototype=Object.create(eo&&eo.prototype)).constructor=ro).prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},ro.prototype.emplaceBack=function(e,t,r){var i=this.length;return this.resize(i+1),this.emplace(i,e,t,r)},ro.prototype.emplace=function(e,t,r,i){var n=3*e;return this.float32[0+n]=t,this.float32[1+n]=r,this.float32[2+n]=i,e},ro);function ro(){eo.apply(this,arguments)}to.prototype.bytesPerElement=12,ji("StructArrayLayout3f12",to);var io,no=(oo.__proto__=io=Rn,((oo.prototype=Object.create(io&&io.prototype)).constructor=oo).prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)},oo.prototype.emplaceBack=function(e){var t=this.length;return this.resize(t+1),this.emplace(t,e)},oo.prototype.emplace=function(e,t){return this.uint32[+e+0]=t,e},oo);function oo(){io.apply(this,arguments)}no.prototype.bytesPerElement=4,ji("StructArrayLayout1ul4",no);var ao,so=(lo.__proto__=ao=Rn,((lo.prototype=Object.create(ao&&ao.prototype)).constructor=lo).prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},lo.prototype.emplaceBack=function(e,t,r,i,n,o,a,s,l){var u=this.length;return this.resize(u+1),this.emplace(u,e,t,r,i,n,o,a,s,l)},lo.prototype.emplace=function(e,t,r,i,n,o,a,s,l,u){var c=10*e,p=5*e;return this.int16[0+c]=t,this.int16[1+c]=r,this.int16[2+c]=i,this.int16[3+c]=n,this.int16[4+c]=o,this.int16[5+c]=a,this.uint32[3+p]=s,this.uint16[8+c]=l,this.uint16[9+c]=u,e},lo);function lo(){ao.apply(this,arguments)}so.prototype.bytesPerElement=20,ji("StructArrayLayout6i1ul2ui20",so);var uo,co=(po.__proto__=uo=Rn,((po.prototype=Object.create(uo&&uo.prototype)).constructor=po).prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},po.prototype.emplaceBack=function(e,t,r,i,n,o){var a=this.length;return this.resize(a+1),this.emplace(a,e,t,r,i,n,o)},po.prototype.emplace=function(e,t,r,i,n,o,a){var s=6*e;return this.int16[0+s]=t,this.int16[1+s]=r,this.int16[2+s]=i,this.int16[3+s]=n,this.int16[4+s]=o,this.int16[5+s]=a,e},po);function po(){uo.apply(this,arguments)}co.prototype.bytesPerElement=12,ji("StructArrayLayout2i2i2i12",co);var ho,mo=(fo.__proto__=ho=Rn,((fo.prototype=Object.create(ho&&ho.prototype)).constructor=fo).prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},fo.prototype.emplaceBack=function(e,t,r,i,n){var o=this.length;return this.resize(o+1),this.emplace(o,e,t,r,i,n)},fo.prototype.emplace=function(e,t,r,i,n,o){var a=4*e,s=8*e;return this.float32[0+a]=t,this.float32[1+a]=r,this.float32[2+a]=i,this.int16[6+s]=n,this.int16[7+s]=o,e},fo);function fo(){ho.apply(this,arguments)}mo.prototype.bytesPerElement=16,ji("StructArrayLayout2f1f2i16",mo);var yo,go=(vo.__proto__=yo=Rn,((vo.prototype=Object.create(yo&&yo.prototype)).constructor=vo).prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},vo.prototype.emplaceBack=function(e,t,r,i){var n=this.length;return this.resize(n+1),this.emplace(n,e,t,r,i)},vo.prototype.emplace=function(e,t,r,i,n){var o=12*e,a=3*e;return this.uint8[0+o]=t,this.uint8[1+o]=r,this.float32[1+a]=i,this.float32[2+a]=n,e},vo);function vo(){yo.apply(this,arguments)}go.prototype.bytesPerElement=12,ji("StructArrayLayout2ub2f12",go);var _o,bo=(xo.__proto__=_o=Rn,((xo.prototype=Object.create(_o&&_o.prototype)).constructor=xo).prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},xo.prototype.emplaceBack=function(e,t,r){var i=this.length;return this.resize(i+1),this.emplace(i,e,t,r)},xo.prototype.emplace=function(e,t,r,i){var n=3*e;return this.uint16[0+n]=t,this.uint16[1+n]=r,this.uint16[2+n]=i,e},xo);function xo(){_o.apply(this,arguments)}bo.prototype.bytesPerElement=6,ji("StructArrayLayout3ui6",bo);var wo,So=(To.__proto__=wo=Rn,((To.prototype=Object.create(wo&&wo.prototype)).constructor=To).prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},To.prototype.emplaceBack=function(e,t,r,i,n,o,a,s,l,u,c,p,h,d,m,f,y){var g=this.length;return this.resize(g+1),this.emplace(g,e,t,r,i,n,o,a,s,l,u,c,p,h,d,m,f,y)},To.prototype.emplace=function(e,t,r,i,n,o,a,s,l,u,c,p,h,d,m,f,y,g){var v=24*e,_=12*e,b=48*e;return this.int16[0+v]=t,this.int16[1+v]=r,this.uint16[2+v]=i,this.uint16[3+v]=n,this.uint32[2+_]=o,this.uint32[3+_]=a,this.uint32[4+_]=s,this.uint16[10+v]=l,this.uint16[11+v]=u,this.uint16[12+v]=c,this.float32[7+_]=p,this.float32[8+_]=h,this.uint8[36+b]=d,this.uint8[37+b]=m,this.uint8[38+b]=f,this.uint32[10+_]=y,this.int16[22+v]=g,e},To);function To(){wo.apply(this,arguments)}So.prototype.bytesPerElement=48,ji("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",So);var Co,Eo=(Io.__proto__=Co=Rn,((Io.prototype=Object.create(Co&&Co.prototype)).constructor=Io).prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},Io.prototype.emplaceBack=function(e,t,r,i,n,o,a,s,l,u,c,p,h,d,m,f,y,g,v,_,b,x,w,S,T,C,E,I){var P=this.length;return this.resize(P+1),this.emplace(P,e,t,r,i,n,o,a,s,l,u,c,p,h,d,m,f,y,g,v,_,b,x,w,S,T,C,E,I)},Io.prototype.emplace=function(e,t,r,i,n,o,a,s,l,u,c,p,h,d,m,f,y,g,v,_,b,x,w,S,T,C,E,I,P){var R=34*e,N=17*e;return this.int16[0+R]=t,this.int16[1+R]=r,this.int16[2+R]=i,this.int16[3+R]=n,this.int16[4+R]=o,this.int16[5+R]=a,this.int16[6+R]=s,this.int16[7+R]=l,this.uint16[8+R]=u,this.uint16[9+R]=c,this.uint16[10+R]=p,this.uint16[11+R]=h,this.uint16[12+R]=d,this.uint16[13+R]=m,this.uint16[14+R]=f,this.uint16[15+R]=y,this.uint16[16+R]=g,this.uint16[17+R]=v,this.uint16[18+R]=_,this.uint16[19+R]=b,this.uint16[20+R]=x,this.uint16[21+R]=w,this.uint16[22+R]=S,this.uint32[12+N]=T,this.float32[13+N]=C,this.float32[14+N]=E,this.float32[15+N]=I,this.float32[16+N]=P,e},Io);function Io(){Co.apply(this,arguments)}Eo.prototype.bytesPerElement=68,ji("StructArrayLayout8i15ui1ul4f68",Eo);var Po,Ro=(No.__proto__=Po=Rn,((No.prototype=Object.create(Po&&Po.prototype)).constructor=No).prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},No.prototype.emplaceBack=function(e){var t=this.length;return this.resize(t+1),this.emplace(t,e)},No.prototype.emplace=function(e,t){return this.float32[+e+0]=t,e},No);function No(){Po.apply(this,arguments)}Ro.prototype.bytesPerElement=4,ji("StructArrayLayout1f4",Ro);var Ao,zo=(Mo.__proto__=Ao=Rn,((Mo.prototype=Object.create(Ao&&Ao.prototype)).constructor=Mo).prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},Mo.prototype.emplaceBack=function(e,t,r){var i=this.length;return this.resize(i+1),this.emplace(i,e,t,r)},Mo.prototype.emplace=function(e,t,r,i){var n=3*e;return this.int16[0+n]=t,this.int16[1+n]=r,this.int16[2+n]=i,e},Mo);function Mo(){Ao.apply(this,arguments)}zo.prototype.bytesPerElement=6,ji("StructArrayLayout3i6",zo);var ko,Oo=(Lo.__proto__=ko=Rn,((Lo.prototype=Object.create(ko&&ko.prototype)).constructor=Lo).prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},Lo.prototype.emplaceBack=function(e,t,r){var i=this.length;return this.resize(i+1),this.emplace(i,e,t,r)},Lo.prototype.emplace=function(e,t,r,i){var n=4*e;return this.uint32[2*e+0]=t,this.uint16[2+n]=r,this.uint16[3+n]=i,e},Lo);function Lo(){ko.apply(this,arguments)}Oo.prototype.bytesPerElement=8,ji("StructArrayLayout1ul2ui8",Oo);var Do,Bo=(Fo.__proto__=Do=Rn,((Fo.prototype=Object.create(Do&&Do.prototype)).constructor=Fo).prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},Fo.prototype.emplaceBack=function(e,t){var r=this.length;return this.resize(r+1),this.emplace(r,e,t)},Fo.prototype.emplace=function(e,t,r){var i=2*e;return this.uint16[0+i]=t,this.uint16[1+i]=r,e},Fo);function Fo(){Do.apply(this,arguments)}Bo.prototype.bytesPerElement=4,ji("StructArrayLayout2ui4",Bo);var qo,Uo=(jo.__proto__=qo=Rn,((jo.prototype=Object.create(qo&&qo.prototype)).constructor=jo).prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},jo.prototype.emplaceBack=function(e){var t=this.length;return this.resize(t+1),this.emplace(t,e)},jo.prototype.emplace=function(e,t){return this.uint16[+e+0]=t,e},jo);function jo(){qo.apply(this,arguments)}Uo.prototype.bytesPerElement=2,ji("StructArrayLayout1ui2",Uo);var Vo,Go=(Ho.__proto__=Vo=Rn,((Ho.prototype=Object.create(Vo&&Vo.prototype)).constructor=Ho).prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},Ho.prototype.emplaceBack=function(e,t){var r=this.length;return this.resize(r+1),this.emplace(r,e,t)},Ho.prototype.emplace=function(e,t,r){var i=2*e;return this.float32[0+i]=t,this.float32[1+i]=r,e},Ho);function Ho(){Vo.apply(this,arguments)}Go.prototype.bytesPerElement=8,ji("StructArrayLayout2f8",Go);var Zo,Wo=(Ko.__proto__=Zo=Rn,((Ko.prototype=Object.create(Zo&&Zo.prototype)).constructor=Ko).prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},Ko.prototype.emplaceBack=function(e,t,r,i){var n=this.length;return this.resize(n+1),this.emplace(n,e,t,r,i)},Ko.prototype.emplace=function(e,t,r,i,n){var o=4*e;return this.float32[0+o]=t,this.float32[1+o]=r,this.float32[2+o]=i,this.float32[3+o]=n,e},Ko);function Ko(){Zo.apply(this,arguments)}Wo.prototype.bytesPerElement=16,ji("StructArrayLayout4f16",Wo);var Xo=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var r={anchorPointX:{configurable:!0},anchorPointY:{configurable:!0},x1:{configurable:!0},y1:{configurable:!0},x2:{configurable:!0},y2:{configurable:!0},featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0},anchorPoint:{configurable:!0}};return r.anchorPointX.get=function(){return this._structArray.int16[this._pos2+0]},r.anchorPointY.get=function(){return this._structArray.int16[this._pos2+1]},r.x1.get=function(){return this._structArray.int16[this._pos2+2]},r.y1.get=function(){return this._structArray.int16[this._pos2+3]},r.x2.get=function(){return this._structArray.int16[this._pos2+4]},r.y2.get=function(){return this._structArray.int16[this._pos2+5]},r.featureIndex.get=function(){return this._structArray.uint32[this._pos4+3]},r.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+8]},r.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+9]},r.anchorPoint.get=function(){return new n(this.anchorPointX,this.anchorPointY)},Object.defineProperties(t.prototype,r),t}(Pn);Xo.prototype.size=20;var Yo,Jo=((Yo=so)&&($o.__proto__=Yo),(($o.prototype=Object.create(Yo&&Yo.prototype)).constructor=$o).prototype.get=function(e){return new Xo(this,e)},$o);function $o(){Yo.apply(this,arguments)}ji("CollisionBoxArray",Jo);var Qo=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var r={anchorX:{configurable:!0},anchorY:{configurable:!0},glyphStartIndex:{configurable:!0},numGlyphs:{configurable:!0},vertexStartIndex:{configurable:!0},lineStartIndex:{configurable:!0},lineLength:{configurable:!0},segment:{configurable:!0},lowerSize:{configurable:!0},upperSize:{configurable:!0},lineOffsetX:{configurable:!0},lineOffsetY:{configurable:!0},writingMode:{configurable:!0},placedOrientation:{configurable:!0},hidden:{configurable:!0},crossTileID:{configurable:!0},associatedIconIndex:{configurable:!0}};return r.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},r.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},r.glyphStartIndex.get=function(){return this._structArray.uint16[this._pos2+2]},r.numGlyphs.get=function(){return this._structArray.uint16[this._pos2+3]},r.vertexStartIndex.get=function(){return this._structArray.uint32[this._pos4+2]},r.lineStartIndex.get=function(){return this._structArray.uint32[this._pos4+3]},r.lineLength.get=function(){return this._structArray.uint32[this._pos4+4]},r.segment.get=function(){return this._structArray.uint16[this._pos2+10]},r.lowerSize.get=function(){return this._structArray.uint16[this._pos2+11]},r.upperSize.get=function(){return this._structArray.uint16[this._pos2+12]},r.lineOffsetX.get=function(){return this._structArray.float32[this._pos4+7]},r.lineOffsetY.get=function(){return this._structArray.float32[this._pos4+8]},r.writingMode.get=function(){return this._structArray.uint8[this._pos1+36]},r.placedOrientation.get=function(){return this._structArray.uint8[this._pos1+37]},r.placedOrientation.set=function(e){this._structArray.uint8[this._pos1+37]=e},r.hidden.get=function(){return this._structArray.uint8[this._pos1+38]},r.hidden.set=function(e){this._structArray.uint8[this._pos1+38]=e},r.crossTileID.get=function(){return this._structArray.uint32[this._pos4+10]},r.crossTileID.set=function(e){this._structArray.uint32[this._pos4+10]=e},r.associatedIconIndex.get=function(){return this._structArray.int16[this._pos2+22]},Object.defineProperties(t.prototype,r),t}(Pn);Qo.prototype.size=48;var ea,ta=((ea=So)&&(ra.__proto__=ea),((ra.prototype=Object.create(ea&&ea.prototype)).constructor=ra).prototype.get=function(e){return new Qo(this,e)},ra);function ra(){ea.apply(this,arguments)}ji("PlacedSymbolArray",ta);var ia=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var r={anchorX:{configurable:!0},anchorY:{configurable:!0},rightJustifiedTextSymbolIndex:{configurable:!0},centerJustifiedTextSymbolIndex:{configurable:!0},leftJustifiedTextSymbolIndex:{configurable:!0},verticalPlacedTextSymbolIndex:{configurable:!0},placedIconSymbolIndex:{configurable:!0},verticalPlacedIconSymbolIndex:{configurable:!0},key:{configurable:!0},textBoxStartIndex:{configurable:!0},textBoxEndIndex:{configurable:!0},verticalTextBoxStartIndex:{configurable:!0},verticalTextBoxEndIndex:{configurable:!0},iconBoxStartIndex:{configurable:!0},iconBoxEndIndex:{configurable:!0},verticalIconBoxStartIndex:{configurable:!0},verticalIconBoxEndIndex:{configurable:!0},featureIndex:{configurable:!0},numHorizontalGlyphVertices:{configurable:!0},numVerticalGlyphVertices:{configurable:!0},numIconVertices:{configurable:!0},numVerticalIconVertices:{configurable:!0},useRuntimeCollisionCircles:{configurable:!0},crossTileID:{configurable:!0},textBoxScale:{configurable:!0},textOffset0:{configurable:!0},textOffset1:{configurable:!0},collisionCircleDiameter:{configurable:!0}};return r.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},r.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},r.rightJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+2]},r.centerJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+3]},r.leftJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+4]},r.verticalPlacedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+5]},r.placedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+6]},r.verticalPlacedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+7]},r.key.get=function(){return this._structArray.uint16[this._pos2+8]},r.textBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+9]},r.textBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+10]},r.verticalTextBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+11]},r.verticalTextBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+12]},r.iconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+13]},r.iconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+14]},r.verticalIconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+15]},r.verticalIconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+16]},r.featureIndex.get=function(){return this._structArray.uint16[this._pos2+17]},r.numHorizontalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+18]},r.numVerticalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+19]},r.numIconVertices.get=function(){return this._structArray.uint16[this._pos2+20]},r.numVerticalIconVertices.get=function(){return this._structArray.uint16[this._pos2+21]},r.useRuntimeCollisionCircles.get=function(){return this._structArray.uint16[this._pos2+22]},r.crossTileID.get=function(){return this._structArray.uint32[this._pos4+12]},r.crossTileID.set=function(e){this._structArray.uint32[this._pos4+12]=e},r.textBoxScale.get=function(){return this._structArray.float32[this._pos4+13]},r.textOffset0.get=function(){return this._structArray.float32[this._pos4+14]},r.textOffset1.get=function(){return this._structArray.float32[this._pos4+15]},r.collisionCircleDiameter.get=function(){return this._structArray.float32[this._pos4+16]},Object.defineProperties(t.prototype,r),t}(Pn);ia.prototype.size=68;var na,oa=((na=Eo)&&(aa.__proto__=na),((aa.prototype=Object.create(na&&na.prototype)).constructor=aa).prototype.get=function(e){return new ia(this,e)},aa);function aa(){na.apply(this,arguments)}ji("SymbolInstanceArray",oa);var sa,la=((sa=Ro)&&(ua.__proto__=sa),((ua.prototype=Object.create(sa&&sa.prototype)).constructor=ua).prototype.getoffsetX=function(e){return this.float32[+e+0]},ua);function ua(){sa.apply(this,arguments)}ji("GlyphOffsetArray",la);var ca,pa=((ca=zo)&&(ha.__proto__=ca),((ha.prototype=Object.create(ca&&ca.prototype)).constructor=ha).prototype.getx=function(e){return this.int16[3*e+0]},ha.prototype.gety=function(e){return this.int16[3*e+1]},ha.prototype.gettileUnitDistanceFromAnchor=function(e){return this.int16[3*e+2]},ha);function ha(){ca.apply(this,arguments)}ji("SymbolLineVertexArray",pa);var da=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var r={featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0}};return r.featureIndex.get=function(){return this._structArray.uint32[this._pos4+0]},r.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+2]},r.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+3]},Object.defineProperties(t.prototype,r),t}(Pn);da.prototype.size=8;var ma,fa=((ma=Oo)&&(ya.__proto__=ma),((ya.prototype=Object.create(ma&&ma.prototype)).constructor=ya).prototype.get=function(e){return new da(this,e)},ya);function ya(){ma.apply(this,arguments)}function ga(e){void 0===e&&(e=[]),this.segments=e}ji("FeatureIndexArray",fa);var va=kn([{name:"a_pos",components:2,type:"Int16"}],4).members;function _a(e,t){return 256*(e=u(Math.floor(e),0,255))+u(Math.floor(t),0,255)}ga.prototype.prepareSegment=function(e,t,r,i){var n=this.segments[this.segments.length-1];return ga.MAX_VERTEX_ARRAY_LENGTH<e&&w("Max vertices per segment is "+ga.MAX_VERTEX_ARRAY_LENGTH+": bucket requested "+e),(!n||n.vertexLength+e>ga.MAX_VERTEX_ARRAY_LENGTH||n.sortKey!==i)&&(n={vertexOffset:t.length,primitiveOffset:r.length,vertexLength:0,primitiveLength:0},void 0!==i&&(n.sortKey=i),this.segments.push(n)),n},ga.prototype.get=function(){return this.segments},ga.prototype.destroy=function(){for(var e=0,t=this.segments;e<t.length;e+=1){var r=t[e];for(var i in r.vaos)r.vaos[i].destroy()}},ga.simpleSegment=function(e,t,r,i){return new ga([{vertexOffset:e,primitiveOffset:t,vertexLength:r,primitiveLength:i,vaos:{},sortKey:0}])},ga.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,ji("SegmentVector",ga);var ba=kn([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]),xa=t((function(e){e.exports=function(e,t){var r,i,n,o,a,s,l,u;for(i=e.length-(r=3&e.length),n=t,a=3432918353,s=461845907,u=0;u<i;)l=255&e.charCodeAt(u)|(255&e.charCodeAt(++u))<<8|(255&e.charCodeAt(++u))<<16|(255&e.charCodeAt(++u))<<24,++u,n=27492+(65535&(o=5*(65535&(n=(n^=l=(65535&(l=(l=(65535&l)*a+(((l>>>16)*a&65535)<<16)&4294967295)<<15|l>>>17))*s+(((l>>>16)*s&65535)<<16)&4294967295)<<13|n>>>19))+((5*(n>>>16)&65535)<<16)&4294967295))+((58964+(o>>>16)&65535)<<16);switch(l=0,r){case 3:l^=(255&e.charCodeAt(u+2))<<16;case 2:l^=(255&e.charCodeAt(u+1))<<8;case 1:n^=l=(65535&(l=(l=(65535&(l^=255&e.charCodeAt(u)))*a+(((l>>>16)*a&65535)<<16)&4294967295)<<15|l>>>17))*s+(((l>>>16)*s&65535)<<16)&4294967295}return n^=e.length,n=2246822507*(65535&(n^=n>>>16))+((2246822507*(n>>>16)&65535)<<16)&4294967295,n=3266489909*(65535&(n^=n>>>13))+((3266489909*(n>>>16)&65535)<<16)&4294967295,(n^=n>>>16)>>>0}})),wa=t((function(e){e.exports=function(e,t){for(var r,i=e.length,n=t^i,o=0;4<=i;)r=1540483477*(65535&(r=255&e.charCodeAt(o)|(255&e.charCodeAt(++o))<<8|(255&e.charCodeAt(++o))<<16|(255&e.charCodeAt(++o))<<24))+((1540483477*(r>>>16)&65535)<<16),n=1540483477*(65535&n)+((1540483477*(n>>>16)&65535)<<16)^(r=1540483477*(65535&(r^=r>>>24))+((1540483477*(r>>>16)&65535)<<16)),i-=4,++o;switch(i){case 3:n^=(255&e.charCodeAt(o+2))<<16;case 2:n^=(255&e.charCodeAt(o+1))<<8;case 1:n=1540483477*(65535&(n^=255&e.charCodeAt(o)))+((1540483477*(n>>>16)&65535)<<16)}return n=1540483477*(65535&(n^=n>>>13))+((1540483477*(n>>>16)&65535)<<16),(n^=n>>>15)>>>0}})),Sa=xa,Ta=wa;function Ca(){this.ids=[],this.positions=[],this.indexed=!1}Sa.murmur3=xa,Sa.murmur2=Ta,Ca.prototype.add=function(e,t,r,i){this.ids.push(Ia(e)),this.positions.push(t,r,i)},Ca.prototype.getPositions=function(e){for(var t=Ia(e),r=0,i=this.ids.length-1;r<i;){var n=r+i>>1;this.ids[n]>=t?i=n:r=1+n}for(var o=[];this.ids[r]===t;)o.push({index:this.positions[3*r],start:this.positions[3*r+1],end:this.positions[3*r+2]}),r++;return o},Ca.serialize=function(e,t){var r=new Float64Array(e.ids),i=new Uint32Array(e.positions);return function e(t,r,i,n){for(;i<n;){for(var o=t[i+n>>1],a=i-1,s=n+1;;){for(;t[++a]<o;);for(;t[--s]>o;);if(s<=a)break;Pa(t,a,s),Pa(r,3*a,3*s),Pa(r,3*a+1,3*s+1),Pa(r,3*a+2,3*s+2)}s-i<n-s?(e(t,r,i,s),i=s+1):(e(t,r,s+1,n),n=s)}}(r,i,0,r.length-1),t&&t.push(r.buffer,i.buffer),{ids:r,positions:i}},Ca.deserialize=function(e){var t=new Ca;return t.ids=e.ids,t.positions=e.positions,t.indexed=!0,t};var Ea=Math.pow(2,53)-1;function Ia(e){var t=+e;return!isNaN(t)&&t<=Ea?t:Sa(String(e))}function Pa(e,t,r){var i=e[t];e[t]=e[r],e[r]=i}function Ra(e,t){this.gl=e.gl,this.location=t}ji("FeaturePositionMap",Ca);var Na,Aa,za,Ma,ka,Oa,La,Da=(Ja.__proto__=La=Ra,((Ja.prototype=Object.create(La&&La.prototype)).constructor=Ja).prototype.set=function(e){this.current!==e&&(this.current=e,this.gl.uniform1i(this.location,e))},Ja),Ba=(Ya.__proto__=Oa=Ra,((Ya.prototype=Object.create(Oa&&Oa.prototype)).constructor=Ya).prototype.set=function(e){this.current!==e&&(this.current=e,this.gl.uniform1f(this.location,e))},Ya),Fa=(Xa.__proto__=ka=Ra,((Xa.prototype=Object.create(ka&&ka.prototype)).constructor=Xa).prototype.set=function(e){e[0]===this.current[0]&&e[1]===this.current[1]||(this.current=e,this.gl.uniform2f(this.location,e[0],e[1]))},Xa),qa=(Ka.__proto__=Ma=Ra,((Ka.prototype=Object.create(Ma&&Ma.prototype)).constructor=Ka).prototype.set=function(e){e[0]===this.current[0]&&e[1]===this.current[1]&&e[2]===this.current[2]||(this.current=e,this.gl.uniform3f(this.location,e[0],e[1],e[2]))},Ka),Ua=(Wa.__proto__=za=Ra,((Wa.prototype=Object.create(za&&za.prototype)).constructor=Wa).prototype.set=function(e){e[0]===this.current[0]&&e[1]===this.current[1]&&e[2]===this.current[2]&&e[3]===this.current[3]||(this.current=e,this.gl.uniform4f(this.location,e[0],e[1],e[2],e[3]))},Wa),ja=(Za.__proto__=Aa=Ra,((Za.prototype=Object.create(Aa&&Aa.prototype)).constructor=Za).prototype.set=function(e){e.r===this.current.r&&e.g===this.current.g&&e.b===this.current.b&&e.a===this.current.a||(this.current=e,this.gl.uniform4f(this.location,e.r,e.g,e.b,e.a))},Za),Va=new Float32Array(16),Ga=(Ha.__proto__=Na=Ra,((Ha.prototype=Object.create(Na&&Na.prototype)).constructor=Ha).prototype.set=function(e){if(e[12]!==this.current[12]||e[0]!==this.current[0])return this.current=e,void this.gl.uniformMatrix4fv(this.location,!1,e);for(var t=1;t<16;t++)if(e[t]!==this.current[t]){this.current=e,this.gl.uniformMatrix4fv(this.location,!1,e);break}},Ha);function Ha(e,t){Na.call(this,e,t),this.current=Va}function Za(e,t){Aa.call(this,e,t),this.current=lt.transparent}function Wa(e,t){za.call(this,e,t),this.current=[0,0,0,0]}function Ka(e,t){Ma.call(this,e,t),this.current=[0,0,0]}function Xa(e,t){ka.call(this,e,t),this.current=[0,0]}function Ya(e,t){Oa.call(this,e,t),this.current=0}function Ja(e,t){La.call(this,e,t),this.current=0}function $a(e){return[_a(255*e.r,255*e.g),_a(255*e.b,255*e.a)]}function Qa(e,t,r){this.value=e,this.uniformNames=t.map((function(e){return"u_"+e})),this.type=r}function es(e,t){this.uniformNames=t.map((function(e){return"u_"+e})),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}function ts(e,t,r,i){this.expression=e,this.type=r,this.maxValue=0,this.paintVertexAttributes=t.map((function(e){return{name:"a_"+e,type:"Float32",components:"color"===r?2:1,offset:0}})),this.paintVertexArray=new i}function rs(e,t,r,i,n,o){this.expression=e,this.uniformNames=t.map((function(e){return"u_"+e+"_t"})),this.type=r,this.useIntegerZoom=i,this.zoom=n,this.maxValue=0,this.paintVertexAttributes=t.map((function(e){return{name:"a_"+e,type:"Float32",components:"color"===r?4:2,offset:0}})),this.paintVertexArray=new o}function is(e,t,r,i,n,o){this.expression=e,this.type=t,this.useIntegerZoom=r,this.zoom=i,this.layerId=o,this.zoomInPaintVertexArray=new n,this.zoomOutPaintVertexArray=new n}function ns(e,t,r){this.binders={},this._buffers=[];var i,n,o=[];for(var a in e.paint._values)if(r(a)){var s=e.paint.get(a);if(s instanceof vn&&Br(s.property.specification)){var l=(i=a,n=e.type,{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[i]||[i.replace(n+"-","").replace(/-/g,"_")]),u=s.value,c=s.property.specification.type,p=s.property.useIntegerZoom,h=s.property.specification["property-type"],d="cross-faded"===h||"cross-faded-data-driven"===h;if("constant"===u.kind)this.binders[a]=d?new es(u.value,l):new Qa(u.value,l,c),o.push("/u_"+a);else if("source"===u.kind||d){var m=as(a,c,"source");this.binders[a]=d?new is(u,c,p,t,m,e.id):new ts(u,l,c,m),o.push("/a_"+a)}else{var f=as(a,c,"composite");this.binders[a]=new rs(u,l,c,p,t,f),o.push("/z_"+a)}}}this.cacheKey=o.sort().join("")}function os(e,t,r){void 0===r&&(r=function(){return!0}),this.programConfigurations={};for(var i=0,n=e;i<n.length;i+=1){var o=n[i];this.programConfigurations[o.id]=new ns(o,t,r)}this.needsUpload=!1,this._featureMap=new Ca,this._bufferOffset=0}function as(e,t,r){var i={color:{source:Go,composite:Wo},number:{source:Ro,composite:Go}},n={"line-pattern":{source:Xn,composite:Xn},"fill-pattern":{source:Xn,composite:Xn},"fill-extrusion-pattern":{source:Xn,composite:Xn}}[e];return n&&n[r]||i[t][r]}Qa.prototype.setUniform=function(e,t,r){e.set(r.constantOr(this.value))},Qa.prototype.getBinding=function(e,t,r){return new("color"===this.type?ja:Ba)(e,t)},es.prototype.setConstantPatternPositions=function(e,t){this.pixelRatioFrom=t.pixelRatio,this.pixelRatioTo=e.pixelRatio,this.patternFrom=t.tlbr,this.patternTo=e.tlbr},es.prototype.setUniform=function(e,t,r,i){var n="u_pattern_to"===i?this.patternTo:"u_pattern_from"===i?this.patternFrom:"u_pixel_ratio_to"===i?this.pixelRatioTo:"u_pixel_ratio_from"===i?this.pixelRatioFrom:null;n&&e.set(n)},es.prototype.getBinding=function(e,t,r){return new("u_pattern"===r.substr(0,9)?Ua:Ba)(e,t)},ts.prototype.populatePaintArray=function(e,t,r,i,n){var o=this.paintVertexArray.length,a=this.expression.evaluate(new un(0),t,{},i,[],n);this.paintVertexArray.resize(e),this._setPaintValue(o,e,a)},ts.prototype.updatePaintArray=function(e,t,r,i){var n=this.expression.evaluate({zoom:0},r,i);this._setPaintValue(e,t,n)},ts.prototype._setPaintValue=function(e,t,r){if("color"===this.type)for(var i=$a(r),n=e;n<t;n++)this.paintVertexArray.emplace(n,i[0],i[1]);else{for(var o=e;o<t;o++)this.paintVertexArray.emplace(o,r);this.maxValue=Math.max(this.maxValue,Math.abs(r))}},ts.prototype.upload=function(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},ts.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},rs.prototype.populatePaintArray=function(e,t,r,i,n){var o=this.expression.evaluate(new un(this.zoom),t,{},i,[],n),a=this.expression.evaluate(new un(this.zoom+1),t,{},i,[],n),s=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(s,e,o,a)},rs.prototype.updatePaintArray=function(e,t,r,i){var n=this.expression.evaluate({zoom:this.zoom},r,i),o=this.expression.evaluate({zoom:this.zoom+1},r,i);this._setPaintValue(e,t,n,o)},rs.prototype._setPaintValue=function(e,t,r,i){if("color"===this.type)for(var n=$a(r),o=$a(i),a=e;a<t;a++)this.paintVertexArray.emplace(a,n[0],n[1],o[0],o[1]);else{for(var s=e;s<t;s++)this.paintVertexArray.emplace(s,r,i);this.maxValue=Math.max(this.maxValue,Math.abs(r),Math.abs(i))}},rs.prototype.upload=function(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},rs.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},rs.prototype.setUniform=function(e,t){var r=this.useIntegerZoom?Math.floor(t.zoom):t.zoom,i=u(this.expression.interpolationFactor(r,this.zoom,this.zoom+1),0,1);e.set(i)},rs.prototype.getBinding=function(e,t,r){return new Ba(e,t)},is.prototype.populatePaintArray=function(e,t,r){var i=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(e),this.zoomOutPaintVertexArray.resize(e),this._setPaintValues(i,e,t.patterns&&t.patterns[this.layerId],r)},is.prototype.updatePaintArray=function(e,t,r,i,n){this._setPaintValues(e,t,r.patterns&&r.patterns[this.layerId],n)},is.prototype._setPaintValues=function(e,t,r,i){if(i&&r){var n=i[r.min],o=i[r.mid],a=i[r.max];if(n&&o&&a)for(var s=e;s<t;s++)this.zoomInPaintVertexArray.emplace(s,o.tl[0],o.tl[1],o.br[0],o.br[1],n.tl[0],n.tl[1],n.br[0],n.br[1],o.pixelRatio,n.pixelRatio),this.zoomOutPaintVertexArray.emplace(s,o.tl[0],o.tl[1],o.br[0],o.br[1],a.tl[0],a.tl[1],a.br[0],a.br[1],o.pixelRatio,a.pixelRatio)}},is.prototype.upload=function(e){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=e.createVertexBuffer(this.zoomInPaintVertexArray,ba.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=e.createVertexBuffer(this.zoomOutPaintVertexArray,ba.members,this.expression.isStateDependent))},is.prototype.destroy=function(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()},ns.prototype.getMaxValue=function(e){var t=this.binders[e];return t instanceof ts||t instanceof rs?t.maxValue:0},ns.prototype.populatePaintArrays=function(e,t,r,i,n){for(var o in this.binders){var a=this.binders[o];(a instanceof ts||a instanceof rs||a instanceof is)&&a.populatePaintArray(e,t,r,i,n)}},ns.prototype.setConstantPatternPositions=function(e,t){for(var r in this.binders){var i=this.binders[r];i instanceof es&&i.setConstantPatternPositions(e,t)}},ns.prototype.updatePaintArrays=function(e,t,r,i,n){var o=!1;for(var a in e)for(var s=0,l=t.getPositions(a);s<l.length;s+=1){var u=l[s],c=r.feature(u.index);for(var p in this.binders){var h=this.binders[p];if((h instanceof ts||h instanceof rs||h instanceof is)&&!0===h.expression.isStateDependent){var d=i.paint.get(p);h.expression=d.value,h.updatePaintArray(u.start,u.end,c,e[a],n),o=!0}}}return o},ns.prototype.defines=function(){var e=[];for(var t in this.binders){var r=this.binders[t];(r instanceof Qa||r instanceof es)&&e.push.apply(e,r.uniformNames.map((function(e){return"#define HAS_UNIFORM_"+e})))}return e},ns.prototype.getBinderAttributes=function(){var e=[];for(var t in this.binders){var r=this.binders[t];if(r instanceof ts||r instanceof rs)for(var i=0;i<r.paintVertexAttributes.length;i++)e.push(r.paintVertexAttributes[i].name);else if(r instanceof is)for(var n=0;n<ba.members.length;n++)e.push(ba.members[n].name)}return e},ns.prototype.getBinderUniforms=function(){var e=[];for(var t in this.binders){var r=this.binders[t];if(r instanceof Qa||r instanceof es||r instanceof rs)for(var i=0,n=r.uniformNames;i<n.length;i+=1)e.push(n[i])}return e},ns.prototype.getPaintVertexBuffers=function(){return this._buffers},ns.prototype.getUniforms=function(e,t){var r=[];for(var i in this.binders){var n=this.binders[i];if(n instanceof Qa||n instanceof es||n instanceof rs)for(var o=0,a=n.uniformNames;o<a.length;o+=1){var s=a[o];if(t[s]){var l=n.getBinding(e,t[s],s);r.push({name:s,property:i,binding:l})}}}return r},ns.prototype.setUniforms=function(e,t,r,i){for(var n=0,o=t;n<o.length;n+=1){var a=o[n],s=a.name,l=a.property;this.binders[l].setUniform(a.binding,i,r.get(l),s)}},ns.prototype.updatePaintBuffers=function(e){for(var t in this._buffers=[],this.binders){var r=this.binders[t];if(e&&r instanceof is){var i=2===e.fromScale?r.zoomInPaintVertexBuffer:r.zoomOutPaintVertexBuffer;i&&this._buffers.push(i)}else(r instanceof ts||r instanceof rs)&&r.paintVertexBuffer&&this._buffers.push(r.paintVertexBuffer)}},ns.prototype.upload=function(e){for(var t in this.binders){var r=this.binders[t];(r instanceof ts||r instanceof rs||r instanceof is)&&r.upload(e)}this.updatePaintBuffers()},ns.prototype.destroy=function(){for(var e in this.binders){var t=this.binders[e];(t instanceof ts||t instanceof rs||t instanceof is)&&t.destroy()}},os.prototype.populatePaintArrays=function(e,t,r,i,n,o){for(var a in this.programConfigurations)this.programConfigurations[a].populatePaintArrays(e,t,i,n,o);void 0!==t.id&&this._featureMap.add(t.id,r,this._bufferOffset,e),this._bufferOffset=e,this.needsUpload=!0},os.prototype.updatePaintArrays=function(e,t,r,i){for(var n=0,o=r;n<o.length;n+=1){var a=o[n];this.needsUpload=this.programConfigurations[a.id].updatePaintArrays(e,this._featureMap,t,a,i)||this.needsUpload}},os.prototype.get=function(e){return this.programConfigurations[e]},os.prototype.upload=function(e){if(this.needsUpload){for(var t in this.programConfigurations)this.programConfigurations[t].upload(e);this.needsUpload=!1}},os.prototype.destroy=function(){for(var e in this.programConfigurations)this.programConfigurations[e].destroy()},ji("ConstantBinder",Qa),ji("CrossFadedConstantBinder",es),ji("SourceExpressionBinder",ts),ji("CrossFadedCompositeBinder",is),ji("CompositeExpressionBinder",rs),ji("ProgramConfiguration",ns,{omit:["_buffers"]}),ji("ProgramConfigurationSet",os);var ss=Math.pow(2,14)-1,ls=-ss-1;function us(e){for(var t=8192/e.extent,r=e.loadGeometry(),i=0;i<r.length;i++)for(var n=r[i],o=0;o<n.length;o++){var a=n[o],s=Math.round(a.x*t),l=Math.round(a.y*t);a.x=u(s,ls,ss),a.y=u(l,ls,ss),(s<a.x||s>a.x+1||l<a.y||l>a.y+1)&&w("Geometry exceeds allowed extent, reduce your vector tile buffer size")}return r}function cs(e,t,r,i,n){e.emplaceBack(2*t+(i+1)/2,2*r+(n+1)/2)}function ps(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map((function(e){return e.id})),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new Dn,this.indexArray=new bo,this.segments=new ga,this.programConfigurations=new os(e.layers,e.zoom),this.stateDependentLayerIds=this.layers.filter((function(e){return e.isStateDependent()})).map((function(e){return e.id}))}function hs(e,t){for(var r=0;r<e.length;r++)if(_s(t,e[r]))return!0;for(var i=0;i<t.length;i++)if(_s(e,t[i]))return!0;return!!fs(e,t)}function ds(e,t){if(1===e.length)return vs(t,e[0]);for(var r=0;r<t.length;r++)for(var i=t[r],n=0;n<i.length;n++)if(_s(e,i[n]))return!0;for(var o=0;o<e.length;o++)if(vs(t,e[o]))return!0;for(var a=0;a<t.length;a++)if(fs(e,t[a]))return!0;return!1}function ms(e,t,r){if(1<e.length){if(fs(e,t))return 1;for(var i=0;i<t.length;i++)if(ys(t[i],e,r))return 1}for(var n=0;n<e.length;n++)if(ys(e[n],t,r))return 1}function fs(e,t){var r,i,n,o;if(0!==e.length&&0!==t.length)for(var a=0;a<e.length-1;a++)for(var s=e[a],l=e[a+1],u=0;u<t.length-1;u++)if(i=l,S(r=s,n=t[u],o=t[u+1])!==S(i,n,o)&&S(r,i,n)!==S(r,i,o))return 1}function ys(e,t,r){var i=r*r;if(1===t.length)return e.distSqr(t[0])<i;for(var n=1;n<t.length;n++)if(gs(e,t[n-1],t[n])<i)return 1}function gs(e,t,r){var i=t.distSqr(r);if(0===i)return e.distSqr(t);var n=((e.x-t.x)*(r.x-t.x)+(e.y-t.y)*(r.y-t.y))/i;return e.distSqr(n<0?t:1<n?r:r.sub(t)._mult(n)._add(t))}function vs(e,t){for(var r,i,n,o=!1,a=0;a<e.length;a++)for(var s=0,l=(r=e[a]).length-1;s<r.length;l=s++)(i=r[s]).y>t.y!=(n=r[l]).y>t.y&&t.x<(n.x-i.x)*(t.y-i.y)/(n.y-i.y)+i.x&&(o=!o);return o}function _s(e,t){for(var r=!1,i=0,n=e.length-1;i<e.length;n=i++){var o=e[i],a=e[n];o.y>t.y!=a.y>t.y&&t.x<(a.x-o.x)*(t.y-o.y)/(a.y-o.y)+o.x&&(r=!r)}return r}function bs(e,t,r){var i=r[0],n=r[2];if(!(e.x<i.x&&t.x<i.x||e.x>n.x&&t.x>n.x||e.y<i.y&&t.y<i.y||e.y>n.y&&t.y>n.y)){var o=S(e,t,r[0]);return o!==S(e,t,r[1])||o!==S(e,t,r[2])||o!==S(e,t,r[3])}}function xs(e,t,r){var i=t.paint.get(e).value;return"constant"===i.kind?i.value:r.programConfigurations.get(t.id).getMaxValue(e)}function ws(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1])}function Ss(e,t,r,i,o){if(!t[0]&&!t[1])return e;var a=n.convert(t)._mult(o);"viewport"===r&&a._rotate(-i);for(var s=[],l=0;l<e.length;l++)s.push(e[l].sub(a));return s}ps.prototype.populate=function(e,t,r){var i=this.layers[0],n=[],o=null;"circle"===i.type&&(o=i.layout.get("circle-sort-key"));for(var a=0,s=e;a<s.length;a+=1){var l=s[a],u=l.feature,c=l.id,p=l.index,h=l.sourceLayerIndex,d=this.layers[0]._featureFilter.needGeometry,m={type:u.type,id:c,properties:u.properties,geometry:d?us(u):[]};if(this.layers[0]._featureFilter.filter(new un(this.zoom),m,r)){d||(m.geometry=us(u));var f=o?o.evaluate(m,{},r):void 0;n.push({id:c,properties:u.properties,type:u.type,sourceLayerIndex:h,index:p,geometry:m.geometry,patterns:{},sortKey:f})}}o&&n.sort((function(e,t){return e.sortKey-t.sortKey}));for(var y=0,g=n;y<g.length;y+=1){var v=g[y],_=v.geometry,b=v.index,x=v.sourceLayerIndex,w=e[b].feature;this.addFeature(v,_,b,r),t.featureIndex.insert(w,_,b,x,this.index)}},ps.prototype.update=function(e,t,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,r)},ps.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},ps.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},ps.prototype.upload=function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,va),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0},ps.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},ps.prototype.addFeature=function(e,t,r,i){for(var n=0,o=t;n<o.length;n+=1)for(var a=0,s=o[n];a<s.length;a+=1){var l=s[a],u=l.x,c=l.y;if(!(u<0||8192<=u||c<0||8192<=c)){var p=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,e.sortKey),h=p.vertexLength;cs(this.layoutVertexArray,u,c,-1,-1),cs(this.layoutVertexArray,u,c,1,-1),cs(this.layoutVertexArray,u,c,1,1),cs(this.layoutVertexArray,u,c,-1,1),this.indexArray.emplaceBack(h,h+1,h+2),this.indexArray.emplaceBack(h,h+3,h+2),p.vertexLength+=4,p.primitiveLength+=2}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,r,{},i)},ji("CircleBucket",ps,{omit:["layers"]});var Ts=new In({"circle-sort-key":new xn(Oe.layout_circle["circle-sort-key"])}),Cs={paint:new In({"circle-radius":new xn(Oe.paint_circle["circle-radius"]),"circle-color":new xn(Oe.paint_circle["circle-color"]),"circle-blur":new xn(Oe.paint_circle["circle-blur"]),"circle-opacity":new xn(Oe.paint_circle["circle-opacity"]),"circle-translate":new bn(Oe.paint_circle["circle-translate"]),"circle-translate-anchor":new bn(Oe.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new bn(Oe.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new bn(Oe.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new xn(Oe.paint_circle["circle-stroke-width"]),"circle-stroke-color":new xn(Oe.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new xn(Oe.paint_circle["circle-stroke-opacity"])}),layout:Ts},Es="undefined"!=typeof Float32Array?Float32Array:Array;function Is(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Ps(e,t,r){var i=t[0],n=t[1],o=t[2],a=t[3],s=t[4],l=t[5],u=t[6],c=t[7],p=t[8],h=t[9],d=t[10],m=t[11],f=t[12],y=t[13],g=t[14],v=t[15],_=r[0],b=r[1],x=r[2],w=r[3];return e[0]=_*i+b*s+x*p+w*f,e[1]=_*n+b*l+x*h+w*y,e[2]=_*o+b*u+x*d+w*g,e[3]=_*a+b*c+x*m+w*v,e[4]=(_=r[4])*i+(b=r[5])*s+(x=r[6])*p+(w=r[7])*f,e[5]=_*n+b*l+x*h+w*y,e[6]=_*o+b*u+x*d+w*g,e[7]=_*a+b*c+x*m+w*v,e[8]=(_=r[8])*i+(b=r[9])*s+(x=r[10])*p+(w=r[11])*f,e[9]=_*n+b*l+x*h+w*y,e[10]=_*o+b*u+x*d+w*g,e[11]=_*a+b*c+x*m+w*v,e[12]=(_=r[12])*i+(b=r[13])*s+(x=r[14])*p+(w=r[15])*f,e[13]=_*n+b*l+x*h+w*y,e[14]=_*o+b*u+x*d+w*g,e[15]=_*a+b*c+x*m+w*v,e}Math.hypot||(Math.hypot=function(){for(var e=arguments,t=0,r=arguments.length;r--;)t+=e[r]*e[r];return Math.sqrt(t)});var Rs,Ns,As=Ps;function zs(e,t,r){var i=t[0],n=t[1],o=t[2],a=t[3];return e[0]=r[0]*i+r[4]*n+r[8]*o+r[12]*a,e[1]=r[1]*i+r[5]*n+r[9]*o+r[13]*a,e[2]=r[2]*i+r[6]*n+r[10]*o+r[14]*a,e[3]=r[3]*i+r[7]*n+r[11]*o+r[15]*a,e}Rs=new Es(3),Es!=Float32Array&&(Rs[0]=0,Rs[1]=0,Rs[2]=0),Ns=new Es(4),Es!=Float32Array&&(Ns[0]=0,Ns[1]=0,Ns[2]=0,Ns[3]=0);var Ms,ks,Os=(ks=new Es(2),Es!=Float32Array&&(ks[0]=0,ks[1]=0),Ls.__proto__=Ms=An,((Ls.prototype=Object.create(Ms&&Ms.prototype)).constructor=Ls).prototype.createBucket=function(e){return new ps(e)},Ls.prototype.queryRadius=function(e){var t=e;return xs("circle-radius",this,t)+xs("circle-stroke-width",this,t)+ws(this.paint.get("circle-translate"))},Ls.prototype.queryIntersectsFeature=function(e,t,r,i,n,o,a,s){for(var l=Ss(e,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),o.angle,a),u=this.paint.get("circle-radius").evaluate(t,r)+this.paint.get("circle-stroke-width").evaluate(t,r),c="map"===this.paint.get("circle-pitch-alignment"),p=c?l:function(e){return l.map((function(t){return Ds(t,e)}))}(s),h=c?u*a:u,d=0,m=i;d<m.length;d+=1)for(var f=0,y=m[d];f<y.length;f+=1){var g=y[f],v=c?g:Ds(g,s),_=h,b=zs([],[g.x,g.y,0,1],s);if("viewport"===this.paint.get("circle-pitch-scale")&&"map"===this.paint.get("circle-pitch-alignment")?_*=b[3]/o.cameraToCenterDistance:"map"===this.paint.get("circle-pitch-scale")&&"viewport"===this.paint.get("circle-pitch-alignment")&&(_*=o.cameraToCenterDistance/b[3]),S=_,_s(x=p,w=v)||ys(w,x,S))return!0}var x,w,S;return!1},Ls);function Ls(e){Ms.call(this,e,Cs)}function Ds(e,t){var r=zs([],[e.x,e.y,0,1],t);return new n(r[0]/r[3],r[1]/r[3])}var Bs,Fs=(qs.__proto__=Bs=ps,(qs.prototype=Object.create(Bs&&Bs.prototype)).constructor=qs);function qs(){Bs.apply(this,arguments)}function Us(e,t,r,i){var n=t.width,o=t.height;if(i){if(i instanceof Uint8ClampedArray)i=new Uint8Array(i.buffer);else if(i.length!==n*o*r)throw new RangeError("mismatched image size")}else i=new Uint8Array(n*o*r);return e.width=n,e.height=o,e.data=i,e}function js(e,t,r){var i=t.width,n=t.height;if(i!==e.width||n!==e.height){var o=Us({},{width:i,height:n},r);Vs(e,o,{x:0,y:0},{x:0,y:0},{width:Math.min(e.width,i),height:Math.min(e.height,n)},r),e.width=i,e.height=n,e.data=o.data}}function Vs(e,t,r,i,n,o){if(0===n.width||0===n.height)return t;if(n.width>e.width||n.height>e.height||r.x>e.width-n.width||r.y>e.height-n.height)throw new RangeError("out of range source coordinates for image copy");if(n.width>t.width||n.height>t.height||i.x>t.width-n.width||i.y>t.height-n.height)throw new RangeError("out of range destination coordinates for image copy");for(var a=e.data,s=t.data,l=0;l<n.height;l++)for(var u=((r.y+l)*e.width+r.x)*o,c=((i.y+l)*t.width+i.x)*o,p=0;p<n.width*o;p++)s[c+p]=a[u+p];return t}ji("HeatmapBucket",Fs,{omit:["layers"]});var Gs=function(e,t){Us(this,e,1,t)};function Hs(e,t){Us(this,e,4,t)}Gs.prototype.resize=function(e){js(this,e,1)},Gs.prototype.clone=function(){return new Gs({width:this.width,height:this.height},new Uint8Array(this.data))},Gs.copy=function(e,t,r,i,n){Vs(e,t,r,i,n,1)},Hs.prototype.resize=function(e){js(this,e,4)},Hs.prototype.replace=function(e,t){t?this.data.set(e):this.data=e instanceof Uint8ClampedArray?new Uint8Array(e.buffer):e},Hs.prototype.clone=function(){return new Hs({width:this.width,height:this.height},new Uint8Array(this.data))},Hs.copy=function(e,t,r,i,n){Vs(e,t,r,i,n,4)},ji("AlphaImage",Gs),ji("RGBAImage",Hs);var Zs={paint:new In({"heatmap-radius":new xn(Oe.paint_heatmap["heatmap-radius"]),"heatmap-weight":new xn(Oe.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new bn(Oe.paint_heatmap["heatmap-intensity"]),"heatmap-color":new En(Oe.paint_heatmap["heatmap-color"]),"heatmap-opacity":new bn(Oe.paint_heatmap["heatmap-opacity"])})};function Ws(e,t){for(var r=new Uint8Array(1024),i={},n=0,o=0;n<256;n++,o+=4){i[t]=n/255;var a=e.evaluate(i);r[o+0]=Math.floor(255*a.r/a.a),r[o+1]=Math.floor(255*a.g/a.a),r[o+2]=Math.floor(255*a.b/a.a),r[o+3]=Math.floor(255*a.a)}return new Hs({width:256,height:1},r)}var Ks,Xs,Ys=(il.__proto__=Xs=An,((il.prototype=Object.create(Xs&&Xs.prototype)).constructor=il).prototype.createBucket=function(e){return new Fs(e)},il.prototype._handleSpecialPaintPropertyUpdate=function(e){"heatmap-color"===e&&this._updateColorRamp()},il.prototype._updateColorRamp=function(){this.colorRamp=Ws(this._transitionablePaint._values["heatmap-color"].value.expression,"heatmapDensity"),this.colorRampTexture=null},il.prototype.resize=function(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)},il.prototype.queryRadius=function(){return 0},il.prototype.queryIntersectsFeature=function(){return!1},il.prototype.hasOffscreenPass=function(){return 0!==this.paint.get("heatmap-opacity")&&"none"!==this.visibility},il),Js={paint:new In({"hillshade-illumination-direction":new bn(Oe.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new bn(Oe.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new bn(Oe.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new bn(Oe.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new bn(Oe.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new bn(Oe.paint_hillshade["hillshade-accent-color"])})},$s=(rl.__proto__=Ks=An,((rl.prototype=Object.create(Ks&&Ks.prototype)).constructor=rl).prototype.hasOffscreenPass=function(){return 0!==this.paint.get("hillshade-exaggeration")&&"none"!==this.visibility},rl),Qs=kn([{name:"a_pos",components:2,type:"Int16"}],4).members,el=nl,tl=nl;function rl(e){Ks.call(this,e,Js)}function il(e){Xs.call(this,e,Zs),this._updateColorRamp()}function nl(e,t,r){r=r||2;var i,n,o,a,s,l,u,c=t&&t.length,p=c?t[0]*r:e.length,h=ol(e,0,p,r,!0),d=[];if(!h||h.next===h.prev)return d;if(c&&(h=function(e,t,r,i){var n,o,a,s=[];for(n=0,o=t.length;n<o;n++)(a=ol(e,t[n]*i,n<o-1?t[n+1]*i:e.length,i,!1))===a.next&&(a.steiner=!0),s.push(fl(a));for(s.sort(hl),n=0;n<s.length;n++)dl(s[n],r),r=al(r,r.next);return r}(e,t,h,r)),e.length>80*r){i=o=e[0],n=a=e[1];for(var m=r;m<p;m+=r)(s=e[m])<i&&(i=s),(l=e[m+1])<n&&(n=l),o<s&&(o=s),a<l&&(a=l);u=0!==(u=Math.max(o-i,a-n))?1/u:0}return sl(h,d,r,i,n,u),d}function ol(e,t,r,i,n){var o,a;if(n===0<Il(e,t,r,i))for(o=t;o<r;o+=i)a=Tl(o,e[o],e[o+1],a);else for(o=r-i;t<=o;o-=i)a=Tl(o,e[o],e[o+1],a);return a&&vl(a,a.next)&&(Cl(a),a=a.next),a}function al(e,t){if(!e)return e;t=t||e;var r,i=e;do{if(r=!1,i.steiner||!vl(i,i.next)&&0!==gl(i.prev,i,i.next))i=i.next;else{if(Cl(i),(i=t=i.prev)===i.next)break;r=!0}}while(r||i!==t);return t}function sl(e,t,r,i,n,o,a){if(e){!a&&o&&function(e,t,r,i){for(var n=e;null===n.z&&(n.z=ml(n.x,n.y,t,r,i)),n.prevZ=n.prev,n.nextZ=n.next,(n=n.next)!==e;);n.prevZ.nextZ=null,n.prevZ=null,function(e){var t,r,i,n,o,a,s,l,u=1;do{for(r=e,o=e=null,a=0;r;){for(a++,i=r,t=s=0;t<u&&(s++,i=i.nextZ);t++);for(l=u;0<s||0<l&&i;)0!==s&&(0===l||!i||r.z<=i.z)?(r=(n=r).nextZ,s--):(i=(n=i).nextZ,l--),o?o.nextZ=n:e=n,n.prevZ=o,o=n;r=i}o.nextZ=null,u*=2}while(1<a)}(n)}(e,i,n,o);for(var s,l,u=e;e.prev!==e.next;)if(s=e.prev,l=e.next,o?ul(e,i,n,o):ll(e))t.push(s.i/r),t.push(e.i/r),t.push(l.i/r),Cl(e),e=l.next,u=l.next;else if((e=l)===u){a?1===a?sl(e=cl(al(e),t,r),t,r,i,n,o,2):2===a&&pl(e,t,r,i,n,o):sl(al(e),t,r,i,n,o,1);break}}}function ll(e){var t=e.prev,r=e,i=e.next;if(!(0<=gl(t,r,i))){for(var n=e.next.next;n!==e.prev;){if(yl(t.x,t.y,r.x,r.y,i.x,i.y,n.x,n.y)&&0<=gl(n.prev,n,n.next))return;n=n.next}return 1}}function ul(e,t,r,i){var n=e.prev,o=e,a=e.next;if(!(0<=gl(n,o,a))){for(var s=n.x>o.x?n.x>a.x?n.x:a.x:o.x>a.x?o.x:a.x,l=n.y>o.y?n.y>a.y?n.y:a.y:o.y>a.y?o.y:a.y,u=ml(n.x<o.x?n.x<a.x?n.x:a.x:o.x<a.x?o.x:a.x,n.y<o.y?n.y<a.y?n.y:a.y:o.y<a.y?o.y:a.y,t,r,i),c=ml(s,l,t,r,i),p=e.prevZ,h=e.nextZ;p&&p.z>=u&&h&&h.z<=c;){if(p!==e.prev&&p!==e.next&&yl(n.x,n.y,o.x,o.y,a.x,a.y,p.x,p.y)&&0<=gl(p.prev,p,p.next))return;if(p=p.prevZ,h!==e.prev&&h!==e.next&&yl(n.x,n.y,o.x,o.y,a.x,a.y,h.x,h.y)&&0<=gl(h.prev,h,h.next))return;h=h.nextZ}for(;p&&p.z>=u;){if(p!==e.prev&&p!==e.next&&yl(n.x,n.y,o.x,o.y,a.x,a.y,p.x,p.y)&&0<=gl(p.prev,p,p.next))return;p=p.prevZ}for(;h&&h.z<=c;){if(h!==e.prev&&h!==e.next&&yl(n.x,n.y,o.x,o.y,a.x,a.y,h.x,h.y)&&0<=gl(h.prev,h,h.next))return;h=h.nextZ}return 1}}function cl(e,t,r){var i=e;do{var n=i.prev,o=i.next.next;!vl(n,o)&&_l(n,i,i.next,o)&&wl(n,o)&&wl(o,n)&&(t.push(n.i/r),t.push(i.i/r),t.push(o.i/r),Cl(i),Cl(i.next),i=e=o),i=i.next}while(i!==e);return al(i)}function pl(e,t,r,i,n,o){var a,s,l=e;do{for(var u=l.next.next;u!==l.prev;){if(l.i!==u.i&&(s=u,(a=l).next.i!==s.i&&a.prev.i!==s.i&&!function(e,t){var r=e;do{if(r.i!==e.i&&r.next.i!==e.i&&r.i!==t.i&&r.next.i!==t.i&&_l(r,r.next,e,t))return 1;r=r.next}while(r!==e)}(a,s)&&(wl(a,s)&&wl(s,a)&&function(e,t){for(var r=e,i=!1,n=(e.x+t.x)/2,o=(e.y+t.y)/2;r.y>o!=r.next.y>o&&r.next.y!==r.y&&n<(r.next.x-r.x)*(o-r.y)/(r.next.y-r.y)+r.x&&(i=!i),(r=r.next)!==e;);return i}(a,s)&&(gl(a.prev,a,s.prev)||gl(a,s.prev,s))||vl(a,s)&&0<gl(a.prev,a,a.next)&&0<gl(s.prev,s,s.next)))){var c=Sl(l,u);return l=al(l,l.next),c=al(c,c.next),sl(l,t,r,i,n,o),void sl(c,t,r,i,n,o)}u=u.next}l=l.next}while(l!==e)}function hl(e,t){return e.x-t.x}function dl(e,t){if(t=function(e,t){var r,i=t,n=e.x,o=e.y,a=-1/0;do{if(o<=i.y&&o>=i.next.y&&i.next.y!==i.y){var s=i.x+(o-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(s<=n&&a<s){if((a=s)===n){if(o===i.y)return i;if(o===i.next.y)return i.next}r=i.x<i.next.x?i:i.next}}i=i.next}while(i!==t);if(!r)return null;if(n===a)return r;var l,u,c,p=r,h=r.x,d=r.y,m=1/0;for(i=r;n>=i.x&&i.x>=h&&n!==i.x&&yl(o<d?n:a,o,h,d,o<d?a:n,o,i.x,i.y)&&(l=Math.abs(o-i.y)/(n-i.x),wl(i,e)&&(l<m||l===m&&(i.x>r.x||i.x===r.x&&(c=i,gl((u=r).prev,u,c.prev)<0&&gl(c.next,u,u.next)<0)))&&(r=i,m=l)),(i=i.next)!==p;);return r}(e,t)){var r=Sl(t,e);al(t,t.next),al(r,r.next)}}function ml(e,t,r,i,n){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-r)*n)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-i)*n)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function fl(e){for(var t=e,r=e;(t.x<r.x||t.x===r.x&&t.y<r.y)&&(r=t),(t=t.next)!==e;);return r}function yl(e,t,r,i,n,o,a,s){return 0<=(n-a)*(t-s)-(e-a)*(o-s)&&0<=(e-a)*(i-s)-(r-a)*(t-s)&&0<=(r-a)*(o-s)-(n-a)*(i-s)}function gl(e,t,r){return(t.y-e.y)*(r.x-t.x)-(t.x-e.x)*(r.y-t.y)}function vl(e,t){return e.x===t.x&&e.y===t.y}function _l(e,t,r,i){var n=xl(gl(e,t,r)),o=xl(gl(e,t,i)),a=xl(gl(r,i,e)),s=xl(gl(r,i,t));return n!==o&&a!==s||0===n&&bl(e,r,t)||0===o&&bl(e,i,t)||0===a&&bl(r,e,i)||0===s&&bl(r,t,i)}function bl(e,t,r){return t.x<=Math.max(e.x,r.x)&&t.x>=Math.min(e.x,r.x)&&t.y<=Math.max(e.y,r.y)&&t.y>=Math.min(e.y,r.y)}function xl(e){return 0<e?1:e<0?-1:0}function wl(e,t){return gl(e.prev,e,e.next)<0?0<=gl(e,t,e.next)&&0<=gl(e,e.prev,t):gl(e,t,e.prev)<0||gl(e,e.next,t)<0}function Sl(e,t){var r=new El(e.i,e.x,e.y),i=new El(t.i,t.x,t.y),n=e.next,o=t.prev;return(e.next=t).prev=e,(r.next=n).prev=r,(i.next=r).prev=i,(o.next=i).prev=o,i}function Tl(e,t,r,i){var n=new El(e,t,r);return i?(n.next=i.next,(n.prev=i).next.prev=n,i.next=n):(n.prev=n).next=n,n}function Cl(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function El(e,t,r){this.i=e,this.x=t,this.y=r,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Il(e,t,r,i){for(var n=0,o=t,a=r-i;o<r;o+=i)n+=(e[a]-e[o])*(e[o+1]+e[a+1]),a=o;return n}function Pl(e,t,r){var i=e[t];e[t]=e[r],e[r]=i}function Rl(e,t){return e<t?-1:t<e?1:0}function Nl(e,t){var r,i,n=e.length;if(n<=1)return[e];for(var o,a,s=[],l=0;l<n;l++){var u=T(e[l]);0!==u&&(e[l].area=Math.abs(u),void 0===a&&(a=u<0),a===u<0?(o&&s.push(o),o=[e[l]]):o.push(e[l]))}if(o&&s.push(o),1<t)for(var c=0;c<s.length;c++)s[c].length<=t||(i=Al,function e(t,r,i,n,o){for(;i<n;){if(600<n-i){var a=n-i+1,s=r-i+1,l=Math.log(a),u=.5*Math.exp(2*l/3),c=.5*Math.sqrt(l*u*(a-u)/a)*(s-a/2<0?-1:1);e(t,r,Math.max(i,Math.floor(r-s*u/a+c)),Math.min(n,Math.floor(r+(a-s)*u/a+c)),o)}var p=t[r],h=i,d=n;for(Pl(t,i,r),0<o(t[n],p)&&Pl(t,i,n);h<d;){for(Pl(t,h,d),h++,d--;o(t[h],p)<0;)h++;for(;0<o(t[d],p);)d--}0===o(t[i],p)?Pl(t,i,d):Pl(t,++d,n),d<=r&&(i=d+1),r<=d&&(n=d-1)}}(r=s[c],t,1,s[c].length-1||r.length-1,i||Rl),s[c]=s[c].slice(0,t));return s}function Al(e,t){return t.area-e.area}function zl(e,t,r){for(var i=r.patternDependencies,n=!1,o=0,a=t;o<a.length;o+=1){var s=a[o].paint.get(e+"-pattern");s.isConstant()||(n=!0);var l=s.constantOr(null);l&&(n=!0,i[l.to]=!0,i[l.from]=!0)}return n}function Ml(e,t,r,i,n){for(var o=n.patternDependencies,a=0,s=t;a<s.length;a+=1){var l=s[a],u=l.paint.get(e+"-pattern").value;if("constant"!==u.kind){var c=u.evaluate({zoom:i-1},r,{},n.availableImages),p=u.evaluate({zoom:i},r,{},n.availableImages),h=u.evaluate({zoom:i+1},r,{},n.availableImages);p=p&&p.name?p.name:p,h=h&&h.name?h.name:h,o[c=c&&c.name?c.name:c]=!0,o[p]=!0,o[h]=!0,r.patterns[l.id]={min:c,mid:p,max:h}}}return r}function kl(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map((function(e){return e.id})),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Dn,this.indexArray=new bo,this.indexArray2=new Bo,this.programConfigurations=new os(e.layers,e.zoom),this.segments=new ga,this.segments2=new ga,this.stateDependentLayerIds=this.layers.filter((function(e){return e.isStateDependent()})).map((function(e){return e.id}))}nl.deviation=function(e,t,r,i){var n=t&&t.length,o=Math.abs(Il(e,0,n?t[0]*r:e.length,r));if(n)for(var a=0,s=t.length;a<s;a++)o-=Math.abs(Il(e,t[a]*r,a<s-1?t[a+1]*r:e.length,r));var l=0;for(a=0;a<i.length;a+=3){var u=i[a]*r,c=i[a+1]*r,p=i[a+2]*r;l+=Math.abs((e[u]-e[p])*(e[1+c]-e[1+u])-(e[u]-e[c])*(e[1+p]-e[1+u]))}return 0===o&&0===l?0:Math.abs((l-o)/o)},nl.flatten=function(e){for(var t=e[0][0].length,r={vertices:[],holes:[],dimensions:t},i=0,n=0;n<e.length;n++){for(var o=0;o<e[n].length;o++)for(var a=0;a<t;a++)r.vertices.push(e[n][o][a]);0<n&&r.holes.push(i+=e[n-1].length)}return r},el.default=tl,kl.prototype.populate=function(e,t,r){this.hasPattern=zl("fill",this.layers,t);for(var i=this.layers[0].layout.get("fill-sort-key"),n=[],o=0,a=e;o<a.length;o+=1){var s=a[o],l=s.feature,u=s.id,c=s.index,p=s.sourceLayerIndex,h=this.layers[0]._featureFilter.needGeometry,d={type:l.type,id:u,properties:l.properties,geometry:h?us(l):[]};if(this.layers[0]._featureFilter.filter(new un(this.zoom),d,r)){h||(d.geometry=us(l));var m=i?i.evaluate(d,{},r,t.availableImages):void 0;n.push({id:u,properties:l.properties,type:l.type,sourceLayerIndex:p,index:c,geometry:d.geometry,patterns:{},sortKey:m})}}i&&n.sort((function(e,t){return e.sortKey-t.sortKey}));for(var f=0,y=n;f<y.length;f+=1){var g=y[f],v=g.geometry,_=g.index,b=g.sourceLayerIndex;if(this.hasPattern){var x=Ml("fill",this.layers,g,this.zoom,t);this.patternFeatures.push(x)}else this.addFeature(g,v,_,r,{});t.featureIndex.insert(e[_].feature,v,_,b,this.index)}},kl.prototype.update=function(e,t,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,r)},kl.prototype.addFeatures=function(e,t,r){for(var i=0,n=this.patternFeatures;i<n.length;i+=1){var o=n[i];this.addFeature(o,o.geometry,o.index,t,r)}},kl.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},kl.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},kl.prototype.upload=function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Qs),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0},kl.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())},kl.prototype.addFeature=function(e,t,r,i,n){for(var o=0,a=Nl(t,500);o<a.length;o+=1){for(var s=a[o],l=0,u=0,c=s;u<c.length;u+=1)l+=c[u].length;for(var p=this.segments.prepareSegment(l,this.layoutVertexArray,this.indexArray),h=p.vertexLength,d=[],m=[],f=0,y=s;f<y.length;f+=1){var g=y[f];if(0!==g.length){g!==s[0]&&m.push(d.length/2);var v=this.segments2.prepareSegment(g.length,this.layoutVertexArray,this.indexArray2),_=v.vertexLength;this.layoutVertexArray.emplaceBack(g[0].x,g[0].y),this.indexArray2.emplaceBack(_+g.length-1,_),d.push(g[0].x),d.push(g[0].y);for(var b=1;b<g.length;b++)this.layoutVertexArray.emplaceBack(g[b].x,g[b].y),this.indexArray2.emplaceBack(_+b-1,_+b),d.push(g[b].x),d.push(g[b].y);v.vertexLength+=g.length,v.primitiveLength+=g.length}}for(var x=el(d,m),w=0;w<x.length;w+=3)this.indexArray.emplaceBack(h+x[w],h+x[w+1],h+x[w+2]);p.vertexLength+=l,p.primitiveLength+=x.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,r,n,i)},ji("FillBucket",kl,{omit:["layers","patternFeatures"]});var Ol,Ll=new In({"fill-sort-key":new xn(Oe.layout_fill["fill-sort-key"])}),Dl={paint:new In({"fill-antialias":new bn(Oe.paint_fill["fill-antialias"]),"fill-opacity":new xn(Oe.paint_fill["fill-opacity"]),"fill-color":new xn(Oe.paint_fill["fill-color"]),"fill-outline-color":new xn(Oe.paint_fill["fill-outline-color"]),"fill-translate":new bn(Oe.paint_fill["fill-translate"]),"fill-translate-anchor":new bn(Oe.paint_fill["fill-translate-anchor"]),"fill-pattern":new Tn(Oe.paint_fill["fill-pattern"])}),layout:Ll},Bl=(Ul.__proto__=Ol=An,((Ul.prototype=Object.create(Ol&&Ol.prototype)).constructor=Ul).prototype.recalculate=function(e,t){Ol.prototype.recalculate.call(this,e,t);var r=this.paint._values["fill-outline-color"];"constant"===r.value.kind&&void 0===r.value.value&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])},Ul.prototype.createBucket=function(e){return new kl(e)},Ul.prototype.queryRadius=function(){return ws(this.paint.get("fill-translate"))},Ul.prototype.queryIntersectsFeature=function(e,t,r,i,n,o,a){return ds(Ss(e,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),o.angle,a),i)},Ul.prototype.isTileClipped=function(){return!0},Ul),Fl=kn([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4).members,ql=jl;function Ul(e){Ol.call(this,e,Dl)}function jl(e,t,r,i,n){this.properties={},this.extent=r,this.type=0,this._pbf=e,this._geometry=-1,this._keys=i,this._values=n,e.readFields(Vl,this,t)}function Vl(e,t,r){1==e?t.id=r.readVarint():2==e?function(e,t){for(var r=e.readVarint()+e.pos;e.pos<r;){var i=t._keys[e.readVarint()],n=t._values[e.readVarint()];t.properties[i]=n}}(r,t):3==e?t.type=r.readVarint():4==e&&(t._geometry=r.pos)}function Gl(e){for(var t,r,i=0,n=0,o=e.length,a=o-1;n<o;a=n++)i+=((r=e[a]).x-(t=e[n]).x)*(t.y+r.y);return i}jl.types=["Unknown","Point","LineString","Polygon"],jl.prototype.loadGeometry=function(){var e=this._pbf;e.pos=this._geometry;for(var t,r=e.readVarint()+e.pos,i=1,o=0,a=0,s=0,l=[];e.pos<r;){if(o<=0){var u=e.readVarint();i=7&u,o=u>>3}if(o--,1===i||2===i)a+=e.readSVarint(),s+=e.readSVarint(),1===i&&(t&&l.push(t),t=[]),t.push(new n(a,s));else{if(7!==i)throw new Error("unknown command "+i);t&&t.push(t[0].clone())}}return t&&l.push(t),l},jl.prototype.bbox=function(){var e=this._pbf;e.pos=this._geometry;for(var t=e.readVarint()+e.pos,r=1,i=0,n=0,o=0,a=1/0,s=-1/0,l=1/0,u=-1/0;e.pos<t;){if(i<=0){var c=e.readVarint();r=7&c,i=c>>3}if(i--,1===r||2===r)(n+=e.readSVarint())<a&&(a=n),s<n&&(s=n),(o+=e.readSVarint())<l&&(l=o),u<o&&(u=o);else if(7!==r)throw new Error("unknown command "+r)}return[a,l,s,u]},jl.prototype.toGeoJSON=function(e,t,r){var i,n,o=this.extent*Math.pow(2,r),a=this.extent*e,s=this.extent*t,l=this.loadGeometry(),u=jl.types[this.type];function c(e){for(var t=0;t<e.length;t++){var r=e[t];e[t]=[360*(r.x+a)/o-180,360/Math.PI*Math.atan(Math.exp((180-360*(r.y+s)/o)*Math.PI/180))-90]}}switch(this.type){case 1:var p=[];for(i=0;i<l.length;i++)p[i]=l[i][0];c(l=p);break;case 2:for(i=0;i<l.length;i++)c(l[i]);break;case 3:for(l=function(e){var t=e.length;if(t<=1)return[e];for(var r,i,n=[],o=0;o<t;o++){var a=Gl(e[o]);0!==a&&(void 0===i&&(i=a<0),i===a<0?(r&&n.push(r),r=[e[o]]):r.push(e[o]))}return r&&n.push(r),n}(l),i=0;i<l.length;i++)for(n=0;n<l[i].length;n++)c(l[i][n])}1===l.length?l=l[0]:u="Multi"+u;var h={type:"Feature",geometry:{type:u,coordinates:l},properties:this.properties};return"id"in this&&(h.id=this.id),h};var Hl=Zl;function Zl(e,t){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=e,this._keys=[],this._values=[],this._features=[],e.readFields(Wl,this,t),this.length=this._features.length}function Wl(e,t,r){15===e?t.version=r.readVarint():1===e?t.name=r.readString():5===e?t.extent=r.readVarint():2===e?t._features.push(r.pos):3===e?t._keys.push(r.readString()):4===e&&t._values.push(function(e){for(var t=null,r=e.readVarint()+e.pos;e.pos<r;){var i=e.readVarint()>>3;t=1==i?e.readString():2==i?e.readFloat():3==i?e.readDouble():4==i?e.readVarint64():5==i?e.readVarint():6==i?e.readSVarint():7==i?e.readBoolean():null}return t}(r))}function Kl(e,t,r){if(3===e){var i=new Hl(r,r.readVarint()+r.pos);i.length&&(t[i.name]=i)}}Zl.prototype.feature=function(e){if(e<0||e>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[e];var t=this._pbf.readVarint()+this._pbf.pos;return new ql(this._pbf,t,this.extent,this._keys,this._values)};var Xl={VectorTile:function(e,t){this.layers=e.readFields(Kl,{},t)},VectorTileFeature:ql,VectorTileLayer:Hl},Yl=Xl.VectorTileFeature.types,Jl=Math.pow(2,13);function $l(e,t,r,i,n,o,a,s){e.emplaceBack(t,r,2*Math.floor(i*Jl)+a,n*Jl*2,o*Jl*2,Math.round(s))}function Ql(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map((function(e){return e.id})),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new Vn,this.indexArray=new bo,this.programConfigurations=new os(e.layers,e.zoom),this.segments=new ga,this.stateDependentLayerIds=this.layers.filter((function(e){return e.isStateDependent()})).map((function(e){return e.id}))}Ql.prototype.populate=function(e,t,r){this.features=[],this.hasPattern=zl("fill-extrusion",this.layers,t);for(var i=0,n=e;i<n.length;i+=1){var o=n[i],a=o.feature,s=o.id,l=o.index,u=o.sourceLayerIndex,c=this.layers[0]._featureFilter.needGeometry,p={type:a.type,id:s,properties:a.properties,geometry:c?us(a):[]};if(this.layers[0]._featureFilter.filter(new un(this.zoom),p,r)){var h={id:s,sourceLayerIndex:u,index:l,geometry:c?p.geometry:us(a),properties:a.properties,type:a.type,patterns:{}};void 0!==a.id&&(h.id=a.id),this.hasPattern?this.features.push(Ml("fill-extrusion",this.layers,h,this.zoom,t)):this.addFeature(h,h.geometry,l,r,{}),t.featureIndex.insert(a,h.geometry,l,u,this.index,!0)}}},Ql.prototype.addFeatures=function(e,t,r){for(var i=0,n=this.features;i<n.length;i+=1){var o=n[i];this.addFeature(o,o.geometry,o.index,t,r)}},Ql.prototype.update=function(e,t,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,r)},Ql.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},Ql.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Ql.prototype.upload=function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Fl),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0},Ql.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Ql.prototype.addFeature=function(e,t,r,i,n){for(var o=0,a=Nl(t,500);o<a.length;o+=1){for(var s=a[o],l=0,u=0,c=s;u<c.length;u+=1)l+=c[u].length;for(var p=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray),h=0,d=s;h<d.length;h+=1){var m=d[h];if(0!==m.length&&!((k=m).every((function(e){return e.x<0}))||k.every((function(e){return 8192<e.x}))||k.every((function(e){return e.y<0}))||k.every((function(e){return 8192<e.y}))))for(var f=0,y=0;y<m.length;y++){var g=m[y];if(1<=y){var v=m[y-1];if(M=v,!((z=g).x===M.x&&(z.x<0||8192<z.x)||z.y===M.y&&(z.y<0||8192<z.y))){p.vertexLength+4>ga.MAX_VERTEX_ARRAY_LENGTH&&(p=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));var _=g.sub(v)._perp()._unit(),b=v.dist(g);32768<f+b&&(f=0),$l(this.layoutVertexArray,g.x,g.y,_.x,_.y,0,0,f),$l(this.layoutVertexArray,g.x,g.y,_.x,_.y,0,1,f),$l(this.layoutVertexArray,v.x,v.y,_.x,_.y,0,0,f+=b),$l(this.layoutVertexArray,v.x,v.y,_.x,_.y,0,1,f);var x=p.vertexLength;this.indexArray.emplaceBack(x,x+2,x+1),this.indexArray.emplaceBack(x+1,x+2,x+3),p.vertexLength+=4,p.primitiveLength+=2}}}}if(p.vertexLength+l>ga.MAX_VERTEX_ARRAY_LENGTH&&(p=this.segments.prepareSegment(l,this.layoutVertexArray,this.indexArray)),"Polygon"===Yl[e.type]){for(var w=[],S=[],T=p.vertexLength,C=0,E=s;C<E.length;C+=1){var I=E[C];if(0!==I.length){I!==s[0]&&S.push(w.length/2);for(var P=0;P<I.length;P++){var R=I[P];$l(this.layoutVertexArray,R.x,R.y,0,0,1,1,0),w.push(R.x),w.push(R.y)}}}for(var N=el(w,S),A=0;A<N.length;A+=3)this.indexArray.emplaceBack(T+N[A],T+N[A+2],T+N[A+1]);p.primitiveLength+=N.length/3,p.vertexLength+=l}}var z,M,k;this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,r,n,i)},ji("FillExtrusionBucket",Ql,{omit:["layers","features"]});var eu,tu={paint:new In({"fill-extrusion-opacity":new bn(Oe["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new xn(Oe["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new bn(Oe["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new bn(Oe["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Tn(Oe["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new xn(Oe["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new xn(Oe["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new bn(Oe["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})},ru=(iu.__proto__=eu=An,((iu.prototype=Object.create(eu&&eu.prototype)).constructor=iu).prototype.createBucket=function(e){return new Ql(e)},iu.prototype.queryRadius=function(){return ws(this.paint.get("fill-extrusion-translate"))},iu.prototype.is3D=function(){return!0},iu.prototype.queryIntersectsFeature=function(e,t,r,i,o,a,s,l){var u=Ss(e,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),a.angle,s),c=this.paint.get("fill-extrusion-height").evaluate(t,r),p=this.paint.get("fill-extrusion-base").evaluate(t,r),h=function(e){for(var t=[],r=0,i=u;r<i.length;r+=1){var o=i[r],a=[o.x,o.y,0,1];zs(a,a,e),t.push(new n(a[0]/a[3],a[1]/a[3]))}return t}(l),d=function(e,t){for(var r=[],i=[],o=t[8]*p,a=t[9]*p,s=t[10]*p,l=t[11]*p,u=t[8]*c,h=t[9]*c,d=t[10]*c,m=t[11]*c,f=0,y=e;f<y.length;f+=1){for(var g=[],v=[],_=0,b=y[f];_<b.length;_+=1){var x=b[_],w=x.x,S=x.y,T=t[0]*w+t[4]*S+t[12],C=t[1]*w+t[5]*S+t[13],E=t[2]*w+t[6]*S+t[14],I=t[3]*w+t[7]*S+t[15],P=E+s,R=I+l,N=T+u,A=C+h,z=E+d,M=I+m,k=new n((T+o)/R,(C+a)/R);k.z=P/R,g.push(k);var O=new n(N/M,A/M);O.z=z/M,v.push(O)}r.push(g),i.push(v)}return[r,i]}(i,l);return function(e,t,r){var i=1/0;ds(r,t)&&(i=ou(r,t[0]));for(var n=0;n<t.length;n++)for(var o=t[n],a=e[n],s=0;s<o.length-1;s++){var l=o[s],u=[l,o[s+1],a[s+1],a[s],l];hs(r,u)&&(i=Math.min(i,ou(r,u)))}return i!==1/0&&i}(d[0],d[1],h)},iu);function iu(e){eu.call(this,e,tu)}function nu(e,t){return e.x*t.x+e.y*t.y}function ou(e,t){if(1===e.length){for(var r,i=0,n=t[i++];!r||n.equals(r);)if(!(r=t[i++]))return 1/0;for(;i<t.length;i++){var o=t[i],a=e[0],s=r.sub(n),l=o.sub(n),u=a.sub(n),c=nu(s,s),p=nu(s,l),h=nu(l,l),d=nu(u,s),m=nu(u,l),f=c*h-p*p,y=(h*d-p*m)/f,g=(c*m-p*d)/f,v=n.z*(1-y-g)+r.z*y+o.z*g;if(isFinite(v))return v}return 1/0}for(var _=1/0,b=0,x=t;b<x.length;b+=1)_=Math.min(_,x[b].z);return _}function au(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map((function(e){return e.id})),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Zn,this.indexArray=new bo,this.programConfigurations=new os(e.layers,e.zoom),this.segments=new ga,this.stateDependentLayerIds=this.layers.filter((function(e){return e.isStateDependent()})).map((function(e){return e.id}))}var su=kn([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4).members,lu=Xl.VectorTileFeature.types,uu=Math.cos(Math.PI/180*37.5),cu=Math.pow(2,14)/.5;au.prototype.populate=function(e,t,r){this.hasPattern=zl("line",this.layers,t);for(var i=this.layers[0].layout.get("line-sort-key"),n=[],o=0,a=e;o<a.length;o+=1){var s=a[o],l=s.feature,u=s.id,c=s.index,p=s.sourceLayerIndex,h=this.layers[0]._featureFilter.needGeometry,d={type:l.type,id:u,properties:l.properties,geometry:h?us(l):[]};if(this.layers[0]._featureFilter.filter(new un(this.zoom),d,r)){h||(d.geometry=us(l));var m=i?i.evaluate(d,{},r):void 0;n.push({id:u,properties:l.properties,type:l.type,sourceLayerIndex:p,index:c,geometry:d.geometry,patterns:{},sortKey:m})}}i&&n.sort((function(e,t){return e.sortKey-t.sortKey}));for(var f=0,y=n;f<y.length;f+=1){var g=y[f],v=g.geometry,_=g.index,b=g.sourceLayerIndex;if(this.hasPattern){var x=Ml("line",this.layers,g,this.zoom,t);this.patternFeatures.push(x)}else this.addFeature(g,v,_,r,{});t.featureIndex.insert(e[_].feature,v,_,b,this.index)}},au.prototype.update=function(e,t,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,r)},au.prototype.addFeatures=function(e,t,r){for(var i=0,n=this.patternFeatures;i<n.length;i+=1){var o=n[i];this.addFeature(o,o.geometry,o.index,t,r)}},au.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},au.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},au.prototype.upload=function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,su),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0},au.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},au.prototype.addFeature=function(e,t,r,i,n){for(var o=this.layers[0].layout,a=o.get("line-join").evaluate(e,{}),s=o.get("line-cap"),l=o.get("line-miter-limit"),u=o.get("line-round-limit"),c=0,p=t;c<p.length;c+=1)this.addLine(p[c],e,a,s,l,u);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,r,n,i)},au.prototype.addLine=function(e,t,r,i,n,o){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,t.properties&&t.properties.hasOwnProperty("mapbox_clip_start")&&t.properties.hasOwnProperty("mapbox_clip_end")){this.clipStart=+t.properties.mapbox_clip_start,this.clipEnd=+t.properties.mapbox_clip_end;for(var a=0;a<e.length-1;a++)this.totalDistance+=e[a].dist(e[a+1]);this.updateScaledDistance()}for(var s="Polygon"===lu[t.type],l=e.length;2<=l&&e[l-1].equals(e[l-2]);)l--;for(var u=0;u<l-1&&e[u].equals(e[u+1]);)u++;if(!(l<(s?3:2))){"bevel"===r&&(n=1.05);var c,p=this.overscaling<=16?122880/(512*this.overscaling):0,h=this.segments.prepareSegment(10*l,this.layoutVertexArray,this.indexArray),d=void 0,m=void 0,f=void 0,y=void 0;this.e1=this.e2=-1,s&&(y=e[u].sub(c=e[l-2])._unit()._perp());for(var g=u;g<l;g++)if(!(m=g===l-1?s?e[u+1]:void 0:e[g+1])||!e[g].equals(m)){y&&(f=y),c&&(d=c),c=e[g],y=m?m.sub(c)._unit()._perp():f;var v=(f=f||y).add(y);0===v.x&&0===v.y||v._unit();var _=f.x*y.x+f.y*y.y,b=v.x*y.x+v.y*y.y,x=0!=b?1/b:1/0,w=2*Math.sqrt(2-2*b),S=b<uu&&d&&m,T=0<f.x*y.y-f.y*y.x;if(S&&u<g){var C=c.dist(d);if(2*p<C){var E=c.sub(c.sub(d)._mult(p/C)._round());this.updateDistance(d,E),this.addCurrentVertex(E,f,0,0,h),d=E}}var I=d&&m,P=I?r:s?"butt":i;if(I&&"round"===P&&(x<o?P="miter":x<=2&&(P="fakeround")),"miter"===P&&n<x&&(P="bevel"),"bevel"===P&&(2<x&&(P="flipbevel"),x<n&&(P="miter")),d&&this.updateDistance(d,c),"miter"===P)v._mult(x),this.addCurrentVertex(c,v,0,0,h);else if("flipbevel"===P){if(100<x)v=y.mult(-1);else{var R=x*f.add(y).mag()/f.sub(y).mag();v._perp()._mult(R*(T?-1:1))}this.addCurrentVertex(c,v,0,0,h),this.addCurrentVertex(c,v.mult(-1),0,0,h)}else if("bevel"===P||"fakeround"===P){var N=-Math.sqrt(x*x-1),A=T?N:0,z=T?0:N;if(d&&this.addCurrentVertex(c,f,A,z,h),"fakeround"===P)for(var M=Math.round(180*w/Math.PI/20),k=1;k<M;k++){var O=k/M;if(.5!==O){var L=O-.5;O+=O*L*(O-1)*((1.0904+_*(_*(3.55645-1.43519*_)-3.2452))*L*L+(.848013+_*(.215638*_-1.06021)))}var D=y.sub(f)._mult(O)._add(f)._unit()._mult(T?-1:1);this.addHalfVertex(c,D.x,D.y,!1,T,0,h)}m&&this.addCurrentVertex(c,y,-A,-z,h)}else if("butt"===P)this.addCurrentVertex(c,v,0,0,h);else if("square"===P){var B=d?1:-1;this.addCurrentVertex(c,v,B,B,h)}else"round"===P&&(d&&(this.addCurrentVertex(c,f,0,0,h),this.addCurrentVertex(c,f,1,1,h,!0)),m&&(this.addCurrentVertex(c,y,-1,-1,h,!0),this.addCurrentVertex(c,y,0,0,h)));if(S&&g<l-1){var F=c.dist(m);if(2*p<F){var q=c.add(m.sub(c)._mult(p/F)._round());this.updateDistance(c,q),this.addCurrentVertex(q,y,0,0,h),c=q}}}}},au.prototype.addCurrentVertex=function(e,t,r,i,n,o){void 0===o&&(o=!1);var a=t.y*i-t.x,s=-t.y-t.x*i;this.addHalfVertex(e,t.x+t.y*r,t.y-t.x*r,o,!1,r,n),this.addHalfVertex(e,a,s,o,!0,-i,n),this.distance>cu/2&&0===this.totalDistance&&(this.distance=0,this.addCurrentVertex(e,t,r,i,n,o))},au.prototype.addHalfVertex=function(e,t,r,i,n,o,a){var s=.5*this.scaledDistance;this.layoutVertexArray.emplaceBack((e.x<<1)+(i?1:0),(e.y<<1)+(n?1:0),Math.round(63*t)+128,Math.round(63*r)+128,1+(0===o?0:o<0?-1:1)|(63&s)<<2,s>>6);var l=a.vertexLength++;0<=this.e1&&0<=this.e2&&(this.indexArray.emplaceBack(this.e1,this.e2,l),a.primitiveLength++),n?this.e2=l:this.e1=l},au.prototype.updateScaledDistance=function(){this.scaledDistance=0<this.totalDistance?(this.clipStart+(this.clipEnd-this.clipStart)*this.distance/this.totalDistance)*(cu-1):this.distance},au.prototype.updateDistance=function(e,t){this.distance+=e.dist(t),this.updateScaledDistance()},ji("LineBucket",au,{omit:["layers","patternFeatures"]});var pu,hu=new In({"line-cap":new bn(Oe.layout_line["line-cap"]),"line-join":new xn(Oe.layout_line["line-join"]),"line-miter-limit":new bn(Oe.layout_line["line-miter-limit"]),"line-round-limit":new bn(Oe.layout_line["line-round-limit"]),"line-sort-key":new xn(Oe.layout_line["line-sort-key"])}),du={paint:new In({"line-opacity":new xn(Oe.paint_line["line-opacity"]),"line-color":new xn(Oe.paint_line["line-color"]),"line-translate":new bn(Oe.paint_line["line-translate"]),"line-translate-anchor":new bn(Oe.paint_line["line-translate-anchor"]),"line-width":new xn(Oe.paint_line["line-width"]),"line-gap-width":new xn(Oe.paint_line["line-gap-width"]),"line-offset":new xn(Oe.paint_line["line-offset"]),"line-blur":new xn(Oe.paint_line["line-blur"]),"line-dasharray":new wn(Oe.paint_line["line-dasharray"]),"line-pattern":new Tn(Oe.paint_line["line-pattern"]),"line-gradient":new En(Oe.paint_line["line-gradient"])}),layout:hu},mu=(fu.__proto__=pu=xn,((fu.prototype=Object.create(pu&&pu.prototype)).constructor=fu).prototype.possiblyEvaluate=function(e,t){return t=new un(Math.floor(t.zoom),{now:t.now,fadeDuration:t.fadeDuration,zoomHistory:t.zoomHistory,transition:t.transition}),pu.prototype.possiblyEvaluate.call(this,e,t)},fu.prototype.evaluate=function(e,t,r,i){return t=p({},t,{zoom:Math.floor(t.zoom)}),pu.prototype.evaluate.call(this,e,t,r,i)},new fu(du.paint.properties["line-width"].specification));function fu(){pu.apply(this,arguments)}mu.useIntegerZoom=!0;var yu,gu=(vu.__proto__=yu=An,((vu.prototype=Object.create(yu&&yu.prototype)).constructor=vu).prototype._handleSpecialPaintPropertyUpdate=function(e){"line-gradient"===e&&this._updateGradient()},vu.prototype._updateGradient=function(){this.gradient=Ws(this._transitionablePaint._values["line-gradient"].value.expression,"lineProgress"),this.gradientTexture=null},vu.prototype.recalculate=function(e,t){yu.prototype.recalculate.call(this,e,t),this.paint._values["line-floorwidth"]=mu.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,e)},vu.prototype.createBucket=function(e){return new au(e)},vu.prototype.queryRadius=function(e){var t=e,r=_u(xs("line-width",this,t),xs("line-gap-width",this,t)),i=xs("line-offset",this,t);return r/2+Math.abs(i)+ws(this.paint.get("line-translate"))},vu.prototype.queryIntersectsFeature=function(e,t,r,i,o,a,s){var l=Ss(e,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),a.angle,s),u=s/2*_u(this.paint.get("line-width").evaluate(t,r),this.paint.get("line-gap-width").evaluate(t,r)),c=this.paint.get("line-offset").evaluate(t,r);return c&&(i=function(e,t){for(var r=[],i=new n(0,0),o=0;o<e.length;o++){for(var a=e[o],s=[],l=0;l<a.length;l++){var u=a[l],c=a[l+1],p=0===l?i:u.sub(a[l-1])._unit()._perp(),h=l===a.length-1?i:c.sub(u)._unit()._perp(),d=p._add(h)._unit();d._mult(1/(d.x*h.x+d.y*h.y)),s.push(d._mult(t)._add(u))}r.push(s)}return r}(i,c*s)),function(e,t,r){for(var i=0;i<t.length;i++){var n=t[i];if(3<=e.length)for(var o=0;o<n.length;o++)if(_s(e,n[o]))return!0;if(ms(e,n,r))return!0}return!1}(l,i,u)},vu.prototype.isTileClipped=function(){return!0},vu);function vu(e){yu.call(this,e,du)}function _u(e,t){return 0<t?t+2*e:e}var bu=kn([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),xu=kn([{name:"a_projected_pos",components:3,type:"Float32"}],4),wu=(kn([{name:"a_fade_opacity",components:1,type:"Uint32"}],4),kn([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}])),Su=(kn([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]),kn([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4)),Tu=kn([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function Cu(e,t,r){return e.sections.forEach((function(e){var i,n,o;e.text=(i=e.text,n=r,"uppercase"===(o=t.layout.get("text-transform").evaluate(n,{}))?i=i.toLocaleUpperCase():"lowercase"===o&&(i=i.toLocaleLowerCase()),pn.applyArabicShaping&&(i=pn.applyArabicShaping(i)),i)})),e}function Eu(e,t,r,i,n){var o,a,s=8*n-i-1,l=(1<<s)-1,u=l>>1,c=-7,p=r?n-1:0,h=r?-1:1,d=e[t+p];for(p+=h,o=d&(1<<-c)-1,d>>=-c,c+=s;0<c;o=256*o+e[t+p],p+=h,c-=8);for(a=o&(1<<-c)-1,o>>=-c,c+=i;0<c;a=256*a+e[t+p],p+=h,c-=8);if(0===o)o=1-u;else{if(o===l)return a?NaN:1/0*(d?-1:1);a+=Math.pow(2,i),o-=u}return(d?-1:1)*a*Math.pow(2,o-i)}function Iu(e,t,r,i,n,o){var a,s,l,u=8*o-n-1,c=(1<<u)-1,p=c>>1,h=23===n?Math.pow(2,-24)-Math.pow(2,-77):0,d=i?0:o-1,m=i?1:-1,f=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,a=c):(a=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-a))<1&&(a--,l*=2),2<=(t+=1<=a+p?h/l:h*Math.pow(2,1-p))*l&&(a++,l/=2),c<=a+p?(s=0,a=c):1<=a+p?(s=(t*l-1)*Math.pow(2,n),a+=p):(s=t*Math.pow(2,p-1)*Math.pow(2,n),a=0));8<=n;e[r+d]=255&s,d+=m,s/=256,n-=8);for(a=a<<n|s,u+=n;0<u;e[r+d]=255&a,d+=m,a/=256,u-=8);e[r+d-m]|=128*f}kn([{name:"triangle",components:3,type:"Uint16"}]),kn([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),kn([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),kn([{type:"Float32",name:"offsetX"}]),kn([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);var Pu={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","¢":"￠","£":"￡","¥":"￥","¦":"￤","¬":"￢","¯":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂"},Ru=Nu;function Nu(e){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(e)?e:new Uint8Array(e||0),this.pos=0,this.type=0,this.length=this.buf.length}Nu.Varint=0,Nu.Fixed64=1,Nu.Bytes=2,Nu.Fixed32=5;var Au="undefined"==typeof TextDecoder?null:new TextDecoder("utf8");function zu(e){return e.type===Nu.Bytes?e.readVarint()+e.pos:e.pos+1}function Mu(e,t,r){return r?4294967296*t+(e>>>0):4294967296*(t>>>0)+(e>>>0)}function ku(e,t,r){var i=t<=16383?1:t<=2097151?2:t<=268435455?3:Math.floor(Math.log(t)/(7*Math.LN2));r.realloc(i);for(var n=r.pos-1;e<=n;n--)r.buf[n+i]=r.buf[n]}function Ou(e,t){for(var r=0;r<e.length;r++)t.writeVarint(e[r])}function Lu(e,t){for(var r=0;r<e.length;r++)t.writeSVarint(e[r])}function Du(e,t){for(var r=0;r<e.length;r++)t.writeFloat(e[r])}function Bu(e,t){for(var r=0;r<e.length;r++)t.writeDouble(e[r])}function Fu(e,t){for(var r=0;r<e.length;r++)t.writeBoolean(e[r])}function qu(e,t){for(var r=0;r<e.length;r++)t.writeFixed32(e[r])}function Uu(e,t){for(var r=0;r<e.length;r++)t.writeSFixed32(e[r])}function ju(e,t){for(var r=0;r<e.length;r++)t.writeFixed64(e[r])}function Vu(e,t){for(var r=0;r<e.length;r++)t.writeSFixed64(e[r])}function Gu(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+16777216*e[t+3]}function Hu(e,t,r){e[r]=t,e[r+1]=t>>>8,e[r+2]=t>>>16,e[r+3]=t>>>24}function Zu(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+(e[t+3]<<24)}function Wu(e,t,r){1===e&&r.readMessage(Ku,t)}function Ku(e,t,r){if(3===e){var i=r.readMessage(Xu,{}),n=i.width,o=i.height,a=i.left,s=i.top,l=i.advance;t.push({id:i.id,bitmap:new Gs({width:n+6,height:o+6},i.bitmap),metrics:{width:n,height:o,left:a,top:s,advance:l}})}}function Xu(e,t,r){1===e?t.id=r.readVarint():2===e?t.bitmap=r.readBytes():3===e?t.width=r.readVarint():4===e?t.height=r.readVarint():5===e?t.left=r.readSVarint():6===e?t.top=r.readSVarint():7===e&&(t.advance=r.readVarint())}function Yu(e){for(var t=0,r=0,i=0,n=e;i<n.length;i+=1){var o=n[i];t+=o.w*o.h,r=Math.max(r,o.w)}e.sort((function(e,t){return t.h-e.h}));for(var a=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(t/.95)),r),h:1/0}],s=0,l=0,u=0,c=e;u<c.length;u+=1)for(var p=c[u],h=a.length-1;0<=h;h--){var d=a[h];if(!(p.w>d.w||p.h>d.h)){if(p.x=d.x,p.y=d.y,l=Math.max(l,p.y+p.h),s=Math.max(s,p.x+p.w),p.w===d.w&&p.h===d.h){var m=a.pop();h<a.length&&(a[h]=m)}else p.h===d.h?(d.x+=p.w,d.w-=p.w):(p.w===d.w||a.push({x:d.x+p.w,y:d.y,w:d.w-p.w,h:p.h}),d.y+=p.h,d.h-=p.h);break}}return{w:s,h:l,fill:t/(s*l)||0}}function Ju(e,t){var r=t.pixelRatio,i=t.version,n=t.stretchX,o=t.stretchY,a=t.content;this.paddedRect=e,this.pixelRatio=r,this.stretchX=n,this.stretchY=o,this.content=a,this.version=i}Nu.prototype={destroy:function(){this.buf=null},readFields:function(e,t,r){for(r=r||this.length;this.pos<r;){var i=this.readVarint(),n=i>>3,o=this.pos;this.type=7&i,e(n,t,this),this.pos===o&&this.skip(i)}return t},readMessage:function(e,t){return this.readFields(e,t,this.readVarint()+this.pos)},readFixed32:function(){var e=Gu(this.buf,this.pos);return this.pos+=4,e},readSFixed32:function(){var e=Zu(this.buf,this.pos);return this.pos+=4,e},readFixed64:function(){var e=Gu(this.buf,this.pos)+4294967296*Gu(this.buf,this.pos+4);return this.pos+=8,e},readSFixed64:function(){var e=Gu(this.buf,this.pos)+4294967296*Zu(this.buf,this.pos+4);return this.pos+=8,e},readFloat:function(){var e=Eu(this.buf,this.pos,!0,23,4);return this.pos+=4,e},readDouble:function(){var e=Eu(this.buf,this.pos,!0,52,8);return this.pos+=8,e},readVarint:function(e){var t,r,i=this.buf;return t=127&(r=i[this.pos++]),r<128?t:(t|=(127&(r=i[this.pos++]))<<7,r<128?t:(t|=(127&(r=i[this.pos++]))<<14,r<128?t:(t|=(127&(r=i[this.pos++]))<<21,r<128?t:function(e,t,r){var i,n,o=r.buf;if(i=(112&(n=o[r.pos++]))>>4,n<128)return Mu(e,i,t);if(i|=(127&(n=o[r.pos++]))<<3,n<128)return Mu(e,i,t);if(i|=(127&(n=o[r.pos++]))<<10,n<128)return Mu(e,i,t);if(i|=(127&(n=o[r.pos++]))<<17,n<128)return Mu(e,i,t);if(i|=(127&(n=o[r.pos++]))<<24,n<128)return Mu(e,i,t);if(i|=(1&(n=o[r.pos++]))<<31,n<128)return Mu(e,i,t);throw new Error("Expected varint not more than 10 bytes")}(t|=(15&(r=i[this.pos]))<<28,e,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var e=this.readVarint();return e%2==1?(e+1)/-2:e/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var e,t,r,i=this.readVarint()+this.pos,n=this.pos;return 12<=(this.pos=i)-n&&Au?(e=this.buf,t=n,r=i,Au.decode(e.subarray(t,r))):function(e,t){for(var r="",i=n;i<t;){var o,a,s,l=e[i],u=null,c=239<l?4:223<l?3:191<l?2:1;if(t<i+c)break;1===c?l<128&&(u=l):2===c?128==(192&(o=e[i+1]))&&(u=(31&l)<<6|63&o)<=127&&(u=null):3===c?(a=e[i+2],128==(192&(o=e[i+1]))&&128==(192&a)&&((u=(15&l)<<12|(63&o)<<6|63&a)<=2047||55296<=u&&u<=57343)&&(u=null)):4===c&&(a=e[i+2],s=e[i+3],128==(192&(o=e[i+1]))&&128==(192&a)&&128==(192&s)&&((u=(15&l)<<18|(63&o)<<12|(63&a)<<6|63&s)<=65535||1114112<=u)&&(u=null)),null===u?(u=65533,c=1):65535<u&&(u-=65536,r+=String.fromCharCode(u>>>10&1023|55296),u=56320|1023&u),r+=String.fromCharCode(u),i+=c}return r}(this.buf,i)},readBytes:function(){var e=this.readVarint()+this.pos,t=this.buf.subarray(this.pos,e);return this.pos=e,t},readPackedVarint:function(e,t){if(this.type!==Nu.Bytes)return e.push(this.readVarint(t));var r=zu(this);for(e=e||[];this.pos<r;)e.push(this.readVarint(t));return e},readPackedSVarint:function(e){if(this.type!==Nu.Bytes)return e.push(this.readSVarint());var t=zu(this);for(e=e||[];this.pos<t;)e.push(this.readSVarint());return e},readPackedBoolean:function(e){if(this.type!==Nu.Bytes)return e.push(this.readBoolean());var t=zu(this);for(e=e||[];this.pos<t;)e.push(this.readBoolean());return e},readPackedFloat:function(e){if(this.type!==Nu.Bytes)return e.push(this.readFloat());var t=zu(this);for(e=e||[];this.pos<t;)e.push(this.readFloat());return e},readPackedDouble:function(e){if(this.type!==Nu.Bytes)return e.push(this.readDouble());var t=zu(this);for(e=e||[];this.pos<t;)e.push(this.readDouble());return e},readPackedFixed32:function(e){if(this.type!==Nu.Bytes)return e.push(this.readFixed32());var t=zu(this);for(e=e||[];this.pos<t;)e.push(this.readFixed32());return e},readPackedSFixed32:function(e){if(this.type!==Nu.Bytes)return e.push(this.readSFixed32());var t=zu(this);for(e=e||[];this.pos<t;)e.push(this.readSFixed32());return e},readPackedFixed64:function(e){if(this.type!==Nu.Bytes)return e.push(this.readFixed64());var t=zu(this);for(e=e||[];this.pos<t;)e.push(this.readFixed64());return e},readPackedSFixed64:function(e){if(this.type!==Nu.Bytes)return e.push(this.readSFixed64());var t=zu(this);for(e=e||[];this.pos<t;)e.push(this.readSFixed64());return e},skip:function(e){var t=7&e;if(t===Nu.Varint)for(;127<this.buf[this.pos++];);else if(t===Nu.Bytes)this.pos=this.readVarint()+this.pos;else if(t===Nu.Fixed32)this.pos+=4;else{if(t!==Nu.Fixed64)throw new Error("Unimplemented type: "+t);this.pos+=8}},writeTag:function(e,t){this.writeVarint(e<<3|t)},realloc:function(e){for(var t=this.length||16;t<this.pos+e;)t*=2;if(t!==this.length){var r=new Uint8Array(t);r.set(this.buf),this.buf=r,this.length=t}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(e){this.realloc(4),Hu(this.buf,e,this.pos),this.pos+=4},writeSFixed32:function(e){this.realloc(4),Hu(this.buf,e,this.pos),this.pos+=4},writeFixed64:function(e){this.realloc(8),Hu(this.buf,-1&e,this.pos),Hu(this.buf,Math.floor(e*(1/4294967296)),this.pos+4),this.pos+=8},writeSFixed64:function(e){this.realloc(8),Hu(this.buf,-1&e,this.pos),Hu(this.buf,Math.floor(e*(1/4294967296)),this.pos+4),this.pos+=8},writeVarint:function(e){268435455<(e=+e||0)||e<0?function(t){var r,i,n,o,a,s,l;if(0<=e?(r=e%4294967296|0,i=e/4294967296|0):(i=~(-e/4294967296),4294967295^(r=~(-e%4294967296))?r=r+1|0:i=i+1|(r=0)),0x10000000000000000<=e||e<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");t.realloc(10),s=r,(l=t).buf[l.pos++]=127&s|128,s>>>=7,l.buf[l.pos++]=127&s|128,s>>>=7,l.buf[l.pos++]=127&s|128,s>>>=7,l.buf[l.pos++]=127&s|128,l.buf[l.pos]=127&(s>>>=7),a=(7&(n=i))<<4,(o=t).buf[o.pos++]|=a|((n>>>=3)?128:0),n&&(o.buf[o.pos++]=127&n|((n>>>=7)?128:0),n&&(o.buf[o.pos++]=127&n|((n>>>=7)?128:0),n&&(o.buf[o.pos++]=127&n|((n>>>=7)?128:0),n&&(o.buf[o.pos++]=127&n|((n>>>=7)?128:0),n&&(o.buf[o.pos++]=127&n)))))}(this):(this.realloc(4),this.buf[this.pos++]=127&e|(127<e?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(127<e?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(127<e?128:0),e<=127||(this.buf[this.pos++]=e>>>7&127))))},writeSVarint:function(e){this.writeVarint(e<0?2*-e-1:2*e)},writeBoolean:function(e){this.writeVarint(Boolean(e))},writeString:function(e){e=String(e),this.realloc(4*e.length),this.pos++;var t=this.pos;this.pos=function(e,t,r){for(var i,n,o=0;o<t.length;o++){if(55295<(i=t.charCodeAt(o))&&i<57344){if(!n){56319<i||o+1===t.length?(e[r++]=239,e[r++]=191,e[r++]=189):n=i;continue}if(i<56320){e[r++]=239,e[r++]=191,e[r++]=189,n=i;continue}i=n-55296<<10|i-56320|65536,n=null}else n&&(e[r++]=239,e[r++]=191,e[r++]=189,n=null);i<128?e[r++]=i:(i<2048?e[r++]=i>>6|192:(i<65536?e[r++]=i>>12|224:(e[r++]=i>>18|240,e[r++]=i>>12&63|128),e[r++]=i>>6&63|128),e[r++]=63&i|128)}return r}(this.buf,e,this.pos);var r=this.pos-t;128<=r&&ku(t,r,this),this.pos=t-1,this.writeVarint(r),this.pos+=r},writeFloat:function(e){this.realloc(4),Iu(this.buf,e,this.pos,!0,23,4),this.pos+=4},writeDouble:function(e){this.realloc(8),Iu(this.buf,e,this.pos,!0,52,8),this.pos+=8},writeBytes:function(e){var t=e.length;this.writeVarint(t),this.realloc(t);for(var r=0;r<t;r++)this.buf[this.pos++]=e[r]},writeRawMessage:function(e,t){this.pos++;var r=this.pos;e(t,this);var i=this.pos-r;128<=i&&ku(r,i,this),this.pos=r-1,this.writeVarint(i),this.pos+=i},writeMessage:function(e,t,r){this.writeTag(e,Nu.Bytes),this.writeRawMessage(t,r)},writePackedVarint:function(e,t){t.length&&this.writeMessage(e,Ou,t)},writePackedSVarint:function(e,t){t.length&&this.writeMessage(e,Lu,t)},writePackedBoolean:function(e,t){t.length&&this.writeMessage(e,Fu,t)},writePackedFloat:function(e,t){t.length&&this.writeMessage(e,Du,t)},writePackedDouble:function(e,t){t.length&&this.writeMessage(e,Bu,t)},writePackedFixed32:function(e,t){t.length&&this.writeMessage(e,qu,t)},writePackedSFixed32:function(e,t){t.length&&this.writeMessage(e,Uu,t)},writePackedFixed64:function(e,t){t.length&&this.writeMessage(e,ju,t)},writePackedSFixed64:function(e,t){t.length&&this.writeMessage(e,Vu,t)},writeBytesField:function(e,t){this.writeTag(e,Nu.Bytes),this.writeBytes(t)},writeFixed32Field:function(e,t){this.writeTag(e,Nu.Fixed32),this.writeFixed32(t)},writeSFixed32Field:function(e,t){this.writeTag(e,Nu.Fixed32),this.writeSFixed32(t)},writeFixed64Field:function(e,t){this.writeTag(e,Nu.Fixed64),this.writeFixed64(t)},writeSFixed64Field:function(e,t){this.writeTag(e,Nu.Fixed64),this.writeSFixed64(t)},writeVarintField:function(e,t){this.writeTag(e,Nu.Varint),this.writeVarint(t)},writeSVarintField:function(e,t){this.writeTag(e,Nu.Varint),this.writeSVarint(t)},writeStringField:function(e,t){this.writeTag(e,Nu.Bytes),this.writeString(t)},writeFloatField:function(e,t){this.writeTag(e,Nu.Fixed32),this.writeFloat(t)},writeDoubleField:function(e,t){this.writeTag(e,Nu.Fixed64),this.writeDouble(t)},writeBooleanField:function(e,t){this.writeVarintField(e,Boolean(t))}};var $u={tl:{configurable:!0},br:{configurable:!0},tlbr:{configurable:!0},displaySize:{configurable:!0}};function Qu(e,t){var r={},i={};this.haveRenderCallbacks=[];var n=[];this.addImages(e,r,n),this.addImages(t,i,n);var o=Yu(n),a=new Hs({width:o.w||1,height:o.h||1});for(var s in e){var l=e[s],u=r[s].paddedRect;Hs.copy(l.data,a,{x:0,y:0},{x:u.x+1,y:u.y+1},l.data)}for(var c in t){var p=t[c],h=i[c].paddedRect,d=h.x+1,m=h.y+1,f=p.data.width,y=p.data.height;Hs.copy(p.data,a,{x:0,y:0},{x:d,y:m},p.data),Hs.copy(p.data,a,{x:0,y:y-1},{x:d,y:m-1},{width:f,height:1}),Hs.copy(p.data,a,{x:0,y:0},{x:d,y:m+y},{width:f,height:1}),Hs.copy(p.data,a,{x:f-1,y:0},{x:d-1,y:m},{width:1,height:y}),Hs.copy(p.data,a,{x:0,y:0},{x:d+f,y:m},{width:1,height:y})}this.image=a,this.iconPositions=r,this.patternPositions=i}function ec(){this.scale=1,this.fontStack="",this.imageName=null}$u.tl.get=function(){return[this.paddedRect.x+1,this.paddedRect.y+1]},$u.br.get=function(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]},$u.tlbr.get=function(){return this.tl.concat(this.br)},$u.displaySize.get=function(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]},Object.defineProperties(Ju.prototype,$u),Qu.prototype.addImages=function(e,t,r){for(var i in e){var n=e[i],o={x:0,y:0,w:n.data.width+2,h:n.data.height+2};r.push(o),t[i]=new Ju(o,n),n.hasRenderCallback&&this.haveRenderCallbacks.push(i)}},Qu.prototype.patchUpdatedImages=function(e,t){for(var r in e.dispatchRenderCallbacks(this.haveRenderCallbacks),e.updatedImages)this.patchUpdatedImage(this.iconPositions[r],e.getImage(r),t),this.patchUpdatedImage(this.patternPositions[r],e.getImage(r),t)},Qu.prototype.patchUpdatedImage=function(e,t,r){if(e&&t&&e.version!==t.version){e.version=t.version;var i=e.tl;r.update(t.data,void 0,{x:i[0],y:i[1]})}},ji("ImagePosition",Ju),ji("ImageAtlas",Qu);var tc={horizontal:1,vertical:2,horizontalOnly:3};function rc(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}function ic(e,t,r,i,n,o,a,s,l,u,c,p,h,d,m,f){var y,g=rc.fromFeature(e,n);p===tc.vertical&&g.verticalizePunctuation();var v=pn.processBidirectionalText,_=pn.processStyledBidirectionalText;if(v&&1===g.sections.length){y=[];for(var b=0,x=v(g.toString(),uc(g,u,o,t,i,d,m));b<x.length;b+=1){var w=x[b],S=new rc;S.text=w,S.sections=g.sections;for(var T=0;T<w.length;T++)S.sectionIndex.push(0);y.push(S)}}else if(_){y=[];for(var C=0,E=_(g.text,g.sectionIndex,uc(g,u,o,t,i,d,m));C<E.length;C+=1){var I=E[C],P=new rc;P.text=I[0],P.sectionIndex=I[1],P.sections=g.sections,y.push(P)}}else y=function(e,t){for(var r=[],i=e.text,n=0,o=0,a=t;o<a.length;o+=1){var s=a[o];r.push(e.substring(n,s)),n=s}return n<i.length&&r.push(e.substring(n,i.length)),r}(g,uc(g,u,o,t,i,d,m));var R=[],N={positionedLines:R,text:g.toString(),top:c[1],bottom:c[1],left:c[0],right:c[0],writingMode:p,iconsInText:!1,verticalizable:!1};return function(e,t,r,i,n,o,a,s,u,c,p){for(var h=0,d=-17,m=0,f=0,y="right"===l?1:"left"===l?0:.5,g=0,v=0,_=n;v<_.length;v+=1){var b=_[v];b.trim();var x=b.getMaxScale(),w=24*(x-1),S={positionedGlyphs:[],lineOffset:0},T=(e.positionedLines[g]=S).positionedGlyphs,C=0;if(b.length()){for(var E=0;E<b.length();E++){var I=b.getSection(E),P=b.getSectionIndex(E),R=b.getCharCode(E),N=0,A=null,z=null,M=null,k=24,O=!(s===tc.horizontal||!c&&!Ji(R)||c&&(nc[R]||(G=R,Xi.Arabic(G)||Xi["Arabic Supplement"](G)||Xi["Arabic Extended-A"](G)||Xi["Arabic Presentation Forms-A"](G)||Xi["Arabic Presentation Forms-B"](G))));if(I.imageName){var L=i[I.imageName];if(!L)continue;M=I.imageName,e.iconsInText=e.iconsInText||!0,z=L.paddedRect;var D=L.displaySize;I.scale=24*I.scale/p,N=w+(24-D[1]*I.scale),k=(A={width:D[0],height:D[1],left:1,top:-3,advance:O?D[1]:D[0]}).advance;var B=O?D[0]*I.scale-24*x:D[1]*I.scale-24*x;0<B&&C<B&&(C=B)}else{var F=r[I.fontStack],q=F&&F[R];if(q&&q.rect)z=q.rect,A=q.metrics;else{var U=t[I.fontStack],j=U&&U[R];if(!j)continue;A=j.metrics}N=24*(x-I.scale)}O?(e.verticalizable=!0,T.push({glyph:R,imageName:M,x:h,y:d+N,vertical:O,scale:I.scale,fontStack:I.fontStack,sectionIndex:P,metrics:A,rect:z}),h+=k*I.scale+u):(T.push({glyph:R,imageName:M,x:h,y:d+N,vertical:O,scale:I.scale,fontStack:I.fontStack,sectionIndex:P,metrics:A,rect:z}),h+=A.advance*I.scale+u)}0!==T.length&&(m=Math.max(h-u,m),pc(T,0,T.length-1,y,C)),h=0;var V=o*x+C;S.lineOffset=Math.max(C,w),d+=V,f=Math.max(V,f),++g}else d+=o,++g}var G,H=d- -17,Z=cc(a),W=Z.horizontalAlign,K=Z.verticalAlign;(function(e,t,r,i,n,a,s){var l,u=(t-r)*i;l=n!==o?-a*K+17:(-K*s+.5)*o;for(var c=0,p=e;c<p.length;c+=1)for(var h=0,d=p[c].positionedGlyphs;h<d.length;h+=1){var m=d[h];m.x+=u,m.y+=l}})(e.positionedLines,y,W,m,f,H,n.length),e.top+=-K*H,e.bottom=e.top+H,e.left+=-W*m,e.right=e.left+m}(N,t,r,i,y,a,s,p,u,h,f),!function(){for(var e=0,t=R;e<t.length;e+=1)if(0!==t[e].positionedGlyphs.length)return;return 1}()&&N}ec.forText=function(e,t){var r=new ec;return r.scale=e||1,r.fontStack=t,r},ec.forImage=function(e){var t=new ec;return t.imageName=e,t},rc.fromFeature=function(e,t){for(var r=new rc,i=0;i<e.sections.length;i++){var n=e.sections[i];n.image?r.addImageSection(n):r.addTextSection(n,t)}return r},rc.prototype.length=function(){return this.text.length},rc.prototype.getSection=function(e){return this.sections[this.sectionIndex[e]]},rc.prototype.getSectionIndex=function(e){return this.sectionIndex[e]},rc.prototype.getCharCode=function(e){return this.text.charCodeAt(e)},rc.prototype.verticalizePunctuation=function(){this.text=function(e){for(var t="",r=0;r<e.length;r++){var i=e.charCodeAt(r+1)||null,n=e.charCodeAt(r-1)||null;t+=i&&$i(i)&&!Pu[e[r+1]]||n&&$i(n)&&!Pu[e[r-1]]||!Pu[e[r]]?e[r]:Pu[e[r]]}return t}(this.text)},rc.prototype.trim=function(){for(var e=0,t=0;t<this.text.length&&nc[this.text.charCodeAt(t)];t++)e++;for(var r=this.text.length,i=this.text.length-1;0<=i&&e<=i&&nc[this.text.charCodeAt(i)];i--)r--;this.text=this.text.substring(e,r),this.sectionIndex=this.sectionIndex.slice(e,r)},rc.prototype.substring=function(e,t){var r=new rc;return r.text=this.text.substring(e,t),r.sectionIndex=this.sectionIndex.slice(e,t),r.sections=this.sections,r},rc.prototype.toString=function(){return this.text},rc.prototype.getMaxScale=function(){var e=this;return this.sectionIndex.reduce((function(t,r){return Math.max(t,e.sections[r].scale)}),0)},rc.prototype.addTextSection=function(e,t){this.text+=e.text,this.sections.push(ec.forText(e.scale,e.fontStack||t));for(var r=this.sections.length-1,i=0;i<e.text.length;++i)this.sectionIndex.push(r)},rc.prototype.addImageSection=function(e){var t=e.image?e.image.name:"";if(0!==t.length){var r=this.getNextImageSectionCharCode();r?(this.text+=String.fromCharCode(r),this.sections.push(ec.forImage(t)),this.sectionIndex.push(this.sections.length-1)):w("Reached maximum number of images 6401")}else w("Can't add FormattedSection with an empty image.")},rc.prototype.getNextImageSectionCharCode=function(){return this.imageSectionID?63743<=this.imageSectionID?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)};var nc={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},oc={};function ac(e,t,r,i,n,o){if(t.imageName){var a=i[t.imageName];return a?a.displaySize[0]*t.scale*24/o+n:0}var s=r[t.fontStack],l=s&&s[e];return l?l.metrics.advance*t.scale+n:0}function sc(e,t,r,i){var n=Math.pow(e-t,2);return i?e<t?n/2:2*n:n+Math.abs(r)*r}function lc(e,t,r,i,n,o){for(var a=null,s=sc(t,r,n,o),l=0,u=i;l<u.length;l+=1){var c=u[l],p=sc(t-c.x,r,n,o)+c.badness;p<=s&&(a=c,s=p)}return{index:e,x:t,priorBreak:a,badness:s}}function uc(e,t,r,i,n,o,a){if("point"!==o)return[];if(!e)return[];for(var s,l=[],u=function(e,t,r,i,n,o){for(var a=0,s=0;s<e.length();s++){var l=e.getSection(s);a+=ac(e.getCharCode(s),l,i,n,t,o)}return a/Math.max(1,Math.ceil(a/r))}(e,t,r,i,n,a),c=0<=e.text.indexOf("​"),p=0,h=0;h<e.length();h++){var d=e.getSection(h),m=e.getCharCode(h);if(nc[m]||(p+=ac(m,d,i,n,t,a)),h<e.length()-1){var f=!((s=m)<11904||!(Xi["Bopomofo Extended"](s)||Xi.Bopomofo(s)||Xi["CJK Compatibility Forms"](s)||Xi["CJK Compatibility Ideographs"](s)||Xi["CJK Compatibility"](s)||Xi["CJK Radicals Supplement"](s)||Xi["CJK Strokes"](s)||Xi["CJK Symbols and Punctuation"](s)||Xi["CJK Unified Ideographs Extension A"](s)||Xi["CJK Unified Ideographs"](s)||Xi["Enclosed CJK Letters and Months"](s)||Xi["Halfwidth and Fullwidth Forms"](s)||Xi.Hiragana(s)||Xi["Ideographic Description Characters"](s)||Xi["Kangxi Radicals"](s)||Xi["Katakana Phonetic Extensions"](s)||Xi.Katakana(s)||Xi["Vertical Forms"](s)||Xi["Yi Radicals"](s)||Xi["Yi Syllables"](s)));(oc[m]||f||d.imageName)&&l.push(lc(h+1,p,u,l,(v=void 0,v=0,10===(y=m)&&(v-=1e4),f&&c&&(v+=150),40!==y&&65288!==y||(v+=50),41!==(g=e.getCharCode(h+1))&&65289!==g||(v+=50),v),!1))}}var y,g,v;return function e(t){return t?e(t.priorBreak).concat(t.index):[]}(lc(e.length(),p,u,l,0,!0))}function cc(e){var t=.5,r=.5;switch(e){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0}switch(e){case"bottom":case"bottom-right":case"bottom-left":r=1;break;case"top":case"top-right":case"top-left":r=0}return{horizontalAlign:t,verticalAlign:r}}function pc(e,t,r,i,n){if(i||n)for(var o=e[r],a=(e[r].x+o.metrics.advance*o.scale)*i,s=t;s<=r;s++)e[s].x-=a,e[s].y+=n}function hc(e,t,r,i,n,o){var a,s=e.image;if(s.content){var l=s.content,u=s.pixelRatio||1;a=[l[0]/u,l[1]/u,s.displaySize[0]-l[2]/u,s.displaySize[1]-l[3]/u]}var c,p,h,d,m=t.left*o,f=t.right*o;p="width"===r||"both"===r?(d=n[0]+m-i[3],n[0]+f+i[1]):(d=n[0]+(m+f-s.displaySize[0])/2)+s.displaySize[0];var y=t.top*o,g=t.bottom*o;return h="height"===r||"both"===r?(c=n[1]+y-i[0],n[1]+g+i[2]):(c=n[1]+(y+g-s.displaySize[1])/2)+s.displaySize[1],{image:s,top:c,right:p,bottom:h,left:d,collisionPadding:a}}oc[10]=!0,oc[32]=!0,oc[38]=!0,oc[40]=!0,oc[41]=!0,oc[43]=!0,oc[45]=!0,oc[47]=!0,oc[173]=!0,oc[183]=!0,oc[8203]=!0,oc[8208]=!0,oc[8211]=!0,oc[8231]=!0;var dc,mc=((dc=n)&&(fc.__proto__=dc),((fc.prototype=Object.create(dc&&dc.prototype)).constructor=fc).prototype.clone=function(){return new fc(this.x,this.y,this.angle,this.segment)},fc);function fc(e,t,r,i){dc.call(this,e,t),this.angle=r,void 0!==i&&(this.segment=i)}function yc(e,t){var r=t.expression;if("constant"===r.kind)return{kind:"constant",layoutSize:r.evaluate(new un(e+1))};if("source"===r.kind)return{kind:"source"};for(var i=r.zoomStops,n=r.interpolationType,o=0;o<i.length&&i[o]<=e;)o++;for(var a=o=Math.max(0,o-1);a<i.length&&i[a]<e+1;)a++;a=Math.min(i.length-1,a);var s=i[o],l=i[a];return"composite"===r.kind?{kind:"composite",minZoom:s,maxZoom:l,interpolationType:n}:{kind:"camera",minZoom:s,maxZoom:l,minSize:r.evaluate(new un(s)),maxSize:r.evaluate(new un(l)),interpolationType:n}}function gc(e,t,r){var i=t.uSize,n=r.lowerSize;return"source"===e.kind?n/128:"composite"===e.kind?Yt(n/128,r.upperSize/128,t.uSizeT):i}function vc(e,t){var r=0,i=0;if("constant"===e.kind)i=e.layoutSize;else if("source"!==e.kind){var n=e.interpolationType,o=n?u(cr.interpolationFactor(n,t,e.minZoom,e.maxZoom),0,1):0;"camera"===e.kind?i=Yt(e.minSize,e.maxSize,o):r=o}return{uSizeT:r,uSize:i}}ji("Anchor",mc);var _c=Object.freeze({__proto__:null,getSizeData:yc,evaluateSizeForFeature:gc,evaluateSizeForZoom:vc,SIZE_PACK_FACTOR:128});function bc(e,t,r,i,n){if(void 0===t.segment)return 1;for(var o=t,a=t.segment+1,s=0;-r/2<s;){if(--a<0)return;s-=e[a].dist(o),o=e[a]}s+=e[a].dist(e[a+1]),a++;for(var l=[],u=0;s<r/2;){var c=e[a],p=e[a+1];if(!p)return;var h=e[a-1].angleTo(c)-c.angleTo(p);for(h=Math.abs((h+3*Math.PI)%(2*Math.PI)-Math.PI),l.push({distance:s,angleDelta:h}),u+=h;s-l[0].distance>i;)u-=l.shift().angleDelta;if(n<u)return;a++,s+=c.dist(p)}return 1}function xc(e){for(var t=0,r=0;r<e.length-1;r++)t+=e[r].dist(e[r+1]);return t}function wc(e,t,r){return e?.6*t*r:0}function Sc(e,t){return Math.max(e?e.right-e.left:0,t?t.right-t.left:0)}function Tc(e,t,r,i,n,o){for(var a=wc(r,n,o),s=Sc(r,i)*o,l=0,u=xc(e)/2,c=0;c<e.length-1;c++){var p=e[c],h=e[c+1],d=p.dist(h);if(u<l+d){var m=(u-l)/d,f=Yt(p.x,h.x,m),y=Yt(p.y,h.y,m),g=new mc(f,y,h.angleTo(p),c);return g._round(),!a||bc(e,g,s,a,t)?g:void 0}l+=d}}function Cc(e,t,r,i,o){for(var a=[],s=0;s<e.length;s++)for(var l=e[s],u=void 0,c=0;c<l.length-1;c++){var p=l[c],h=l[c+1];p.x<t&&h.x<t||(p.x<t?p=new n(t,p.y+(t-p.x)/(h.x-p.x)*(h.y-p.y))._round():h.x<t&&(h=new n(t,p.y+(t-p.x)/(h.x-p.x)*(h.y-p.y))._round()),p.y<r&&h.y<r||(p.y<r?p=new n(p.x+(r-p.y)/(h.y-p.y)*(h.x-p.x),r)._round():h.y<r&&(h=new n(p.x+(r-p.y)/(h.y-p.y)*(h.x-p.x),r)._round()),p.x>=i&&h.x>=i||(p.x>=i?p=new n(i,p.y+(i-p.x)/(h.x-p.x)*(h.y-p.y))._round():h.x>=i&&(h=new n(i,p.y+(i-p.x)/(h.x-p.x)*(h.y-p.y))._round()),p.y>=o&&h.y>=o||(p.y>=o?p=new n(p.x+(o-p.y)/(h.y-p.y)*(h.x-p.x),o)._round():h.y>=o&&(h=new n(p.x+(o-p.y)/(h.y-p.y)*(h.x-p.x),o)._round()),u&&p.equals(u[u.length-1])||a.push(u=[p]),u.push(h)))))}return a}function Ec(e,t,r,i){function o(e,t){return e+t[1]-t[0]}var a=[],s=e.image,l=s.pixelRatio,u=s.paddedRect.w-2,c=s.paddedRect.h-2,p=e.right-e.left,h=e.bottom-e.top,d=s.stretchX||[[0,u]],m=s.stretchY||[[0,c]],f=d.reduce(o,0),y=m.reduce(o,0),g=u-f,v=c-y,_=0,b=f,x=0,w=y,S=0,T=g,C=0,E=v;if(s.content&&i){var I=s.content;_=Ic(d,0,I[0]),x=Ic(m,0,I[1]),b=Ic(d,I[0],I[2]),w=Ic(m,I[1],I[3]),S=I[0]-_,C=I[1]-x,T=I[2]-I[0]-b,E=I[3]-I[1]-w}function P(i,o,a,u){var c=Rc(i.stretch-_,b,p,e.left),d=Nc(i.fixed-S,T,i.stretch,f),m=Rc(o.stretch-x,w,h,e.top),g=Nc(o.fixed-C,E,o.stretch,y),v=Rc(a.stretch-_,b,p,e.left),I=Nc(a.fixed-S,T,a.stretch,f),P=Rc(u.stretch-x,w,h,e.top),R=Nc(u.fixed-C,E,u.stretch,y),N=new n(c,m),A=new n(v,m),z=new n(v,P),M=new n(c,P),k=new n(d/l,g/l),O=new n(I/l,R/l),L=t*Math.PI/180;if(L){var D=Math.sin(L),B=Math.cos(L),F=[B,-D,D,B];N._matMult(F),A._matMult(F),M._matMult(F),z._matMult(F)}var q=i.stretch+i.fixed,U=o.stretch+o.fixed;return{tl:N,tr:A,bl:M,br:z,tex:{x:s.paddedRect.x+1+q,y:s.paddedRect.y+1+U,w:a.stretch+a.fixed-q,h:u.stretch+u.fixed-U},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:k,pixelOffsetBR:O,minFontScaleX:T/l/p,minFontScaleY:E/l/h,isSDF:r}}if(i&&(s.stretchX||s.stretchY))for(var R=Pc(d,g,f),N=Pc(m,v,y),A=0;A<R.length-1;A++)for(var z=R[A],M=R[A+1],k=0;k<N.length-1;k++)a.push(P(z,N[k],M,N[k+1]));else a.push(P({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:1+u},{fixed:0,stretch:1+c}));return a}function Ic(e,t,r){for(var i=0,n=0,o=e;n<o.length;n+=1){var a=o[n];i+=Math.max(t,Math.min(r,a[1]))-Math.max(t,Math.min(r,a[0]))}return i}function Pc(e,t,r){for(var i=[{fixed:-1,stretch:0}],n=0,o=e;n<o.length;n+=1){var a=o[n],s=a[0],l=a[1],u=i[i.length-1];i.push({fixed:s-u.stretch,stretch:u.stretch}),i.push({fixed:s-u.stretch,stretch:u.stretch+(l-s)})}return i.push({fixed:t+1,stretch:r}),i}function Rc(e,t,r,i){return e/t*r+i}function Nc(e,t,r,i){return e-t*r/i}function Ac(e,t,r,i,o,a,s,l,u,c){if(this.boxStartIndex=e.length,u){var p=a.top,h=a.bottom,d=a.collisionPadding;d&&(p-=d[1],h+=d[3]);var m=h-p;0<m&&(m=Math.max(10,m),this.circleDiameter=m)}else{var f=a.top*s-l,y=a.bottom*s+l,g=a.left*s-l,v=a.right*s+l,_=a.collisionPadding;if(_&&(g-=_[0]*s,f-=_[1]*s,v+=_[2]*s,y+=_[3]*s),c){var b=new n(g,f),x=new n(v,f),w=new n(g,y),S=new n(v,y),T=c*Math.PI/180;b._rotate(T),x._rotate(T),w._rotate(T),S._rotate(T),g=Math.min(b.x,x.x,w.x,S.x),v=Math.max(b.x,x.x,w.x,S.x),f=Math.min(b.y,x.y,w.y,S.y),y=Math.max(b.y,x.y,w.y,S.y)}e.emplaceBack(t.x,t.y,g,f,v,y,r,i,o)}this.boxEndIndex=e.length}var zc=function(e,t){if(void 0===e&&(e=[]),void 0===t&&(t=Mc),this.data=e,this.length=this.data.length,this.compare=t,0<this.length)for(var r=(this.length>>1)-1;0<=r;r--)this._down(r)};function Mc(e,t){return e<t?-1:t<e?1:0}function kc(e,t,r){void 0===t&&(t=1),void 0===r&&(r=!1);for(var i=1/0,o=1/0,a=-1/0,s=-1/0,l=e[0],u=0;u<l.length;u++){var c=l[u];(!u||c.x<i)&&(i=c.x),(!u||c.y<o)&&(o=c.y),(!u||c.x>a)&&(a=c.x),(!u||c.y>s)&&(s=c.y)}var p=Math.min(a-i,s-o),h=p/2,d=new zc([],Oc);if(0===p)return new n(i,o);for(var m=i;m<a;m+=p)for(var f=o;f<s;f+=p)d.push(new Lc(m+h,f+h,h,e));for(var y=function(e){for(var t=0,r=0,i=0,n=e[0],o=0,a=n.length,s=a-1;o<a;s=o++){var l=n[o],u=n[s],c=l.x*u.y-u.x*l.y;r+=(l.x+u.x)*c,i+=(l.y+u.y)*c,t+=3*c}return new Lc(r/t,i/t,0,e)}(e),g=d.length;d.length;){var v=d.pop();(v.d>y.d||!y.d)&&(y=v,r&&console.log("found best %d after %d probes",Math.round(1e4*v.d)/1e4,g)),v.max-y.d<=t||(d.push(new Lc(v.p.x-(h=v.h/2),v.p.y-h,h,e)),d.push(new Lc(v.p.x+h,v.p.y-h,h,e)),d.push(new Lc(v.p.x-h,v.p.y+h,h,e)),d.push(new Lc(v.p.x+h,v.p.y+h,h,e)),g+=4)}return r&&(console.log("num probes: "+g),console.log("best distance: "+y.d)),y.p}function Oc(e,t){return t.max-e.max}function Lc(e,t,r,i){this.p=new n(e,t),this.h=r,this.d=function(e,t){for(var r=!1,i=1/0,n=0;n<t.length;n++)for(var o=t[n],a=0,s=o.length,l=s-1;a<s;l=a++){var u=o[a],c=o[l];u.y>e.y!=c.y>e.y&&e.x<(c.x-u.x)*(e.y-u.y)/(c.y-u.y)+u.x&&(r=!r),i=Math.min(i,gs(e,u,c))}return(r?1:-1)*Math.sqrt(i)}(this.p,i),this.max=this.d+this.h*Math.SQRT2}zc.prototype.push=function(e){this.data.push(e),this.length++,this._up(this.length-1)},zc.prototype.pop=function(){if(0!==this.length){var e=this.data[0],t=this.data.pop();return this.length--,0<this.length&&(this.data[0]=t,this._down(0)),e}},zc.prototype.peek=function(){return this.data[0]},zc.prototype._up=function(e){for(var t=this.data,r=this.compare,i=t[e];0<e;){var n=e-1>>1,o=t[n];if(0<=r(i,o))break;t[e]=o,e=n}t[e]=i},zc.prototype._down=function(e){for(var t=this.data,r=this.compare,i=this.length>>1,n=t[e];e<i;){var o=1+(e<<1),a=t[o],s=o+1;if(s<this.length&&r(t[s],a)<0&&(a=t[o=s]),0<=r(a,n))break;t[e]=a,e=o}t[e]=n};var Dc=Number.POSITIVE_INFINITY;function Bc(e,t){return t[1]!==Dc?function(e,t,r){var i=0,n=0;switch(t=Math.abs(t),r=Math.abs(r),e){case"top-right":case"top-left":case"top":n=r-7;break;case"bottom-right":case"bottom-left":case"bottom":n=7-r}switch(e){case"top-right":case"bottom-right":case"right":i=-t;break;case"top-left":case"bottom-left":case"left":i=t}return[i,n]}(e,t[0],t[1]):function(e,t){var r=0,i=0;t<0&&(t=0);var n=t/Math.sqrt(2);switch(e){case"top-right":case"top-left":i=n-7;break;case"bottom-right":case"bottom-left":i=7-n;break;case"bottom":i=7-t;break;case"top":i=t-7}switch(e){case"top-right":case"bottom-right":r=-n;break;case"top-left":case"bottom-left":r=n;break;case"left":r=t;break;case"right":r=-t}return[r,i]}(e,t[0])}function Fc(e){switch(e){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function qc(e,t,r,i,o,a,s,l,u,c,p,h,d,m,f){var y=function(e,t,r,i,o,a,s){for(var l=r.layout.get("text-rotate").evaluate(o,{})*Math.PI/180,u=[],c=0,p=e.positionedLines;c<p.length;c+=1)for(var h=p[c],d=0,m=h.positionedGlyphs;d<m.length;d+=1){var f=m[d];if(f.rect){var y=f.rect||{},g=4,v=!0,_=1,b=0,x=(i||s)&&f.vertical,w=f.metrics.advance*f.scale/2;if(s&&e.verticalizable&&(b=h.lineOffset/2-(f.imageName?-(24-f.metrics.width*f.scale)/2:24*(f.scale-1))),f.imageName){var S=a[f.imageName];v=S.sdf,g=1/(_=S.pixelRatio)}var T=i?[f.x+w,f.y]:[0,0],C=i?[0,0]:[f.x+w+t[0],f.y+t[1]-b],E=[0,0];x&&(E=C,C=[0,0]);var I=(f.metrics.left-g)*f.scale-w+C[0],P=(-f.metrics.top-g)*f.scale+C[1],R=I+y.w*f.scale/_,N=P+y.h*f.scale/_,A=new n(I,P),z=new n(R,P),M=new n(I,N),k=new n(R,N);if(x){var O=new n(-w,17+w),L=-Math.PI/2,D=12-w,B=new n(22-D,-(f.imageName?D:0)),F=new(Function.prototype.bind.apply(n,[null].concat(E)));A._rotateAround(L,O)._add(B)._add(F),z._rotateAround(L,O)._add(B)._add(F),M._rotateAround(L,O)._add(B)._add(F),k._rotateAround(L,O)._add(B)._add(F)}if(l){var q=Math.sin(l),U=Math.cos(l),j=[U,-q,q,U];A._matMult(j),z._matMult(j),M._matMult(j),k._matMult(j)}var V=new n(0,0),G=new n(0,0);u.push({tl:A,tr:z,bl:M,br:k,tex:y,writingMode:e.writingMode,glyphOffset:T,sectionIndex:f.sectionIndex,isSDF:v,pixelOffsetTL:V,pixelOffsetBR:G,minFontScaleX:0,minFontScaleY:0})}}return u}(r,l,o,a,s,i,e.allowVerticalPlacement),g=e.textSizeData,v=null;"source"===g.kind?32640<(v=[128*o.layout.get("text-size").evaluate(s,{})])[0]&&w(e.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'):"composite"===g.kind&&(32640<(v=[128*m.compositeTextSizes[0].evaluate(s,{},f),128*m.compositeTextSizes[1].evaluate(s,{},f)])[0]||32640<v[1])&&w(e.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'),e.addSymbols(e.text,y,v,l,a,s,c,t,u.lineStartIndex,u.lineLength,d,f);for(var _=0,b=p;_<b.length;_+=1)h[b[_]]=e.text.placedSymbolArray.length-1;return 4*y.length}function Uc(e){for(var t in e)return e[t];return null}function jc(e,t,r,i){var n=e.compareText;if(t in n){for(var o=n[t],a=o.length-1;0<=a;a--)if(i.dist(o[a])<r)return 1}else n[t]=[];return n[t].push(i),0}var Vc=Xl.VectorTileFeature.types,Gc=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Hc(e,t,r,i,n,o,a,s,l,u,c,p,h){var d=s?Math.min(32640,Math.round(s[0])):0,m=s?Math.min(32640,Math.round(s[1])):0;e.emplaceBack(t,r,Math.round(32*i),Math.round(32*n),o,a,(d<<1)+(l?1:0),m,16*u,16*c,256*p,256*h)}function Zc(e,t,r){e.emplaceBack(t.x,t.y,r),e.emplaceBack(t.x,t.y,r),e.emplaceBack(t.x,t.y,r),e.emplaceBack(t.x,t.y,r)}function Wc(e){for(var t=0,r=e.sections;t<r.length;t+=1)if(en(r[t].text))return 1}function Kc(e){this.layoutVertexArray=new $n,this.indexArray=new bo,this.programConfigurations=e,this.segments=new ga,this.dynamicLayoutVertexArray=new to,this.opacityVertexArray=new no,this.placedSymbolArray=new ta}function Xc(e,t,r){this.layoutVertexArray=new e,this.layoutAttributes=t,this.indexArray=new r,this.segments=new ga,this.collisionVertexArray=new go}function Yc(e){this.collisionBoxArray=e.collisionBoxArray,this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map((function(e){return e.id})),this.index=e.index,this.pixelRatio=e.pixelRatio,this.sourceLayerIndex=e.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Is([]),this.placementViewportMatrix=Is([]);var t=this.layers[0]._unevaluatedLayout._values;this.textSizeData=yc(this.zoom,t["text-size"]),this.iconSizeData=yc(this.zoom,t["icon-size"]);var r=this.layers[0].layout,i=r.get("symbol-sort-key"),n=r.get("symbol-z-order");this.sortFeaturesByKey="viewport-y"!==n&&void 0!==i.constantOr(1),this.sortFeaturesByY=("viewport-y"===n||"auto"===n&&!this.sortFeaturesByKey)&&(r.get("text-allow-overlap")||r.get("icon-allow-overlap")||r.get("text-ignore-placement")||r.get("icon-ignore-placement")),"point"===r.get("symbol-placement")&&(this.writingModes=r.get("text-writing-mode").map((function(e){return tc[e]}))),this.stateDependentLayerIds=this.layers.filter((function(e){return e.isStateDependent()})).map((function(e){return e.id})),this.sourceID=e.sourceID}function Jc(e){this.type=e.property.overrides?e.property.overrides.runtimeType:He,this.defaultValue=e}Kc.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length&&0===this.indexArray.length&&0===this.dynamicLayoutVertexArray.length&&0===this.opacityVertexArray.length},Kc.prototype.upload=function(e,t,r,i){this.isEmpty()||(r&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,bu.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,t),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,xu.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,Gc,!0),this.opacityVertexBuffer.itemSize=1),(r||i)&&this.programConfigurations.upload(e))},Kc.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())},ji("SymbolBuffers",Kc),Xc.prototype.upload=function(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,wu.members,!0)},Xc.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())},ji("CollisionBuffers",Xc),Yc.prototype.createArrays=function(){this.text=new Kc(new os(this.layers,this.zoom,(function(e){return/^text/.test(e)}))),this.icon=new Kc(new os(this.layers,this.zoom,(function(e){return/^icon/.test(e)}))),this.glyphOffsetArray=new la,this.lineVertexArray=new pa,this.symbolInstances=new oa},Yc.prototype.calculateGlyphDependencies=function(e,t,r,i,n){for(var o=0;o<e.length;o++)if(t[e.charCodeAt(o)]=!0,(r||i)&&n){var a=Pu[e.charAt(o)];a&&(t[a.charCodeAt(0)]=!0)}},Yc.prototype.populate=function(e,t,r){var i=this.layers[0],n=i.layout,o=n.get("text-font"),a=n.get("text-field"),s=n.get("icon-image"),l=("constant"!==a.value.kind||a.value.value instanceof pt&&!a.value.value.isEmpty()||0<a.value.value.toString().length)&&("constant"!==o.value.kind||0<o.value.value.length),u="constant"!==s.value.kind||!!s.value.value||0<Object.keys(s.parameters).length,c=n.get("symbol-sort-key");if(this.features=[],l||u){for(var p=t.iconDependencies,h=t.glyphDependencies,d=t.availableImages,m=new un(this.zoom),f=0,y=e;f<y.length;f+=1){var g=y[f],v=g.feature,_=g.id,b=g.index,x=g.sourceLayerIndex,w=i._featureFilter.needGeometry,S={type:v.type,id:_,properties:v.properties,geometry:w?us(v):[]};if(i._featureFilter.filter(m,S,r)){w||(S.geometry=us(v));var T=void 0;if(l){var C=i.getValueAndResolveTokens("text-field",S,r,d),E=pt.factory(C);Wc(E)&&(this.hasRTLText=!0),(!this.hasRTLText||"unavailable"===sn()||this.hasRTLText&&pn.isParsed())&&(T=Cu(E,i,S))}var I=void 0;if(u){var P=i.getValueAndResolveTokens("icon-image",S,r,d);I=P instanceof ht?P:ht.fromString(P)}if(T||I){var R=this.sortFeaturesByKey?c.evaluate(S,{},r):void 0,N={id:_,text:T,icon:I,index:b,sourceLayerIndex:x,geometry:us(v),properties:v.properties,type:Vc[v.type],sortKey:R};if(this.features.push(N),I&&(p[I.name]=!0),T){var A=o.evaluate(S,{},r).join(","),z="map"===n.get("text-rotation-alignment")&&"point"!==n.get("symbol-placement");this.allowVerticalPlacement=this.writingModes&&0<=this.writingModes.indexOf(tc.vertical);for(var M=0,k=T.sections;M<k.length;M+=1){var O=k[M];if(O.image)p[O.image.name]=!0;else{var L=Yi(T.toString()),D=O.fontStack||A,B=h[D]=h[D]||{};this.calculateGlyphDependencies(O.text,B,z,this.allowVerticalPlacement,L)}}}}}}"line"===n.get("symbol-placement")&&(this.features=function(e){var t={},r={},i=[],n=0;function o(t){i.push(e[t]),n++}function a(e,t,n){var o=r[e];return delete r[e],r[t]=o,i[o].geometry[0].pop(),i[o].geometry[0]=i[o].geometry[0].concat(n[0]),o}function s(e,r,n){var o=t[r];return delete t[r],t[e]=o,i[o].geometry[0].shift(),i[o].geometry[0]=n[0].concat(i[o].geometry[0]),o}function l(e,t,r){var i=r?t[0][t[0].length-1]:t[0][0];return e+":"+i.x+":"+i.y}for(var u=0;u<e.length;u++){var c=e[u],p=c.geometry,h=c.text?c.text.toString():null;if(h){var d=l(h,p),m=l(h,p,!0);if(d in r&&m in t&&r[d]!==t[m]){var f=s(d,m,p),y=a(d,m,i[f].geometry);delete t[d],delete r[m],r[l(h,i[y].geometry,!0)]=y,i[f].geometry=null}else d in r?a(d,m,p):m in t?s(d,m,p):(o(u),t[d]=n-1,r[m]=n-1)}else o(u)}return i.filter((function(e){return e.geometry}))}(this.features)),this.sortFeaturesByKey&&this.features.sort((function(e,t){return e.sortKey-t.sortKey}))}},Yc.prototype.update=function(e,t,r){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(e,t,this.layers,r),this.icon.programConfigurations.updatePaintArrays(e,t,this.layers,r))},Yc.prototype.isEmpty=function(){return 0===this.symbolInstances.length&&!this.hasRTLText},Yc.prototype.uploadPending=function(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload},Yc.prototype.upload=function(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0},Yc.prototype.destroyDebugData=function(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()},Yc.prototype.destroy=function(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()},Yc.prototype.addToLineVertexArray=function(e,t){var r=this.lineVertexArray.length;if(void 0!==e.segment){for(var i=e.dist(t[e.segment+1]),n=e.dist(t[e.segment]),o={},a=e.segment+1;a<t.length;a++)o[a]={x:t[a].x,y:t[a].y,tileUnitDistanceFromAnchor:i},a<t.length-1&&(i+=t[a+1].dist(t[a]));for(var s=e.segment||0;0<=s;s--)o[s]={x:t[s].x,y:t[s].y,tileUnitDistanceFromAnchor:n},0<s&&(n+=t[s-1].dist(t[s]));for(var l=0;l<t.length;l++){var u=o[l];this.lineVertexArray.emplaceBack(u.x,u.y,u.tileUnitDistanceFromAnchor)}}return{lineStartIndex:r,lineLength:this.lineVertexArray.length-r}},Yc.prototype.addSymbols=function(e,t,r,i,n,o,a,s,l,u,c,p){for(var h=e.indexArray,d=e.layoutVertexArray,m=e.segments.prepareSegment(4*t.length,d,h,o.sortKey),f=this.glyphOffsetArray.length,y=m.vertexLength,g=this.allowVerticalPlacement&&a===tc.vertical?Math.PI/2:0,v=o.text&&o.text.sections,_=0;_<t.length;_++){var b=t[_],x=b.tl,w=b.tr,S=b.bl,T=b.br,C=b.tex,E=b.pixelOffsetTL,I=b.pixelOffsetBR,P=b.minFontScaleX,R=b.minFontScaleY,N=b.glyphOffset,A=b.isSDF,z=b.sectionIndex,M=m.vertexLength,k=N[1];Hc(d,s.x,s.y,x.x,k+x.y,C.x,C.y,r,A,E.x,E.y,P,R),Hc(d,s.x,s.y,w.x,k+w.y,C.x+C.w,C.y,r,A,I.x,E.y,P,R),Hc(d,s.x,s.y,S.x,k+S.y,C.x,C.y+C.h,r,A,E.x,I.y,P,R),Hc(d,s.x,s.y,T.x,k+T.y,C.x+C.w,C.y+C.h,r,A,I.x,I.y,P,R),Zc(e.dynamicLayoutVertexArray,s,g),h.emplaceBack(M,M+1,M+2),h.emplaceBack(M+1,M+2,M+3),m.vertexLength+=4,m.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(N[0]),_!==t.length-1&&z===t[_+1].sectionIndex||e.programConfigurations.populatePaintArrays(d.length,o,o.index,{},p,v&&v[z])}e.placedSymbolArray.emplaceBack(s.x,s.y,f,this.glyphOffsetArray.length-f,y,l,u,s.segment,r?r[0]:0,r?r[1]:0,i[0],i[1],a,0,!1,0,c)},Yc.prototype._addCollisionDebugVertex=function(e,t,r,i,n,o){return t.emplaceBack(0,0),e.emplaceBack(r.x,r.y,i,n,Math.round(o.x),Math.round(o.y))},Yc.prototype.addCollisionDebugVertices=function(e,t,r,i,o,a,s){var l=o.segments.prepareSegment(4,o.layoutVertexArray,o.indexArray),u=l.vertexLength,c=o.layoutVertexArray,p=o.collisionVertexArray,h=s.anchorX,d=s.anchorY;this._addCollisionDebugVertex(c,p,a,h,d,new n(e,t)),this._addCollisionDebugVertex(c,p,a,h,d,new n(r,t)),this._addCollisionDebugVertex(c,p,a,h,d,new n(r,i)),this._addCollisionDebugVertex(c,p,a,h,d,new n(e,i)),l.vertexLength+=4;var m=o.indexArray;m.emplaceBack(u,u+1),m.emplaceBack(u+1,u+2),m.emplaceBack(u+2,u+3),m.emplaceBack(u+3,u),l.primitiveLength+=4},Yc.prototype.addDebugCollisionBoxes=function(e,t,r,i){for(var n=e;n<t;n++){var o=this.collisionBoxArray.get(n);this.addCollisionDebugVertices(o.x1,o.y1,o.x2,o.y2,i?this.textCollisionBox:this.iconCollisionBox,o.anchorPoint,r)}},Yc.prototype.generateCollisionDebugBuffers=function(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Xc(co,Su.members,Bo),this.iconCollisionBox=new Xc(co,Su.members,Bo);for(var e=0;e<this.symbolInstances.length;e++){var t=this.symbolInstances.get(e);this.addDebugCollisionBoxes(t.textBoxStartIndex,t.textBoxEndIndex,t,!0),this.addDebugCollisionBoxes(t.verticalTextBoxStartIndex,t.verticalTextBoxEndIndex,t,!0),this.addDebugCollisionBoxes(t.iconBoxStartIndex,t.iconBoxEndIndex,t,!1),this.addDebugCollisionBoxes(t.verticalIconBoxStartIndex,t.verticalIconBoxEndIndex,t,!1)}},Yc.prototype._deserializeCollisionBoxesForSymbol=function(e,t,r,i,n,o,a,s,l){for(var u={},c=t;c<r;c++){var p=e.get(c);u.textBox={x1:p.x1,y1:p.y1,x2:p.x2,y2:p.y2,anchorPointX:p.anchorPointX,anchorPointY:p.anchorPointY},u.textFeatureIndex=p.featureIndex;break}for(var h=i;h<n;h++){var d=e.get(h);u.verticalTextBox={x1:d.x1,y1:d.y1,x2:d.x2,y2:d.y2,anchorPointX:d.anchorPointX,anchorPointY:d.anchorPointY},u.verticalTextFeatureIndex=d.featureIndex;break}for(var m=o;m<a;m++){var f=e.get(m);u.iconBox={x1:f.x1,y1:f.y1,x2:f.x2,y2:f.y2,anchorPointX:f.anchorPointX,anchorPointY:f.anchorPointY},u.iconFeatureIndex=f.featureIndex;break}for(var y=s;y<l;y++){var g=e.get(y);u.verticalIconBox={x1:g.x1,y1:g.y1,x2:g.x2,y2:g.y2,anchorPointX:g.anchorPointX,anchorPointY:g.anchorPointY},u.verticalIconFeatureIndex=g.featureIndex;break}return u},Yc.prototype.deserializeCollisionBoxes=function(e){this.collisionArrays=[];for(var t=0;t<this.symbolInstances.length;t++){var r=this.symbolInstances.get(t);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,r.textBoxStartIndex,r.textBoxEndIndex,r.verticalTextBoxStartIndex,r.verticalTextBoxEndIndex,r.iconBoxStartIndex,r.iconBoxEndIndex,r.verticalIconBoxStartIndex,r.verticalIconBoxEndIndex))}},Yc.prototype.hasTextData=function(){return 0<this.text.segments.get().length},Yc.prototype.hasIconData=function(){return 0<this.icon.segments.get().length},Yc.prototype.hasDebugData=function(){return this.textCollisionBox&&this.iconCollisionBox},Yc.prototype.hasTextCollisionBoxData=function(){return this.hasDebugData()&&0<this.textCollisionBox.segments.get().length},Yc.prototype.hasIconCollisionBoxData=function(){return this.hasDebugData()&&0<this.iconCollisionBox.segments.get().length},Yc.prototype.addIndicesForPlacedSymbol=function(e,t){for(var r=e.placedSymbolArray.get(t),i=r.vertexStartIndex+4*r.numGlyphs,n=r.vertexStartIndex;n<i;n+=4)e.indexArray.emplaceBack(n,n+1,n+2),e.indexArray.emplaceBack(n+1,n+2,n+3)},Yc.prototype.getSortedSymbolIndexes=function(e){if(this.sortedAngle===e&&void 0!==this.symbolInstanceIndexes)return this.symbolInstanceIndexes;for(var t=Math.sin(e),r=Math.cos(e),i=[],n=[],o=[],a=0;a<this.symbolInstances.length;++a){o.push(a);var s=this.symbolInstances.get(a);i.push(0|Math.round(t*s.anchorX+r*s.anchorY)),n.push(s.featureIndex)}return o.sort((function(e,t){return i[e]-i[t]||n[t]-n[e]})),o},Yc.prototype.addToSortKeyRanges=function(e,t){var r=this.sortKeyRanges[this.sortKeyRanges.length-1];r&&r.sortKey===t?r.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:t,symbolInstanceStart:e,symbolInstanceEnd:e+1})},Yc.prototype.sortFeatures=function(e){var t=this;if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(1<this.text.segments.get().length||1<this.icon.segments.get().length)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(var r=0,i=this.symbolInstanceIndexes;r<i.length;r+=1){var n=this.symbolInstances.get(i[r]);this.featureSortOrder.push(n.featureIndex),[n.rightJustifiedTextSymbolIndex,n.centerJustifiedTextSymbolIndex,n.leftJustifiedTextSymbolIndex].forEach((function(e,r,i){0<=e&&i.indexOf(e)===r&&t.addIndicesForPlacedSymbol(t.text,e)})),0<=n.verticalPlacedTextSymbolIndex&&this.addIndicesForPlacedSymbol(this.text,n.verticalPlacedTextSymbolIndex),0<=n.placedIconSymbolIndex&&this.addIndicesForPlacedSymbol(this.icon,n.placedIconSymbolIndex),0<=n.verticalPlacedIconSymbolIndex&&this.addIndicesForPlacedSymbol(this.icon,n.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}},ji("SymbolBucket",Yc,{omit:["layers","collisionBoxArray","features","compareText"]}),Yc.MAX_GLYPHS=65535,Yc.addDynamicAttributes=Zc;var $c=new In({"symbol-placement":new bn(Oe.layout_symbol["symbol-placement"]),"symbol-spacing":new bn(Oe.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new bn(Oe.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new xn(Oe.layout_symbol["symbol-sort-key"]),"symbol-z-order":new bn(Oe.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new bn(Oe.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new bn(Oe.layout_symbol["icon-ignore-placement"]),"icon-optional":new bn(Oe.layout_symbol["icon-optional"]),"icon-rotation-alignment":new bn(Oe.layout_symbol["icon-rotation-alignment"]),"icon-size":new xn(Oe.layout_symbol["icon-size"]),"icon-text-fit":new bn(Oe.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new bn(Oe.layout_symbol["icon-text-fit-padding"]),"icon-image":new xn(Oe.layout_symbol["icon-image"]),"icon-rotate":new xn(Oe.layout_symbol["icon-rotate"]),"icon-padding":new bn(Oe.layout_symbol["icon-padding"]),"icon-keep-upright":new bn(Oe.layout_symbol["icon-keep-upright"]),"icon-offset":new xn(Oe.layout_symbol["icon-offset"]),"icon-anchor":new xn(Oe.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new bn(Oe.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new bn(Oe.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new bn(Oe.layout_symbol["text-rotation-alignment"]),"text-field":new xn(Oe.layout_symbol["text-field"]),"text-font":new xn(Oe.layout_symbol["text-font"]),"text-size":new xn(Oe.layout_symbol["text-size"]),"text-max-width":new xn(Oe.layout_symbol["text-max-width"]),"text-line-height":new bn(Oe.layout_symbol["text-line-height"]),"text-letter-spacing":new xn(Oe.layout_symbol["text-letter-spacing"]),"text-justify":new xn(Oe.layout_symbol["text-justify"]),"text-radial-offset":new xn(Oe.layout_symbol["text-radial-offset"]),"text-variable-anchor":new bn(Oe.layout_symbol["text-variable-anchor"]),"text-anchor":new xn(Oe.layout_symbol["text-anchor"]),"text-max-angle":new bn(Oe.layout_symbol["text-max-angle"]),"text-writing-mode":new bn(Oe.layout_symbol["text-writing-mode"]),"text-rotate":new xn(Oe.layout_symbol["text-rotate"]),"text-padding":new bn(Oe.layout_symbol["text-padding"]),"text-keep-upright":new bn(Oe.layout_symbol["text-keep-upright"]),"text-transform":new xn(Oe.layout_symbol["text-transform"]),"text-offset":new xn(Oe.layout_symbol["text-offset"]),"text-allow-overlap":new bn(Oe.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new bn(Oe.layout_symbol["text-ignore-placement"]),"text-optional":new bn(Oe.layout_symbol["text-optional"])}),Qc={paint:new In({"icon-opacity":new xn(Oe.paint_symbol["icon-opacity"]),"icon-color":new xn(Oe.paint_symbol["icon-color"]),"icon-halo-color":new xn(Oe.paint_symbol["icon-halo-color"]),"icon-halo-width":new xn(Oe.paint_symbol["icon-halo-width"]),"icon-halo-blur":new xn(Oe.paint_symbol["icon-halo-blur"]),"icon-translate":new bn(Oe.paint_symbol["icon-translate"]),"icon-translate-anchor":new bn(Oe.paint_symbol["icon-translate-anchor"]),"text-opacity":new xn(Oe.paint_symbol["text-opacity"]),"text-color":new xn(Oe.paint_symbol["text-color"],{runtimeType:Xe,getOverride:function(e){return e.textColor},hasOverride:function(e){return!!e.textColor}}),"text-halo-color":new xn(Oe.paint_symbol["text-halo-color"]),"text-halo-width":new xn(Oe.paint_symbol["text-halo-width"]),"text-halo-blur":new xn(Oe.paint_symbol["text-halo-blur"]),"text-translate":new bn(Oe.paint_symbol["text-translate"]),"text-translate-anchor":new bn(Oe.paint_symbol["text-translate-anchor"])}),layout:$c};function ep(e,t,r,i){this.context=e,this.format=r,this.texture=e.gl.createTexture(),this.update(t,i)}Jc.prototype.evaluate=function(e){if(e.formattedSection){var t=this.defaultValue.property.overrides;if(t&&t.hasOverride(e.formattedSection))return t.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default},Jc.prototype.eachChild=function(e){this.defaultValue.isConstant()||e(this.defaultValue.value._styleExpression.expression)},Jc.prototype.outputDefined=function(){return!1},Jc.prototype.serialize=function(){return null},ji("FormatSectionOverride",Jc,{omit:["defaultValue"]});var tp,rp,ip,np,op=(bp.__proto__=np=An,((bp.prototype=Object.create(np&&np.prototype)).constructor=bp).prototype.recalculate=function(e,t){if(np.prototype.recalculate.call(this,e,t),"auto"===this.layout.get("icon-rotation-alignment")&&(this.layout._values["icon-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-rotation-alignment")&&(this.layout._values["text-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-pitch-alignment")&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),"auto"===this.layout.get("icon-pitch-alignment")&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),"point"===this.layout.get("symbol-placement")){var r=this.layout.get("text-writing-mode");if(r){for(var i=[],n=0,o=r;n<o.length;n+=1){var a=o[n];i.indexOf(a)<0&&i.push(a)}this.layout._values["text-writing-mode"]=i}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()},bp.prototype.getValueAndResolveTokens=function(e,t,r,i){var n,o=this.layout.get(e).evaluate(t,{},r,i),a=this._unevaluatedLayout._values[e];return a.isDataDriven()||Yr(a.value)||!o?o:(n=t.properties,o.replace(/{([^{}]+)}/g,(function(e,t){return t in n?String(n[t]):""})))},bp.prototype.createBucket=function(e){return new Yc(e)},bp.prototype.queryRadius=function(){return 0},bp.prototype.queryIntersectsFeature=function(){return!1},bp.prototype._setPaintOverrides=function(){for(var e=0,t=Qc.paint.overridableProperties;e<t.length;e+=1){var r=t[e];if(bp.hasPaintOverride(this.layout,r)){var i,n=this.paint.get(r),o=new Jc(n),a=new Xr(o,n.property.specification);i="constant"===n.value.kind||"source"===n.value.kind?new $r("source",a):new Qr("composite",a,n.value.zoomStops,n.value._interpolationType),this.paint._values[r]=new vn(n.property,i,n.parameters)}}},bp.prototype._handleOverridablePaintPropertyUpdate=function(e,t,r){return!(!this.layout||t.isDataDriven()||r.isDataDriven())&&bp.hasPaintOverride(this.layout,e)},bp.hasPaintOverride=function(e,t){function r(e){for(var t=0,r=e;t<r.length;t+=1)if(n.overrides&&n.overrides.hasOverride(r[t]))return o=!0,0}var i=e.get("text-field"),n=Qc.paint.properties[t],o=!1;if("constant"===i.value.kind&&i.value.value instanceof pt)r(i.value.value.sections);else if("source"===i.value.kind){var a=function(e){o||(e instanceof gt&&ft(e.value)===Qe?r(e.value.sections):e instanceof xt?r(e.sections):e.eachChild(a))},s=i.value;s._styleExpression&&a(s._styleExpression.expression)}return o},bp),ap={paint:new In({"background-color":new bn(Oe.paint_background["background-color"]),"background-pattern":new wn(Oe.paint_background["background-pattern"]),"background-opacity":new bn(Oe.paint_background["background-opacity"])})},sp=(_p.__proto__=ip=An,(_p.prototype=Object.create(ip&&ip.prototype)).constructor=_p),lp={paint:new In({"raster-opacity":new bn(Oe.paint_raster["raster-opacity"]),"raster-hue-rotate":new bn(Oe.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new bn(Oe.paint_raster["raster-brightness-min"]),"raster-brightness-max":new bn(Oe.paint_raster["raster-brightness-max"]),"raster-saturation":new bn(Oe.paint_raster["raster-saturation"]),"raster-contrast":new bn(Oe.paint_raster["raster-contrast"]),"raster-resampling":new bn(Oe.paint_raster["raster-resampling"]),"raster-fade-duration":new bn(Oe.paint_raster["raster-fade-duration"])})},up=(vp.__proto__=rp=An,(vp.prototype=Object.create(rp&&rp.prototype)).constructor=vp),cp=(gp.__proto__=tp=An,((gp.prototype=Object.create(tp&&tp.prototype)).constructor=gp).prototype.is3D=function(){return"3d"===this.implementation.renderingMode},gp.prototype.hasOffscreenPass=function(){return void 0!==this.implementation.prerender},gp.prototype.recalculate=function(){},gp.prototype.updateTransitions=function(){},gp.prototype.hasTransition=function(){},gp.prototype.serialize=function(){},gp.prototype.onAdd=function(e){this.implementation.onAdd&&this.implementation.onAdd(e,e.painter.context.gl)},gp.prototype.onRemove=function(e){this.implementation.onRemove&&this.implementation.onRemove(e,e.painter.context.gl)},gp),pp={circle:Os,heatmap:Ys,hillshade:$s,fill:Bl,"fill-extrusion":ru,line:gu,symbol:op,background:sp,raster:up},hp=a.HTMLImageElement,dp=a.HTMLCanvasElement,mp=a.HTMLVideoElement,fp=a.ImageData,yp=a.ImageBitmap;function gp(e){tp.call(this,e,{}),this.implementation=e}function vp(e){rp.call(this,e,lp)}function _p(e){ip.call(this,e,ap)}function bp(e){np.call(this,e,Qc)}function xp(e){var t=this;this._callback=e,this._triggered=!1,"undefined"!=typeof MessageChannel&&(this._channel=new MessageChannel,this._channel.port2.onmessage=function(){t._triggered=!1,t._callback()})}function wp(e,t,r){this.target=e,this.parent=t,this.mapId=r,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},y(["receive","process"],this),this.invoker=new xp(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=C()?e:a}function Sp(e,t,r){var i=2*Math.PI*6378137/256/Math.pow(2,r);return[e*i-2*Math.PI*6378137/2,t*i-2*Math.PI*6378137/2]}function Tp(e,t){e&&(t?this.setSouthWest(e).setNorthEast(t):4===e.length?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):this.setSouthWest(e[0]).setNorthEast(e[1]))}ep.prototype.update=function(e,t,r){var i=e.width,n=e.height,o=!(this.size&&this.size[0]===i&&this.size[1]===n||r),a=this.context,s=a.gl;if(this.useMipmap=Boolean(t&&t.useMipmap),s.bindTexture(s.TEXTURE_2D,this.texture),a.pixelStoreUnpackFlipY.set(!1),a.pixelStoreUnpack.set(1),a.pixelStoreUnpackPremultiplyAlpha.set(this.format===s.RGBA&&(!t||!1!==t.premultiply)),o)this.size=[i,n],e instanceof hp||e instanceof dp||e instanceof mp||e instanceof fp||yp&&e instanceof yp?s.texImage2D(s.TEXTURE_2D,0,this.format,this.format,s.UNSIGNED_BYTE,e):s.texImage2D(s.TEXTURE_2D,0,this.format,i,n,0,this.format,s.UNSIGNED_BYTE,e.data);else{var l=r||{x:0,y:0},u=l.x,c=l.y;e instanceof hp||e instanceof dp||e instanceof mp||e instanceof fp||yp&&e instanceof yp?s.texSubImage2D(s.TEXTURE_2D,0,u,c,s.RGBA,s.UNSIGNED_BYTE,e):s.texSubImage2D(s.TEXTURE_2D,0,u,c,i,n,s.RGBA,s.UNSIGNED_BYTE,e.data)}this.useMipmap&&this.isSizePowerOfTwo()&&s.generateMipmap(s.TEXTURE_2D)},ep.prototype.bind=function(e,t,r){var i=this.context.gl;i.bindTexture(i.TEXTURE_2D,this.texture),r!==i.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(r=i.LINEAR),e!==this.filter&&(i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,e),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,r||e),this.filter=e),t!==this.wrap&&(i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,t),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,t),this.wrap=t)},ep.prototype.isSizePowerOfTwo=function(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0},ep.prototype.destroy=function(){this.context.gl.deleteTexture(this.texture),this.texture=null},xp.prototype.trigger=function(){var e=this;this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout((function(){e._triggered=!1,e._callback()}),0))},xp.prototype.remove=function(){delete this._channel,this._callback=function(){}},wp.prototype.send=function(e,t,r,i,n){var o=this;void 0===n&&(n=!1);var a=Math.round(1e18*Math.random()).toString(36).substring(0,10);r&&(this.callbacks[a]=r);var s=P(this.globalScope)?void 0:[];return this.target.postMessage({id:a,type:e,hasCallback:!!r,targetMapId:i,mustQueue:n,sourceMapId:this.mapId,data:Zi(t,s)},s),{cancel:function(){r&&delete o.callbacks[a],o.target.postMessage({id:a,type:"<cancel>",targetMapId:i,sourceMapId:o.mapId})}}},wp.prototype.receive=function(e){var t=e.data,r=t.id;if(r&&(!t.targetMapId||this.mapId===t.targetMapId))if("<cancel>"===t.type){delete this.tasks[r];var i=this.cancelCallbacks[r];delete this.cancelCallbacks[r],i&&i()}else C()||t.mustQueue?(this.tasks[r]=t,this.taskQueue.push(r),this.invoker.trigger()):this.processTask(r,t)},wp.prototype.process=function(){if(this.taskQueue.length){var e=this.taskQueue.shift(),t=this.tasks[e];delete this.tasks[e],this.taskQueue.length&&this.invoker.trigger(),t&&this.processTask(e,t)}},wp.prototype.processTask=function(e,t){var r=this;if("<response>"===t.type){var i=this.callbacks[e];delete this.callbacks[e],i&&(t.error?i(Wi(t.error)):i(null,Wi(t.data)))}else{var n=!1,o=P(this.globalScope)?void 0:[],a=t.hasCallback?function(t,i){n=!0,delete r.cancelCallbacks[e],r.target.postMessage({id:e,type:"<response>",sourceMapId:r.mapId,error:t?Zi(t):null,data:Zi(i,o)},o)}:function(e){n=!0},s=null,l=Wi(t.data);if(this.parent[t.type])s=this.parent[t.type](t.sourceMapId,l,a);else if(this.parent.getWorkerSource){var u=t.type.split(".");s=this.parent.getWorkerSource(t.sourceMapId,u[0],l.source)[u[1]](l,a)}else a(new Error("Could not find function "+t.type));!n&&s&&s.cancel&&(this.cancelCallbacks[e]=s.cancel)}},wp.prototype.remove=function(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)},Tp.prototype.setNorthEast=function(e){return this._ne=e instanceof Cp?new Cp(e.lng,e.lat):Cp.convert(e),this},Tp.prototype.setSouthWest=function(e){return this._sw=e instanceof Cp?new Cp(e.lng,e.lat):Cp.convert(e),this},Tp.prototype.extend=function(e){var t,r,i=this._sw,n=this._ne;if(e instanceof Cp)r=t=e;else{if(!(e instanceof Tp))return Array.isArray(e)?4===e.length||e.every(Array.isArray)?this.extend(Tp.convert(e)):this.extend(Cp.convert(e)):this;if(r=e._ne,!(t=e._sw)||!r)return this}return i||n?(i.lng=Math.min(t.lng,i.lng),i.lat=Math.min(t.lat,i.lat),n.lng=Math.max(r.lng,n.lng),n.lat=Math.max(r.lat,n.lat)):(this._sw=new Cp(t.lng,t.lat),this._ne=new Cp(r.lng,r.lat)),this},Tp.prototype.getCenter=function(){return new Cp((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)},Tp.prototype.getSouthWest=function(){return this._sw},Tp.prototype.getNorthEast=function(){return this._ne},Tp.prototype.getNorthWest=function(){return new Cp(this.getWest(),this.getNorth())},Tp.prototype.getSouthEast=function(){return new Cp(this.getEast(),this.getSouth())},Tp.prototype.getWest=function(){return this._sw.lng},Tp.prototype.getSouth=function(){return this._sw.lat},Tp.prototype.getEast=function(){return this._ne.lng},Tp.prototype.getNorth=function(){return this._ne.lat},Tp.prototype.toArray=function(){return[this._sw.toArray(),this._ne.toArray()]},Tp.prototype.toString=function(){return"LngLatBounds("+this._sw.toString()+", "+this._ne.toString()+")"},Tp.prototype.isEmpty=function(){return!(this._sw&&this._ne)},Tp.prototype.contains=function(e){var t=Cp.convert(e),r=t.lng,i=t.lat,n=this._sw.lng<=r&&r<=this._ne.lng;return this._sw.lng>this._ne.lng&&(n=this._sw.lng>=r&&r>=this._ne.lng),this._sw.lat<=i&&i<=this._ne.lat&&n},Tp.convert=function(e){return!e||e instanceof Tp?e:new Tp(e)};var Cp=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid LngLat object: ("+e+", "+t+")");if(this.lng=+e,this.lat=+t,90<this.lat||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")};Cp.prototype.wrap=function(){return new Cp(c(this.lng,-180,180),this.lat)},Cp.prototype.toArray=function(){return[this.lng,this.lat]},Cp.prototype.toString=function(){return"LngLat("+this.lng+", "+this.lat+")"},Cp.prototype.distanceTo=function(e){var t=Math.PI/180,r=this.lat*t,i=e.lat*t,n=Math.sin(r)*Math.sin(i)+Math.cos(r)*Math.cos(i)*Math.cos((e.lng-this.lng)*t);return 6371008.8*Math.acos(Math.min(n,1))},Cp.prototype.toBounds=function(e){void 0===e&&(e=0);var t=360*e/40075017,r=t/Math.cos(Math.PI/180*this.lat);return new Tp(new Cp(this.lng-r,this.lat-t),new Cp(this.lng+r,this.lat+t))},Cp.convert=function(e){if(e instanceof Cp)return e;if(Array.isArray(e)&&(2===e.length||3===e.length))return new Cp(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&"object"==typeof e&&null!==e)return new Cp(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")};var Ep=2*Math.PI*6371008.8;function Ip(e){return Ep*Math.cos(e*Math.PI/180)}function Pp(e){return(180+e)/360}function Rp(e){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e*Math.PI/360)))/360}function Np(e,t){return e/Ip(t)}function Ap(e){return 360/Math.PI*Math.atan(Math.exp((180-360*e)*Math.PI/180))-90}function zp(e,t,r){void 0===r&&(r=0),this.x=+e,this.y=+t,this.z=+r}function Mp(e,t,r){this.z=e,this.x=t,this.y=r,this.key=Lp(0,e,e,t,r)}function kp(e,t){this.wrap=e,this.canonical=t,this.key=Lp(e,t.z,t.z,t.x,t.y)}function Op(e,t,r,i,n){this.overscaledZ=e,this.wrap=t,this.canonical=new Mp(r,+i,+n),this.key=Lp(t,e,r,i,n)}function Lp(e,t,r,i,n){(e*=2)<0&&(e=-1*e-1);var o=1<<r;return(o*o*e+o*n+i).toString(36)+r.toString(36)+t.toString(36)}function Dp(e,t,r){if(this.uid=e,t.height!==t.width)throw new RangeError("DEM tiles must be square");if(r&&"mapbox"!==r&&"terrarium"!==r)return w('"'+r+'" is not a valid encoding type. Valid types include "mapbox" and "terrarium".');this.stride=t.height;var i=this.dim=t.height-2;this.data=new Uint32Array(t.data.buffer),this.encoding=r||"mapbox";for(var n=0;n<i;n++)this.data[this._idx(-1,n)]=this.data[this._idx(0,n)],this.data[this._idx(i,n)]=this.data[this._idx(i-1,n)],this.data[this._idx(n,-1)]=this.data[this._idx(n,0)],this.data[this._idx(n,i)]=this.data[this._idx(n,i-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(i,-1)]=this.data[this._idx(i-1,0)],this.data[this._idx(-1,i)]=this.data[this._idx(0,i-1)],this.data[this._idx(i,i)]=this.data[this._idx(i-1,i-1)]}function Bp(e){this._stringToNumber={},this._numberToString=[];for(var t=0;t<e.length;t++){var r=e[t];this._stringToNumber[r]=t,this._numberToString[t]=r}}function Fp(e,t,r,i,n){this.type="Feature",(this._vectorTileFeature=e)._z=t,e._x=r,e._y=i,this.properties=e.properties,this.id=n}zp.fromLngLat=function(e,t){void 0===t&&(t=0);var r=Cp.convert(e);return new zp(Pp(r.lng),Rp(r.lat),Np(t,r.lat))},zp.prototype.toLngLat=function(){return new Cp(360*this.x-180,Ap(this.y))},zp.prototype.toAltitude=function(){return this.z*Ip(Ap(this.y))},zp.prototype.meterInMercatorCoordinateUnits=function(){return 1/Ep*(e=Ap(this.y),1/Math.cos(e*Math.PI/180));var e},Mp.prototype.equals=function(e){return this.z===e.z&&this.x===e.x&&this.y===e.y},Mp.prototype.url=function(e,t){var r,i,n,o,a,s=(i=this.y,n=this.z,o=Sp(256*(r=this.x),256*(i=Math.pow(2,n)-i-1),n),a=Sp(256*(r+1),256*(i+1),n),o[0]+","+o[1]+","+a[0]+","+a[1]),l=function(e,t,r){for(var i,n="",o=e;0<o;o--)n+=(t&(i=1<<o-1)?1:0)+(r&i?2:0);return n}(this.z,this.x,this.y);return e[(this.x+this.y)%e.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(this.z)).replace("{x}",String(this.x)).replace("{y}",String("tms"===t?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",l).replace("{bbox-epsg-3857}",s)},Mp.prototype.getTilePoint=function(e){var t=Math.pow(2,this.z);return new n(8192*(e.x*t-this.x),8192*(e.y*t-this.y))},Mp.prototype.toString=function(){return this.z+"/"+this.x+"/"+this.y},Op.prototype.equals=function(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)},Op.prototype.scaledTo=function(e){var t=this.canonical.z-e;return e>this.canonical.z?new Op(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Op(e,this.wrap,e,this.canonical.x>>t,this.canonical.y>>t)},Op.prototype.calculateScaledKey=function(e,t){var r=this.canonical.z-e;return e>this.canonical.z?Lp(this.wrap*t,e,this.canonical.z,this.canonical.x,this.canonical.y):Lp(this.wrap*t,e,e,this.canonical.x>>r,this.canonical.y>>r)},Op.prototype.isChildOf=function(e){if(e.wrap!==this.wrap)return!1;var t=this.canonical.z-e.canonical.z;return 0===e.overscaledZ||e.overscaledZ<this.overscaledZ&&e.canonical.x===this.canonical.x>>t&&e.canonical.y===this.canonical.y>>t},Op.prototype.children=function(e){if(this.overscaledZ>=e)return[new Op(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];var t=this.canonical.z+1,r=2*this.canonical.x,i=2*this.canonical.y;return[new Op(t,this.wrap,t,r,i),new Op(t,this.wrap,t,1+r,i),new Op(t,this.wrap,t,r,1+i),new Op(t,this.wrap,t,1+r,1+i)]},Op.prototype.isLessThan=function(e){return this.wrap<e.wrap||!(this.wrap>e.wrap)&&(this.overscaledZ<e.overscaledZ||!(this.overscaledZ>e.overscaledZ)&&(this.canonical.x<e.canonical.x||!(this.canonical.x>e.canonical.x)&&this.canonical.y<e.canonical.y))},Op.prototype.wrapped=function(){return new Op(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)},Op.prototype.unwrapTo=function(e){return new Op(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)},Op.prototype.overscaleFactor=function(){return Math.pow(2,this.overscaledZ-this.canonical.z)},Op.prototype.toUnwrapped=function(){return new kp(this.wrap,this.canonical)},Op.prototype.toString=function(){return this.overscaledZ+"/"+this.canonical.x+"/"+this.canonical.y},Op.prototype.getTilePoint=function(e){return this.canonical.getTilePoint(new zp(e.x-this.wrap,e.y))},ji("CanonicalTileID",Mp),ji("OverscaledTileID",Op,{omit:["posMatrix"]}),Dp.prototype.get=function(e,t){var r=new Uint8Array(this.data.buffer),i=4*this._idx(e,t);return("terrarium"===this.encoding?this._unpackTerrarium:this._unpackMapbox)(r[i],r[1+i],r[2+i])},Dp.prototype.getUnpackVector=function(){return"terrarium"===this.encoding?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]},Dp.prototype._idx=function(e,t){if(e<-1||e>=this.dim+1||t<-1||t>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(t+1)*this.stride+(e+1)},Dp.prototype._unpackMapbox=function(e,t,r){return(256*e*256+256*t+r)/10-1e4},Dp.prototype._unpackTerrarium=function(e,t,r){return 256*e+t+r/256-32768},Dp.prototype.getPixels=function(){return new Hs({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))},Dp.prototype.backfillBorder=function(e,t,r){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");var i=t*this.dim,n=t*this.dim+this.dim,o=r*this.dim,a=r*this.dim+this.dim;switch(t){case-1:i=n-1;break;case 1:n=i+1}switch(r){case-1:o=a-1;break;case 1:a=o+1}for(var s=-t*this.dim,l=-r*this.dim,u=o;u<a;u++)for(var c=i;c<n;c++)this.data[this._idx(c,u)]=e.data[this._idx(c+s,u+l)]},ji("DEMData",Dp),Bp.prototype.encode=function(e){return this._stringToNumber[e]},Bp.prototype.decode=function(e){return this._numberToString[e]};var qp={geometry:{configurable:!0}};function Up(){this.state={},this.stateChanges={},this.deletedStates={}}function jp(e,t){this.tileID=e,this.x=e.canonical.x,this.y=e.canonical.y,this.z=e.canonical.z,this.grid=new Di(8192,16,0),this.grid3D=new Di(8192,16,0),this.featureIndexArray=new fa,this.promoteId=t}function Vp(e,t,r,i,n){return v(e,(function(e,o){var a=t instanceof _n?t.get(o):null;return a&&a.evaluate?a.evaluate(r,i,n):a}))}function Gp(e){for(var t=1/0,r=1/0,i=-1/0,n=-1/0,o=0,a=e;o<a.length;o+=1){var s=a[o];t=Math.min(t,s.x),r=Math.min(r,s.y),i=Math.max(i,s.x),n=Math.max(n,s.y)}return{minX:t,minY:r,maxX:i,maxY:n}}function Hp(e,t){return t-e}function Zp(e,t){this.tileID=e,this.uid=d(),this.uses=0,this.tileSize=t,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.expiredRequestCount=0,this.state="loading"}function Wp(e){this._marks={start:[e.url,"start"].join("#"),end:[e.url,"end"].join("#"),measure:e.url.toString()},Kp.mark(this._marks.start)}qp.geometry.get=function(){return void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry},qp.geometry.set=function(e){this._geometry=e},Fp.prototype.toJSON=function(){var e={geometry:this.geometry};for(var t in this)"_geometry"!==t&&"_vectorTileFeature"!==t&&(e[t]=this[t]);return e},Object.defineProperties(Fp.prototype,qp),Up.prototype.updateState=function(e,t,r){var i=String(t);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][i]=this.stateChanges[e][i]||{},p(this.stateChanges[e][i],r),null===this.deletedStates[e])for(var n in this.deletedStates[e]={},this.state[e])n!==i&&(this.deletedStates[e][n]=null);else if(this.deletedStates[e]&&null===this.deletedStates[e][i])for(var o in this.deletedStates[e][i]={},this.state[e][i])r[o]||(this.deletedStates[e][i][o]=null);else for(var a in r)this.deletedStates[e]&&this.deletedStates[e][i]&&null===this.deletedStates[e][i][a]&&delete this.deletedStates[e][i][a]},Up.prototype.removeFeatureState=function(e,t,r){if(null!==this.deletedStates[e]){var i=String(t);if(this.deletedStates[e]=this.deletedStates[e]||{},r&&void 0!==t)null!==this.deletedStates[e][i]&&(this.deletedStates[e][i]=this.deletedStates[e][i]||{},this.deletedStates[e][i][r]=null);else if(void 0!==t)if(this.stateChanges[e]&&this.stateChanges[e][i])for(r in this.deletedStates[e][i]={},this.stateChanges[e][i])this.deletedStates[e][i][r]=null;else this.deletedStates[e][i]=null;else this.deletedStates[e]=null}},Up.prototype.getState=function(e,t){var r=String(t),i=p({},(this.state[e]||{})[r],(this.stateChanges[e]||{})[r]);if(null===this.deletedStates[e])return{};if(this.deletedStates[e]){var n=this.deletedStates[e][t];if(null===n)return{};for(var o in n)delete i[o]}return i},Up.prototype.initializeTileState=function(e,t){e.setFeatureState(this.state,t)},Up.prototype.coalesceChanges=function(e,t){var r={};for(var i in this.stateChanges){this.state[i]=this.state[i]||{};var n={};for(var o in this.stateChanges[i])this.state[i][o]||(this.state[i][o]={}),p(this.state[i][o],this.stateChanges[i][o]),n[o]=this.state[i][o];r[i]=n}for(var a in this.deletedStates){this.state[a]=this.state[a]||{};var s={};if(null===this.deletedStates[a])for(var l in this.state[a])s[l]={},this.state[a][l]={};else for(var u in this.deletedStates[a]){if(null===this.deletedStates[a][u])this.state[a][u]={};else for(var c=0,h=Object.keys(this.deletedStates[a][u]);c<h.length;c+=1)delete this.state[a][u][h[c]];s[u]=this.state[a][u]}r[a]=r[a]||{},p(r[a],s)}if(this.stateChanges={},this.deletedStates={},0!==Object.keys(r).length)for(var d in e)e[d].setFeatureState(r,t)},jp.prototype.insert=function(e,t,r,i,n,o){var a=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(r,i,n);for(var s=o?this.grid3D:this.grid,l=0;l<t.length;l++){for(var u=t[l],c=[1/0,1/0,-1/0,-1/0],p=0;p<u.length;p++){var h=u[p];c[0]=Math.min(c[0],h.x),c[1]=Math.min(c[1],h.y),c[2]=Math.max(c[2],h.x),c[3]=Math.max(c[3],h.y)}c[0]<8192&&c[1]<8192&&0<=c[2]&&0<=c[3]&&s.insert(a,c[0],c[1],c[2],c[3])}},jp.prototype.loadVTLayers=function(){return this.vtLayers||(this.vtLayers=new Xl.VectorTile(new Ru(this.rawTileData)).layers,this.sourceLayerCoder=new Bp(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers},jp.prototype.query=function(e,t,r,i){var o=this;this.loadVTLayers();for(var a=e.params||{},s=8192/e.tileSize/e.scale,l=ci(a.filter),u=e.queryGeometry,c=e.queryPadding*s,p=Gp(u),h=this.grid.query(p.minX-c,p.minY-c,p.maxX+c,p.maxY+c),d=Gp(e.cameraQueryGeometry),m=0,f=this.grid3D.query(d.minX-c,d.minY-c,d.maxX+c,d.maxY+c,(function(t,r,i,o){return function(e,t,r,i,o){for(var a=0,s=e;a<s.length;a+=1){var l=s[a];if(t<=l.x&&r<=l.y&&i>=l.x&&o>=l.y)return!0}var u=[new n(t,r),new n(t,o),new n(i,o),new n(i,r)];if(2<e.length)for(var c=0,p=u;c<p.length;c+=1)if(_s(e,p[c]))return!0;for(var h=0;h<e.length-1;h++)if(bs(e[h],e[h+1],u))return!0;return!1}(e.cameraQueryGeometry,t-c,r-c,i+c,o+c)}));m<f.length;m+=1)h.push(f[m]);h.sort(Hp);for(var y,g={},v=function(n){var c=h[n];if(c!==y){y=c;var p=o.featureIndexArray.get(c),d=null;o.loadMatchingFeature(g,p.bucketIndex,p.sourceLayerIndex,p.featureIndex,l,a.layers,a.availableImages,t,r,i,(function(t,r,i){return d=d||us(t),r.queryIntersectsFeature(u,t,i,d,o.z,e.transform,s,e.pixelPosMatrix)}))}},_=0;_<h.length;_++)v(_);return g},jp.prototype.loadMatchingFeature=function(e,t,r,i,n,o,a,s,l,u,c){var p=this.bucketLayerIDs[t];if(!o||function(e,t){for(var r=0;r<e.length;r++)if(0<=t.indexOf(e[r]))return 1}(o,p)){var h=this.sourceLayerCoder.decode(r),d=this.vtLayers[h].feature(i);if(n.filter(new un(this.tileID.overscaledZ),d))for(var m=this.getId(d,h),f=0;f<p.length;f++){var y=p[f];if(!(o&&o.indexOf(y)<0)){var g=s[y];if(g){var v={};void 0!==m&&u&&(v=u.getState(g.sourceLayer||"_geojsonTileLayer",m));var _=l[y];_.paint=Vp(_.paint,g.paint,d,v,a),_.layout=Vp(_.layout,g.layout,d,v,a);var b=!c||c(d,g,v);if(b){var x=new Fp(d,this.z,this.x,this.y,m);x.layer=_;var w=e[y];void 0===w&&(w=e[y]=[]),w.push({featureIndex:i,feature:x,intersectionZ:b})}}}}}},jp.prototype.lookupSymbolFeatures=function(e,t,r,i,n,o,a,s){var l={};this.loadVTLayers();for(var u=ci(n),c=0,p=e;c<p.length;c+=1)this.loadMatchingFeature(l,r,i,p[c],u,o,a,s,t);return l},jp.prototype.hasLayer=function(e){for(var t=0,r=this.bucketLayerIDs;t<r.length;t+=1)for(var i=0,n=r[t];i<n.length;i+=1)if(e===n[i])return!0;return!1},jp.prototype.getId=function(e,t){var r=e.id;return this.promoteId&&"boolean"==typeof(r=e.properties["string"==typeof this.promoteId?this.promoteId:this.promoteId[t]])&&(r=Number(r)),r},ji("FeatureIndex",jp,{omit:["rawTileData","sourceLayerCoder"]}),Zp.prototype.registerFadeDuration=function(e){var t=e+this.timeAdded;t<D.now()||this.fadeEndTime&&t<this.fadeEndTime||(this.fadeEndTime=t)},Zp.prototype.wasRequested=function(){return"errored"===this.state||"loaded"===this.state||"reloading"===this.state},Zp.prototype.loadVectorData=function(e,t,r){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",e){for(var i in e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=function(e,t){var r={};if(!t)return r;for(var i=function(){var e=o[n],i=e.layerIds.map((function(e){return t.getLayer(e)})).filter(Boolean);if(0!==i.length){e.layers=i,e.stateDependentLayerIds&&(e.stateDependentLayers=e.stateDependentLayerIds.map((function(e){return i.filter((function(t){return t.id===e}))[0]})));for(var a=0,s=i;a<s.length;a+=1)r[s[a].id]=e}},n=0,o=e;n<o.length;n+=1)i();return r}(e.buckets,t.style),this.hasSymbolBuckets=!1,this.buckets){var n=this.buckets[i];if(n instanceof Yc){if(this.hasSymbolBuckets=!0,!r)break;n.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(var o in this.buckets){var a=this.buckets[o];if(a instanceof Yc&&a.hasRTLText){this.hasRTLText=!0,pn.isLoading()||pn.isLoaded()||"deferred"!==sn()||ln();break}}for(var s in this.queryPadding=0,this.buckets){var l=this.buckets[s];this.queryPadding=Math.max(this.queryPadding,t.style.getLayer(s).queryRadius(l))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage)}else this.collisionBoxArray=new Jo},Zp.prototype.unloadVectorData=function(){for(var e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"},Zp.prototype.getBucket=function(e){return this.buckets[e.id]},Zp.prototype.upload=function(e){for(var t in this.buckets){var r=this.buckets[t];r.uploadPending()&&r.upload(e)}var i=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new ep(e,this.imageAtlas.image,i.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new ep(e,this.glyphAtlasImage,i.ALPHA),this.glyphAtlasImage=null)},Zp.prototype.prepare=function(e){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture)},Zp.prototype.queryRenderedFeatures=function(e,t,r,i,n,o,a,s,l,u){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:i,cameraQueryGeometry:n,scale:o,tileSize:this.tileSize,pixelPosMatrix:u,transform:s,params:a,queryPadding:this.queryPadding*l},e,t,r):{}},Zp.prototype.querySourceFeatures=function(e,t){var r=this.latestFeatureIndex;if(r&&r.rawTileData){var i=r.loadVTLayers(),n=t?t.sourceLayer:"",o=i._geojsonTileLayer||i[n];if(o)for(var a=ci(t&&t.filter),s=this.tileID.canonical,l=s.z,u=s.x,c=s.y,p={z:l,x:u,y:c},h=0;h<o.length;h++){var d=o.feature(h);if(a.filter(new un(this.tileID.overscaledZ),d)){var m=new Fp(d,l,u,c,r.getId(d,n));m.tile=p,e.push(m)}}}},Zp.prototype.hasData=function(){return"loaded"===this.state||"reloading"===this.state||"expired"===this.state},Zp.prototype.patternsLoaded=function(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length},Zp.prototype.setExpiryData=function(e){var t=this.expirationTime;if(e.cacheControl){var r=E(e.cacheControl);r["max-age"]&&(this.expirationTime=Date.now()+1e3*r["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){var i=Date.now(),n=!1;if(this.expirationTime>i)n=!1;else if(t)if(this.expirationTime<t)n=!0;else{var o=this.expirationTime-t;o?this.expirationTime=i+Math.max(o,3e4):n=!0}else n=!0;n?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}},Zp.prototype.getExpiryTimeout=function(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-(new Date).getTime(),Math.pow(2,31)-1)},Zp.prototype.setFeatureState=function(e,t){if(this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&0!==Object.keys(e).length){var r=this.latestFeatureIndex.loadVTLayers();for(var i in this.buckets)if(t.style.hasLayer(i)){var n=this.buckets[i],o=n.layers[0].sourceLayer||"_geojsonTileLayer",a=r[o],s=e[o];if(a&&s&&0!==Object.keys(s).length){n.update(s,a,this.imageAtlas&&this.imageAtlas.patternPositions||{});var l=t&&t.style&&t.style.getLayer(i);l&&(this.queryPadding=Math.max(this.queryPadding,l.queryRadius(n)))}}}},Zp.prototype.holdingForFade=function(){return void 0!==this.symbolFadeHoldUntil},Zp.prototype.symbolFadeFinished=function(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<D.now()},Zp.prototype.clearFadeHold=function(){this.symbolFadeHoldUntil=void 0},Zp.prototype.setHoldDuration=function(e){this.symbolFadeHoldUntil=D.now()+e},Zp.prototype.setDependencies=function(e,t){for(var r={},i=0,n=t;i<n.length;i+=1)r[n[i]]=!0;this.dependencies[e]=r},Zp.prototype.hasDependency=function(e,t){for(var r=0,i=e;r<i.length;r+=1){var n=this.dependencies[i[r]];if(n)for(var o=0,a=t;o<a.length;o+=1)if(n[a[o]])return!0}return!1};var Kp=a.performance;Wp.prototype.finish=function(){Kp.mark(this._marks.end);var e=Kp.getEntriesByName(this._marks.measure);return 0===e.length&&(Kp.measure(this._marks.measure,this._marks.start,this._marks.end),e=Kp.getEntriesByName(this._marks.measure),Kp.clearMarks(this._marks.start),Kp.clearMarks(this._marks.end),Kp.clearMeasures(this._marks.measure)),e},e.Actor=wp,e.AlphaImage=Gs,e.CanonicalTileID=Mp,e.CollisionBoxArray=Jo,e.Color=lt,e.DEMData=Dp,e.DataConstantProperty=bn,e.DictionaryCoder=Bp,e.EXTENT=8192,e.ErrorEvent=Me,e.EvaluationParameters=un,e.Event=Ne,e.Evented=Ae,e.FeatureIndex=jp,e.FillBucket=kl,e.FillExtrusionBucket=Ql,e.ImageAtlas=Qu,e.ImagePosition=Ju,e.LineBucket=au,e.LngLat=Cp,e.LngLatBounds=Tp,e.MercatorCoordinate=zp,e.ONE_EM=24,e.OverscaledTileID=Op,e.Point=n,e.Point$1=n,e.Properties=In,e.Protobuf=Ru,e.RGBAImage=Hs,e.RequestManager=V,e.RequestPerformance=Wp,e.ResourceType=ge,e.SegmentVector=ga,e.SourceFeatureState=Up,e.StructArrayLayout1ui2=Uo,e.StructArrayLayout2f1f2i16=mo,e.StructArrayLayout2i4=Dn,e.StructArrayLayout3ui6=bo,e.StructArrayLayout4i8=qn,e.SymbolBucket=Yc,e.Texture=ep,e.Tile=Zp,e.Transitionable=mn,e.Uniform1f=Ba,e.Uniform1i=Da,e.Uniform2f=Fa,e.Uniform3f=qa,e.Uniform4f=Ua,e.UniformColor=ja,e.UniformMatrix4f=Ga,e.UnwrappedTileID=kp,e.ValidationError=Le,e.WritingMode=tc,e.ZoomHistory=Ki,e.add=function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e},e.addDynamicAttributes=Zc,e.asyncAll=function(e,t,r){if(!e.length)return r(null,[]);var i=e.length,n=new Array(e.length),o=null;e.forEach((function(e,a){t(e,(function(e,t){e&&(o=e),n[a]=t,0==--i&&r(o,n)}))}))},e.bezier=s,e.bindAll=y,e.browser=D,e.cacheEntryPossiblyAdded=function(e){++fe>ue&&(e.getActor().send("enforceCacheSizeLimit",le),fe=0)},e.clamp=u,e.clearTileCache=function(e){var t=a.caches.delete("mapbox-tiles");e&&t.catch(e).then((function(){return e()}))},e.clipLine=Cc,e.clone=function(e){var t=new Es(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},e.clone$1=b,e.clone$2=function(e){var t=new Es(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},e.collisionCircleLayout=Tu,e.config=B,e.create=function(){var e=new Es(16);return Es!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e},e.create$1=function(){var e=new Es(9);return Es!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e},e.create$2=function(){var e=new Es(4);return Es!=Float32Array&&(e[1]=0,e[2]=0),e[0]=1,e[3]=1,e},e.createCommonjsModule=t,e.createExpression=Jr,e.createLayout=kn,e.createStyleLayer=function(e){return"custom"===e.type?new cp(e):new pp[e.type](e)},e.cross=function(e,t,r){var i=t[0],n=t[1],o=t[2],a=r[0],s=r[1],l=r[2];return e[0]=n*l-o*s,e[1]=o*a-i*l,e[2]=i*s-n*a,e},e.deepEqual=function e(t,r){if(Array.isArray(t)){if(!Array.isArray(r)||t.length!==r.length)return!1;for(var i=0;i<t.length;i++)if(!e(t[i],r[i]))return!1;return!0}if("object"!=typeof t||null===t||null===r)return t===r;if("object"!=typeof r)return!1;if(Object.keys(t).length!==Object.keys(r).length)return!1;for(var n in t)if(!e(t[n],r[n]))return!1;return!0},e.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]},e.dot$1=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]},e.ease=l,e.emitValidationErrors=Li,e.endsWith=g,e.enforceCacheSizeLimit=function(e){he(),Q&&Q.then((function(t){t.keys().then((function(r){for(var i=0;i<r.length-e;i++)t.delete(r[i])}))}))},e.evaluateSizeForFeature=gc,e.evaluateSizeForZoom=vc,e.evaluateVariableOffset=Bc,e.evented=cn,e.extend=p,e.featureFilter=ci,e.filterObject=_,e.fromRotation=function(e,t){var r=Math.sin(t),i=Math.cos(t);return e[0]=i,e[1]=r,e[2]=0,e[3]=-r,e[4]=i,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},e.getAnchorAlignment=cc,e.getAnchorJustification=Fc,e.getArrayBuffer=Se,e.getImage=Ie,e.getJSON=function(e,t){return we(p(e,{type:"json"}),t)},e.getRTLTextPluginStatus=sn,e.getReferrer=be,e.getVideo=function(e,t){var r,i,n=a.document.createElement("video");n.muted=!0,n.onloadstart=function(){t(null,n)};for(var o=0;o<e.length;o++){var s=a.document.createElement("source");r=e[o],i=void 0,(i=a.document.createElement("a")).href=r,i.protocol===a.document.location.protocol&&i.host===a.document.location.host||(n.crossOrigin="Anonymous"),s.src=e[o],n.appendChild(s)}return{cancel:function(){}}},e.identity=Is,e.invert=function(e,t){var r=t[0],i=t[1],n=t[2],o=t[3],a=t[4],s=t[5],l=t[6],u=t[7],c=t[8],p=t[9],h=t[10],d=t[11],m=t[12],f=t[13],y=t[14],g=t[15],v=r*s-i*a,_=r*l-n*a,b=r*u-o*a,x=i*l-n*s,w=i*u-o*s,S=n*u-o*l,T=c*f-p*m,C=c*y-h*m,E=c*g-d*m,I=p*y-h*f,P=p*g-d*f,R=h*g-d*y,N=v*R-_*P+b*I+x*E-w*C+S*T;return N?(e[0]=(s*R-l*P+u*I)*(N=1/N),e[1]=(n*P-i*R-o*I)*N,e[2]=(f*S-y*w+g*x)*N,e[3]=(h*w-p*S-d*x)*N,e[4]=(l*E-a*R-u*C)*N,e[5]=(r*R-n*E+o*C)*N,e[6]=(y*b-m*S-g*_)*N,e[7]=(c*S-h*b+d*_)*N,e[8]=(a*P-s*E+u*T)*N,e[9]=(i*E-r*P-o*T)*N,e[10]=(m*w-f*b+g*v)*N,e[11]=(p*b-c*w-d*v)*N,e[12]=(s*C-a*I-l*T)*N,e[13]=(r*I-i*C+n*T)*N,e[14]=(f*_-m*x-y*v)*N,e[15]=(c*x-p*_+h*v)*N,e):null},e.isChar=Xi,e.isMapboxURL=H,e.keysDifference=function(e,t){var r=[];for(var i in e)i in t||r.push(i);return r},e.makeRequest=we,e.mapObject=v,e.mercatorXfromLng=Pp,e.mercatorYfromLat=Rp,e.mercatorZfromAltitude=Np,e.mul=As,e.multiply=Ps,e.mvt=Xl,e.normalize=function(e,t){var r=t[0],i=t[1],n=t[2],o=r*r+i*i+n*n;return 0<o&&(o=1/Math.sqrt(o)),e[0]=t[0]*o,e[1]=t[1]*o,e[2]=t[2]*o,e},e.number=Yt,e.offscreenCanvasSupported=ye,e.ortho=function(e,t,r,i,n,o,a){var s=1/(t-r),l=1/(i-n),u=1/(o-a);return e[0]=-2*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*l,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*u,e[11]=0,e[12]=(t+r)*s,e[13]=(n+i)*l,e[14]=(a+o)*u,e[15]=1,e},e.parseGlyphPBF=function(e){return new Ru(e).readFields(Wu,[])},e.pbf=Ru,e.performSymbolLayout=function(e,t,r,i,n,o,a){e.createArrays(),e.tilePixelRatio=8192/(512*e.overscaling),e.compareText={},e.iconsNeedLinear=!1;var s=e.layers[0].layout,l=e.layers[0]._unevaluatedLayout._values,u={};if("composite"===e.textSizeData.kind){var c=e.textSizeData,p=c.maxZoom;u.compositeTextSizes=[l["text-size"].possiblyEvaluate(new un(c.minZoom),a),l["text-size"].possiblyEvaluate(new un(p),a)]}if("composite"===e.iconSizeData.kind){var h=e.iconSizeData,d=h.maxZoom;u.compositeIconSizes=[l["icon-size"].possiblyEvaluate(new un(h.minZoom),a),l["icon-size"].possiblyEvaluate(new un(d),a)]}u.layoutTextSize=l["text-size"].possiblyEvaluate(new un(e.zoom+1),a),u.layoutIconSize=l["icon-size"].possiblyEvaluate(new un(e.zoom+1),a),u.textMaxSize=l["text-size"].possiblyEvaluate(new un(18));for(var m=24*s.get("text-line-height"),f="map"===s.get("text-rotation-alignment")&&"point"!==s.get("symbol-placement"),y=s.get("text-keep-upright"),g=s.get("text-size"),v=function(){var o=b[_],l=s.get("text-font").evaluate(o,{},a).join(","),c=g.evaluate(o,{},a),p=u.layoutTextSize.evaluate(o,{},a),h=u.layoutIconSize.evaluate(o,{},a),d={horizontal:{},vertical:void 0},v=o.text,x=[0,0];if(v){var S=v.toString(),T=24*s.get("text-letter-spacing").evaluate(o,{},a),C=function(){for(var e=0,t=S;e<t.length;e+=1)if(r=t[e].charCodeAt(0),Xi.Arabic(r)||Xi["Arabic Supplement"](r)||Xi["Arabic Extended-A"](r)||Xi["Arabic Presentation Forms-A"](r)||Xi["Arabic Presentation Forms-B"](r))return;var r;return 1}()?T:0,E=s.get("text-anchor").evaluate(o,{},a),I=s.get("text-variable-anchor");if(!I){var P=s.get("text-radial-offset").evaluate(o,{},a);x=P?Bc(E,[24*P,Dc]):s.get("text-offset").evaluate(o,{},a).map((function(e){return 24*e}))}var R=f?"center":s.get("text-justify").evaluate(o,{},a),N=s.get("symbol-placement"),A="point"===N?24*s.get("text-max-width").evaluate(o,{},a):0,z=function(){e.allowVerticalPlacement&&Yi(S)&&(d.vertical=ic(v,t,r,n,l,A,m,E,"left",C,x,tc.vertical,!0,N,p,c))};if(!f&&I){for(var M="auto"===R?I.map((function(e){return Fc(e)})):[R],k=!1,O=0;O<M.length;O++){var L=M[O];if(!d.horizontal[L])if(k)d.horizontal[L]=d.horizontal[0];else{var D=ic(v,t,r,n,l,A,m,"center",L,C,x,tc.horizontal,!1,N,p,c);D&&(k=1===(d.horizontal[L]=D).positionedLines.length)}}z()}else{"auto"===R&&(R=Fc(E));var B=ic(v,t,r,n,l,A,m,E,R,C,x,tc.horizontal,!1,N,p,c);B&&(d.horizontal[R]=B),z(),Yi(S)&&f&&y&&(d.vertical=ic(v,t,r,n,l,A,m,E,R,C,x,tc.vertical,!1,N,p,c))}}var F,q,U,j,V,G=void 0,H=!1;if(o.icon&&o.icon.name){var Z=i[o.icon.name];Z&&(F=n[o.icon.name],q=s.get("icon-offset").evaluate(o,{},a),U=cc(s.get("icon-anchor").evaluate(o,{},a)),j=q[0]-F.displaySize[0]*U.horizontalAlign,G={image:F,top:V=q[1]-F.displaySize[1]*U.verticalAlign,bottom:V+F.displaySize[1],left:j,right:j+F.displaySize[0]},H=Z.sdf,void 0===e.sdfIcons?e.sdfIcons=Z.sdf:e.sdfIcons!==Z.sdf&&w("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),Z.pixelRatio===e.pixelRatio&&0===s.get("icon-rotate").constantOr(1)||(e.iconsNeedLinear=!0))}var W=Uc(d.horizontal)||d.vertical;e.iconsInText=!!W&&W.iconsInText,(W||G)&&function(e,t,r,i,n,o,a,s,l,u,c){var p=o.textMaxSize.evaluate(t,{});void 0===p&&(p=a);var h,d,m,f,y,g,v,_,b,x,S,T,C,E=e.layers[0].layout,I=E.get("icon-offset").evaluate(t,{},c),P=Uc(r.horizontal),R=a/24,N=e.tilePixelRatio*R,A=e.tilePixelRatio*p/24,z=e.tilePixelRatio*s,M=e.tilePixelRatio*E.get("symbol-spacing"),k=E.get("text-padding")*e.tilePixelRatio,O=E.get("icon-padding")*e.tilePixelRatio,L=E.get("text-max-angle")/180*Math.PI,D="map"===E.get("text-rotation-alignment")&&"point"!==E.get("symbol-placement"),B="map"===E.get("icon-rotation-alignment")&&"point"!==E.get("symbol-placement"),F=E.get("symbol-placement"),q=M/2,U=E.get("icon-text-fit");function j(s,p){p.x<0||8192<=p.x||p.y<0||8192<=p.y||function(e,t,r,i,n,o,a,s,l,u,c,p,h,d,m,f,y,g,v,_,b,x,S,T,C){var E,I,P,R,N,A,z=e.addToLineVertexArray(t,r),M=0,k=0,O=0,L=0,D=-1,B=-1,F={},q=Sa(""),U=0;if(A=void 0===s._unevaluatedLayout.getValue("text-radial-offset")?(U=(E=s.layout.get("text-offset").evaluate(b,{},T).map((function(e){return 24*e})))[0],E[1]):(U=24*s.layout.get("text-radial-offset").evaluate(b,{},T),Dc),e.allowVerticalPlacement&&i.vertical){var j=s.layout.get("text-rotate").evaluate(b,{},T)+90;R=new Ac(l,t,u,c,p,i.vertical,h,d,m,j),a&&(N=new Ac(l,t,u,c,p,a,y,g,m,j))}if(n){var V=s.layout.get("icon-rotate").evaluate(b,{}),G="none"!==s.layout.get("icon-text-fit"),H=Ec(n,V,S,G),Z=a?Ec(a,V,S,G):void 0;P=new Ac(l,t,u,c,p,n,y,g,!1,V),M=4*H.length;var W=e.iconSizeData,K=null;"source"===W.kind?32640<(K=[128*s.layout.get("icon-size").evaluate(b,{})])[0]&&w(e.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'):"composite"===W.kind&&(32640<(K=[128*x.compositeIconSizes[0].evaluate(b,{},T),128*x.compositeIconSizes[1].evaluate(b,{},T)])[0]||32640<K[1])&&w(e.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'),e.addSymbols(e.icon,H,K,_,v,b,!1,t,z.lineStartIndex,z.lineLength,-1,T),D=e.icon.placedSymbolArray.length-1,Z&&(k=4*Z.length,e.addSymbols(e.icon,Z,K,_,v,b,tc.vertical,t,z.lineStartIndex,z.lineLength,-1,T),B=e.icon.placedSymbolArray.length-1)}for(var X in i.horizontal){var Y=i.horizontal[X];I||(q=Sa(Y.text),I=new Ac(l,t,u,c,p,Y,h,d,m,s.layout.get("text-rotate").evaluate(b,{},T)));var J=1===Y.positionedLines.length;if(O+=qc(e,t,Y,o,s,m,b,f,z,i.vertical?tc.horizontal:tc.horizontalOnly,J?Object.keys(i.horizontal):[X],F,D,x,T),J)break}function $(e,t){return e&&e.circleDiameter?Math.max(e.circleDiameter,t):t}i.vertical&&(L+=qc(e,t,i.vertical,o,s,m,b,f,z,tc.vertical,["vertical"],F,B,x,T));var Q=I?I.boxStartIndex:e.collisionBoxArray.length,ee=I?I.boxEndIndex:e.collisionBoxArray.length,te=R?R.boxStartIndex:e.collisionBoxArray.length,re=R?R.boxEndIndex:e.collisionBoxArray.length,ie=P?P.boxStartIndex:e.collisionBoxArray.length,ne=P?P.boxEndIndex:e.collisionBoxArray.length,oe=N?N.boxStartIndex:e.collisionBoxArray.length,ae=N?N.boxEndIndex:e.collisionBoxArray.length,se=-1,le=-1<(se=$(N,se=$(P,se=$(R,se=$(I,se)))))?1:0;le&&(se*=C/24),e.glyphOffsetArray.length>=Yc.MAX_GLYPHS&&w("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),void 0!==b.sortKey&&e.addToSortKeyRanges(e.symbolInstances.length,b.sortKey),e.symbolInstances.emplaceBack(t.x,t.y,0<=F.right?F.right:-1,0<=F.center?F.center:-1,0<=F.left?F.left:-1,F.vertical||-1,D,B,q,Q,ee,te,re,ie,ne,oe,ae,u,O,L,M,k,le,0,h,U,A,se)}(e,p,s,r,i,n,h,e.layers[0],e.collisionBoxArray,t.index,t.sourceLayerIndex,e.index,N,k,D,l,z,O,B,I,t,o,u,c,a)}if(i&&"none"!==U&&(e.allowVerticalPlacement&&r.vertical&&(h=hc(i,r.vertical,U,E.get("icon-text-fit-padding"),I,R)),P&&(i=hc(i,P,U,E.get("icon-text-fit-padding"),I,R))),"line"===F)for(var V=0,G=Cc(t.geometry,0,0,8192,8192);V<G.length;V+=1)for(var H=G[V],Z=0,W=(d=H,m=M,f=L,y=r.vertical||P,g=i,v=A,_=e.overscaling,b=8192,x=wc(y,24,v),m-(T=(S=Sc(y,g))*v)<m/4&&(m=T+m/4),function e(t,r,i,n,o,a,s,l,u){for(var c=a/2,p=xc(t),h=0,d=r-i,m=[],f=0;f<t.length-1;f++){for(var y=t[f],g=t[f+1],v=y.dist(g),_=g.angleTo(y);d+i<h+v;){var b=((d+=i)-h)/v,x=Yt(y.x,g.x,b),w=Yt(y.y,g.y,b);if(0<=x&&x<u&&0<=w&&w<u&&0<=d-c&&d+c<=p){var S=new mc(x,w,_,f);S._round(),n&&!bc(t,S,a,n,o)||m.push(S)}}h+=v}return l||m.length||s||(m=e(t,h/2,i,n,o,a,s,!0,u)),m}(d,(C=0===d[0].x||d[0].x===b||0===d[0].y||d[0].y===b)?m/2*_%m:(S/2+48)*v*_%m,m,x,f,T,C,!1,b));Z<W.length;Z+=1){var K=W[Z];P&&jc(e,P.text,q,K)||j(H,K)}else if("line-center"===F)for(var X=0,Y=t.geometry;X<Y.length;X+=1){var J=Y[X];if(1<J.length){var $=Tc(J,L,r.vertical||P,i,24,A);$&&j(J,$)}}else if("Polygon"===t.type)for(var Q=0,ee=Nl(t.geometry,0);Q<ee.length;Q+=1){var te=ee[Q],re=kc(te,16);j(te[0],new mc(re.x,re.y,0))}else if("LineString"===t.type)for(var ie=0,ne=t.geometry;ie<ne.length;ie+=1){var oe=ne[ie];j(oe,new mc(oe[0].x,oe[0].y,0))}else if("Point"===t.type)for(var ae=0,se=t.geometry;ae<se.length;ae+=1)for(var le=0,ue=se[ae];le<ue.length;le+=1){var ce=ue[le];j([ce],new mc(ce.x,ce.y,0))}}(e,o,d,G,i,u,p,h,x,H,a)},_=0,b=e.features;_<b.length;_+=1)v();o&&e.generateCollisionDebugBuffers()},e.perspective=function(e,t,r,i,n){var o,a=1/Math.tan(t/2);return e[0]=a/r,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=a,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,null!=n&&n!==1/0?(e[10]=(n+i)*(o=1/(i-n)),e[14]=2*n*i*o):(e[10]=-1,e[14]=-2*i),e},e.pick=function(e,t){for(var r={},i=0;i<t.length;i++){var n=t[i];n in e&&(r[n]=e[n])}return r},e.plugin=pn,e.polygonIntersectsPolygon=hs,e.postMapLoadEvent=se,e.postTurnstileEvent=oe,e.potpack=Yu,e.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],e.register=ji,e.registerForPluginStateChange=function(e){return e({pluginStatus:nn,pluginURL:on}),cn.on("pluginStateChange",e),e},e.rotate=function(e,t,r){var i=t[0],n=t[1],o=t[2],a=t[3],s=Math.sin(r),l=Math.cos(r);return e[0]=i*l+o*s,e[1]=n*l+a*s,e[2]=i*-s+o*l,e[3]=n*-s+a*l,e},e.rotateX=function(e,t,r){var i=Math.sin(r),n=Math.cos(r),o=t[4],a=t[5],s=t[6],l=t[7],u=t[8],c=t[9],p=t[10],h=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=o*n+u*i,e[5]=a*n+c*i,e[6]=s*n+p*i,e[7]=l*n+h*i,e[8]=u*n-o*i,e[9]=c*n-a*i,e[10]=p*n-s*i,e[11]=h*n-l*i,e},e.rotateZ=function(e,t,r){var i=Math.sin(r),n=Math.cos(r),o=t[0],a=t[1],s=t[2],l=t[3],u=t[4],c=t[5],p=t[6],h=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=o*n+u*i,e[1]=a*n+c*i,e[2]=s*n+p*i,e[3]=l*n+h*i,e[4]=u*n-o*i,e[5]=c*n-a*i,e[6]=p*n-s*i,e[7]=h*n-l*i,e},e.scale=function(e,t,r){var i=r[0],n=r[1],o=r[2];return e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e[3]=t[3]*i,e[4]=t[4]*n,e[5]=t[5]*n,e[6]=t[6]*n,e[7]=t[7]*n,e[8]=t[8]*o,e[9]=t[9]*o,e[10]=t[10]*o,e[11]=t[11]*o,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},e.scale$1=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e},e.scale$2=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e},e.setCacheLimits=function(e,t){le=e,ue=t},e.setRTLTextPlugin=function(e,t,r){if(void 0===r&&(r=!1),"deferred"===nn||"loading"===nn||"loaded"===nn)throw new Error("setRTLTextPlugin cannot be called multiple times.");on=D.resolveURL(e),nn="deferred",rn=t,an(),r||ln()},e.sphericalToCartesian=function(e){var t=e[0],r=e[1],i=e[2];return r+=90,r*=Math.PI/180,i*=Math.PI/180,{x:t*Math.cos(r)*Math.sin(i),y:t*Math.sin(r)*Math.sin(i),z:t*Math.cos(i)}},e.sqrLen=function(e){var t=e[0],r=e[1];return t*t+r*r},e.styleSpec=Oe,e.sub=function(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e},e.symbolSize=_c,e.transformMat3=function(e,t,r){var i=t[0],n=t[1],o=t[2];return e[0]=i*r[0]+n*r[3]+o*r[6],e[1]=i*r[1]+n*r[4]+o*r[7],e[2]=i*r[2]+n*r[5]+o*r[8],e},e.transformMat4=zs,e.translate=function(e,t,r){var i,n,o,a,s,l,u,c,p,h,d,m,f=r[0],y=r[1],g=r[2];return t===e?(e[12]=t[0]*f+t[4]*y+t[8]*g+t[12],e[13]=t[1]*f+t[5]*y+t[9]*g+t[13],e[14]=t[2]*f+t[6]*y+t[10]*g+t[14],e[15]=t[3]*f+t[7]*y+t[11]*g+t[15]):(n=t[1],o=t[2],a=t[3],s=t[4],l=t[5],u=t[6],c=t[7],p=t[8],h=t[9],d=t[10],m=t[11],e[0]=i=t[0],e[1]=n,e[2]=o,e[3]=a,e[4]=s,e[5]=l,e[6]=u,e[7]=c,e[8]=p,e[9]=h,e[10]=d,e[11]=m,e[12]=i*f+s*y+p*g+t[12],e[13]=n*f+l*y+h*g+t[13],e[14]=o*f+u*y+d*g+t[14],e[15]=a*f+c*y+m*g+t[15]),e},e.triggerPluginCompletionEvent=tn,e.uniqueId=d,e.validateCustomStyleLayer=function(e){var t=[],r=e.id;return void 0===r&&t.push({message:"layers."+r+': missing required property "id"'}),void 0===e.render&&t.push({message:"layers."+r+': missing required method "render"'}),e.renderingMode&&"2d"!==e.renderingMode&&"3d"!==e.renderingMode&&t.push({message:"layers."+r+': property "renderingMode" must be either "2d" or "3d"'}),t},e.validateLight=Mi,e.validateStyle=zi,e.values=function(e){var t=[];for(var r in e)t.push(e[r]);return t},e.vectorTile=Xl,e.version="1.11.1",e.warnOnce=w,e.webpSupported=F,e.window=a,e.wrap=c})),r(0,(function(e){function t(e){var r=typeof e;if("number"==r||"boolean"==r||"string"==r||null==e)return JSON.stringify(e);if(Array.isArray(e)){for(var i="[",n=0,o=e;n<o.length;n+=1)i+=t(o[n])+",";return i+"]"}for(var a=Object.keys(e).sort(),s="{",l=0;l<a.length;l++)s+=JSON.stringify(a[l])+":"+t(e[a[l]])+",";return s+"}"}function r(r){for(var i="",n=0,o=e.refProperties;n<o.length;n+=1)i+="/"+t(r[o[n]]);return i}function i(e){this.keyCache={},e&&this.replace(e)}function n(t){var r={},i=[];for(var n in t){var o=t[n],a=r[n]={};for(var s in o){var l=o[+s];if(l&&0!==l.bitmap.width&&0!==l.bitmap.height){var u={x:0,y:0,w:l.bitmap.width+2,h:l.bitmap.height+2};i.push(u),a[s]={rect:u,metrics:l.metrics}}}}var c=e.potpack(i),p=new e.AlphaImage({width:c.w||1,height:c.h||1});for(var h in t){var d=t[h];for(var m in d){var f=d[+m];if(f&&0!==f.bitmap.width&&0!==f.bitmap.height){var y=r[h][m].rect;e.AlphaImage.copy(f.bitmap,p,{x:0,y:0},{x:y.x+1,y:y.y+1},f.bitmap)}}}this.image=p,this.positions=r}function o(t){this.tileID=new e.OverscaledTileID(t.tileID.overscaledZ,t.tileID.wrap,t.tileID.canonical.z,t.tileID.canonical.x,t.tileID.canonical.y),this.uid=t.uid,this.zoom=t.zoom,this.pixelRatio=t.pixelRatio,this.tileSize=t.tileSize,this.source=t.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=t.showCollisionBoxes,this.collectResourceTiming=!!t.collectResourceTiming,this.returnDependencies=!!t.returnDependencies,this.promoteId=t.promoteId}function a(t,r,i){for(var n=new e.EvaluationParameters(r),o=0,a=t;o<a.length;o+=1)a[o].recalculate(n,i)}function s(t,r){var i=e.getArrayBuffer(t.request,(function(t,i,n,o){t?r(t):i&&r(null,{vectorTile:new e.vectorTile.VectorTile(new e.pbf(i)),rawData:i,cacheControl:n,expires:o})}));return function(){i.cancel(),r()}}function l(e,t,r,i){this.actor=e,this.layerIndex=t,this.availableImages=r,this.loadVectorData=i||s,this.loading={},this.loaded={}}function u(){this.loaded={}}i.prototype.replace=function(e){this._layerConfigs={},this._layers={},this.update(e,[])},i.prototype.update=function(t,i){for(var n=this,o=0,a=t;o<a.length;o+=1){var s=a[o];this._layerConfigs[s.id]=s;var l=this._layers[s.id]=e.createStyleLayer(s);l._featureFilter=e.featureFilter(l.filter),this.keyCache[s.id]&&delete this.keyCache[s.id]}for(var u=0,c=i;u<c.length;u+=1){var p=c[u];delete this.keyCache[p],delete this._layerConfigs[p],delete this._layers[p]}this.familiesBySource={};for(var h=0,d=function(e,t){for(var i={},n=0;n<e.length;n++){var o=t&&t[e[n].id]||r(e[n]);t&&(t[e[n].id]=o);var a=i[o];(a=a||(i[o]=[])).push(e[n])}var s=[];for(var l in i)s.push(i[l]);return s}(e.values(this._layerConfigs),this.keyCache);h<d.length;h+=1){var m=d[h].map((function(e){return n._layers[e.id]})),f=m[0];if("none"!==f.visibility){var y=f.source||"",g=this.familiesBySource[y];g=g||(this.familiesBySource[y]={});var v=f.sourceLayer||"_geojsonTileLayer",_=g[v];(_=_||(g[v]=[])).push(m)}}},e.register("GlyphAtlas",n),o.prototype.parse=function(t,r,i,o,s){var l=this;this.status="parsing",this.data=t,this.collisionBoxArray=new e.CollisionBoxArray;var u=new e.DictionaryCoder(Object.keys(t.layers).sort()),c=new e.FeatureIndex(this.tileID,this.promoteId);c.bucketLayerIDs=[];var p,h,d,m,f={},y={featureIndex:c,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:i},g=r.familiesBySource[this.source];for(var v in g){var _=t.layers[v];if(_){1===_.version&&e.warnOnce('Vector tile source "'+this.source+'" layer "'+v+'" does not use vector tile spec v2 and therefore may have some rendering errors.');for(var b=u.encode(v),x=[],w=0;w<_.length;w++){var S=_.feature(w),T=c.getId(S,v);x.push({feature:S,id:T,index:w,sourceLayerIndex:b})}for(var C=0,E=g[v];C<E.length;C+=1){var I=E[C],P=I[0];P.minzoom&&this.zoom<Math.floor(P.minzoom)||P.maxzoom&&this.zoom>=P.maxzoom||"none"!==P.visibility&&(a(I,this.zoom,i),(f[P.id]=P.createBucket({index:c.bucketLayerIDs.length,layers:I,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:b,sourceID:this.source})).populate(x,y,this.tileID.canonical),c.bucketLayerIDs.push(I.map((function(e){return e.id}))))}}}var R=e.mapObject(y.glyphDependencies,(function(e){return Object.keys(e).map(Number)}));Object.keys(R).length?o.send("getGlyphs",{uid:this.uid,stacks:R},(function(e,t){p||(p=e,h=t,z.call(l))})):h={};var N=Object.keys(y.iconDependencies);N.length?o.send("getImages",{icons:N,source:this.source,tileID:this.tileID,type:"icons"},(function(e,t){p||(p=e,d=t,z.call(l))})):d={};var A=Object.keys(y.patternDependencies);function z(){if(p)return s(p);if(h&&d&&m){var t=new n(h),r=new e.ImageAtlas(d,m);for(var o in f){var l=f[o];l instanceof e.SymbolBucket?(a(l.layers,this.zoom,i),e.performSymbolLayout(l,h,t.positions,d,r.iconPositions,this.showCollisionBoxes,this.tileID.canonical)):l.hasPattern&&(l instanceof e.LineBucket||l instanceof e.FillBucket||l instanceof e.FillExtrusionBucket)&&(a(l.layers,this.zoom,i),l.addFeatures(y,this.tileID.canonical,r.patternPositions))}this.status="done",s(null,{buckets:e.values(f).filter((function(e){return!e.isEmpty()})),featureIndex:c,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:t.image,imageAtlas:r,glyphMap:this.returnDependencies?h:null,iconMap:this.returnDependencies?d:null,glyphPositions:this.returnDependencies?t.positions:null})}}A.length?o.send("getImages",{icons:A,source:this.source,tileID:this.tileID,type:"patterns"},(function(e,t){p||(p=e,m=t,z.call(l))})):m={},z.call(this)},l.prototype.loadTile=function(t,r){var i=this,n=t.uid;this.loading||(this.loading={});var a=!!(t&&t.request&&t.request.collectResourceTiming)&&new e.RequestPerformance(t.request),s=this.loading[n]=new o(t);s.abort=this.loadVectorData(t,(function(t,o){if(delete i.loading[n],t||!o)return s.status="done",i.loaded[n]=s,r(t);var l=o.rawData,u={};o.expires&&(u.expires=o.expires),o.cacheControl&&(u.cacheControl=o.cacheControl);var c={};if(a){var p=a.finish();p&&(c.resourceTiming=JSON.parse(JSON.stringify(p)))}s.vectorTile=o.vectorTile,s.parse(o.vectorTile,i.layerIndex,i.availableImages,i.actor,(function(t,i){if(t||!i)return r(t);r(null,e.extend({rawTileData:l.slice(0)},i,u,c))})),i.loaded=i.loaded||{},i.loaded[n]=s}))},l.prototype.reloadTile=function(e,t){var r=this,i=this.loaded,n=e.uid,o=this;if(i&&i[n]){var a=i[n];a.showCollisionBoxes=e.showCollisionBoxes;var s=function(e,i){var n=a.reloadCallback;n&&(delete a.reloadCallback,a.parse(a.vectorTile,o.layerIndex,r.availableImages,o.actor,n)),t(e,i)};"parsing"===a.status?a.reloadCallback=s:"done"===a.status&&(a.vectorTile?a.parse(a.vectorTile,this.layerIndex,this.availableImages,this.actor,s):s())}},l.prototype.abortTile=function(e,t){var r=this.loading,i=e.uid;r&&r[i]&&r[i].abort&&(r[i].abort(),delete r[i]),t()},l.prototype.removeTile=function(e,t){var r=this.loaded,i=e.uid;r&&r[i]&&delete r[i],t()};var c=e.window.ImageBitmap;function p(e,t){if(0!==e.length){h(e[0],t);for(var r=1;r<e.length;r++)h(e[r],!t)}}function h(e,t){for(var r=0,i=0,n=e.length,o=n-1;i<n;o=i++)r+=(e[i][0]-e[o][0])*(e[o][1]+e[i][1]);0<=r!=!!t&&e.reverse()}function d(t){this._feature=t,this.extent=e.EXTENT,this.type=t.type,this.properties=t.tags,"id"in t&&!isNaN(t.id)&&(this.id=parseInt(t.id,10))}u.prototype.loadTile=function(t,r){var i=t.uid,n=t.encoding,o=t.rawImageData,a=c&&o instanceof c?this.getImageData(o):o,s=new e.DEMData(i,a,n);this.loaded=this.loaded||{},r(null,this.loaded[i]=s)},u.prototype.getImageData=function(t){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(t.width,t.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=t.width,this.offscreenCanvas.height=t.height,this.offscreenCanvasContext.drawImage(t,0,0,t.width,t.height);var r=this.offscreenCanvasContext.getImageData(-1,-1,t.width+2,t.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new e.RGBAImage({width:r.width,height:r.height},r.data)},u.prototype.removeTile=function(e){var t=this.loaded,r=e.uid;t&&t[r]&&delete t[r]};var m=e.vectorTile.VectorTileFeature.prototype.toGeoJSON;d.prototype.loadGeometry=function(){if(1===this._feature.type){for(var t=[],r=0,i=this._feature.geometry;r<i.length;r+=1){var n=i[r];t.push([new e.Point$1(n[0],n[1])])}return t}for(var o=[],a=0,s=this._feature.geometry;a<s.length;a+=1){for(var l=[],u=0,c=s[a];u<c.length;u+=1){var p=c[u];l.push(new e.Point$1(p[0],p[1]))}o.push(l)}return o},d.prototype.toGeoJSON=function(e,t,r){return m.call(this,e,t,r)};var f=function(t){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=e.EXTENT,this.length=t.length,this._features=t};f.prototype.feature=function(e){return new d(this._features[e])};var y=e.vectorTile.VectorTileFeature,g=v;function v(e,t){this.options=t||{},this.features=e,this.length=e.length}function _(e,t){this.id="number"==typeof e.id?e.id:void 0,this.type=e.type,this.rawGeometry=1===e.type?[e.geometry]:e.geometry,this.properties=e.tags,this.extent=t||4096}v.prototype.feature=function(e){return new _(this.features[e],this.options.extent)},_.prototype.loadGeometry=function(){var t=this.rawGeometry;this.geometry=[];for(var r=0;r<t.length;r++){for(var i=t[r],n=[],o=0;o<i.length;o++)n.push(new e.Point$1(i[o][0],i[o][1]));this.geometry.push(n)}return this.geometry},_.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var e=this.geometry,t=1/0,r=-1/0,i=1/0,n=-1/0,o=0;o<e.length;o++)for(var a=e[o],s=0;s<a.length;s++){var l=a[s];t=Math.min(t,l.x),r=Math.max(r,l.x),i=Math.min(i,l.y),n=Math.max(n,l.y)}return[t,i,r,n]},_.prototype.toGeoJSON=y.prototype.toGeoJSON;var b=w,x=g;function w(t){var r=new e.pbf;return function(e,t){for(var r in e.layers)t.writeMessage(3,S,e.layers[r])}(t,r),r.finish()}function S(e,t){var r;t.writeVarintField(15,e.version||1),t.writeStringField(1,e.name||""),t.writeVarintField(5,e.extent||4096);var i={keys:[],values:[],keycache:{},valuecache:{}};for(r=0;r<e.length;r++)i.feature=e.feature(r),t.writeMessage(2,T,i);var n=i.keys;for(r=0;r<n.length;r++)t.writeStringField(3,n[r]);var o=i.values;for(r=0;r<o.length;r++)t.writeMessage(4,R,o[r])}function T(e,t){var r=e.feature;void 0!==r.id&&t.writeVarintField(1,r.id),t.writeMessage(2,C,e),t.writeVarintField(3,r.type),t.writeMessage(4,P,r)}function C(e,t){var r=e.feature,i=e.keys,n=e.values,o=e.keycache,a=e.valuecache;for(var s in r.properties){var l=o[s];void 0===l&&(i.push(s),o[s]=l=i.length-1),t.writeVarint(l);var u=r.properties[s],c=typeof u;"string"!=c&&"boolean"!=c&&"number"!=c&&(u=JSON.stringify(u));var p=c+":"+u,h=a[p];void 0===h&&(n.push(u),a[p]=h=n.length-1),t.writeVarint(h)}}function E(e,t){return(t<<3)+(7&e)}function I(e){return e<<1^e>>31}function P(e,t){for(var r=e.loadGeometry(),i=e.type,n=0,o=0,a=r.length,s=0;s<a;s++){var l=r[s],u=1;1===i&&(u=l.length),t.writeVarint(E(1,u));for(var c=3===i?l.length-1:l.length,p=0;p<c;p++){1===p&&1!==i&&t.writeVarint(E(2,c-1));var h=l[p].x-n,d=l[p].y-o;t.writeVarint(I(h)),t.writeVarint(I(d)),n+=h,o+=d}3===i&&t.writeVarint(15)}}function R(e,t){var r=typeof e;"string"==r?t.writeStringField(1,e):"boolean"==r?t.writeBooleanField(7,e):"number"==r&&(e%1!=0?t.writeDoubleField(3,e):e<0?t.writeSVarintField(6,e):t.writeVarintField(5,e))}function N(e,t,r,i){A(e,r,i),A(t,2*r,2*i),A(t,2*r+1,2*i+1)}function A(e,t,r){var i=e[t];e[t]=e[r],e[r]=i}function z(e,t,r,i){var n=e-r,o=t-i;return n*n+o*o}function M(e){return e[0]}function k(e){return e[1]}function O(e,t,r,i,n){void 0===t&&(t=M),void 0===r&&(r=k),void 0===i&&(i=64),void 0===n&&(n=Float64Array),this.nodeSize=i;for(var o=(this.points=e).length<65536?Uint16Array:Uint32Array,a=this.ids=new o(e.length),s=this.coords=new n(2*e.length),l=0;l<e.length;l++)s[2*(a[l]=l)]=t(e[l]),s[2*l+1]=r(e[l]);!function e(t,r,i,n,o,a){if(!(o-n<=i)){var s=n+o>>1;!function e(t,r,i,n,o,a){for(;n<o;){if(600<o-n){var s=o-n+1,l=i-n+1,u=Math.log(s),c=.5*Math.exp(2*u/3),p=.5*Math.sqrt(u*c*(s-c)/s)*(l-s/2<0?-1:1);e(t,r,i,Math.max(n,Math.floor(i-l*c/s+p)),Math.min(o,Math.floor(i+(s-l)*c/s+p)),a)}var h=r[2*i+a],d=n,m=o;for(N(t,r,n,i),r[2*o+a]>h&&N(t,r,n,o);d<m;){for(N(t,r,d,m),d++,m--;r[2*d+a]<h;)d++;for(;r[2*m+a]>h;)m--}r[2*n+a]===h?N(t,r,n,m):N(t,r,++m,o),m<=i&&(n=m+1),i<=m&&(o=m-1)}}(t,r,s,n,o,a%2),e(t,r,i,n,s-1,a+1),e(t,r,i,1+s,o,a+1)}}(a,s,i,0,a.length-1,0)}function L(e){this.options=j(Object.create(D),e),this.trees=new Array(this.options.maxZoom+1)}b.fromVectorTileJs=w,b.fromGeojsonVt=function(e,t){t=t||{};var r={};for(var i in e)r[i]=new g(e[i].features,t),r[i].name=i,r[i].version=t.version,r[i].extent=t.extent;return w({layers:r})},b.GeoJSONWrapper=x,O.prototype.range=function(e,t,r,i){return function(e,t,r,i,n,o,a){for(var s,l,u=[0,e.length-1,0],c=[];u.length;){var p=u.pop(),h=u.pop(),d=u.pop();if(h-d<=a)for(var m=d;m<=h;m++)l=t[2*m+1],(s=t[2*m])>=r&&s<=n&&i<=l&&l<=o&&c.push(e[m]);else{var f=Math.floor((d+h)/2);l=t[2*f+1],(s=t[2*f])>=r&&s<=n&&i<=l&&l<=o&&c.push(e[f]);var y=(p+1)%2;(0===p?r<=s:i<=l)&&(u.push(d),u.push(f-1),u.push(y)),(0===p?s<=n:l<=o)&&(u.push(f+1),u.push(h),u.push(y))}}return c}(this.ids,this.coords,e,t,r,i,this.nodeSize)};var D={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!(O.prototype.within=function(e,t,r){return function(e,t,r,i,n,o){for(var a=[0,e.length-1,0],s=[],l=n*n;a.length;){var u=a.pop(),c=a.pop(),p=a.pop();if(c-p<=o)for(var h=p;h<=c;h++)z(t[2*h],t[2*h+1],r,i)<=l&&s.push(e[h]);else{var d=Math.floor((p+c)/2),m=t[2*d],f=t[2*d+1];z(m,f,r,i)<=l&&s.push(e[d]);var y=(u+1)%2;(0===u?r-n<=m:i-n<=f)&&(a.push(p),a.push(d-1),a.push(y)),(0===u?m<=r+n:f<=i+n)&&(a.push(d+1),a.push(c),a.push(y))}}return s}(this.ids,this.coords,e,t,r,this.nodeSize)}),generateId:!1,reduce:null,map:function(e){return e}};function B(e){return{type:"Feature",id:e.id,properties:F(e),geometry:{type:"Point",coordinates:[360*(e.x-.5),(t=(180-360*e.y)*Math.PI/180,360*Math.atan(Math.exp(t))/Math.PI-90)]}};var t}function F(e){var t=e.numPoints,r=1e4<=t?Math.round(t/1e3)+"k":1e3<=t?Math.round(t/100)/10+"k":t;return j(j({},e.properties),{cluster:!0,cluster_id:e.id,point_count:t,point_count_abbreviated:r})}function q(e){return e/360+.5}function U(e){var t=Math.sin(e*Math.PI/180),r=.5-.25*Math.log((1+t)/(1-t))/Math.PI;return r<0?0:1<r?1:r}function j(e,t){for(var r in t)e[r]=t[r];return e}function V(e){return e.x}function G(e){return e.y}function H(e,t,r,i,n,o){var a=n-r,s=o-i;if(0!==a||0!==s){var l=((e-r)*a+(t-i)*s)/(a*a+s*s);1<l?(r=n,i=o):0<l&&(r+=a*l,i+=s*l)}return(a=e-r)*a+(s=t-i)*s}function Z(e,t,r,i){var n={id:void 0===e?null:e,type:t,geometry:r,tags:i,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(e){var t=e.geometry,r=e.type;if("Point"===r||"MultiPoint"===r||"LineString"===r)W(e,t);else if("Polygon"===r||"MultiLineString"===r)for(var i=0;i<t.length;i++)W(e,t[i]);else if("MultiPolygon"===r)for(i=0;i<t.length;i++)for(var n=0;n<t[i].length;n++)W(e,t[i][n])}(n),n}function W(e,t){for(var r=0;r<t.length;r+=3)e.minX=Math.min(e.minX,t[r]),e.minY=Math.min(e.minY,t[r+1]),e.maxX=Math.max(e.maxX,t[r]),e.maxY=Math.max(e.maxY,t[r+1])}function K(e,t,r,i){if(t.geometry){var n=t.geometry.coordinates,o=t.geometry.type,a=Math.pow(r.tolerance/((1<<r.maxZoom)*r.extent),2),s=[],l=t.id;if(r.promoteId?l=t.properties[r.promoteId]:r.generateId&&(l=i||0),"Point"===o)X(n,s);else if("MultiPoint"===o)for(var u=0;u<n.length;u++)X(n[u],s);else if("LineString"===o)Y(n,s,a,!1);else if("MultiLineString"===o){if(r.lineMetrics){for(u=0;u<n.length;u++)Y(n[u],s=[],a,!1),e.push(Z(l,"LineString",s,t.properties));return}J(n,s,a,!1)}else if("Polygon"===o)J(n,s,a,!0);else{if("MultiPolygon"!==o){if("GeometryCollection"!==o)throw new Error("Input data is not a valid GeoJSON object.");for(u=0;u<t.geometry.geometries.length;u++)K(e,{id:l,geometry:t.geometry.geometries[u],properties:t.properties},r,i);return}for(u=0;u<n.length;u++){var c=[];J(n[u],c,a,!0),s.push(c)}}e.push(Z(l,o,s,t.properties))}}function X(e,t){t.push($(e[0])),t.push(Q(e[1])),t.push(0)}function Y(e,t,r,i){for(var n,o,a=0,s=0;s<e.length;s++){var l=$(e[s][0]),u=Q(e[s][1]);t.push(l),t.push(u),t.push(0),0<s&&(a+=i?(n*u-l*o)/2:Math.sqrt(Math.pow(l-n,2)+Math.pow(u-o,2))),n=l,o=u}var c=t.length-3;t[2]=1,function e(t,r,i,n){for(var o,a=n,s=i-r>>1,l=i-r,u=t[r],c=t[r+1],p=t[i],h=t[i+1],d=r+3;d<i;d+=3){var m=H(t[d],t[d+1],u,c,p,h);if(a<m)o=d,a=m;else if(m===a){var f=Math.abs(d-s);f<l&&(o=d,l=f)}}n<a&&(3<o-r&&e(t,r,o,n),t[o+2]=a,3<i-o&&e(t,o,i,n))}(t,0,c,r),t[2+c]=1,t.size=Math.abs(a),t.start=0,t.end=t.size}function J(e,t,r,i){for(var n=0;n<e.length;n++){var o=[];Y(e[n],o,r,i),t.push(o)}}function $(e){return e/360+.5}function Q(e){var t=Math.sin(e*Math.PI/180),r=.5-.25*Math.log((1+t)/(1-t))/Math.PI;return r<0?0:1<r?1:r}function ee(e,t,r,i,n,o,a,s){if(i/=t,o>=(r/=t)&&a<i)return e;if(a<r||i<=o)return null;for(var l=[],u=0;u<e.length;u++){var c=e[u],p=c.geometry,h=c.type,d=0===n?c.minX:c.minY,m=0===n?c.maxX:c.maxY;if(r<=d&&m<i)l.push(c);else if(!(m<r||i<=d)){var f=[];if("Point"===h||"MultiPoint"===h)te(p,f,r,i,n);else if("LineString"===h)re(p,f,r,i,n,!1,s.lineMetrics);else if("MultiLineString"===h)ne(p,f,r,i,n,!1);else if("Polygon"===h)ne(p,f,r,i,n,!0);else if("MultiPolygon"===h)for(var y=0;y<p.length;y++){var g=[];ne(p[y],g,r,i,n,!0),g.length&&f.push(g)}if(f.length){if(s.lineMetrics&&"LineString"===h){for(y=0;y<f.length;y++)l.push(Z(c.id,h,f[y],c.tags));continue}"LineString"!==h&&"MultiLineString"!==h||(1===f.length?(h="LineString",f=f[0]):h="MultiLineString"),"Point"!==h&&"MultiPoint"!==h||(h=3===f.length?"Point":"MultiPoint"),l.push(Z(c.id,h,f,c.tags))}}}return l.length?l:null}function te(e,t,r,i,n){for(var o=0;o<e.length;o+=3){var a=e[o+n];r<=a&&a<=i&&(t.push(e[o]),t.push(e[o+1]),t.push(e[o+2]))}}function re(e,t,r,i,n,o,a){for(var s,l,u=ie(e),c=0===n?ae:se,p=e.start,h=0;h<e.length-3;h+=3){var d=e[h],m=e[h+1],f=e[h+2],y=e[h+3],g=e[h+4],v=0===n?d:m,_=0===n?y:g,b=!1;a&&(s=Math.sqrt(Math.pow(d-y,2)+Math.pow(m-g,2))),v<r?r<_&&(l=c(u,d,m,y,g,r),a&&(u.start=p+s*l)):i<v?_<i&&(l=c(u,d,m,y,g,i),a&&(u.start=p+s*l)):oe(u,d,m,f),_<r&&r<=v&&(l=c(u,d,m,y,g,r),b=!0),i<_&&v<=i&&(l=c(u,d,m,y,g,i),b=!0),!o&&b&&(a&&(u.end=p+s*l),t.push(u),u=ie(e)),a&&(p+=s)}var x=e.length-3;d=e[x],m=e[x+1],f=e[x+2],(v=0===n?d:m)>=r&&v<=i&&oe(u,d,m,f),x=u.length-3,o&&3<=x&&(u[x]!==u[0]||u[x+1]!==u[1])&&oe(u,u[0],u[1],u[2]),u.length&&t.push(u)}function ie(e){var t=[];return t.size=e.size,t.start=e.start,t.end=e.end,t}function ne(e,t,r,i,n,o){for(var a=0;a<e.length;a++)re(e[a],t,r,i,n,o,!1)}function oe(e,t,r,i){e.push(t),e.push(r),e.push(i)}function ae(e,t,r,i,n,o){var a=(o-t)/(i-t);return e.push(o),e.push(r+(n-r)*a),e.push(1),a}function se(e,t,r,i,n,o){var a=(o-r)/(n-r);return e.push(t+(i-t)*a),e.push(o),e.push(1),a}function le(e,t){for(var r=[],i=0;i<e.length;i++){var n,o=e[i],a=o.type;if("Point"===a||"MultiPoint"===a||"LineString"===a)n=ue(o.geometry,t);else if("MultiLineString"===a||"Polygon"===a){n=[];for(var s=0;s<o.geometry.length;s++)n.push(ue(o.geometry[s],t))}else if("MultiPolygon"===a)for(n=[],s=0;s<o.geometry.length;s++){for(var l=[],u=0;u<o.geometry[s].length;u++)l.push(ue(o.geometry[s][u],t));n.push(l)}r.push(Z(o.id,a,n,o.tags))}return r}function ue(e,t){var r=[];r.size=e.size,void 0!==e.start&&(r.start=e.start,r.end=e.end);for(var i=0;i<e.length;i+=3)r.push(e[i]+t,e[i+1],e[i+2]);return r}function ce(e,t){if(e.transformed)return e;var r,i,n,o=1<<e.z,a=e.x,s=e.y;for(r=0;r<e.features.length;r++){var l=e.features[r],u=l.geometry,c=l.type;if(l.geometry=[],1===c)for(i=0;i<u.length;i+=2)l.geometry.push(pe(u[i],u[i+1],t,o,a,s));else for(i=0;i<u.length;i++){var p=[];for(n=0;n<u[i].length;n+=2)p.push(pe(u[i][n],u[i][n+1],t,o,a,s));l.geometry.push(p)}}return e.transformed=!0,e}function pe(e,t,r,i,n,o){return[Math.round(r*(e*i-n)),Math.round(r*(t*i-o))]}function he(e,t,r,i,n){for(var o=t===n.maxZoom?0:n.tolerance/((1<<t)*n.extent),a={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:r,y:i,z:t,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},s=0;s<e.length;s++){a.numFeatures++,de(a,e[s],o,n);var l=e[s].minX,u=e[s].minY,c=e[s].maxX,p=e[s].maxY;l<a.minX&&(a.minX=l),u<a.minY&&(a.minY=u),c>a.maxX&&(a.maxX=c),p>a.maxY&&(a.maxY=p)}return a}function de(e,t,r,i){var n=t.geometry,o=t.type,a=[];if("Point"===o||"MultiPoint"===o)for(var s=0;s<n.length;s+=3)a.push(n[s]),a.push(n[s+1]),e.numPoints++,e.numSimplified++;else if("LineString"===o)me(a,n,e,r,!1,!1);else if("MultiLineString"===o||"Polygon"===o)for(s=0;s<n.length;s++)me(a,n[s],e,r,"Polygon"===o,0===s);else if("MultiPolygon"===o)for(var l=0;l<n.length;l++){var u=n[l];for(s=0;s<u.length;s++)me(a,u[s],e,r,!0,0===s)}if(a.length){var c=t.tags||null;if("LineString"===o&&i.lineMetrics){for(var p in c={},t.tags)c[p]=t.tags[p];c.mapbox_clip_start=n.start/n.size,c.mapbox_clip_end=n.end/n.size}var h={geometry:a,type:"Polygon"===o||"MultiPolygon"===o?3:"LineString"===o||"MultiLineString"===o?2:1,tags:c};null!==t.id&&(h.id=t.id),e.features.push(h)}}function me(e,t,r,i,n,o){var a=i*i;if(0<i&&t.size<(n?a:i))r.numPoints+=t.length/3;else{for(var s=[],l=0;l<t.length;l+=3)(0===i||t[l+2]>a)&&(r.numSimplified++,s.push(t[l]),s.push(t[l+1])),r.numPoints++;n&&function(e,t){for(var r=0,i=0,n=e.length,o=n-2;i<n;o=i,i+=2)r+=(e[i]-e[o])*(e[i+1]+e[o+1]);if(0<r===t)for(i=0,n=e.length;i<n/2;i+=2){var a=e[i],s=e[i+1];e[i]=e[n-2-i],e[i+1]=e[n-1-i],e[n-2-i]=a,e[n-1-i]=s}}(s,o),e.push(s)}}function fe(e,t){var r=(t=this.options=function(e,t){for(var r in t)e[r]=t[r];return e}(Object.create(this.options),t)).debug;if(r&&console.time("preprocess data"),t.maxZoom<0||24<t.maxZoom)throw new Error("maxZoom should be in the 0-24 range");if(t.promoteId&&t.generateId)throw new Error("promoteId and generateId cannot be used together.");var i,n,o,a,s,l,u=function(e,t){var r=[];if("FeatureCollection"===e.type)for(var i=0;i<e.features.length;i++)K(r,e.features[i],t,i);else K(r,"Feature"===e.type?e:{geometry:e},t);return r}(e,t);this.tiles={},this.tileCoords=[],r&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",t.indexMaxZoom,t.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),s=ee(a=i=u,1,-1-(o=(n=t).buffer/n.extent),o,0,-1,2,n),l=ee(i,1,1-o,2+o,0,-1,2,n),(s||l)&&(a=ee(i,1,-o,1+o,0,-1,2,n)||[],s&&(a=le(s,1).concat(a)),l&&(a=a.concat(le(l,-1)))),(u=a).length&&this.splitTile(u,0,0,0),r&&(u.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function ye(e,t,r){return 32*((1<<e)*r+t)+e}function ge(e,t){var r=e.tileID.canonical;if(!this._geoJSONIndex)return t(null,null);var i=this._geoJSONIndex.getTile(r.z,r.x,r.y);if(!i)return t(null,null);var n=new f(i.features),o=b(n);0===o.byteOffset&&o.byteLength===o.buffer.byteLength||(o=new Uint8Array(o)),t(null,{vectorTile:n,rawData:o.buffer})}function ve(t){var r=this;this.self=t,this.actor=new e.Actor(t,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:l,geojson:be},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=function(e,t){if(r.workerSourceTypes[e])throw new Error('Worker source with name "'+e+'" already registered.');r.workerSourceTypes[e]=t},this.self.registerRTLTextPlugin=function(t){if(e.plugin.isParsed())throw new Error("RTL text plugin already registered.");e.plugin.applyArabicShaping=t.applyArabicShaping,e.plugin.processBidirectionalText=t.processBidirectionalText,e.plugin.processStyledBidirectionalText=t.processStyledBidirectionalText}}L.prototype.load=function(e){var t=this.options,r=t.log,i=t.minZoom,n=t.maxZoom,o=t.nodeSize;r&&console.time("total time");var a,s,l,u="prepare "+e.length+" points";r&&console.time(u),this.points=e;for(var c=[],p=0;p<e.length;p++)e[p].geometry&&c.push((a=p,l=(s=e[p].geometry.coordinates)[1],{x:q(s[0]),y:U(l),zoom:1/0,index:a,parentId:-1}));this.trees[n+1]=new O(c,V,G,o,Float32Array),r&&console.timeEnd(u);for(var h=n;i<=h;h--){var d=+Date.now();c=this._cluster(c,h),this.trees[h]=new O(c,V,G,o,Float32Array),r&&console.log("z%d: %d clusters in %dms",h,c.length,Date.now()-d)}return r&&console.timeEnd("total time"),this},L.prototype.getClusters=function(e,t){var r=((e[0]+180)%360+360)%360-180,i=Math.max(-90,Math.min(90,e[1])),n=180===e[2]?180:((e[2]+180)%360+360)%360-180,o=Math.max(-90,Math.min(90,e[3]));if(360<=e[2]-e[0])r=-180,n=180;else if(n<r){var a=this.getClusters([r,i,180,o],t),s=this.getClusters([-180,i,n,o],t);return a.concat(s)}for(var l=this.trees[this._limitZoom(t)],u=[],c=0,p=l.range(q(r),U(o),q(n),U(i));c<p.length;c+=1){var h=l.points[p[c]];u.push(h.numPoints?B(h):this.points[h.index])}return u},L.prototype.getChildren=function(e){var t=this._getOriginId(e),r=this._getOriginZoom(e),i="No cluster with the specified id.",n=this.trees[r];if(!n)throw new Error(i);var o=n.points[t];if(!o)throw new Error(i);for(var a=this.options.radius/(this.options.extent*Math.pow(2,r-1)),s=[],l=0,u=n.within(o.x,o.y,a);l<u.length;l+=1){var c=n.points[u[l]];c.parentId===e&&s.push(c.numPoints?B(c):this.points[c.index])}if(0===s.length)throw new Error(i);return s},L.prototype.getLeaves=function(e,t,r){var i=[];return this._appendLeaves(i,e,t=t||10,r=r||0,0),i},L.prototype.getTile=function(e,t,r){var i=this.trees[this._limitZoom(e)],n=Math.pow(2,e),o=this.options,a=o.radius/o.extent,s=(r-a)/n,l=(r+1+a)/n,u={features:[]};return this._addTileFeatures(i.range((t-a)/n,s,(t+1+a)/n,l),i.points,t,r,n,u),0===t&&this._addTileFeatures(i.range(1-a/n,s,1,l),i.points,n,r,n,u),t===n-1&&this._addTileFeatures(i.range(0,s,a/n,l),i.points,-1,r,n,u),u.features.length?u:null},L.prototype.getClusterExpansionZoom=function(e){for(var t=this._getOriginZoom(e)-1;t<=this.options.maxZoom;){var r=this.getChildren(e);if(t++,1!==r.length)break;e=r[0].properties.cluster_id}return t},L.prototype._appendLeaves=function(e,t,r,i,n){for(var o=0,a=this.getChildren(t);o<a.length;o+=1){var s=a[o],l=s.properties;if(l&&l.cluster?n+l.point_count<=i?n+=l.point_count:n=this._appendLeaves(e,l.cluster_id,r,i,n):n<i?n++:e.push(s),e.length===r)break}return n},L.prototype._addTileFeatures=function(e,t,r,i,n,o){for(var a=0,s=e;a<s.length;a+=1){var l=t[s[a]],u=l.numPoints,c={type:1,geometry:[[Math.round(this.options.extent*(l.x*n-r)),Math.round(this.options.extent*(l.y*n-i))]],tags:u?F(l):this.points[l.index].properties},p=void 0;u?p=l.id:this.options.generateId?p=l.index:this.points[l.index].id&&(p=this.points[l.index].id),void 0!==p&&(c.id=p),o.features.push(c)}},L.prototype._limitZoom=function(e){return Math.max(this.options.minZoom,Math.min(+e,this.options.maxZoom+1))},L.prototype._cluster=function(e,t){for(var r=[],i=this.options,n=i.reduce,o=i.minPoints,a=i.radius/(i.extent*Math.pow(2,t)),s=0;s<e.length;s++){var l=e[s];if(!(l.zoom<=t)){l.zoom=t;for(var u=this.trees[t+1],c=u.within(l.x,l.y,a),p=l.numPoints||1,h=p,d=0,m=c;d<m.length;d+=1){var f=u.points[m[d]];f.zoom>t&&(h+=f.numPoints||1)}if(o<=h){for(var y=l.x*p,g=l.y*p,v=n&&1<p?this._map(l,!0):null,_=(s<<5)+(t+1)+this.points.length,b=0,x=c;b<x.length;b+=1){var w=u.points[x[b]];if(!(w.zoom<=t)){w.zoom=t;var S=w.numPoints||1;y+=w.x*S,g+=w.y*S,w.parentId=_,n&&n(v=v||this._map(l,!0),this._map(w))}}l.parentId=_,r.push({x:y/h,y:g/h,zoom:1/0,id:_,parentId:-1,numPoints:h,properties:v})}else if(r.push(l),1<h)for(var T=0,C=c;T<C.length;T+=1){var E=u.points[C[T]];E.zoom<=t||(E.zoom=t,r.push(E))}}}return r},L.prototype._getOriginId=function(e){return e-this.points.length>>5},L.prototype._getOriginZoom=function(e){return(e-this.points.length)%32},fe.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!(L.prototype._map=function(e,t){if(e.numPoints)return t?j({},e.properties):e.properties;var r=this.points[e.index].properties,i=this.options.map(r);return t&&i===r?j({},i):i}),promoteId:null,generateId:!1,debug:0},fe.prototype.splitTile=function(e,t,r,i,n,o,a){for(var s=[e,t,r,i],l=this.options,u=l.debug;s.length;){i=s.pop(),r=s.pop(),t=s.pop(),e=s.pop();var c=1<<t,p=ye(t,r,i),h=this.tiles[p];if(!h&&(1<u&&console.time("creation"),h=this.tiles[p]=he(e,t,r,i,l),this.tileCoords.push({z:t,x:r,y:i}),u)){1<u&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",t,r,i,h.numFeatures,h.numPoints,h.numSimplified),console.timeEnd("creation"));var d="z"+t;this.stats[d]=(this.stats[d]||0)+1,this.total++}if(h.source=e,n){if(t===l.maxZoom||t===n)continue;var m=1<<n-t;if(r!==Math.floor(o/m)||i!==Math.floor(a/m))continue}else if(t===l.indexMaxZoom||h.numPoints<=l.indexMaxPoints)continue;if(h.source=null,0!==e.length){1<u&&console.time("clipping");var f,y,g,v,_,b,x=.5*l.buffer/l.extent,w=.5-x,S=.5+x,T=1+x;f=y=g=v=null,_=ee(e,c,r-x,r+S,0,h.minX,h.maxX,l),b=ee(e,c,r+w,r+T,0,h.minX,h.maxX,l),e=null,_&&(f=ee(_,c,i-x,i+S,1,h.minY,h.maxY,l),y=ee(_,c,i+w,i+T,1,h.minY,h.maxY,l),_=null),b&&(g=ee(b,c,i-x,i+S,1,h.minY,h.maxY,l),v=ee(b,c,i+w,i+T,1,h.minY,h.maxY,l),b=null),1<u&&console.timeEnd("clipping"),s.push(f||[],t+1,2*r,2*i),s.push(y||[],t+1,2*r,2*i+1),s.push(g||[],t+1,2*r+1,2*i),s.push(v||[],t+1,2*r+1,2*i+1)}}},fe.prototype.getTile=function(e,t,r){var i=this.options,n=i.extent,o=i.debug;if(e<0||24<e)return null;var a=1<<e,s=ye(e,t=(t%a+a)%a,r);if(this.tiles[s])return ce(this.tiles[s],n);1<o&&console.log("drilling down to z%d-%d-%d",e,t,r);for(var l,u=e,c=t,p=r;!l&&0<u;)u--,c=Math.floor(c/2),p=Math.floor(p/2),l=this.tiles[ye(u,c,p)];return l&&l.source?(1<o&&console.log("found parent tile z%d-%d-%d",u,c,p),1<o&&console.time("drilling down"),this.splitTile(l.source,u,c,p,e,t,r),1<o&&console.timeEnd("drilling down"),this.tiles[s]?ce(this.tiles[s],n):null):null};var _e,be=(xe.__proto__=_e=l,((xe.prototype=Object.create(_e&&_e.prototype)).constructor=xe).prototype.loadData=function(e,t){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),this._pendingCallback=t,this._pendingLoadDataParams=e,this._state&&"Idle"!==this._state?this._state="NeedsLoadData":(this._state="Coalescing",this._loadData())},xe.prototype._loadData=function(){var t=this;if(this._pendingCallback&&this._pendingLoadDataParams){var r=this._pendingCallback,i=this._pendingLoadDataParams;delete this._pendingCallback,delete this._pendingLoadDataParams;var n=!!(i&&i.request&&i.request.collectResourceTiming)&&new e.RequestPerformance(i.request);this.loadGeoJSON(i,(function(o,a){if(o||!a)return r(o);if("object"!=typeof a)return r(new Error("Input data given to '"+i.source+"' is not a valid GeoJSON object."));!function e(t,r){var i,n=t&&t.type;if("FeatureCollection"===n)for(i=0;i<t.features.length;i++)e(t.features[i],r);else if("GeometryCollection"===n)for(i=0;i<t.geometries.length;i++)e(t.geometries[i],r);else if("Feature"===n)e(t.geometry,r);else if("Polygon"===n)p(t.coordinates,r);else if("MultiPolygon"===n)for(i=0;i<t.coordinates.length;i++)p(t.coordinates[i],r);return t}(a,!0);try{t._geoJSONIndex=i.cluster?new L(function(){var t=i.superclusterOptions,r=i.clusterProperties;if(!r||!t)return t;for(var n={},o={},a={accumulated:null,zoom:0},s={properties:null},l=Object.keys(r),u=0,c=l;u<c.length;u+=1){var p=c[u],h=r[p],d=h[0],m=e.createExpression(h[1]),f=e.createExpression("string"==typeof d?[d,["accumulated"],["get",p]]:d);n[p]=m.value,o[p]=f.value}return t.map=function(e){s.properties=e;for(var t={},r=0,i=l;r<i.length;r+=1){var o=i[r];t[o]=n[o].evaluate(a,s)}return t},t.reduce=function(e,t){s.properties=t;for(var r=0,i=l;r<i.length;r+=1){var n=i[r];a.accumulated=e[n],e[n]=o[n].evaluate(a,s)}},t}()).load(a.features):new fe(a,i.geojsonVtOptions)}catch(o){return r(o)}t.loaded={};var s={};if(n){var l=n.finish();l&&(s.resourceTiming={},s.resourceTiming[i.source]=JSON.parse(JSON.stringify(l)))}r(null,s)}))}},xe.prototype.coalesce=function(){"Coalescing"===this._state?this._state="Idle":"NeedsLoadData"===this._state&&(this._state="Coalescing",this._loadData())},xe.prototype.reloadTile=function(e,t){var r=this.loaded;return r&&r[e.uid]?_e.prototype.reloadTile.call(this,e,t):this.loadTile(e,t)},xe.prototype.loadGeoJSON=function(t,r){if(t.request)e.getJSON(t.request,r);else{if("string"!=typeof t.data)return r(new Error("Input data given to '"+t.source+"' is not a valid GeoJSON object."));try{return r(null,JSON.parse(t.data))}catch(e){return r(new Error("Input data given to '"+t.source+"' is not a valid GeoJSON object."))}}},xe.prototype.removeSource=function(e,t){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),t()},xe.prototype.getClusterExpansionZoom=function(e,t){try{t(null,this._geoJSONIndex.getClusterExpansionZoom(e.clusterId))}catch(e){t(e)}},xe.prototype.getClusterChildren=function(e,t){try{t(null,this._geoJSONIndex.getChildren(e.clusterId))}catch(e){t(e)}},xe.prototype.getClusterLeaves=function(e,t){try{t(null,this._geoJSONIndex.getLeaves(e.clusterId,e.limit,e.offset))}catch(e){t(e)}},xe);function xe(e,t,r,i){_e.call(this,e,t,r,ge),i&&(this.loadGeoJSON=i)}return ve.prototype.setReferrer=function(e,t){this.referrer=t},ve.prototype.setImages=function(e,t,r){for(var i in this.availableImages[e]=t,this.workerSources[e]){var n=this.workerSources[e][i];for(var o in n)n[o].availableImages=t}r()},ve.prototype.setLayers=function(e,t,r){this.getLayerIndex(e).replace(t),r()},ve.prototype.updateLayers=function(e,t,r){this.getLayerIndex(e).update(t.layers,t.removedIds),r()},ve.prototype.loadTile=function(e,t,r){this.getWorkerSource(e,t.type,t.source).loadTile(t,r)},ve.prototype.loadDEMTile=function(e,t,r){this.getDEMWorkerSource(e,t.source).loadTile(t,r)},ve.prototype.reloadTile=function(e,t,r){this.getWorkerSource(e,t.type,t.source).reloadTile(t,r)},ve.prototype.abortTile=function(e,t,r){this.getWorkerSource(e,t.type,t.source).abortTile(t,r)},ve.prototype.removeTile=function(e,t,r){this.getWorkerSource(e,t.type,t.source).removeTile(t,r)},ve.prototype.removeDEMTile=function(e,t){this.getDEMWorkerSource(e,t.source).removeTile(t)},ve.prototype.removeSource=function(e,t,r){if(this.workerSources[e]&&this.workerSources[e][t.type]&&this.workerSources[e][t.type][t.source]){var i=this.workerSources[e][t.type][t.source];delete this.workerSources[e][t.type][t.source],void 0!==i.removeSource?i.removeSource(t,r):r()}},ve.prototype.loadWorkerSource=function(e,t,r){try{this.self.importScripts(t.url),r()}catch(e){r(e.toString())}},ve.prototype.syncRTLPluginState=function(t,r,i){try{e.plugin.setState(r);var n=e.plugin.getPluginURL();if(e.plugin.isLoaded()&&!e.plugin.isParsed()&&null!=n){this.self.importScripts(n);var o=e.plugin.isParsed();i(o?void 0:new Error("RTL Text Plugin failed to import scripts from "+n),o)}}catch(t){i(t.toString())}},ve.prototype.getAvailableImages=function(e){var t=this.availableImages[e];return t||[]},ve.prototype.getLayerIndex=function(e){var t=this.layerIndexes[e];return t||(this.layerIndexes[e]=new i)},ve.prototype.getWorkerSource=function(e,t,r){var i=this;return this.workerSources[e]||(this.workerSources[e]={}),this.workerSources[e][t]||(this.workerSources[e][t]={}),this.workerSources[e][t][r]||(this.workerSources[e][t][r]=new this.workerSourceTypes[t]({send:function(t,r,n){i.actor.send(t,r,n,e)}},this.getLayerIndex(e),this.getAvailableImages(e))),this.workerSources[e][t][r]},ve.prototype.getDEMWorkerSource=function(e,t){return this.demWorkerSources[e]||(this.demWorkerSources[e]={}),this.demWorkerSources[e][t]||(this.demWorkerSources[e][t]=new u),this.demWorkerSources[e][t]},ve.prototype.enforceCacheSizeLimit=function(t,r){e.enforceCacheSizeLimit(r)},"undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof self&&self instanceof WorkerGlobalScope&&(self.worker=new ve(self)),ve})),r(0,(function(e){var t=e.createCommonjsModule((function(e){function t(e){return!r(e)}function r(e){return"undefined"==typeof window||"undefined"==typeof document?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if("Worker"in window&&"Blob"in window&&"URL"in window){var e,t,r=new Blob([""],{type:"text/javascript"}),i=URL.createObjectURL(r);try{t=new Worker(i),e=!0}catch(t){e=!1}return t&&t.terminate(),URL.revokeObjectURL(i),e}}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var e=document.createElement("canvas");e.width=e.height=1;var t=e.getContext("2d");if(t){var r=t.getImageData(0,0,1,1);return r&&r.width===e.width}}()?(void 0===i[r=e&&e.failIfMajorPerformanceCaveat]&&(i[r]=function(){var e,i,n,o=(e=r,i=document.createElement("canvas"),(n=Object.create(t.webGLContextAttributes)).failIfMajorPerformanceCaveat=e,i.probablySupportsContext?i.probablySupportsContext("webgl",n)||i.probablySupportsContext("experimental-webgl",n):i.supportsContext?i.supportsContext("webgl",n)||i.supportsContext("experimental-webgl",n):i.getContext("webgl",n)||i.getContext("experimental-webgl",n));if(!o)return!1;var a=o.createShader(o.VERTEX_SHADER);return!(!a||o.isContextLost())&&(o.shaderSource(a,"void main() {}"),o.compileShader(a),!0===o.getShaderParameter(a,o.COMPILE_STATUS))}()),i[r]?void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var r}e.exports?e.exports=t:window&&(window.mapboxgl=window.mapboxgl||{},window.mapboxgl.supported=t,window.mapboxgl.notSupportedReason=r);var i={};t.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0}})),r={create:function(t,r,i){var n=e.window.document.createElement(t);return void 0!==r&&(n.className=r),i&&i.appendChild(n),n},createNS:function(t,r){return e.window.document.createElementNS(t,r)}},i=e.window.document&&e.window.document.documentElement.style;function n(e){if(!i)return e[0];for(var t=0;t<e.length;t++)if(e[t]in i)return e[t];return e[0]}var o,a=n(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]);r.disableDrag=function(){i&&a&&(o=i[a],i[a]="none")},r.enableDrag=function(){i&&a&&(i[a]=o)};var s=n(["transform","WebkitTransform"]),l=!(r.setTransform=function(e,t){e.style[s]=t});try{var u=Object.defineProperty({},"passive",{get:function(){l=!0}});e.window.addEventListener("test",u,u),e.window.removeEventListener("test",u,u)}catch(e){l=!1}r.addEventListener=function(e,t,r,i){void 0===i&&(i={}),e.addEventListener(t,r,"passive"in i&&l?i:i.capture)},r.removeEventListener=function(e,t,r,i){void 0===i&&(i={}),e.removeEventListener(t,r,"passive"in i&&l?i:i.capture)};var c=function(t){t.preventDefault(),t.stopPropagation(),e.window.removeEventListener("click",c,!0)};r.suppressClick=function(){e.window.addEventListener("click",c,!0),e.window.setTimeout((function(){e.window.removeEventListener("click",c,!0)}),0)},r.mousePos=function(t,r){var i=t.getBoundingClientRect();return new e.Point(r.clientX-i.left-t.clientLeft,r.clientY-i.top-t.clientTop)},r.touchPos=function(t,r){for(var i=t.getBoundingClientRect(),n=[],o=0;o<r.length;o++)n.push(new e.Point(r[o].clientX-i.left-t.clientLeft,r[o].clientY-i.top-t.clientTop));return n},r.mouseButton=function(t){return void 0!==e.window.InstallTrigger&&2===t.button&&t.ctrlKey&&0<=e.window.navigator.platform.toUpperCase().indexOf("MAC")?0:t.button},r.remove=function(e){e.parentNode&&e.parentNode.removeChild(e)};var p,h=((p=e.Evented)&&(y.__proto__=p),((y.prototype=Object.create(p&&p.prototype)).constructor=y).prototype.isLoaded=function(){return this.loaded},y.prototype.setLoaded=function(e){if(this.loaded!==e&&(this.loaded=e)){for(var t=0,r=this.requestors;t<r.length;t+=1){var i=r[t];this._notify(i.ids,i.callback)}this.requestors=[]}},y.prototype.getImage=function(e){return this.images[e]},y.prototype.addImage=function(e,t){this._validate(e,t)&&(this.images[e]=t)},y.prototype._validate=function(t,r){var i=!0;return this._validateStretch(r.stretchX,r.data&&r.data.width)||(this.fire(new e.ErrorEvent(new Error('Image "'+t+'" has invalid "stretchX" value'))),i=!1),this._validateStretch(r.stretchY,r.data&&r.data.height)||(this.fire(new e.ErrorEvent(new Error('Image "'+t+'" has invalid "stretchY" value'))),i=!1),this._validateContent(r.content,r)||(this.fire(new e.ErrorEvent(new Error('Image "'+t+'" has invalid "content" value'))),i=!1),i},y.prototype._validateStretch=function(e,t){if(!e)return!0;for(var r=0,i=0,n=e;i<n.length;i+=1){var o=n[i];if(o[0]<r||o[1]<o[0]||t<o[1])return!1;r=o[1]}return!0},y.prototype._validateContent=function(e,t){return!(e&&(4!==e.length||e[0]<0||t.data.width<e[0]||e[1]<0||t.data.height<e[1]||e[2]<0||t.data.width<e[2]||e[3]<0||t.data.height<e[3]||e[2]<e[0]||e[3]<e[1]))},y.prototype.updateImage=function(e,t){t.version=this.images[e].version+1,this.images[e]=t,this.updatedImages[e]=!0},y.prototype.removeImage=function(e){var t=this.images[e];delete this.images[e],delete this.patterns[e],t.userImage&&t.userImage.onRemove&&t.userImage.onRemove()},y.prototype.listImages=function(){return Object.keys(this.images)},y.prototype.getImages=function(e,t){var r=!0;if(!this.isLoaded())for(var i=0,n=e;i<n.length;i+=1)this.images[n[i]]||(r=!1);this.isLoaded()||r?this._notify(e,t):this.requestors.push({ids:e,callback:t})},y.prototype._notify=function(t,r){for(var i={},n=0,o=t;n<o.length;n+=1){var a=o[n];this.images[a]||this.fire(new e.Event("styleimagemissing",{id:a}));var s=this.images[a];s?i[a]={data:s.data.clone(),pixelRatio:s.pixelRatio,sdf:s.sdf,version:s.version,stretchX:s.stretchX,stretchY:s.stretchY,content:s.content,hasRenderCallback:Boolean(s.userImage&&s.userImage.render)}:e.warnOnce('Image "'+a+'" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.')}r(null,i)},y.prototype.getPixelSize=function(){var e=this.atlasImage;return{width:e.width,height:e.height}},y.prototype.getPattern=function(t){var r=this.patterns[t],i=this.getImage(t);if(!i)return null;if(r&&r.position.version===i.version)return r.position;if(r)r.position.version=i.version;else{var n={w:i.data.width+2,h:i.data.height+2,x:0,y:0},o=new e.ImagePosition(n,i);this.patterns[t]={bin:n,position:o}}return this._updatePatternAtlas(),this.patterns[t].position},y.prototype.bind=function(t){var r=t.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new e.Texture(t,this.atlasImage,r.RGBA),this.atlasTexture.bind(r.LINEAR,r.CLAMP_TO_EDGE)},y.prototype._updatePatternAtlas=function(){var t=[];for(var r in this.patterns)t.push(this.patterns[r].bin);var i=e.potpack(t),n=i.w,o=i.h,a=this.atlasImage;for(var s in a.resize({width:n||1,height:o||1}),this.patterns){var l=this.patterns[s].bin,u=l.x+1,c=l.y+1,p=this.images[s].data,h=p.width,d=p.height;e.RGBAImage.copy(p,a,{x:0,y:0},{x:u,y:c},{width:h,height:d}),e.RGBAImage.copy(p,a,{x:0,y:d-1},{x:u,y:c-1},{width:h,height:1}),e.RGBAImage.copy(p,a,{x:0,y:0},{x:u,y:c+d},{width:h,height:1}),e.RGBAImage.copy(p,a,{x:h-1,y:0},{x:u-1,y:c},{width:1,height:d}),e.RGBAImage.copy(p,a,{x:0,y:0},{x:u+h,y:c},{width:1,height:d})}this.dirty=!0},y.prototype.beginFrame=function(){this.callbackDispatchedThisFrame={}},y.prototype.dispatchRenderCallbacks=function(e){for(var t=0,r=e;t<r.length;t+=1){var i=r[t];if(!this.callbackDispatchedThisFrame[i]){this.callbackDispatchedThisFrame[i]=!0;var n=this.images[i];a=void 0,(a=(o=n).userImage)&&a.render&&a.render()&&(o.data.replace(new Uint8Array(a.data.buffer)),1)&&this.updateImage(i,n)}}var o,a},y),d=g,m=g,f=1e20;function y(){p.call(this),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new e.RGBAImage({width:1,height:1}),this.dirty=!0}function g(e,t,r,i,n,o){this.fontSize=e||24,this.buffer=void 0===t?3:t,this.cutoff=i||.25,this.fontFamily=n||"sans-serif",this.fontWeight=o||"normal",this.radius=r||8;var a=this.size=this.fontSize+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=a,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(a*a),this.gridInner=new Float64Array(a*a),this.f=new Float64Array(a),this.d=new Float64Array(a),this.z=new Float64Array(a+1),this.v=new Int16Array(a),this.middle=Math.round(a/2*(0<=navigator.userAgent.indexOf("Gecko/")?1.2:1))}function v(e,t,r,i,n,o,a){for(var s=0;s<t;s++){for(var l=0;l<r;l++)i[l]=e[l*t+s];for(_(i,n,o,a,r),l=0;l<r;l++)e[l*t+s]=n[l]}for(l=0;l<r;l++){for(s=0;s<t;s++)i[s]=e[l*t+s];for(_(i,n,o,a,t),s=0;s<t;s++)e[l*t+s]=Math.sqrt(n[s])}}function _(e,t,r,i,n){i[r[0]=0]=-f,i[1]=+f;for(var o=1,a=0;o<n;o++){for(var s=(e[o]+o*o-(e[r[a]]+r[a]*r[a]))/(2*o-2*r[a]);s<=i[a];)a--,s=(e[o]+o*o-(e[r[a]]+r[a]*r[a]))/(2*o-2*r[a]);r[++a]=o,i[a]=s,i[a+1]=+f}for(a=o=0;o<n;o++){for(;i[a+1]<o;)a++;t[o]=(o-r[a])*(o-r[a])+e[r[a]]}}function b(e,t){this.requestManager=e,this.localIdeographFontFamily=t,this.entries={}}function x(){this.specification=e.styleSpec.light.position}function w(e,t){this.width=e,this.height=t,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}g.prototype.draw=function(e){this.ctx.clearRect(0,0,this.size,this.size),this.ctx.fillText(e,this.buffer,this.middle);for(var t=this.ctx.getImageData(0,0,this.size,this.size),r=new Uint8ClampedArray(this.size*this.size),i=0;i<this.size*this.size;i++){var n=t.data[4*i+3]/255;this.gridOuter[i]=1==n?0:0==n?f:Math.pow(Math.max(0,.5-n),2),this.gridInner[i]=1==n?f:0==n?0:Math.pow(Math.max(0,n-.5),2)}for(v(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z),v(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z),i=0;i<this.size*this.size;i++)r[i]=Math.max(0,Math.min(255,Math.round(255-255*((this.gridOuter[i]-this.gridInner[i])/this.radius+this.cutoff))));return r},d.default=m,b.prototype.setURL=function(e){this.url=e},b.prototype.getGlyphs=function(t,r){var i=this,n=[];for(var o in t)for(var a=0,s=t[o];a<s.length;a+=1)n.push({stack:o,id:s[a]});e.asyncAll(n,(function(e,t){var r=e.stack,n=e.id,o=i.entries[r],a=(o=o||(i.entries[r]={glyphs:{},requests:{},ranges:{}})).glyphs[n];if(void 0===a){if(a=i._tinySDF(o,r,n))return o.glyphs[n]=a,void t(null,{stack:r,id:n,glyph:a});var s=Math.floor(n/256);if(65535<256*s)t(new Error("glyphs > 65535 not supported"));else if(o.ranges[s])t(null,{stack:r,id:n,glyph:a});else{var l=o.requests[s];l||(l=o.requests[s]=[],b.loadGlyphRange(r,s,i.url,i.requestManager,(function(e,t){if(t){for(var r in t)i._doesCharSupportLocalGlyph(+r)||(o.glyphs[+r]=t[+r]);o.ranges[s]=!0}for(var n=0,a=l;n<a.length;n+=1)(0,a[n])(e,t);delete o.requests[s]}))),l.push((function(e,i){e?t(e):i&&t(null,{stack:r,id:n,glyph:i[n]||null})}))}}else t(null,{stack:r,id:n,glyph:a})}),(function(e,t){if(e)r(e);else if(t){for(var i={},n=0,o=t;n<o.length;n+=1){var a=o[n],s=a.stack,l=a.id,u=a.glyph;(i[s]||(i[s]={}))[l]=u&&{id:u.id,bitmap:u.bitmap.clone(),metrics:u.metrics}}r(null,i)}}))},b.prototype._doesCharSupportLocalGlyph=function(t){return!!this.localIdeographFontFamily&&(e.isChar["CJK Unified Ideographs"](t)||e.isChar["Hangul Syllables"](t)||e.isChar.Hiragana(t)||e.isChar.Katakana(t))},b.prototype._tinySDF=function(t,r,i){var n=this.localIdeographFontFamily;if(n&&this._doesCharSupportLocalGlyph(i)){var o=t.tinySDF;if(!o){var a="400";/bold/i.test(r)?a="900":/medium/i.test(r)?a="500":/light/i.test(r)&&(a="200"),o=t.tinySDF=new b.TinySDF(24,3,8,.25,n,a)}return{id:i,bitmap:new e.AlphaImage({width:30,height:30},o.draw(String.fromCharCode(i))),metrics:{width:24,height:24,left:0,top:-8,advance:24}}}},b.loadGlyphRange=function(t,r,i,n,o){var a=256*r,s=255+a,l=n.transformRequest(n.normalizeGlyphsURL(i).replace("{fontstack}",t).replace("{range}",a+"-"+s),e.ResourceType.Glyphs);e.getArrayBuffer(l,(function(t,r){if(t)o(t);else if(r){for(var i={},n=0,a=e.parseGlyphPBF(r);n<a.length;n+=1){var s=a[n];i[s.id]=s}o(null,i)}}))},b.TinySDF=d,x.prototype.possiblyEvaluate=function(t,r){return e.sphericalToCartesian(t.expression.evaluate(r))},x.prototype.interpolate=function(t,r,i){return{x:e.number(t.x,r.x,i),y:e.number(t.y,r.y,i),z:e.number(t.z,r.z,i)}};var S,T=new e.Properties({anchor:new e.DataConstantProperty(e.styleSpec.light.anchor),position:new x,color:new e.DataConstantProperty(e.styleSpec.light.color),intensity:new e.DataConstantProperty(e.styleSpec.light.intensity)}),C=((S=e.Evented)&&(E.__proto__=S),((E.prototype=Object.create(S&&S.prototype)).constructor=E).prototype.getLight=function(){return this._transitionable.serialize()},E.prototype.setLight=function(t,r){if(void 0===r&&(r={}),!this._validate(e.validateLight,t,r))for(var i in t){var n=t[i];e.endsWith(i,"-transition")?this._transitionable.setTransition(i.slice(0,-"-transition".length),n):this._transitionable.setValue(i,n)}},E.prototype.updateTransitions=function(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)},E.prototype.hasTransition=function(){return this._transitioning.hasTransition()},E.prototype.recalculate=function(e){this.properties=this._transitioning.possiblyEvaluate(e)},E.prototype._validate=function(t,r,i){return(!i||!1!==i.validate)&&e.emitValidationErrors(this,t.call(e.validateStyle,e.extend({value:r,style:{glyphs:!0,sprite:!0},styleSpec:e.styleSpec})))},E);function E(t){S.call(this),this._transitionable=new e.Transitionable(T),this.setLight(t),this._transitioning=this._transitionable.untransitioned()}function I(t,r){this.workerPool=t,this.actors=[],this.currentActor=0,this.id=e.uniqueId();for(var i=this.workerPool.acquire(this.id),n=0;n<i.length;n++){var o=new I.Actor(i[n],r,this.id);o.name="Worker "+n,this.actors.push(o)}}function P(t,r,i){function n(n,o){if(n)return i(n);if(o){var a=e.pick(e.extend(o,t),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);o.vector_layers&&(a.vectorLayers=o.vector_layers,a.vectorLayerIds=a.vectorLayers.map((function(e){return e.id}))),a.tiles=r.canonicalizeTileset(a,t.url),i(null,a)}}return t.url?e.getJSON(r.transformRequest(r.normalizeSourceURL(t.url),e.ResourceType.Source),n):e.browser.frame((function(){return n(null,t)}))}function R(t,r,i){this.bounds=e.LngLatBounds.convert(this.validateBounds(t)),this.minzoom=r||0,this.maxzoom=i||24}w.prototype.getDash=function(e,t){var r=e.join(",")+String(t);return this.dashEntry[r]||(this.dashEntry[r]=this.addDash(e,t)),this.dashEntry[r]},w.prototype.getDashRanges=function(e,t,r){var i=[],n=e.length%2==1?-e[e.length-1]*r:0,o=e[0]*r,a=!0;i.push({left:n,right:o,isDash:a,zeroLength:0===e[0]});for(var s=e[0],l=1;l<e.length;l++){var u=e[l];i.push({left:n=s*r,right:o=(s+=u)*r,isDash:a=!a,zeroLength:0===u})}return i},w.prototype.addRoundDash=function(e,t,r){for(var i=t/2,n=-r;n<=r;n++)for(var o=this.width*(this.nextRow+r+n),a=0,s=e[a],l=0;l<this.width;l++){1<l/s.right&&(s=e[++a]);var u=Math.abs(l-s.left),c=Math.abs(l-s.right),p=Math.min(u,c),h=void 0,d=n/r*(1+i);if(s.isDash){var m=i-Math.abs(d);h=Math.sqrt(p*p+m*m)}else h=i-Math.sqrt(p*p+d*d);this.data[o+l]=Math.max(0,Math.min(255,h+128))}},w.prototype.addRegularDash=function(e){for(var t=e.length-1;0<=t;--t){var r=e[t],i=e[t+1];r.zeroLength?e.splice(t,1):i&&i.isDash===r.isDash&&(i.left=r.left,e.splice(t,1))}var n=e[0],o=e[e.length-1];n.isDash===o.isDash&&(n.left=o.left-this.width,o.right=n.right+this.width);for(var a=this.width*this.nextRow,s=0,l=e[s],u=0;u<this.width;u++){1<u/l.right&&(l=e[++s]);var c=Math.abs(u-l.left),p=Math.abs(u-l.right),h=Math.min(c,p);this.data[a+u]=Math.max(0,Math.min(255,(l.isDash?h:-h)+128))}},w.prototype.addDash=function(t,r){var i=r?7:0,n=2*i+1;if(this.nextRow+n>this.height)return e.warnOnce("LineAtlas out of space"),null;for(var o=0,a=0;a<t.length;a++)o+=t[a];if(0!==o){var s=this.width/o,l=this.getDashRanges(t,this.width,s);r?this.addRoundDash(l,s,i):this.addRegularDash(l)}var u={y:(this.nextRow+i+.5)/this.height,height:2*i/this.height,width:o};return this.nextRow+=n,this.dirty=!0,u},w.prototype.bind=function(e){var t=e.gl;this.texture?(t.bindTexture(t.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,t.texSubImage2D(t.TEXTURE_2D,0,0,0,this.width,this.height,t.ALPHA,t.UNSIGNED_BYTE,this.data))):(this.texture=t.createTexture(),t.bindTexture(t.TEXTURE_2D,this.texture),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.REPEAT),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.REPEAT),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texImage2D(t.TEXTURE_2D,0,t.ALPHA,this.width,this.height,0,t.ALPHA,t.UNSIGNED_BYTE,this.data))},I.prototype.broadcast=function(t,r,i){e.asyncAll(this.actors,(function(e,i){e.send(t,r,i)}),i=i||function(){})},I.prototype.getActor=function(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]},I.prototype.remove=function(){this.actors.forEach((function(e){e.remove()})),this.actors=[],this.workerPool.release(this.id)},I.Actor=e.Actor,R.prototype.validateBounds=function(e){return Array.isArray(e)&&4===e.length?[Math.max(-180,e[0]),Math.max(-90,e[1]),Math.min(180,e[2]),Math.min(90,e[3])]:[-180,-90,180,90]},R.prototype.contains=function(t){var r=Math.pow(2,t.z),i=Math.floor(e.mercatorXfromLng(this.bounds.getWest())*r),n=Math.floor(e.mercatorYfromLat(this.bounds.getNorth())*r),o=Math.ceil(e.mercatorXfromLng(this.bounds.getEast())*r),a=Math.ceil(e.mercatorYfromLat(this.bounds.getSouth())*r);return t.x>=i&&t.x<o&&t.y>=n&&t.y<a};var N,A,z,M,k,O,L,D=((L=e.Evented)&&($.__proto__=L),(($.prototype=Object.create(L&&L.prototype)).constructor=$).prototype.load=function(){var t=this;this._loaded=!1,this.fire(new e.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=P(this._options,this.map._requestManager,(function(r,i){t._tileJSONRequest=null,t._loaded=!0,r?t.fire(new e.ErrorEvent(r)):i&&(e.extend(t,i),i.bounds&&(t.tileBounds=new R(i.bounds,t.minzoom,t.maxzoom)),e.postTurnstileEvent(i.tiles,t.map._requestManager._customAccessToken),e.postMapLoadEvent(i.tiles,t.map._getMapId(),t.map._requestManager._skuToken,t.map._requestManager._customAccessToken),t.fire(new e.Event("data",{dataType:"source",sourceDataType:"metadata"})),t.fire(new e.Event("data",{dataType:"source",sourceDataType:"content"})))}))},$.prototype.loaded=function(){return this._loaded},$.prototype.hasTile=function(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)},$.prototype.onAdd=function(e){this.map=e,this.load()},$.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},$.prototype.serialize=function(){return e.extend({},this._options)},$.prototype.loadTile=function(t,r){var i=this.map._requestManager.normalizeTileURL(t.tileID.canonical.url(this.tiles,this.scheme)),n={request:this.map._requestManager.transformRequest(i,e.ResourceType.Tile),uid:t.uid,tileID:t.tileID,zoom:t.tileID.overscaledZ,tileSize:this.tileSize*t.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:e.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function o(i,n){return delete t.request,t.aborted?r(null):i&&404!==i.status?r(i):(n&&n.resourceTiming&&(t.resourceTiming=n.resourceTiming),this.map._refreshExpiredTiles&&n&&t.setExpiryData(n),t.loadVectorData(n,this.map.painter),e.cacheEntryPossiblyAdded(this.dispatcher),r(null),void(t.reloadCallback&&(this.loadTile(t,t.reloadCallback),t.reloadCallback=null)))}n.request.collectResourceTiming=this._collectResourceTiming,t.actor&&"expired"!==t.state?"loading"===t.state?t.reloadCallback=r:t.request=t.actor.send("reloadTile",n,o.bind(this)):(t.actor=this.dispatcher.getActor(),t.request=t.actor.send("loadTile",n,o.bind(this)))},$.prototype.abortTile=function(e){e.request&&(e.request.cancel(),delete e.request),e.actor&&e.actor.send("abortTile",{uid:e.uid,type:this.type,source:this.id},void 0)},$.prototype.unloadTile=function(e){e.unloadVectorData(),e.actor&&e.actor.send("removeTile",{uid:e.uid,type:this.type,source:this.id},void 0)},$.prototype.hasTransition=function(){return!1},$),B=((O=e.Evented)&&(J.__proto__=O),((J.prototype=Object.create(O&&O.prototype)).constructor=J).prototype.load=function(){var t=this;this._loaded=!1,this.fire(new e.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=P(this._options,this.map._requestManager,(function(r,i){t._tileJSONRequest=null,t._loaded=!0,r?t.fire(new e.ErrorEvent(r)):i&&(e.extend(t,i),i.bounds&&(t.tileBounds=new R(i.bounds,t.minzoom,t.maxzoom)),e.postTurnstileEvent(i.tiles),e.postMapLoadEvent(i.tiles,t.map._getMapId(),t.map._requestManager._skuToken),t.fire(new e.Event("data",{dataType:"source",sourceDataType:"metadata"})),t.fire(new e.Event("data",{dataType:"source",sourceDataType:"content"})))}))},J.prototype.loaded=function(){return this._loaded},J.prototype.onAdd=function(e){this.map=e,this.load()},J.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},J.prototype.serialize=function(){return e.extend({},this._options)},J.prototype.hasTile=function(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)},J.prototype.loadTile=function(t,r){var i=this,n=this.map._requestManager.normalizeTileURL(t.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);t.request=e.getImage(this.map._requestManager.transformRequest(n,e.ResourceType.Tile),(function(n,o){if(delete t.request,t.aborted)t.state="unloaded",r(null);else if(n)t.state="errored",r(n);else if(o){i.map._refreshExpiredTiles&&t.setExpiryData(o),delete o.cacheControl,delete o.expires;var a=i.map.painter.context,s=a.gl;t.texture=i.map.painter.getTileTexture(o.width),t.texture?t.texture.update(o,{useMipmap:!0}):(t.texture=new e.Texture(a,o,s.RGBA,{useMipmap:!0}),t.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE,s.LINEAR_MIPMAP_NEAREST),a.extTextureFilterAnisotropic&&s.texParameterf(s.TEXTURE_2D,a.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,a.extTextureFilterAnisotropicMax)),t.state="loaded",e.cacheEntryPossiblyAdded(i.dispatcher),r(null)}}))},J.prototype.abortTile=function(e,t){e.request&&(e.request.cancel(),delete e.request),t()},J.prototype.unloadTile=function(e,t){e.texture&&this.map.painter.saveTileTexture(e.texture),t()},J.prototype.hasTransition=function(){return!1},J),F=(Y.__proto__=k=B,((Y.prototype=Object.create(k&&k.prototype)).constructor=Y).prototype.serialize=function(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}},Y.prototype.loadTile=function(t,r){var i=this.map._requestManager.normalizeTileURL(t.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);t.request=e.getImage(this.map._requestManager.transformRequest(i,e.ResourceType.Tile),function(i,n){if(delete t.request,t.aborted)t.state="unloaded",r(null);else if(i)t.state="errored",r(i);else if(n){this.map._refreshExpiredTiles&&t.setExpiryData(n),delete n.cacheControl,delete n.expires;var o=e.window.ImageBitmap&&n instanceof e.window.ImageBitmap&&e.offscreenCanvasSupported()?n:e.browser.getImageData(n,1),a={uid:t.uid,coord:t.tileID,source:this.id,rawImageData:o,encoding:this.encoding};t.actor&&"expired"!==t.state||(t.actor=this.dispatcher.getActor(),t.actor.send("loadDEMTile",a,function(e,i){e&&(t.state="errored",r(e)),i&&(t.dem=i,t.needsHillshadePrepare=!0,t.state="loaded",r(null))}.bind(this)))}}.bind(this)),t.neighboringTiles=this._getNeighboringTiles(t.tileID)},Y.prototype._getNeighboringTiles=function(t){var r=t.canonical,i=Math.pow(2,r.z),n=(r.x-1+i)%i,o=0===r.x?t.wrap-1:t.wrap,a=(r.x+1+i)%i,s=r.x+1===i?t.wrap+1:t.wrap,l={};return l[new e.OverscaledTileID(t.overscaledZ,o,r.z,n,r.y).key]={backfilled:!1},l[new e.OverscaledTileID(t.overscaledZ,s,r.z,a,r.y).key]={backfilled:!1},0<r.y&&(l[new e.OverscaledTileID(t.overscaledZ,o,r.z,n,r.y-1).key]={backfilled:!1},l[new e.OverscaledTileID(t.overscaledZ,t.wrap,r.z,r.x,r.y-1).key]={backfilled:!1},l[new e.OverscaledTileID(t.overscaledZ,s,r.z,a,r.y-1).key]={backfilled:!1}),r.y+1<i&&(l[new e.OverscaledTileID(t.overscaledZ,o,r.z,n,r.y+1).key]={backfilled:!1},l[new e.OverscaledTileID(t.overscaledZ,t.wrap,r.z,r.x,r.y+1).key]={backfilled:!1},l[new e.OverscaledTileID(t.overscaledZ,s,r.z,a,r.y+1).key]={backfilled:!1}),l},Y.prototype.unloadTile=function(e){e.demTexture&&this.map.painter.saveTileTexture(e.demTexture),e.fbo&&(e.fbo.destroy(),delete e.fbo),e.dem&&delete e.dem,delete e.neighboringTiles,e.state="unloaded",e.actor&&e.actor.send("removeDEMTile",{uid:e.uid,source:this.id})},Y),q=((M=e.Evented)&&(X.__proto__=M),((X.prototype=Object.create(M&&M.prototype)).constructor=X).prototype.load=function(){var t=this;this.fire(new e.Event("dataloading",{dataType:"source"})),this._updateWorkerData((function(r){if(r)t.fire(new e.ErrorEvent(r));else{var i={dataType:"source",sourceDataType:"metadata"};t._collectResourceTiming&&t._resourceTiming&&0<t._resourceTiming.length&&(i.resourceTiming=t._resourceTiming,t._resourceTiming=[]),t.fire(new e.Event("data",i))}}))},X.prototype.onAdd=function(e){this.map=e,this.load()},X.prototype.setData=function(t){var r=this;return this._data=t,this.fire(new e.Event("dataloading",{dataType:"source"})),this._updateWorkerData((function(t){if(t)r.fire(new e.ErrorEvent(t));else{var i={dataType:"source",sourceDataType:"content"};r._collectResourceTiming&&r._resourceTiming&&0<r._resourceTiming.length&&(i.resourceTiming=r._resourceTiming,r._resourceTiming=[]),r.fire(new e.Event("data",i))}})),this},X.prototype.getClusterExpansionZoom=function(e,t){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:e,source:this.id},t),this},X.prototype.getClusterChildren=function(e,t){return this.actor.send("geojson.getClusterChildren",{clusterId:e,source:this.id},t),this},X.prototype.getClusterLeaves=function(e,t,r,i){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:e,limit:t,offset:r},i),this},X.prototype._updateWorkerData=function(t){var r=this;this._loaded=!1;var i=e.extend({},this.workerOptions),n=this._data;"string"==typeof n?(i.request=this.map._requestManager.transformRequest(e.browser.resolveURL(n),e.ResourceType.Source),i.request.collectResourceTiming=this._collectResourceTiming):i.data=JSON.stringify(n),this.actor.send(this.type+".loadData",i,(function(e,n){r._removed||n&&n.abandoned||(r._loaded=!0,n&&n.resourceTiming&&n.resourceTiming[r.id]&&(r._resourceTiming=n.resourceTiming[r.id].slice(0)),r.actor.send(r.type+".coalesce",{source:i.source},null),t(e))}))},X.prototype.loaded=function(){return this._loaded},X.prototype.loadTile=function(t,r){var i=this,n=t.actor?"reloadTile":"loadTile";t.actor=this.actor,t.request=this.actor.send(n,{type:this.type,uid:t.uid,tileID:t.tileID,zoom:t.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:e.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},(function(e,o){return delete t.request,t.unloadVectorData(),t.aborted?r(null):e?r(e):(t.loadVectorData(o,i.map.painter,"reloadTile"==n),r(null))}))},X.prototype.abortTile=function(e){e.request&&(e.request.cancel(),delete e.request),e.aborted=!0},X.prototype.unloadTile=function(e){e.unloadVectorData(),this.actor.send("removeTile",{uid:e.uid,type:this.type,source:this.id})},X.prototype.onRemove=function(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})},X.prototype.serialize=function(){return e.extend({},this._options,{type:this.type,data:this._data})},X.prototype.hasTransition=function(){return!1},X),U=e.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]),j=((z=e.Evented)&&(K.__proto__=z),((K.prototype=Object.create(z&&z.prototype)).constructor=K).prototype.load=function(t,r){var i=this;this._loaded=!1,this.fire(new e.Event("dataloading",{dataType:"source"})),this.url=this.options.url,e.getImage(this.map._requestManager.transformRequest(this.url,e.ResourceType.Image),(function(n,o){i._loaded=!0,n?i.fire(new e.ErrorEvent(n)):o&&(i.image=o,t&&(i.coordinates=t),r&&r(),i._finishLoading())}))},K.prototype.loaded=function(){return this._loaded},K.prototype.updateImage=function(e){var t=this;return this.image&&e.url&&(this.options.url=e.url,this.load(e.coordinates,(function(){t.texture=null}))),this},K.prototype._finishLoading=function(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new e.Event("data",{dataType:"source",sourceDataType:"metadata"})))},K.prototype.onAdd=function(e){this.map=e,this.load()},K.prototype.setCoordinates=function(t){var r=this,i=(this.coordinates=t).map(e.MercatorCoordinate.fromLngLat);this.tileID=function(){for(var t=1/0,r=1/0,n=-1/0,o=-1/0,a=0,s=i;a<s.length;a+=1){var l=s[a];t=Math.min(t,l.x),r=Math.min(r,l.y),n=Math.max(n,l.x),o=Math.max(o,l.y)}var u=Math.max(n-t,o-r),c=Math.max(0,Math.floor(-Math.log(u)/Math.LN2)),p=Math.pow(2,c);return new e.CanonicalTileID(c,Math.floor((t+n)/2*p),Math.floor((r+o)/2*p))}(),this.minzoom=this.maxzoom=this.tileID.z;var n=i.map((function(e){return r.tileID.getTilePoint(e)._round()}));return this._boundsArray=new e.StructArrayLayout4i8,this._boundsArray.emplaceBack(n[0].x,n[0].y,0,0),this._boundsArray.emplaceBack(n[1].x,n[1].y,e.EXTENT,0),this._boundsArray.emplaceBack(n[3].x,n[3].y,0,e.EXTENT),this._boundsArray.emplaceBack(n[2].x,n[2].y,e.EXTENT,e.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new e.Event("data",{dataType:"source",sourceDataType:"content"})),this},K.prototype.prepare=function(){if(0!==Object.keys(this.tiles).length&&this.image){var t=this.map.painter.context,r=t.gl;for(var i in this.boundsBuffer||(this.boundsBuffer=t.createVertexBuffer(this._boundsArray,U.members)),this.boundsSegments||(this.boundsSegments=e.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new e.Texture(t,this.image,r.RGBA),this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE)),this.tiles){var n=this.tiles[i];"loaded"!==n.state&&(n.state="loaded",n.texture=this.texture)}}},K.prototype.loadTile=function(e,t){this.tileID&&this.tileID.equals(e.tileID.canonical)?(this.tiles[String(e.tileID.wrap)]=e).buckets={}:e.state="errored",t(null)},K.prototype.serialize=function(){return{type:"image",url:this.options.url,coordinates:this.coordinates}},K.prototype.hasTransition=function(){return!1},K),V=(W.__proto__=A=j,((W.prototype=Object.create(A&&A.prototype)).constructor=W).prototype.load=function(){var t=this;this._loaded=!1;var r=this.options;this.urls=[];for(var i=0,n=r.urls;i<n.length;i+=1)this.urls.push(this.map._requestManager.transformRequest(n[i],e.ResourceType.Source).url);e.getVideo(this.urls,(function(r,i){t._loaded=!0,r?t.fire(new e.ErrorEvent(r)):i&&(t.video=i,t.video.loop=!0,t.video.addEventListener("playing",(function(){t.map.triggerRepaint()})),t.map&&t.video.play(),t._finishLoading())}))},W.prototype.pause=function(){this.video&&this.video.pause()},W.prototype.play=function(){this.video&&this.video.play()},W.prototype.seek=function(t){if(this.video){var r=this.video.seekable;t<r.start(0)||t>r.end(0)?this.fire(new e.ErrorEvent(new e.ValidationError("sources."+this.id,null,"Playback for this video can be set only between the "+r.start(0)+" and "+r.end(0)+"-second mark."))):this.video.currentTime=t}},W.prototype.getVideo=function(){return this.video},W.prototype.onAdd=function(e){this.map||(this.map=e,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))},W.prototype.prepare=function(){if(!(0===Object.keys(this.tiles).length||this.video.readyState<2)){var t=this.map.painter.context,r=t.gl;for(var i in this.boundsBuffer||(this.boundsBuffer=t.createVertexBuffer(this._boundsArray,U.members)),this.boundsSegments||(this.boundsSegments=e.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE),r.texSubImage2D(r.TEXTURE_2D,0,0,0,r.RGBA,r.UNSIGNED_BYTE,this.video)):(this.texture=new e.Texture(t,this.video,r.RGBA),this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE)),this.tiles){var n=this.tiles[i];"loaded"!==n.state&&(n.state="loaded",n.texture=this.texture)}}},W.prototype.serialize=function(){return{type:"video",urls:this.urls,coordinates:this.coordinates}},W.prototype.hasTransition=function(){return this.video&&!this.video.paused},W),G=(Z.__proto__=N=j,((Z.prototype=Object.create(N&&N.prototype)).constructor=Z).prototype.load=function(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof e.window.HTMLCanvasElement?this.options.canvas:e.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new e.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())},Z.prototype.getCanvas=function(){return this.canvas},Z.prototype.onAdd=function(e){this.map=e,this.load(),this.canvas&&this.animate&&this.play()},Z.prototype.onRemove=function(){this.pause()},Z.prototype.prepare=function(){var t=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,t=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,t=!0),!this._hasInvalidDimensions()&&0!==Object.keys(this.tiles).length){var r=this.map.painter.context,i=r.gl;for(var n in this.boundsBuffer||(this.boundsBuffer=r.createVertexBuffer(this._boundsArray,U.members)),this.boundsSegments||(this.boundsSegments=e.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(t||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new e.Texture(r,this.canvas,i.RGBA,{premultiply:!0}),this.tiles){var o=this.tiles[n];"loaded"!==o.state&&(o.state="loaded",o.texture=this.texture)}}},Z.prototype.serialize=function(){return{type:"canvas",coordinates:this.coordinates}},Z.prototype.hasTransition=function(){return this._playing},Z.prototype._hasInvalidDimensions=function(){for(var e=0,t=[this.canvas.width,this.canvas.height];e<t.length;e+=1){var r=t[e];if(isNaN(r)||r<=0)return!0}return!1},Z),H={vector:D,raster:B,"raster-dem":F,geojson:q,video:V,image:j,canvas:G};function Z(t,r,i,n){N.call(this,t,r,i,n),r.coordinates?Array.isArray(r.coordinates)&&4===r.coordinates.length&&!r.coordinates.some((function(e){return!Array.isArray(e)||2!==e.length||e.some((function(e){return"number"!=typeof e}))}))||this.fire(new e.ErrorEvent(new e.ValidationError("sources."+t,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new e.ErrorEvent(new e.ValidationError("sources."+t,null,'missing required property "coordinates"'))),r.animate&&"boolean"!=typeof r.animate&&this.fire(new e.ErrorEvent(new e.ValidationError("sources."+t,null,'optional "animate" property must be a boolean value'))),r.canvas?"string"==typeof r.canvas||r.canvas instanceof e.window.HTMLCanvasElement||this.fire(new e.ErrorEvent(new e.ValidationError("sources."+t,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new e.ErrorEvent(new e.ValidationError("sources."+t,null,'missing required property "canvas"'))),this.options=r,this.animate=void 0===r.animate||r.animate}function W(e,t,r,i){A.call(this,e,t,r,i),this.roundZoom=!0,this.type="video",this.options=t}function K(e,t,r,i){z.call(this),this.id=e,this.dispatcher=r,this.coordinates=t.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(i),this.options=t}function X(t,r,i,n){M.call(this),this.id=t,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._loaded=!1,this.actor=i.getActor(),this.setEventedParent(n),this._data=r.data,this._options=e.extend({},r),this._collectResourceTiming=r.collectResourceTiming,this._resourceTiming=[],void 0!==r.maxzoom&&(this.maxzoom=r.maxzoom),r.type&&(this.type=r.type),r.attribution&&(this.attribution=r.attribution),this.promoteId=r.promoteId;var o=e.EXTENT/this.tileSize;this.workerOptions=e.extend({source:this.id,cluster:r.cluster||!1,geojsonVtOptions:{buffer:(void 0!==r.buffer?r.buffer:128)*o,tolerance:(void 0!==r.tolerance?r.tolerance:.375)*o,extent:e.EXTENT,maxZoom:this.maxzoom,lineMetrics:r.lineMetrics||!1,generateId:r.generateId||!1},superclusterOptions:{maxZoom:void 0!==r.clusterMaxZoom?Math.min(r.clusterMaxZoom,this.maxzoom-1):this.maxzoom-1,minPoints:Math.max(2,r.clusterMinPoints||2),extent:e.EXTENT,radius:(r.clusterRadius||50)*o,log:!1,generateId:r.generateId||!1},clusterProperties:r.clusterProperties},r.workerOptions)}function Y(t,r,i,n){k.call(this,t,r,i,n),this.type="raster-dem",this.maxzoom=22,this._options=e.extend({type:"raster-dem"},r),this.encoding=r.encoding||"mapbox"}function J(t,r,i,n){O.call(this),this.id=t,this.dispatcher=i,this.setEventedParent(n),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=e.extend({type:"raster"},r),e.extend(this,e.pick(r,["url","scheme","tileSize"]))}function $(t,r,i,n){if(L.call(this),this.id=t,this.dispatcher=i,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,e.extend(this,e.pick(r,["url","scheme","tileSize","promoteId"])),this._options=e.extend({type:"vector"},r),this._collectResourceTiming=r.collectResourceTiming,512!==this.tileSize)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(n)}function Q(t,r,i,n,o,a){var s,l,u,c=function(e,t,r){if(e)for(var i=0,n=e;i<n.length;i+=1){var o=t[n[i]];if(o&&o.source===r&&"fill-extrusion"===o.type)return!0}else for(var a in t){var s=t[a];if(s.source===r&&"fill-extrusion"===s.type)return!0}return!1}(o&&o.layers,r,t.id),p=a.maxPitchScaleFactor(),h=t.tilesIn(n,p,c);h.sort(ee);for(var d=[],m=0,f=h;m<f.length;m+=1){var y=f[m];d.push({wrappedTileID:y.tileID.wrapped().key,queryResults:y.tile.queryRenderedFeatures(r,i,t._state,y.queryGeometry,y.cameraQueryGeometry,y.scale,o,a,p,(s=t.transform,l=y.tileID,u=e.identity([]),e.translate(u,u,[1,1,0]),e.scale(u,u,[.5*s.width,.5*s.height,1]),e.multiply(u,u,s.calculatePosMatrix(l.toUnwrapped()))))})}var g=function(){for(var e={},t={},r=0,i=d;r<i.length;r+=1){var n=i[r],o=n.queryResults,a=n.wrappedTileID,s=t[a]=t[a]||{};for(var l in o)for(var u=o[l],c=s[l]=s[l]||{},p=e[l]=e[l]||[],h=0,m=u;h<m.length;h+=1){var f=m[h];c[f.featureIndex]||(c[f.featureIndex]=!0,p.push(f))}}return e}();for(var v in g)g[v].forEach((function(e){var r=e.feature,i=t.getFeatureState(r.layer["source-layer"],r.id);r.source=r.layer.source,r.layer["source-layer"]&&(r.sourceLayer=r.layer["source-layer"]),r.state=i}));return g}function ee(e,t){var r=e.tileID,i=t.tileID;return r.overscaledZ-i.overscaledZ||r.canonical.y-i.canonical.y||r.wrap-i.wrap||r.canonical.x-i.canonical.x}function te(e,t){this.max=e,this.onRemove=t,this.reset()}function re(e,t,r){var i=(this.context=e).gl;this.buffer=i.createBuffer(),this.dynamicDraw=Boolean(r),this.context.unbindVAO(),e.bindElementBuffer.set(this.buffer),i.bufferData(i.ELEMENT_ARRAY_BUFFER,t.arrayBuffer,this.dynamicDraw?i.DYNAMIC_DRAW:i.STATIC_DRAW),this.dynamicDraw||delete t.arrayBuffer}function ie(e,t,r,i){this.length=t.length,this.attributes=r,this.itemSize=t.bytesPerElement,this.dynamicDraw=i;var n=(this.context=e).gl;this.buffer=n.createBuffer(),e.bindVertexBuffer.set(this.buffer),n.bufferData(n.ARRAY_BUFFER,t.arrayBuffer,this.dynamicDraw?n.DYNAMIC_DRAW:n.STATIC_DRAW),this.dynamicDraw||delete t.arrayBuffer}te.prototype.reset=function(){for(var e in this.data)for(var t=0,r=this.data[e];t<r.length;t+=1){var i=r[t];i.timeout&&clearTimeout(i.timeout),this.onRemove(i.value)}return this.data={},this.order=[],this},te.prototype.add=function(e,t,r){var i=this,n=e.wrapped().key;void 0===this.data[n]&&(this.data[n]=[]);var o={value:t,timeout:void 0};if(void 0!==r&&(o.timeout=setTimeout((function(){i.remove(e,o)}),r)),this.data[n].push(o),this.order.push(n),this.order.length>this.max){var a=this._getAndRemoveByKey(this.order[0]);a&&this.onRemove(a)}return this},te.prototype.has=function(e){return e.wrapped().key in this.data},te.prototype.getAndRemove=function(e){return this.has(e)?this._getAndRemoveByKey(e.wrapped().key):null},te.prototype._getAndRemoveByKey=function(e){var t=this.data[e].shift();return t.timeout&&clearTimeout(t.timeout),0===this.data[e].length&&delete this.data[e],this.order.splice(this.order.indexOf(e),1),t.value},te.prototype.getByKey=function(e){var t=this.data[e];return t?t[0].value:null},te.prototype.get=function(e){return this.has(e)?this.data[e.wrapped().key][0].value:null},te.prototype.remove=function(e,t){if(!this.has(e))return this;var r=e.wrapped().key,i=void 0===t?0:this.data[r].indexOf(t),n=this.data[r][i];return this.data[r].splice(i,1),n.timeout&&clearTimeout(n.timeout),0===this.data[r].length&&delete this.data[r],this.onRemove(n.value),this.order.splice(this.order.indexOf(r),1),this},te.prototype.setMaxSize=function(e){for(this.max=e;this.order.length>this.max;){var t=this._getAndRemoveByKey(this.order[0]);t&&this.onRemove(t)}return this},te.prototype.filter=function(e){var t=[];for(var r in this.data)for(var i=0,n=this.data[r];i<n.length;i+=1){var o=n[i];e(o.value)||t.push(o)}for(var a=0,s=t;a<s.length;a+=1){var l=s[a];this.remove(l.value.tileID,l)}},re.prototype.bind=function(){this.context.bindElementBuffer.set(this.buffer)},re.prototype.updateData=function(e){var t=this.context.gl;this.context.unbindVAO(),this.bind(),t.bufferSubData(t.ELEMENT_ARRAY_BUFFER,0,e.arrayBuffer)},re.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var ne={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};function oe(e){this.gl=e.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}function ae(e,t,r,i){this.context=e,this.width=t,this.height=r;var n=this.framebuffer=e.gl.createFramebuffer();this.colorAttachment=new _t(e,n),i&&(this.depthAttachment=new bt(e,n))}ie.prototype.bind=function(){this.context.bindVertexBuffer.set(this.buffer)},ie.prototype.updateData=function(e){var t=this.context.gl;this.bind(),t.bufferSubData(t.ARRAY_BUFFER,0,e.arrayBuffer)},ie.prototype.enableAttributes=function(e,t){for(var r=0;r<this.attributes.length;r++){var i=t.attributes[this.attributes[r].name];void 0!==i&&e.enableVertexAttribArray(i)}},ie.prototype.setVertexAttribPointers=function(e,t,r){for(var i=0;i<this.attributes.length;i++){var n=this.attributes[i],o=t.attributes[n.name];void 0!==o&&e.vertexAttribPointer(o,n.components,e[ne[n.type]],!1,this.itemSize,n.offset+this.itemSize*(r||0))}},ie.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)},oe.prototype.get=function(){return this.current},oe.prototype.set=function(e){},oe.prototype.getDefault=function(){return this.default},oe.prototype.setDefault=function(){this.set(this.default)};var se,le,ue,ce,pe,he,de,me,fe,ye,ge,ve,_e,be,xe,we,Se,Te,Ce,Ee,Ie,Pe,Re,Ne,Ae,ze,Me,ke,Oe,Le,De,Be,Fe,qe,Ue=(er.__proto__=qe=oe,((er.prototype=Object.create(qe&&qe.prototype)).constructor=er).prototype.getDefault=function(){return e.Color.transparent},er.prototype.set=function(e){var t=this.current;e.r===t.r&&e.g===t.g&&e.b===t.b&&e.a===t.a&&!this.dirty||(this.gl.clearColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)},er),je=(Qt.__proto__=Fe=oe,((Qt.prototype=Object.create(Fe&&Fe.prototype)).constructor=Qt).prototype.getDefault=function(){return 1},Qt.prototype.set=function(e){e===this.current&&!this.dirty||(this.gl.clearDepth(e),this.current=e,this.dirty=!1)},Qt),Ve=($t.__proto__=Be=oe,(($t.prototype=Object.create(Be&&Be.prototype)).constructor=$t).prototype.getDefault=function(){return 0},$t.prototype.set=function(e){e===this.current&&!this.dirty||(this.gl.clearStencil(e),this.current=e,this.dirty=!1)},$t),Ge=(Jt.__proto__=De=oe,((Jt.prototype=Object.create(De&&De.prototype)).constructor=Jt).prototype.getDefault=function(){return[!0,!0,!0,!0]},Jt.prototype.set=function(e){var t=this.current;e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&!this.dirty||(this.gl.colorMask(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)},Jt),He=(Yt.__proto__=Le=oe,((Yt.prototype=Object.create(Le&&Le.prototype)).constructor=Yt).prototype.getDefault=function(){return!0},Yt.prototype.set=function(e){e===this.current&&!this.dirty||(this.gl.depthMask(e),this.current=e,this.dirty=!1)},Yt),Ze=(Xt.__proto__=Oe=oe,((Xt.prototype=Object.create(Oe&&Oe.prototype)).constructor=Xt).prototype.getDefault=function(){return 255},Xt.prototype.set=function(e){e===this.current&&!this.dirty||(this.gl.stencilMask(e),this.current=e,this.dirty=!1)},Xt),We=(Kt.__proto__=ke=oe,((Kt.prototype=Object.create(ke&&ke.prototype)).constructor=Kt).prototype.getDefault=function(){return{func:this.gl.ALWAYS,ref:0,mask:255}},Kt.prototype.set=function(e){var t=this.current;e.func===t.func&&e.ref===t.ref&&e.mask===t.mask&&!this.dirty||(this.gl.stencilFunc(e.func,e.ref,e.mask),this.current=e,this.dirty=!1)},Kt),Ke=(Wt.__proto__=Me=oe,((Wt.prototype=Object.create(Me&&Me.prototype)).constructor=Wt).prototype.getDefault=function(){var e=this.gl;return[e.KEEP,e.KEEP,e.KEEP]},Wt.prototype.set=function(e){var t=this.current;e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&!this.dirty||(this.gl.stencilOp(e[0],e[1],e[2]),this.current=e,this.dirty=!1)},Wt),Xe=(Zt.__proto__=ze=oe,((Zt.prototype=Object.create(ze&&ze.prototype)).constructor=Zt).prototype.getDefault=function(){return!1},Zt.prototype.set=function(e){if(e!==this.current||this.dirty){var t=this.gl;e?t.enable(t.STENCIL_TEST):t.disable(t.STENCIL_TEST),this.current=e,this.dirty=!1}},Zt),Ye=(Ht.__proto__=Ae=oe,((Ht.prototype=Object.create(Ae&&Ae.prototype)).constructor=Ht).prototype.getDefault=function(){return[0,1]},Ht.prototype.set=function(e){var t=this.current;e[0]===t[0]&&e[1]===t[1]&&!this.dirty||(this.gl.depthRange(e[0],e[1]),this.current=e,this.dirty=!1)},Ht),Je=(Gt.__proto__=Ne=oe,((Gt.prototype=Object.create(Ne&&Ne.prototype)).constructor=Gt).prototype.getDefault=function(){return!1},Gt.prototype.set=function(e){if(e!==this.current||this.dirty){var t=this.gl;e?t.enable(t.DEPTH_TEST):t.disable(t.DEPTH_TEST),this.current=e,this.dirty=!1}},Gt),$e=(Vt.__proto__=Re=oe,((Vt.prototype=Object.create(Re&&Re.prototype)).constructor=Vt).prototype.getDefault=function(){return this.gl.LESS},Vt.prototype.set=function(e){e===this.current&&!this.dirty||(this.gl.depthFunc(e),this.current=e,this.dirty=!1)},Vt),Qe=(jt.__proto__=Pe=oe,((jt.prototype=Object.create(Pe&&Pe.prototype)).constructor=jt).prototype.getDefault=function(){return!1},jt.prototype.set=function(e){if(e!==this.current||this.dirty){var t=this.gl;e?t.enable(t.BLEND):t.disable(t.BLEND),this.current=e,this.dirty=!1}},jt),et=(Ut.__proto__=Ie=oe,((Ut.prototype=Object.create(Ie&&Ie.prototype)).constructor=Ut).prototype.getDefault=function(){var e=this.gl;return[e.ONE,e.ZERO]},Ut.prototype.set=function(e){var t=this.current;e[0]===t[0]&&e[1]===t[1]&&!this.dirty||(this.gl.blendFunc(e[0],e[1]),this.current=e,this.dirty=!1)},Ut),tt=(qt.__proto__=Ee=oe,((qt.prototype=Object.create(Ee&&Ee.prototype)).constructor=qt).prototype.getDefault=function(){return e.Color.transparent},qt.prototype.set=function(e){var t=this.current;e.r===t.r&&e.g===t.g&&e.b===t.b&&e.a===t.a&&!this.dirty||(this.gl.blendColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)},qt),rt=(Ft.__proto__=Ce=oe,((Ft.prototype=Object.create(Ce&&Ce.prototype)).constructor=Ft).prototype.getDefault=function(){return this.gl.FUNC_ADD},Ft.prototype.set=function(e){e===this.current&&!this.dirty||(this.gl.blendEquation(e),this.current=e,this.dirty=!1)},Ft),it=(Bt.__proto__=Te=oe,((Bt.prototype=Object.create(Te&&Te.prototype)).constructor=Bt).prototype.getDefault=function(){return!1},Bt.prototype.set=function(e){if(e!==this.current||this.dirty){var t=this.gl;e?t.enable(t.CULL_FACE):t.disable(t.CULL_FACE),this.current=e,this.dirty=!1}},Bt),nt=(Dt.__proto__=Se=oe,((Dt.prototype=Object.create(Se&&Se.prototype)).constructor=Dt).prototype.getDefault=function(){return this.gl.BACK},Dt.prototype.set=function(e){e===this.current&&!this.dirty||(this.gl.cullFace(e),this.current=e,this.dirty=!1)},Dt),ot=(Lt.__proto__=we=oe,((Lt.prototype=Object.create(we&&we.prototype)).constructor=Lt).prototype.getDefault=function(){return this.gl.CCW},Lt.prototype.set=function(e){e===this.current&&!this.dirty||(this.gl.frontFace(e),this.current=e,this.dirty=!1)},Lt),at=(Ot.__proto__=xe=oe,((Ot.prototype=Object.create(xe&&xe.prototype)).constructor=Ot).prototype.getDefault=function(){return null},Ot.prototype.set=function(e){e===this.current&&!this.dirty||(this.gl.useProgram(e),this.current=e,this.dirty=!1)},Ot),st=(kt.__proto__=be=oe,((kt.prototype=Object.create(be&&be.prototype)).constructor=kt).prototype.getDefault=function(){return this.gl.TEXTURE0},kt.prototype.set=function(e){e===this.current&&!this.dirty||(this.gl.activeTexture(e),this.current=e,this.dirty=!1)},kt),lt=(Mt.__proto__=_e=oe,((Mt.prototype=Object.create(_e&&_e.prototype)).constructor=Mt).prototype.getDefault=function(){var e=this.gl;return[0,0,e.drawingBufferWidth,e.drawingBufferHeight]},Mt.prototype.set=function(e){var t=this.current;e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&!this.dirty||(this.gl.viewport(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)},Mt),ut=(zt.__proto__=ve=oe,((zt.prototype=Object.create(ve&&ve.prototype)).constructor=zt).prototype.getDefault=function(){return null},zt.prototype.set=function(e){if(e!==this.current||this.dirty){var t=this.gl;t.bindFramebuffer(t.FRAMEBUFFER,e),this.current=e,this.dirty=!1}},zt),ct=(At.__proto__=ge=oe,((At.prototype=Object.create(ge&&ge.prototype)).constructor=At).prototype.getDefault=function(){return null},At.prototype.set=function(e){if(e!==this.current||this.dirty){var t=this.gl;t.bindRenderbuffer(t.RENDERBUFFER,e),this.current=e,this.dirty=!1}},At),pt=(Nt.__proto__=ye=oe,((Nt.prototype=Object.create(ye&&ye.prototype)).constructor=Nt).prototype.getDefault=function(){return null},Nt.prototype.set=function(e){if(e!==this.current||this.dirty){var t=this.gl;t.bindTexture(t.TEXTURE_2D,e),this.current=e,this.dirty=!1}},Nt),ht=(Rt.__proto__=fe=oe,((Rt.prototype=Object.create(fe&&fe.prototype)).constructor=Rt).prototype.getDefault=function(){return null},Rt.prototype.set=function(e){if(e!==this.current||this.dirty){var t=this.gl;t.bindBuffer(t.ARRAY_BUFFER,e),this.current=e,this.dirty=!1}},Rt),dt=(Pt.__proto__=me=oe,((Pt.prototype=Object.create(me&&me.prototype)).constructor=Pt).prototype.getDefault=function(){return null},Pt.prototype.set=function(e){var t=this.gl;t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,e),this.current=e,this.dirty=!1},Pt),mt=(It.__proto__=de=oe,((It.prototype=Object.create(de&&de.prototype)).constructor=It).prototype.getDefault=function(){return null},It.prototype.set=function(e){this.vao&&(e!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(e),this.current=e,this.dirty=!1)},It),ft=(Et.__proto__=he=oe,((Et.prototype=Object.create(he&&he.prototype)).constructor=Et).prototype.getDefault=function(){return 4},Et.prototype.set=function(e){if(e!==this.current||this.dirty){var t=this.gl;t.pixelStorei(t.UNPACK_ALIGNMENT,e),this.current=e,this.dirty=!1}},Et),yt=(Ct.__proto__=pe=oe,((Ct.prototype=Object.create(pe&&pe.prototype)).constructor=Ct).prototype.getDefault=function(){return!1},Ct.prototype.set=function(e){if(e!==this.current||this.dirty){var t=this.gl;t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e),this.current=e,this.dirty=!1}},Ct),gt=(Tt.__proto__=ce=oe,((Tt.prototype=Object.create(ce&&ce.prototype)).constructor=Tt).prototype.getDefault=function(){return!1},Tt.prototype.set=function(e){if(e!==this.current||this.dirty){var t=this.gl;t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,e),this.current=e,this.dirty=!1}},Tt),vt=(St.__proto__=ue=oe,((St.prototype=Object.create(ue&&ue.prototype)).constructor=St).prototype.getDefault=function(){return null},St),_t=(wt.__proto__=le=vt,((wt.prototype=Object.create(le&&le.prototype)).constructor=wt).prototype.setDirty=function(){this.dirty=!0},wt.prototype.set=function(e){if(e!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var t=this.gl;t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e,0),this.current=e,this.dirty=!1}},wt),bt=(xt.__proto__=se=vt,((xt.prototype=Object.create(se&&se.prototype)).constructor=xt).prototype.set=function(e){if(e!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var t=this.gl;t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.RENDERBUFFER,e),this.current=e,this.dirty=!1}},xt);function xt(){se.apply(this,arguments)}function wt(){le.apply(this,arguments)}function St(e,t){ue.call(this,e),this.context=e,this.parent=t}function Tt(){ce.apply(this,arguments)}function Ct(){pe.apply(this,arguments)}function Et(){he.apply(this,arguments)}function It(e){de.call(this,e),this.vao=e.extVertexArrayObject}function Pt(){me.apply(this,arguments)}function Rt(){fe.apply(this,arguments)}function Nt(){ye.apply(this,arguments)}function At(){ge.apply(this,arguments)}function zt(){ve.apply(this,arguments)}function Mt(){_e.apply(this,arguments)}function kt(){be.apply(this,arguments)}function Ot(){xe.apply(this,arguments)}function Lt(){we.apply(this,arguments)}function Dt(){Se.apply(this,arguments)}function Bt(){Te.apply(this,arguments)}function Ft(){Ce.apply(this,arguments)}function qt(){Ee.apply(this,arguments)}function Ut(){Ie.apply(this,arguments)}function jt(){Pe.apply(this,arguments)}function Vt(){Re.apply(this,arguments)}function Gt(){Ne.apply(this,arguments)}function Ht(){Ae.apply(this,arguments)}function Zt(){ze.apply(this,arguments)}function Wt(){Me.apply(this,arguments)}function Kt(){ke.apply(this,arguments)}function Xt(){Oe.apply(this,arguments)}function Yt(){Le.apply(this,arguments)}function Jt(){De.apply(this,arguments)}function $t(){Be.apply(this,arguments)}function Qt(){Fe.apply(this,arguments)}function er(){qe.apply(this,arguments)}ae.prototype.destroy=function(){var e=this.context.gl,t=this.colorAttachment.get();if(t&&e.deleteTexture(t),this.depthAttachment){var r=this.depthAttachment.get();r&&e.deleteRenderbuffer(r)}e.deleteFramebuffer(this.framebuffer)};var tr=function(e,t,r){this.func=e,this.mask=t,this.range=r};tr.ReadOnly=!1,tr.ReadWrite=!0,tr.disabled=new tr(519,tr.ReadOnly,[0,1]);var rr=function(e,t,r,i,n,o){this.test=e,this.ref=t,this.mask=r,this.fail=i,this.depthFail=n,this.pass=o};rr.disabled=new rr({func:519,mask:0},0,0,7680,7680,7680);var ir=function(e,t,r){this.blendFunction=e,this.blendColor=t,this.mask=r};ir.disabled=new ir(ir.Replace=[1,0],e.Color.transparent,[!1,!1,!1,!1]),ir.unblended=new ir(ir.Replace,e.Color.transparent,[!0,!0,!0,!0]),ir.alphaBlended=new ir([1,771],e.Color.transparent,[!0,!0,!0,!0]);var nr=function(e,t,r){this.enable=e,this.mode=t,this.frontFace=r};function or(e){this.gl=e,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new Ue(this),this.clearDepth=new je(this),this.clearStencil=new Ve(this),this.colorMask=new Ge(this),this.depthMask=new He(this),this.stencilMask=new Ze(this),this.stencilFunc=new We(this),this.stencilOp=new Ke(this),this.stencilTest=new Xe(this),this.depthRange=new Ye(this),this.depthTest=new Je(this),this.depthFunc=new $e(this),this.blend=new Qe(this),this.blendFunc=new et(this),this.blendColor=new tt(this),this.blendEquation=new rt(this),this.cullFace=new it(this),this.cullFaceSide=new nt(this),this.frontFace=new ot(this),this.program=new at(this),this.activeTexture=new st(this),this.viewport=new lt(this),this.bindFramebuffer=new ut(this),this.bindRenderbuffer=new ct(this),this.bindTexture=new pt(this),this.bindVertexBuffer=new ht(this),this.bindElementBuffer=new dt(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new mt(this),this.pixelStoreUnpack=new ft(this),this.pixelStoreUnpackPremultiplyAlpha=new yt(this),this.pixelStoreUnpackFlipY=new gt(this),this.extTextureFilterAnisotropic=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=e.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=e.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(e.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=e.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=e.getExtension("EXT_disjoint_timer_query")}nr.disabled=new nr(!1,1029,2305),nr.backCCW=new nr(!0,1029,2305),or.prototype.setDefault=function(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()},or.prototype.setDirty=function(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0},or.prototype.createIndexBuffer=function(e,t){return new re(this,e,t)},or.prototype.createVertexBuffer=function(e,t,r){return new ie(this,e,t,r)},or.prototype.createRenderbuffer=function(e,t,r){var i=this.gl,n=i.createRenderbuffer();return this.bindRenderbuffer.set(n),i.renderbufferStorage(i.RENDERBUFFER,e,t,r),this.bindRenderbuffer.set(null),n},or.prototype.createFramebuffer=function(e,t,r){return new ae(this,e,t,r)},or.prototype.clear=function(e){var t=e.color,r=e.depth,i=this.gl,n=0;t&&(n|=i.COLOR_BUFFER_BIT,this.clearColor.set(t),this.colorMask.set([!0,!0,!0,!0])),void 0!==r&&(n|=i.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(r),this.depthMask.set(!0)),i.clear(n)},or.prototype.setCullFace=function(e){!1===e.enable?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(e.mode),this.frontFace.set(e.frontFace))},or.prototype.setDepthMode=function(e){e.func!==this.gl.ALWAYS||e.mask?(this.depthTest.set(!0),this.depthFunc.set(e.func),this.depthMask.set(e.mask),this.depthRange.set(e.range)):this.depthTest.set(!1)},or.prototype.setStencilMode=function(e){e.test.func!==this.gl.ALWAYS||e.mask?(this.stencilTest.set(!0),this.stencilMask.set(e.mask),this.stencilOp.set([e.fail,e.depthFail,e.pass]),this.stencilFunc.set({func:e.test.func,ref:e.ref,mask:e.test.mask})):this.stencilTest.set(!1)},or.prototype.setColorMode=function(t){e.deepEqual(t.blendFunction,ir.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(t.blendFunction),this.blendColor.set(t.blendColor)),this.colorMask.set(t.mask)},or.prototype.unbindVAO=function(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)};var ar,sr=((ar=e.Evented)&&(lr.__proto__=ar),((lr.prototype=Object.create(ar&&ar.prototype)).constructor=lr).prototype.onAdd=function(e){this.map=e,this._maxTileCacheSize=e?e._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(e)},lr.prototype.onRemove=function(e){this._source&&this._source.onRemove&&this._source.onRemove(e)},lr.prototype.loaded=function(){if(this._sourceErrored)return!0;if(!this._sourceLoaded)return!1;if(!this._source.loaded())return!1;for(var e in this._tiles){var t=this._tiles[e];if("loaded"!==t.state&&"errored"!==t.state)return!1}return!0},lr.prototype.getSource=function(){return this._source},lr.prototype.pause=function(){this._paused=!0},lr.prototype.resume=function(){if(this._paused){var e=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,e&&this.reload(),this.transform&&this.update(this.transform)}},lr.prototype._loadTile=function(e,t){return this._source.loadTile(e,t)},lr.prototype._unloadTile=function(e){if(this._source.unloadTile)return this._source.unloadTile(e,(function(){}))},lr.prototype._abortTile=function(e){if(this._source.abortTile)return this._source.abortTile(e,(function(){}))},lr.prototype.serialize=function(){return this._source.serialize()},lr.prototype.prepare=function(e){for(var t in this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null),this._tiles){var r=this._tiles[t];r.upload(e),r.prepare(this.map.style.imageManager)}},lr.prototype.getIds=function(){return e.values(this._tiles).map((function(e){return e.tileID})).sort(ur).map((function(e){return e.key}))},lr.prototype.getRenderableIds=function(t){var r=this,i=[];for(var n in this._tiles)this._isIdRenderable(n,t)&&i.push(this._tiles[n]);return t?i.sort((function(t,i){var n=t.tileID,o=i.tileID,a=new e.Point(n.canonical.x,n.canonical.y)._rotate(r.transform.angle),s=new e.Point(o.canonical.x,o.canonical.y)._rotate(r.transform.angle);return n.overscaledZ-o.overscaledZ||s.y-a.y||s.x-a.x})).map((function(e){return e.tileID.key})):i.map((function(e){return e.tileID})).sort(ur).map((function(e){return e.key}))},lr.prototype.hasRenderableParent=function(e){var t=this.findLoadedParent(e,0);return!!t&&this._isIdRenderable(t.tileID.key)},lr.prototype._isIdRenderable=function(e,t){return this._tiles[e]&&this._tiles[e].hasData()&&!this._coveredTiles[e]&&(t||!this._tiles[e].holdingForFade())},lr.prototype.reload=function(){if(this._paused)this._shouldReloadOnResume=!0;else for(var e in this._cache.reset(),this._tiles)"errored"!==this._tiles[e].state&&this._reloadTile(e,"reloading")},lr.prototype._reloadTile=function(e,t){var r=this._tiles[e];r&&("loading"!==r.state&&(r.state=t),this._loadTile(r,this._tileLoaded.bind(this,r,e,t)))},lr.prototype._tileLoaded=function(t,r,i,n){if(n)return t.state="errored",void(404!==n.status?this._source.fire(new e.ErrorEvent(n,{tile:t})):this.update(this.transform));t.timeAdded=e.browser.now(),"expired"===i&&(t.refreshedUponExpiration=!0),this._setTileReloadTimer(r,t),"raster-dem"===this.getSource().type&&t.dem&&this._backfillDEM(t),this._state.initializeTileState(t,this.map?this.map.painter:null),this._source.fire(new e.Event("data",{dataType:"source",tile:t,coord:t.tileID}))},lr.prototype._backfillDEM=function(e){for(var t=this.getRenderableIds(),r=0;r<t.length;r++){var i=t[r];if(e.neighboringTiles&&e.neighboringTiles[i]){var n=this.getTileByID(i);o(e,n),o(n,e)}}function o(e,t){e.needsHillshadePrepare=!0;var r=t.tileID.canonical.x-e.tileID.canonical.x,i=t.tileID.canonical.y-e.tileID.canonical.y,n=Math.pow(2,e.tileID.canonical.z),o=t.tileID.key;0===r&&0==i||1<Math.abs(i)||(1<Math.abs(r)&&(1===Math.abs(r+n)?r+=n:1===Math.abs(r-n)&&(r-=n)),t.dem&&e.dem&&(e.dem.backfillBorder(t.dem,r,i),e.neighboringTiles&&e.neighboringTiles[o]&&(e.neighboringTiles[o].backfilled=!0)))}},lr.prototype.getTile=function(e){return this.getTileByID(e.key)},lr.prototype.getTileByID=function(e){return this._tiles[e]},lr.prototype._retainLoadedChildren=function(e,t,r,i){for(var n in this._tiles){var o=this._tiles[n];if(!(i[n]||!o.hasData()||o.tileID.overscaledZ<=t||o.tileID.overscaledZ>r)){for(var a=o.tileID;o&&o.tileID.overscaledZ>t+1;){var s=o.tileID.scaledTo(o.tileID.overscaledZ-1);(o=this._tiles[s.key])&&o.hasData()&&(a=s)}for(var l=a;l.overscaledZ>t;)if(e[(l=l.scaledTo(l.overscaledZ-1)).key]){i[a.key]=a;break}}}},lr.prototype.findLoadedParent=function(e,t){if(e.key in this._loadedParentTiles){var r=this._loadedParentTiles[e.key];return r&&r.tileID.overscaledZ>=t?r:null}for(var i=e.overscaledZ-1;t<=i;i--){var n=e.scaledTo(i),o=this._getLoadedTile(n);if(o)return o}},lr.prototype._getLoadedTile=function(e){var t=this._tiles[e.key];return t&&t.hasData()?t:this._cache.getByKey(e.wrapped().key)},lr.prototype.updateCacheSize=function(e){var t=Math.ceil(e.width/this._source.tileSize)+1,r=Math.ceil(e.height/this._source.tileSize)+1,i=Math.floor(t*r*5),n="number"==typeof this._maxTileCacheSize?Math.min(this._maxTileCacheSize,i):i;this._cache.setMaxSize(n)},lr.prototype.handleWrapJump=function(e){var t=Math.round((e-(void 0===this._prevLng?e:this._prevLng))/360);if(this._prevLng=e,t){var r={};for(var i in this._tiles){var n=this._tiles[i];n.tileID=n.tileID.unwrapTo(n.tileID.wrap+t),r[n.tileID.key]=n}for(var o in this._tiles=r,this._timers)clearTimeout(this._timers[o]),delete this._timers[o];for(var a in this._tiles)this._setTileReloadTimer(a,this._tiles[a])}},lr.prototype.update=function(t){var r=this;if(this.transform=t,this._sourceLoaded&&!this._paused){var i;this.updateCacheSize(t),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used?this._source.tileID?i=t.getVisibleUnwrappedCoordinates(this._source.tileID).map((function(t){return new e.OverscaledTileID(t.canonical.z,t.wrap,t.canonical.z,t.canonical.x,t.canonical.y)})):(i=t.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}),this._source.hasTile&&(i=i.filter((function(e){return r._source.hasTile(e)})))):i=[];var n=t.coveringZoomLevel(this._source),o=Math.max(n-lr.maxOverzooming,this._source.minzoom),a=Math.max(n+lr.maxUnderzooming,this._source.minzoom),s=this._updateRetainedTiles(i,n);if(cr(this._source.type)){for(var l={},u={},c=0,p=Object.keys(s);c<p.length;c+=1){var h=p[c],d=s[h],m=this._tiles[h];if(m&&!(m.fadeEndTime&&m.fadeEndTime<=e.browser.now())){var f=this.findLoadedParent(d,o);f&&(this._addTile(f.tileID),l[f.tileID.key]=f.tileID),u[h]=d}}for(var y in this._retainLoadedChildren(u,n,a,s),l)s[y]||(this._coveredTiles[y]=!0,s[y]=l[y])}for(var g in s)this._tiles[g].clearFadeHold();for(var v=0,_=e.keysDifference(this._tiles,s);v<_.length;v+=1){var b=_[v],x=this._tiles[b];x.hasSymbolBuckets&&!x.holdingForFade()?x.setHoldDuration(this.map._fadeDuration):x.hasSymbolBuckets&&!x.symbolFadeFinished()||this._removeTile(b)}this._updateLoadedParentTileCache()}},lr.prototype.releaseSymbolFadeTiles=function(){for(var e in this._tiles)this._tiles[e].holdingForFade()&&this._removeTile(e)},lr.prototype._updateRetainedTiles=function(e,t){for(var r={},i={},n=Math.max(t-lr.maxOverzooming,this._source.minzoom),o=Math.max(t+lr.maxUnderzooming,this._source.minzoom),a={},s=0,l=e;s<l.length;s+=1){var u=l[s],c=this._addTile(u);r[u.key]=u,c.hasData()||t<this._source.maxzoom&&(a[u.key]=u)}this._retainLoadedChildren(a,t,o,r);for(var p=0,h=e;p<h.length;p+=1){var d=h[p],m=this._tiles[d.key];if(!m.hasData()){if(t+1>this._source.maxzoom){var f=d.children(this._source.maxzoom)[0],y=this.getTile(f);if(y&&y.hasData()){r[f.key]=f;continue}}else{var g=d.children(this._source.maxzoom);if(r[g[0].key]&&r[g[1].key]&&r[g[2].key]&&r[g[3].key])continue}for(var v=m.wasRequested(),_=d.overscaledZ-1;n<=_;--_){var b=d.scaledTo(_);if(i[b.key])break;if(i[b.key]=!0,!(m=this.getTile(b))&&v&&(m=this._addTile(b)),m&&(r[b.key]=b,v=m.wasRequested(),m.hasData()))break}}}return r},lr.prototype._updateLoadedParentTileCache=function(){for(var e in this._loadedParentTiles={},this._tiles){for(var t=[],r=void 0,i=this._tiles[e].tileID;0<i.overscaledZ;){if(i.key in this._loadedParentTiles){r=this._loadedParentTiles[i.key];break}t.push(i.key);var n=i.scaledTo(i.overscaledZ-1);if(r=this._getLoadedTile(n))break;i=n}for(var o=0,a=t;o<a.length;o+=1)this._loadedParentTiles[a[o]]=r}},lr.prototype._addTile=function(t){var r=this._tiles[t.key];if(r)return r;(r=this._cache.getAndRemove(t))&&(this._setTileReloadTimer(t.key,r),r.tileID=t,this._state.initializeTileState(r,this.map?this.map.painter:null),this._cacheTimers[t.key]&&(clearTimeout(this._cacheTimers[t.key]),delete this._cacheTimers[t.key],this._setTileReloadTimer(t.key,r)));var i=Boolean(r);return i||(r=new e.Tile(t,this._source.tileSize*t.overscaleFactor()),this._loadTile(r,this._tileLoaded.bind(this,r,t.key,r.state))),r?(r.uses++,this._tiles[t.key]=r,i||this._source.fire(new e.Event("dataloading",{tile:r,coord:r.tileID,dataType:"source"})),r):null},lr.prototype._setTileReloadTimer=function(e,t){var r=this;e in this._timers&&(clearTimeout(this._timers[e]),delete this._timers[e]);var i=t.getExpiryTimeout();i&&(this._timers[e]=setTimeout((function(){r._reloadTile(e,"expired"),delete r._timers[e]}),i))},lr.prototype._removeTile=function(e){var t=this._tiles[e];t&&(t.uses--,delete this._tiles[e],this._timers[e]&&(clearTimeout(this._timers[e]),delete this._timers[e]),0<t.uses||(t.hasData()&&"reloading"!==t.state?this._cache.add(t.tileID,t,t.getExpiryTimeout()):(t.aborted=!0,this._abortTile(t),this._unloadTile(t))))},lr.prototype.clearTiles=function(){for(var e in this._shouldReloadOnResume=!1,this._paused=!1,this._tiles)this._removeTile(e);this._cache.reset()},lr.prototype.tilesIn=function(t,r,i){var n=this,o=[],a=this.transform;if(!a)return o;for(var s=i?a.getCameraQueryGeometry(t):t,l=t.map((function(e){return a.pointCoordinate(e)})),u=s.map((function(e){return a.pointCoordinate(e)})),c=this.getIds(),p=1/0,h=1/0,d=-1/0,m=-1/0,f=0,y=u;f<y.length;f+=1){var g=y[f];p=Math.min(p,g.x),h=Math.min(h,g.y),d=Math.max(d,g.x),m=Math.max(m,g.y)}for(var v=function(t){var i=n._tiles[c[t]];if(!i.holdingForFade()){var s=i.tileID,f=Math.pow(2,a.zoom-i.tileID.overscaledZ),y=r*i.queryPadding*e.EXTENT/i.tileSize/f,g=[s.getTilePoint(new e.MercatorCoordinate(p,h)),s.getTilePoint(new e.MercatorCoordinate(d,m))];if(g[0].x-y<e.EXTENT&&g[0].y-y<e.EXTENT&&0<=g[1].x+y&&0<=g[1].y+y){var v=l.map((function(e){return s.getTilePoint(e)})),_=u.map((function(e){return s.getTilePoint(e)}));o.push({tile:i,tileID:s,queryGeometry:v,cameraQueryGeometry:_,scale:f})}}},_=0;_<c.length;_++)v(_);return o},lr.prototype.getVisibleCoordinates=function(e){for(var t=this,r=this.getRenderableIds(e).map((function(e){return t._tiles[e].tileID})),i=0,n=r;i<n.length;i+=1){var o=n[i];o.posMatrix=this.transform.calculatePosMatrix(o.toUnwrapped())}return r},lr.prototype.hasTransition=function(){if(this._source.hasTransition())return!0;if(cr(this._source.type))for(var t in this._tiles){var r=this._tiles[t];if(void 0!==r.fadeEndTime&&r.fadeEndTime>=e.browser.now())return!0}return!1},lr.prototype.setFeatureState=function(e,t,r){this._state.updateState(e=e||"_geojsonTileLayer",t,r)},lr.prototype.removeFeatureState=function(e,t,r){this._state.removeFeatureState(e=e||"_geojsonTileLayer",t,r)},lr.prototype.getFeatureState=function(e,t){return this._state.getState(e=e||"_geojsonTileLayer",t)},lr.prototype.setDependencies=function(e,t,r){var i=this._tiles[e];i&&i.setDependencies(t,r)},lr.prototype.reloadTilesForDependencies=function(e,t){for(var r in this._tiles)this._tiles[r].hasDependency(e,t)&&this._reloadTile(r,"reloading");this._cache.filter((function(r){return!r.hasDependency(e,t)}))},lr);function lr(t,r,i){var n=this;ar.call(this),this.id=t,this.dispatcher=i,this.on("data",(function(e){"source"===e.dataType&&"metadata"===e.sourceDataType&&(n._sourceLoaded=!0),n._sourceLoaded&&!n._paused&&"source"===e.dataType&&"content"===e.sourceDataType&&(n.reload(),n.transform&&n.update(n.transform))})),this.on("error",(function(){n._sourceErrored=!0})),this._source=function(t,i,n){var o=new H[r.type](t,r,i,n);if(o.id!==t)throw new Error("Expected Source id to be "+t+" instead of "+o.id);return e.bindAll(["load","abort","unload","serialize","prepare"],o),o}(t,i,this),this._tiles={},this._cache=new te(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new e.SourceFeatureState}function ur(e,t){var r=Math.abs(2*e.wrap)-(e.wrap<0),i=Math.abs(2*t.wrap)-(t.wrap<0);return e.overscaledZ-t.overscaledZ||i-r||t.canonical.y-e.canonical.y||t.canonical.x-e.canonical.x}function cr(e){return"raster"===e||"image"===e||"video"===e}function pr(){return new e.window.Worker(Ma.workerUrl)}sr.maxOverzooming=10,sr.maxUnderzooming=3;var hr="mapboxgl_preloaded_worker_pool",dr=function(){this.active={}};dr.prototype.acquire=function(e){if(!this.workers)for(this.workers=[];this.workers.length<dr.workerCount;)this.workers.push(new pr);return this.active[e]=!0,this.workers.slice()},dr.prototype.release=function(e){delete this.active[e],0===this.numActive()&&(this.workers.forEach((function(e){e.terminate()})),this.workers=null)},dr.prototype.isPreloaded=function(){return!!this.active[hr]},dr.prototype.numActive=function(){return Object.keys(this.active).length};var mr,fr=Math.floor(e.browser.hardwareConcurrency/2);function yr(){return mr=mr||new dr}function gr(t,r){var i={};for(var n in t)"ref"!==n&&(i[n]=t[n]);return e.refProperties.forEach((function(e){e in r&&(i[e]=r[e])})),i}function vr(e){e=e.slice();for(var t=Object.create(null),r=0;r<e.length;r++)t[e[r].id]=e[r];for(var i=0;i<e.length;i++)"ref"in e[i]&&(e[i]=gr(e[i],t[e[i].ref]));return e}dr.workerCount=Math.max(Math.min(fr,6),1);var _r={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function br(e,t,r){r.push({command:_r.addSource,args:[e,t[e]]})}function xr(e,t,r){t.push({command:_r.removeSource,args:[e]}),r[e]=!0}function wr(t,r,i){var n;for(n in t[i])if(t[i].hasOwnProperty(n)&&"data"!==n&&!e.deepEqual(t[i][n],r[i][n]))return;for(n in r[i])if(r[i].hasOwnProperty(n)&&"data"!==n&&!e.deepEqual(t[i][n],r[i][n]))return;return 1}function Sr(t,r,i,n,o,a){var s;for(s in r=r||{},t=t||{})t.hasOwnProperty(s)&&(e.deepEqual(t[s],r[s])||i.push({command:a,args:[n,s,r[s],o]}));for(s in r)r.hasOwnProperty(s)&&!t.hasOwnProperty(s)&&(e.deepEqual(t[s],r[s])||i.push({command:a,args:[n,s,r[s],o]}))}function Tr(e){return e.id}function Cr(e,t){return e[t.id]=t,e}function Er(e,t){this.reset(e,t)}function Ir(e,t,r){var i=this.boxCells=[],n=this.circleCells=[];this.xCellCount=Math.ceil(e/r),this.yCellCount=Math.ceil(t/r);for(var o=0;o<this.xCellCount*this.yCellCount;o++)i.push([]),n.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=e,this.height=t,this.xScale=this.xCellCount/e,this.yScale=this.yCellCount/t,this.boxUid=0,this.circleUid=0}function Pr(t,r,i,n,o){var a=e.create();return r?(e.scale(a,a,[1/o,1/o,1]),i||e.rotateZ(a,a,n.angle)):e.multiply(a,n.labelPlaneMatrix,t),a}function Rr(t,r,i,n,o){if(r){var a=e.clone(t);return e.scale(a,a,[o,o,1]),i||e.rotateZ(a,a,-n.angle),a}return n.glCoordMatrix}function Nr(t,r){var i=[t.x,t.y,0,1];qr(i,i,r);var n=i[3];return{point:new e.Point(i[0]/n,i[1]/n),signedDistanceFromCamera:n}}function Ar(e,t){return.5+e/t*.5}function zr(t,r,i,n,o,a,s,l){var u,c,p,h,d=n?t.textSizeData:t.iconSizeData,m=e.evaluateSizeForZoom(d,i.transform.zoom),f=[256/i.width*2+1,256/i.height*2+1],y=n?t.text.dynamicLayoutVertexArray:t.icon.dynamicLayoutVertexArray;y.clear();for(var g=t.lineVertexArray,v=n?t.text.placedSymbolArray:t.icon.placedSymbolArray,_=i.transform.width/i.transform.height,b=!1,x=0;x<v.length;x++){var w=v.get(x);if(w.hidden||w.writingMode===e.WritingMode.vertical&&!b)Fr(w.numGlyphs,y);else{b=!1;var S=[w.anchorX,w.anchorY,0,1];if(e.transformMat4(S,S,r),p=(u=S)[0]/u[3],h=u[1]/u[3],p>=-(c=f)[0]&&p<=c[0]&&h>=-c[1]&&h<=c[1]){var T=Ar(i.transform.cameraToCenterDistance,S[3]),C=e.evaluateSizeForFeature(d,m,w),E=s?C/T:C*T,I=new e.Point(w.anchorX,w.anchorY),P=Nr(I,o).point,R={},N=Or(w,E,!1,l,r,o,a,t.glyphOffsetArray,g,y,P,I,R,_);b=N.useVertical,(N.notEnoughRoom||b||N.needsFlipping&&Or(w,E,!0,l,r,o,a,t.glyphOffsetArray,g,y,P,I,R,_).notEnoughRoom)&&Fr(w.numGlyphs,y)}else Fr(w.numGlyphs,y)}}n?t.text.dynamicLayoutVertexBuffer.updateData(y):t.icon.dynamicLayoutVertexBuffer.updateData(y)}function Mr(e,t,r,i,n,o,a,s,l,u,c){var p=s.glyphStartIndex+s.numGlyphs,h=s.lineStartIndex,d=s.lineStartIndex+s.lineLength,m=t.getoffsetX(s.glyphStartIndex),f=t.getoffsetX(p-1),y=Dr(e*m,r,i,n,o,a,s.segment,h,d,l,u,c);if(!y)return null;var g=Dr(e*f,r,i,n,o,a,s.segment,h,d,l,u,c);return g?{first:y,last:g}:null}function kr(t,r,i,n){return t===e.WritingMode.horizontal&&Math.abs(i.y-r.y)>Math.abs(i.x-r.x)*n?{useVertical:!0}:(t===e.WritingMode.vertical?r.y<i.y:r.x>i.x)?{needsFlipping:!0}:null}function Or(t,r,i,n,o,a,s,l,u,c,p,h,d,m){var f,y=r/24,g=t.lineOffsetX*y,v=t.lineOffsetY*y;if(1<t.numGlyphs){var _=t.glyphStartIndex+t.numGlyphs,b=t.lineStartIndex,x=t.lineStartIndex+t.lineLength,w=Mr(y,l,g,v,i,p,h,t,u,a,d);if(!w)return{notEnoughRoom:!0};var S=Nr(w.first.point,s).point,T=Nr(w.last.point,s).point;if(n&&!i){var C=kr(t.writingMode,S,T,m);if(C)return C}f=[w.first];for(var E=t.glyphStartIndex+1;E<_-1;E++)f.push(Dr(y*l.getoffsetX(E),g,v,i,p,h,t.segment,b,x,u,a,d));f.push(w.last)}else{if(n&&!i){var I=Nr(h,o).point,P=t.lineStartIndex+t.segment+1,R=new e.Point(u.getx(P),u.gety(P)),N=Nr(R,o),A=0<N.signedDistanceFromCamera?N.point:Lr(h,R,I,1,o),z=kr(t.writingMode,I,A,m);if(z)return z}var M=Dr(y*l.getoffsetX(t.glyphStartIndex),g,v,i,p,h,t.segment,t.lineStartIndex,t.lineStartIndex+t.lineLength,u,a,d);if(!M)return{notEnoughRoom:!0};f=[M]}for(var k=0,O=f;k<O.length;k+=1){var L=O[k];e.addDynamicAttributes(c,L.point,L.angle)}return{}}function Lr(e,t,r,i,n){var o=Nr(e.add(e.sub(t)._unit()),n).point,a=r.sub(o);return r.add(a._mult(i/a.mag()))}function Dr(t,r,i,n,o,a,s,l,u,c,p,h){var d=n?t-r:t+r,m=0<d?1:-1,f=0;n&&(m*=-1,f=Math.PI),m<0&&(f+=Math.PI);for(var y=0<m?l+s:l+s+1,g=o,v=o,_=0,b=0,x=Math.abs(d),w=[];_+b<=x;){if((y+=m)<l||u<=y)return null;if(v=g,w.push(g),void 0===(g=h[y])){var S=new e.Point(c.getx(y),c.gety(y)),T=Nr(S,p);if(0<T.signedDistanceFromCamera)g=h[y]=T.point;else{var C=y-m;g=Lr(0===_?a:new e.Point(c.getx(C),c.gety(C)),S,v,x-_+1,p)}}_+=b,b=v.dist(g)}var E=(x-_)/b,I=g.sub(v),P=I.mult(E)._add(v);P._add(I._unit()._perp()._mult(i*m));var R=f+Math.atan2(g.y-v.y,g.x-v.x);return w.push(P),{point:P,angle:R,path:w}}Er.prototype.reset=function(e,t){this.points=e||[],this._distances=[0];for(var r=1;r<this.points.length;r++)this._distances[r]=this._distances[r-1]+this.points[r].dist(this.points[r-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(t||0,.5*this.length),this.paddedLength=this.length-2*this.padding},Er.prototype.lerp=function(t){if(1===this.points.length)return this.points[0];t=e.clamp(t,0,1);for(var r=1,i=this._distances[r],n=t*this.paddedLength+this.padding;i<n&&r<this._distances.length;)i=this._distances[++r];var o=r-1,a=this._distances[o],s=i-a,l=0<s?(n-a)/s:0;return this.points[o].mult(1-l).add(this.points[r].mult(l))},Ir.prototype.keysLength=function(){return this.boxKeys.length+this.circleKeys.length},Ir.prototype.insert=function(e,t,r,i,n){this._forEachCell(t,r,i,n,this._insertBoxCell,this.boxUid++),this.boxKeys.push(e),this.bboxes.push(t),this.bboxes.push(r),this.bboxes.push(i),this.bboxes.push(n)},Ir.prototype.insertCircle=function(e,t,r,i){this._forEachCell(t-i,r-i,t+i,r+i,this._insertCircleCell,this.circleUid++),this.circleKeys.push(e),this.circles.push(t),this.circles.push(r),this.circles.push(i)},Ir.prototype._insertBoxCell=function(e,t,r,i,n,o){this.boxCells[n].push(o)},Ir.prototype._insertCircleCell=function(e,t,r,i,n,o){this.circleCells[n].push(o)},Ir.prototype._query=function(e,t,r,i,n,o){if(r<0||e>this.width||i<0||t>this.height)return!n&&[];var a=[];if(e<=0&&t<=0&&this.width<=r&&this.height<=i){if(n)return!0;for(var s=0;s<this.boxKeys.length;s++)a.push({key:this.boxKeys[s],x1:this.bboxes[4*s],y1:this.bboxes[4*s+1],x2:this.bboxes[4*s+2],y2:this.bboxes[4*s+3]});for(var l=0;l<this.circleKeys.length;l++){var u=this.circles[3*l],c=this.circles[3*l+1],p=this.circles[3*l+2];a.push({key:this.circleKeys[l],x1:u-p,y1:c-p,x2:u+p,y2:c+p})}return o?a.filter(o):a}return this._forEachCell(e,t,r,i,this._queryCell,a,{hitTest:n,seenUids:{box:{},circle:{}}},o),n?0<a.length:a},Ir.prototype._queryCircle=function(e,t,r,i,n){var o=e-r,a=e+r,s=t-r,l=t+r;if(a<0||o>this.width||l<0||s>this.height)return!i&&[];var u=[];return this._forEachCell(o,s,a,l,this._queryCellCircle,u,{hitTest:i,circle:{x:e,y:t,radius:r},seenUids:{box:{},circle:{}}},n),i?0<u.length:u},Ir.prototype.query=function(e,t,r,i,n){return this._query(e,t,r,i,!1,n)},Ir.prototype.hitTest=function(e,t,r,i,n){return this._query(e,t,r,i,!0,n)},Ir.prototype.hitTestCircle=function(e,t,r,i){return this._queryCircle(e,t,r,!0,i)},Ir.prototype._queryCell=function(e,t,r,i,n,o,a,s){var l=a.seenUids,u=this.boxCells[n];if(null!==u)for(var c=this.bboxes,p=0,h=u;p<h.length;p+=1){var d=h[p];if(!l.box[d]){l.box[d]=!0;var m=4*d;if(e<=c[2+m]&&t<=c[3+m]&&r>=c[0+m]&&i>=c[1+m]&&(!s||s(this.boxKeys[d]))){if(a.hitTest)return o.push(!0),!0;o.push({key:this.boxKeys[d],x1:c[m],y1:c[1+m],x2:c[2+m],y2:c[3+m]})}}}var f=this.circleCells[n];if(null!==f)for(var y=this.circles,g=0,v=f;g<v.length;g+=1){var _=v[g];if(!l.circle[_]){l.circle[_]=!0;var b=3*_;if(this._circleAndRectCollide(y[b],y[1+b],y[2+b],e,t,r,i)&&(!s||s(this.circleKeys[_]))){if(a.hitTest)return o.push(!0),!0;var x=y[b],w=y[1+b],S=y[2+b];o.push({key:this.circleKeys[_],x1:x-S,y1:w-S,x2:x+S,y2:w+S})}}}},Ir.prototype._queryCellCircle=function(e,t,r,i,n,o,a,s){var l=a.circle,u=a.seenUids,c=this.boxCells[n];if(null!==c)for(var p=this.bboxes,h=0,d=c;h<d.length;h+=1){var m=d[h];if(!u.box[m]){u.box[m]=!0;var f=4*m;if(this._circleAndRectCollide(l.x,l.y,l.radius,p[0+f],p[1+f],p[2+f],p[3+f])&&(!s||s(this.boxKeys[m])))return o.push(!0),!0}}var y=this.circleCells[n];if(null!==y)for(var g=this.circles,v=0,_=y;v<_.length;v+=1){var b=_[v];if(!u.circle[b]){u.circle[b]=!0;var x=3*b;if(this._circlesCollide(g[x],g[1+x],g[2+x],l.x,l.y,l.radius)&&(!s||s(this.circleKeys[b])))return o.push(!0),!0}}},Ir.prototype._forEachCell=function(e,t,r,i,n,o,a,s){for(var l=this._convertToXCellCoord(e),u=this._convertToYCellCoord(t),c=this._convertToXCellCoord(r),p=this._convertToYCellCoord(i),h=l;h<=c;h++)for(var d=u;d<=p;d++)if(n.call(this,e,t,r,i,this.xCellCount*d+h,o,a,s))return},Ir.prototype._convertToXCellCoord=function(e){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(e*this.xScale)))},Ir.prototype._convertToYCellCoord=function(e){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(e*this.yScale)))},Ir.prototype._circlesCollide=function(e,t,r,i,n,o){var a=i-e,s=n-t,l=r+o;return a*a+s*s<l*l},Ir.prototype._circleAndRectCollide=function(e,t,r,i,n,o,a){var s=(o-i)/2,l=Math.abs(e-(i+s));if(s+r<l)return!1;var u=(a-n)/2,c=Math.abs(t-(n+u));if(u+r<c)return!1;if(l<=s||c<=u)return!0;var p=l-s,h=c-u;return p*p+h*h<=r*r};var Br=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function Fr(e,t){for(var r=0;r<e;r++){var i=t.length;t.resize(i+4),t.float32.set(Br,3*i)}}function qr(e,t,r){var i=t[0],n=t[1];return e[0]=r[0]*i+r[4]*n+r[12],e[1]=r[1]*i+r[5]*n+r[13],e[3]=r[3]*i+r[7]*n+r[15],e}function Ur(e,t,r){void 0===t&&(t=new Ir(e.width+200,e.height+200,25)),void 0===r&&(r=new Ir(e.width+200,e.height+200,25)),this.transform=e,this.grid=t,this.ignoredGrid=r,this.pitchfactor=Math.cos(e._pitch)*e.cameraToCenterDistance,this.screenRightBoundary=e.width+100,this.screenBottomBoundary=e.height+100,this.gridRightBoundary=e.width+200,this.gridBottomBoundary=e.height+200}function jr(t,r,i){return r*(e.EXTENT/(t.tileSize*Math.pow(2,i-t.tileID.overscaledZ)))}function Vr(e,t,r,i){this.opacity=e?Math.max(0,Math.min(1,e.opacity+(e.placed?t:-t))):i&&r?1:0,this.placed=r}function Gr(e,t,r,i,n){this.text=new Vr(e?e.text:null,t,r,n),this.icon=new Vr(e?e.icon:null,t,i,n)}function Hr(e,t,r){this.text=e,this.icon=t,this.skipFade=r}function Zr(){this.invProjMatrix=e.create(),this.viewportMatrix=e.create(),this.circles=[]}function Wr(e,t,r,i,n){this.bucketInstanceId=e,this.featureIndex=t,this.sourceLayerIndex=r,this.bucketIndex=i,this.tileID=n}function Kr(e){this.crossSourceCollisions=e,this.maxGroupID=0,this.collisionGroups={}}function Xr(t,r,i,n,o){var a=e.getAnchorAlignment(t),s=-(a.horizontalAlign-.5)*r,l=-(a.verticalAlign-.5)*i,u=e.evaluateVariableOffset(t,n);return new e.Point(s+u[0]*o,l+u[1]*o)}function Yr(t,r,i,n,o,a){var s=t.x1,l=t.x2,u=t.y1,c=t.y2,p=t.anchorPointX,h=t.anchorPointY,d=new e.Point(r,i);return n&&d._rotate(o?a:-a),{x1:s+d.x,y1:u+d.y,x2:l+d.x,y2:c+d.y,anchorPointX:p,anchorPointY:h}}function Jr(e,t,r,i){this.transform=e.clone(),this.collisionIndex=new Ur(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=t,this.retainedQueryData={},this.collisionGroups=new Kr(r),this.collisionCircleArrays={},(this.prevPlacement=i)&&(i.prevPlacement=void 0),this.placedOrientations={}}function $r(e,t,r,i,n){e.emplaceBack(t?1:0,r?1:0,i||0,n||0),e.emplaceBack(t?1:0,r?1:0,i||0,n||0),e.emplaceBack(t?1:0,r?1:0,i||0,n||0),e.emplaceBack(t?1:0,r?1:0,i||0,n||0)}Ur.prototype.placeCollisionBox=function(e,t,r,i,n){var o=this.projectAndGetPerspectiveRatio(i,e.anchorPointX,e.anchorPointY),a=r*o.perspectiveRatio,s=e.x1*a+o.point.x,l=e.y1*a+o.point.y,u=e.x2*a+o.point.x,c=e.y2*a+o.point.y;return!this.isInsideGrid(s,l,u,c)||!t&&this.grid.hitTest(s,l,u,c,n)?{box:[],offscreen:!1}:{box:[s,l,u,c],offscreen:this.isOffscreen(s,l,u,c)}},Ur.prototype.placeCollisionCircles=function(t,r,i,n,o,a,s,l,u,c,p,h,d){var m=[],f=new e.Point(r.anchorX,r.anchorY),y=Nr(f,a),g=Ar(this.transform.cameraToCenterDistance,y.signedDistanceFromCamera),v=(c?o/g:o*g)/e.ONE_EM,_=Nr(f,s).point,b=Mr(v,n,r.lineOffsetX*v,r.lineOffsetY*v,!1,_,f,r,i,s,{}),x=!1,w=!1,S=!0;if(b){for(var T=.5*h*g+d,C=new e.Point(-100,-100),E=new e.Point(this.screenRightBoundary,this.screenBottomBoundary),I=new Er,P=b.first,R=b.last,N=[],A=P.path.length-1;1<=A;A--)N.push(P.path[A]);for(var z=1;z<R.path.length;z++)N.push(R.path[z]);var M=2.5*T;if(l){var k=N.map((function(e){return Nr(e,l)}));N=k.some((function(e){return e.signedDistanceFromCamera<=0}))?[]:k.map((function(e){return e.point}))}var O=[];if(0<N.length){for(var L=N[0].clone(),D=N[0].clone(),B=1;B<N.length;B++)L.x=Math.min(L.x,N[B].x),L.y=Math.min(L.y,N[B].y),D.x=Math.max(D.x,N[B].x),D.y=Math.max(D.y,N[B].y);O=L.x>=C.x&&D.x<=E.x&&L.y>=C.y&&D.y<=E.y?[N]:D.x<C.x||L.x>E.x||D.y<C.y||L.y>E.y?[]:e.clipLine([N],C.x,C.y,E.x,E.y)}for(var F=0,q=O;F<q.length;F+=1){var U;I.reset(q[F],.25*T),U=I.length<=.5*T?1:Math.ceil(I.paddedLength/M)+1;for(var j=0;j<U;j++){var V=j/Math.max(U-1,1),G=I.lerp(V),H=G.x+100,Z=G.y+100;m.push(H,Z,T,0);var W=H-T,K=Z-T,X=H+T,Y=Z+T;if(S=S&&this.isOffscreen(W,K,X,Y),w=w||this.isInsideGrid(W,K,X,Y),!t&&this.grid.hitTestCircle(H,Z,T,p)&&(x=!0,!u))return{circles:[],offscreen:!1,collisionDetected:x}}}}return{circles:!u&&x||!w?[]:m,offscreen:S,collisionDetected:x}},Ur.prototype.queryRenderedSymbols=function(t){if(0===t.length||0===this.grid.keysLength()&&0===this.ignoredGrid.keysLength())return{};for(var r=[],i=1/0,n=1/0,o=-1/0,a=-1/0,s=0,l=t;s<l.length;s+=1){var u=l[s],c=new e.Point(u.x+100,u.y+100);i=Math.min(i,c.x),n=Math.min(n,c.y),o=Math.max(o,c.x),a=Math.max(a,c.y),r.push(c)}for(var p={},h={},d=0,m=this.grid.query(i,n,o,a).concat(this.ignoredGrid.query(i,n,o,a));d<m.length;d+=1){var f=m[d],y=f.key;if(void 0===p[y.bucketInstanceId]&&(p[y.bucketInstanceId]={}),!p[y.bucketInstanceId][y.featureIndex]){var g=[new e.Point(f.x1,f.y1),new e.Point(f.x2,f.y1),new e.Point(f.x2,f.y2),new e.Point(f.x1,f.y2)];e.polygonIntersectsPolygon(r,g)&&(p[y.bucketInstanceId][y.featureIndex]=!0,void 0===h[y.bucketInstanceId]&&(h[y.bucketInstanceId]=[]),h[y.bucketInstanceId].push(y.featureIndex))}}return h},Ur.prototype.insertCollisionBox=function(e,t,r,i,n){(t?this.ignoredGrid:this.grid).insert({bucketInstanceId:r,featureIndex:i,collisionGroupID:n},e[0],e[1],e[2],e[3])},Ur.prototype.insertCollisionCircles=function(e,t,r,i,n){for(var o=t?this.ignoredGrid:this.grid,a={bucketInstanceId:r,featureIndex:i,collisionGroupID:n},s=0;s<e.length;s+=4)o.insertCircle(a,e[s],e[s+1],e[s+2])},Ur.prototype.projectAndGetPerspectiveRatio=function(t,r,i){var n=[r,i,0,1];return qr(n,n,t),{point:new e.Point((n[0]/n[3]+1)/2*this.transform.width+100,(-n[1]/n[3]+1)/2*this.transform.height+100),perspectiveRatio:.5+this.transform.cameraToCenterDistance/n[3]*.5}},Ur.prototype.isOffscreen=function(e,t,r,i){return r<100||e>=this.screenRightBoundary||i<100||t>this.screenBottomBoundary},Ur.prototype.isInsideGrid=function(e,t,r,i){return 0<=r&&e<this.gridRightBoundary&&0<=i&&t<this.gridBottomBoundary},Ur.prototype.getViewportMatrix=function(){var t=e.identity([]);return e.translate(t,t,[-100,-100,0]),t},Vr.prototype.isHidden=function(){return 0===this.opacity&&!this.placed},Gr.prototype.isHidden=function(){return this.text.isHidden()&&this.icon.isHidden()},Kr.prototype.get=function(e){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[e]){var t=++this.maxGroupID;this.collisionGroups[e]={ID:t,predicate:function(e){return e.collisionGroupID===t}}}return this.collisionGroups[e]},Jr.prototype.getBucketParts=function(t,r,i,n){var o=i.getBucket(r),a=i.latestFeatureIndex;if(o&&a&&r.id===o.layerIds[0]){var s=i.collisionBoxArray,l=o.layers[0].layout,u=Math.pow(2,this.transform.zoom-i.tileID.overscaledZ),c=i.tileSize/e.EXTENT,p=this.transform.calculatePosMatrix(i.tileID.toUnwrapped()),h="map"===l.get("text-pitch-alignment"),d="map"===l.get("text-rotation-alignment"),m=jr(i,1,this.transform.zoom),f=Pr(p,h,d,this.transform,m),y=null;if(h){var g=Rr(p,h,d,this.transform,m);y=e.multiply([],this.transform.labelPlaneMatrix,g)}this.retainedQueryData[o.bucketInstanceId]=new Wr(o.bucketInstanceId,a,o.sourceLayerIndex,o.index,i.tileID);var v={bucket:o,layout:l,posMatrix:p,textLabelPlaneMatrix:f,labelToScreenMatrix:y,scale:u,textPixelRatio:c,holdingForFade:i.holdingForFade(),collisionBoxArray:s,partiallyEvaluatedTextSize:e.evaluateSizeForZoom(o.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(o.sourceID)};if(n)for(var _=0,b=o.sortKeyRanges;_<b.length;_+=1){var x=b[_];t.push({sortKey:x.sortKey,symbolInstanceStart:x.symbolInstanceStart,symbolInstanceEnd:x.symbolInstanceEnd,parameters:v})}else t.push({symbolInstanceStart:0,symbolInstanceEnd:o.symbolInstances.length,parameters:v})}},Jr.prototype.attemptAnchorPlacement=function(e,t,r,i,n,o,a,s,l,u,c,p,h,d,m){var f,y=[p.textOffset0,p.textOffset1],g=Xr(e,r,i,y,n),v=this.collisionIndex.placeCollisionBox(Yr(t,g.x,g.y,o,a,this.transform.angle),c,s,l,u.predicate);if(!m||0!==this.collisionIndex.placeCollisionBox(Yr(m,g.x,g.y,o,a,this.transform.angle),c,s,l,u.predicate).box.length)return 0<v.box.length?(this.prevPlacement&&this.prevPlacement.variableOffsets[p.crossTileID]&&this.prevPlacement.placements[p.crossTileID]&&this.prevPlacement.placements[p.crossTileID].text&&(f=this.prevPlacement.variableOffsets[p.crossTileID].anchor),this.variableOffsets[p.crossTileID]={textOffset:y,width:r,height:i,anchor:e,textBoxScale:n,prevAnchor:f},this.markUsedJustification(h,e,p,d),h.allowVerticalPlacement&&(this.markUsedOrientation(h,d,p),this.placedOrientations[p.crossTileID]=d),{shift:g,placedGlyphBoxes:v}):void 0},Jr.prototype.placeLayerBucketPart=function(t,r,i){var n=this,o=t.parameters,a=o.bucket,s=o.layout,l=o.posMatrix,u=o.textLabelPlaneMatrix,c=o.labelToScreenMatrix,p=o.textPixelRatio,h=o.holdingForFade,d=o.collisionBoxArray,m=o.partiallyEvaluatedTextSize,f=o.collisionGroup,y=s.get("text-optional"),g=s.get("icon-optional"),v=s.get("text-allow-overlap"),_=s.get("icon-allow-overlap"),b="map"===s.get("text-rotation-alignment"),x="map"===s.get("text-pitch-alignment"),w="none"!==s.get("icon-text-fit"),S="viewport-y"===s.get("symbol-z-order"),T=v&&(_||!a.hasIconData()||g),C=_&&(v||!a.hasTextData()||y);function E(t,o){if(!r[t.crossTileID])if(h)n.placements[t.crossTileID]=new Hr(!1,!1,!1);else{var d,S=!1,E=!1,I=!0,P=null,R={box:null,offscreen:null},N={box:null,offscreen:null},A=null,z=null,M=0,k=0,O=0;o.textFeatureIndex?M=o.textFeatureIndex:t.useRuntimeCollisionCircles&&(M=t.featureIndex),o.verticalTextFeatureIndex&&(k=o.verticalTextFeatureIndex);var L=o.textBox;if(L){var D=function(r){var i=e.WritingMode.horizontal;if(a.allowVerticalPlacement&&!r&&n.prevPlacement){var o=n.prevPlacement.placedOrientations[t.crossTileID];o&&(n.placedOrientations[t.crossTileID]=o,n.markUsedOrientation(a,i=o,t))}return i},B=function(r,i){if(a.allowVerticalPlacement&&0<t.numVerticalGlyphVertices&&o.verticalTextBox)for(var n=0,s=a.writingModes;n<s.length&&(s[n]===e.WritingMode.vertical?(R=i(),N=R):R=r(),!(R&&R.box&&R.box.length));n+=1);else R=r()};if(s.get("text-variable-anchor")){var F=s.get("text-variable-anchor");if(n.prevPlacement&&n.prevPlacement.variableOffsets[t.crossTileID]){var q=n.prevPlacement.variableOffsets[t.crossTileID];0<F.indexOf(q.anchor)&&(F=F.filter((function(e){return e!==q.anchor}))).unshift(q.anchor)}var U=function(e,r,i){for(var o=e.x2-e.x1,s=e.y2-e.y1,u=t.textBoxScale,c=w&&!_?r:null,h={box:[],offscreen:!1},d=v?2*F.length:F.length,m=0;m<d;++m){var y=n.attemptAnchorPlacement(F[m%F.length],e,o,s,u,b,x,p,l,f,m>=F.length,t,a,i,c);if(y&&(h=y.placedGlyphBoxes)&&h.box&&h.box.length){S=!0,P=y.shift;break}}return h};B((function(){return U(L,o.iconBox,e.WritingMode.horizontal)}),(function(){var r=o.verticalTextBox;return a.allowVerticalPlacement&&!(R&&R.box&&R.box.length)&&0<t.numVerticalGlyphVertices&&r?U(r,o.verticalIconBox,e.WritingMode.vertical):{box:null,offscreen:null}})),R&&(S=R.box,I=R.offscreen);var j=D(R&&R.box);if(!S&&n.prevPlacement){var V=n.prevPlacement.variableOffsets[t.crossTileID];V&&(n.variableOffsets[t.crossTileID]=V,n.markUsedJustification(a,V.anchor,t,j))}}else{var G=function(e,r){var i=n.collisionIndex.placeCollisionBox(e,v,p,l,f.predicate);return i&&i.box&&i.box.length&&(n.markUsedOrientation(a,r,t),n.placedOrientations[t.crossTileID]=r),i};B((function(){return G(L,e.WritingMode.horizontal)}),(function(){var r=o.verticalTextBox;return a.allowVerticalPlacement&&0<t.numVerticalGlyphVertices&&r?G(r,e.WritingMode.vertical):{box:null,offscreen:null}})),D(R&&R.box&&R.box.length)}}if(S=(d=R)&&d.box&&0<d.box.length,I=d&&d.offscreen,t.useRuntimeCollisionCircles){var H=a.text.placedSymbolArray.get(t.centerJustifiedTextSymbolIndex),Z=e.evaluateSizeForFeature(a.textSizeData,m,H),W=s.get("text-padding");A=n.collisionIndex.placeCollisionCircles(v,H,a.lineVertexArray,a.glyphOffsetArray,Z,l,u,c,i,x,f.predicate,t.collisionCircleDiameter,W),S=v||0<A.circles.length&&!A.collisionDetected,I=I&&A.offscreen}if(o.iconFeatureIndex&&(O=o.iconFeatureIndex),o.iconBox){var K=function(e){var t=w&&P?Yr(e,P.x,P.y,b,x,n.transform.angle):e;return n.collisionIndex.placeCollisionBox(t,_,p,l,f.predicate)};E=N&&N.box&&N.box.length&&o.verticalIconBox?0<(z=K(o.verticalIconBox)).box.length:0<(z=K(o.iconBox)).box.length,I=I&&z.offscreen}var X=y||0===t.numHorizontalGlyphVertices&&0===t.numVerticalGlyphVertices,Y=g||0===t.numIconVertices;if(X||Y?Y?X||(E=E&&S):S=E&&S:E=S=E&&S,S&&d&&d.box&&n.collisionIndex.insertCollisionBox(d.box,s.get("text-ignore-placement"),a.bucketInstanceId,N&&N.box&&k?k:M,f.ID),E&&z&&n.collisionIndex.insertCollisionBox(z.box,s.get("icon-ignore-placement"),a.bucketInstanceId,O,f.ID),A&&(S&&n.collisionIndex.insertCollisionCircles(A.circles,s.get("text-ignore-placement"),a.bucketInstanceId,M,f.ID),i)){var J=a.bucketInstanceId,$=n.collisionCircleArrays[J];void 0===$&&($=n.collisionCircleArrays[J]=new Zr);for(var Q=0;Q<A.circles.length;Q+=4)$.circles.push(A.circles[Q+0]),$.circles.push(A.circles[Q+1]),$.circles.push(A.circles[Q+2]),$.circles.push(A.collisionDetected?1:0)}n.placements[t.crossTileID]=new Hr(S||T,E||C,I||a.justReloaded),r[t.crossTileID]=!0}}if(!a.collisionArrays&&d&&a.deserializeCollisionBoxes(d),S)for(var I=a.getSortedSymbolIndexes(this.transform.angle),P=I.length-1;0<=P;--P){var R=I[P];E(a.symbolInstances.get(R),a.collisionArrays[R])}else for(var N=t.symbolInstanceStart;N<t.symbolInstanceEnd;N++)E(a.symbolInstances.get(N),a.collisionArrays[N]);if(i&&a.bucketInstanceId in this.collisionCircleArrays){var A=this.collisionCircleArrays[a.bucketInstanceId];e.invert(A.invProjMatrix,l),A.viewportMatrix=this.collisionIndex.getViewportMatrix()}a.justReloaded=!1},Jr.prototype.markUsedJustification=function(t,r,i,n){var o;o=n===e.WritingMode.vertical?i.verticalPlacedTextSymbolIndex:{left:i.leftJustifiedTextSymbolIndex,center:i.centerJustifiedTextSymbolIndex,right:i.rightJustifiedTextSymbolIndex}[e.getAnchorJustification(r)];for(var a=0,s=[i.leftJustifiedTextSymbolIndex,i.centerJustifiedTextSymbolIndex,i.rightJustifiedTextSymbolIndex,i.verticalPlacedTextSymbolIndex];a<s.length;a+=1){var l=s[a];0<=l&&(t.text.placedSymbolArray.get(l).crossTileID=0<=o&&l!==o?0:i.crossTileID)}},Jr.prototype.markUsedOrientation=function(t,r,i){for(var n=r===e.WritingMode.horizontal||r===e.WritingMode.horizontalOnly?r:0,o=r===e.WritingMode.vertical?r:0,a=0,s=[i.leftJustifiedTextSymbolIndex,i.centerJustifiedTextSymbolIndex,i.rightJustifiedTextSymbolIndex];a<s.length;a+=1)t.text.placedSymbolArray.get(s[a]).placedOrientation=n;i.verticalPlacedTextSymbolIndex&&(t.text.placedSymbolArray.get(i.verticalPlacedTextSymbolIndex).placedOrientation=o)},Jr.prototype.commit=function(e){this.commitTime=e,this.zoomAtLastRecencyCheck=this.transform.zoom;var t=this.prevPlacement,r=!1;this.prevZoomAdjustment=t?t.zoomAdjustment(this.transform.zoom):0;var i=t?t.symbolFadeChange(e):1,n=t?t.opacities:{},o=t?t.variableOffsets:{},a=t?t.placedOrientations:{};for(var s in this.placements){var l=this.placements[s],u=n[s];r=u?(this.opacities[s]=new Gr(u,i,l.text,l.icon),r||l.text!==u.text.placed||l.icon!==u.icon.placed):(this.opacities[s]=new Gr(null,i,l.text,l.icon,l.skipFade),r||l.text||l.icon)}for(var c in n){var p=n[c];if(!this.opacities[c]){var h=new Gr(p,i,!1,!1);h.isHidden()||(this.opacities[c]=h,r=r||p.text.placed||p.icon.placed)}}for(var d in o)this.variableOffsets[d]||!this.opacities[d]||this.opacities[d].isHidden()||(this.variableOffsets[d]=o[d]);for(var m in a)this.placedOrientations[m]||!this.opacities[m]||this.opacities[m].isHidden()||(this.placedOrientations[m]=a[m]);r?this.lastPlacementChangeTime=e:"number"!=typeof this.lastPlacementChangeTime&&(this.lastPlacementChangeTime=t?t.lastPlacementChangeTime:e)},Jr.prototype.updateLayerOpacities=function(e,t){for(var r={},i=0,n=t;i<n.length;i+=1){var o=n[i],a=o.getBucket(e);a&&o.latestFeatureIndex&&e.id===a.layerIds[0]&&this.updateBucketOpacities(a,r,o.collisionBoxArray)}},Jr.prototype.updateBucketOpacities=function(t,r,i){var n=this;t.hasTextData()&&t.text.opacityVertexArray.clear(),t.hasIconData()&&t.icon.opacityVertexArray.clear(),t.hasIconCollisionBoxData()&&t.iconCollisionBox.collisionVertexArray.clear(),t.hasTextCollisionBoxData()&&t.textCollisionBox.collisionVertexArray.clear();var o=t.layers[0].layout,a=new Gr(null,0,!1,!1,!0),s=o.get("text-allow-overlap"),l=o.get("icon-allow-overlap"),u=o.get("text-variable-anchor"),c="map"===o.get("text-rotation-alignment"),p="map"===o.get("text-pitch-alignment"),h="none"!==o.get("icon-text-fit"),d=new Gr(null,0,s&&(l||!t.hasIconData()||o.get("icon-optional")),l&&(s||!t.hasTextData()||o.get("text-optional")),!0);!t.collisionArrays&&i&&(t.hasIconCollisionBoxData()||t.hasTextCollisionBoxData())&&t.deserializeCollisionBoxes(i);for(var m=function(e,t,r){for(var i=0;i<t/4;i++)e.opacityVertexArray.emplaceBack(r)},f=function(i){var o=t.symbolInstances.get(i),s=o.numHorizontalGlyphVertices,l=o.numVerticalGlyphVertices,f=o.crossTileID,y=n.opacities[f];r[f]?y=a:y||(n.opacities[f]=y=d),r[f]=!0;var g=0<o.numIconVertices,v=n.placedOrientations[o.crossTileID],_=v===e.WritingMode.vertical,b=v===e.WritingMode.horizontal||v===e.WritingMode.horizontalOnly;if(0<s||0<l){var x=ai(y.text);m(t.text,s,_?li:x),m(t.text,l,b?li:x);var w=y.text.isHidden();[o.rightJustifiedTextSymbolIndex,o.centerJustifiedTextSymbolIndex,o.leftJustifiedTextSymbolIndex].forEach((function(e){0<=e&&(t.text.placedSymbolArray.get(e).hidden=w||_?1:0)})),0<=o.verticalPlacedTextSymbolIndex&&(t.text.placedSymbolArray.get(o.verticalPlacedTextSymbolIndex).hidden=w||b?1:0);var S=n.variableOffsets[o.crossTileID];S&&n.markUsedJustification(t,S.anchor,o,v);var T=n.placedOrientations[o.crossTileID];T&&(n.markUsedJustification(t,"left",o,T),n.markUsedOrientation(t,T,o))}if(g){var C=ai(y.icon),E=!(h&&o.verticalPlacedIconSymbolIndex&&_);0<=o.placedIconSymbolIndex&&(m(t.icon,o.numIconVertices,E?C:li),t.icon.placedSymbolArray.get(o.placedIconSymbolIndex).hidden=y.icon.isHidden()),0<=o.verticalPlacedIconSymbolIndex&&(m(t.icon,o.numVerticalIconVertices,E?li:C),t.icon.placedSymbolArray.get(o.verticalPlacedIconSymbolIndex).hidden=y.icon.isHidden())}if(t.hasIconCollisionBoxData()||t.hasTextCollisionBoxData()){var I=t.collisionArrays[i];if(I){var P=new e.Point(0,0);if(I.textBox||I.verticalTextBox){var R=!0;if(u){var N=n.variableOffsets[f];N?(P=Xr(N.anchor,N.width,N.height,N.textOffset,N.textBoxScale),c&&P._rotate(p?n.transform.angle:-n.transform.angle)):R=!1}I.textBox&&$r(t.textCollisionBox.collisionVertexArray,y.text.placed,!R||_,P.x,P.y),I.verticalTextBox&&$r(t.textCollisionBox.collisionVertexArray,y.text.placed,!R||b,P.x,P.y)}var A=Boolean(!b&&I.verticalIconBox);I.iconBox&&$r(t.iconCollisionBox.collisionVertexArray,y.icon.placed,A,h?P.x:0,h?P.y:0),I.verticalIconBox&&$r(t.iconCollisionBox.collisionVertexArray,y.icon.placed,!A,h?P.x:0,h?P.y:0)}}},y=0;y<t.symbolInstances.length;y++)f(y);if(t.sortFeatures(this.transform.angle),this.retainedQueryData[t.bucketInstanceId]&&(this.retainedQueryData[t.bucketInstanceId].featureSortOrder=t.featureSortOrder),t.hasTextData()&&t.text.opacityVertexBuffer&&t.text.opacityVertexBuffer.updateData(t.text.opacityVertexArray),t.hasIconData()&&t.icon.opacityVertexBuffer&&t.icon.opacityVertexBuffer.updateData(t.icon.opacityVertexArray),t.hasIconCollisionBoxData()&&t.iconCollisionBox.collisionVertexBuffer&&t.iconCollisionBox.collisionVertexBuffer.updateData(t.iconCollisionBox.collisionVertexArray),t.hasTextCollisionBoxData()&&t.textCollisionBox.collisionVertexBuffer&&t.textCollisionBox.collisionVertexBuffer.updateData(t.textCollisionBox.collisionVertexArray),t.bucketInstanceId in this.collisionCircleArrays){var g=this.collisionCircleArrays[t.bucketInstanceId];t.placementInvProjMatrix=g.invProjMatrix,t.placementViewportMatrix=g.viewportMatrix,t.collisionCircleArray=g.circles,delete this.collisionCircleArrays[t.bucketInstanceId]}},Jr.prototype.symbolFadeChange=function(e){return 0===this.fadeDuration?1:(e-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment},Jr.prototype.zoomAdjustment=function(e){return Math.max(0,(this.transform.zoom-e)/1.5)},Jr.prototype.hasTransitions=function(e){return this.stale||e-this.lastPlacementChangeTime<this.fadeDuration},Jr.prototype.stillRecent=function(e,t){var r=this.zoomAtLastRecencyCheck===t?1-this.zoomAdjustment(t):1;return this.zoomAtLastRecencyCheck=t,this.commitTime+this.fadeDuration*r>e},Jr.prototype.setStale=function(){this.stale=!0};var Qr=Math.pow(2,25),ei=Math.pow(2,24),ti=Math.pow(2,17),ri=Math.pow(2,16),ii=Math.pow(2,9),ni=Math.pow(2,8),oi=Math.pow(2,1);function ai(e){if(0===e.opacity&&!e.placed)return 0;if(1===e.opacity&&e.placed)return 4294967295;var t=e.placed?1:0,r=Math.floor(127*e.opacity);return r*Qr+t*ei+r*ti+t*ri+r*ii+t*ni+r*oi+t}function si(e){this._sortAcrossTiles="viewport-y"!==e.layout.get("symbol-z-order")&&void 0!==e.layout.get("symbol-sort-key").constantOr(1),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}var li=0;function ui(e,t,r,i,n,o,a){this.placement=new Jr(e,n,o,a),this._currentPlacementIndex=t.length-1,this._forceFullPlacement=r,this._showCollisionBoxes=i,this._done=!1}function ci(e,t,r){this.tileID=e,this.indexedSymbolInstances={},this.bucketInstanceId=r;for(var i=0;i<t.length;i++){var n=t.get(i),o=n.key;this.indexedSymbolInstances[o]||(this.indexedSymbolInstances[o]=[]),this.indexedSymbolInstances[o].push({crossTileID:n.crossTileID,coord:this.getScaledCoordinates(n,e)})}}si.prototype.continuePlacement=function(e,t,r,i,n){for(var o=this._bucketParts;this._currentTileIndex<e.length;)if(t.getBucketParts(o,i,e[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,n())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,o.sort((function(e,t){return e.sortKey-t.sortKey})));this._currentPartIndex<o.length;)if(t.placeLayerBucketPart(o[this._currentPartIndex],this._seenCrossTileIDs,r),this._currentPartIndex++,n())return!0;return!1},ui.prototype.isDone=function(){return this._done},ui.prototype.continuePlacement=function(t,r,i){for(var n=this,o=e.browser.now(),a=function(){var t=e.browser.now()-o;return!n._forceFullPlacement&&2<t};0<=this._currentPlacementIndex;){var s=r[t[this._currentPlacementIndex]],l=this.placement.collisionIndex.transform.zoom;if("symbol"===s.type&&(!s.minzoom||s.minzoom<=l)&&(!s.maxzoom||s.maxzoom>l)){if(this._inProgressLayer||(this._inProgressLayer=new si(s)),this._inProgressLayer.continuePlacement(i[s.source],this.placement,this._showCollisionBoxes,s,a))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0},ui.prototype.commit=function(e){return this.placement.commit(e),this.placement};var pi=512/e.EXTENT/2;function hi(){this.maxCrossTileID=0}function di(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}function mi(){this.layerIndexes={},this.crossTileIDs=new hi,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}function fi(t,r){return e.emitValidationErrors(t,r&&r.filter((function(e){return"source.canvas"!==e.identifier})))}ci.prototype.getScaledCoordinates=function(t,r){var i=pi/Math.pow(2,r.canonical.z-this.tileID.canonical.z);return{x:Math.floor((r.canonical.x*e.EXTENT+t.anchorX)*i),y:Math.floor((r.canonical.y*e.EXTENT+t.anchorY)*i)}},ci.prototype.findMatches=function(e,t,r){for(var i=this.tileID.canonical.z<t.canonical.z?1:Math.pow(2,this.tileID.canonical.z-t.canonical.z),n=0;n<e.length;n++){var o=e.get(n);if(!o.crossTileID){var a=this.indexedSymbolInstances[o.key];if(a)for(var s=this.getScaledCoordinates(o,t),l=0,u=a;l<u.length;l+=1){var c=u[l];if(Math.abs(c.coord.x-s.x)<=i&&Math.abs(c.coord.y-s.y)<=i&&!r[c.crossTileID]){r[c.crossTileID]=!0,o.crossTileID=c.crossTileID;break}}}}},hi.prototype.generate=function(){return++this.maxCrossTileID},di.prototype.handleWrapJump=function(e){var t=Math.round((e-this.lng)/360);if(0!==t)for(var r in this.indexes){var i=this.indexes[r],n={};for(var o in i){var a=i[o];a.tileID=a.tileID.unwrapTo(a.tileID.wrap+t),n[a.tileID.key]=a}this.indexes[r]=n}this.lng=e},di.prototype.addBucket=function(e,t,r){if(this.indexes[e.overscaledZ]&&this.indexes[e.overscaledZ][e.key]){if(this.indexes[e.overscaledZ][e.key].bucketInstanceId===t.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(e.overscaledZ,this.indexes[e.overscaledZ][e.key])}for(var i=0;i<t.symbolInstances.length;i++)t.symbolInstances.get(i).crossTileID=0;this.usedCrossTileIDs[e.overscaledZ]||(this.usedCrossTileIDs[e.overscaledZ]={});var n=this.usedCrossTileIDs[e.overscaledZ];for(var o in this.indexes){var a=this.indexes[o];if(Number(o)>e.overscaledZ)for(var s in a){var l=a[s];l.tileID.isChildOf(e)&&l.findMatches(t.symbolInstances,e,n)}else{var u=a[e.scaledTo(Number(o)).key];u&&u.findMatches(t.symbolInstances,e,n)}}for(var c=0;c<t.symbolInstances.length;c++){var p=t.symbolInstances.get(c);p.crossTileID||(p.crossTileID=r.generate(),n[p.crossTileID]=!0)}return void 0===this.indexes[e.overscaledZ]&&(this.indexes[e.overscaledZ]={}),this.indexes[e.overscaledZ][e.key]=new ci(e,t.symbolInstances,t.bucketInstanceId),!0},di.prototype.removeBucketCrossTileIDs=function(e,t){for(var r in t.indexedSymbolInstances)for(var i=0,n=t.indexedSymbolInstances[r];i<n.length;i+=1)delete this.usedCrossTileIDs[e][n[i].crossTileID]},di.prototype.removeStaleBuckets=function(e){var t=!1;for(var r in this.indexes){var i=this.indexes[r];for(var n in i)e[i[n].bucketInstanceId]||(this.removeBucketCrossTileIDs(r,i[n]),delete i[n],t=!0)}return t},mi.prototype.addLayer=function(e,t,r){var i=this.layerIndexes[e.id];void 0===i&&(i=this.layerIndexes[e.id]=new di);var n=!1,o={};i.handleWrapJump(r);for(var a=0,s=t;a<s.length;a+=1){var l=s[a],u=l.getBucket(e);u&&e.id===u.layerIds[0]&&(u.bucketInstanceId||(u.bucketInstanceId=++this.maxBucketInstanceId),i.addBucket(l.tileID,u,this.crossTileIDs)&&(n=!0),o[u.bucketInstanceId]=!0)}return i.removeStaleBuckets(o)&&(n=!0),n},mi.prototype.pruneUnusedLayers=function(e){var t={};for(var r in e.forEach((function(e){t[e]=!0})),this.layerIndexes)t[r]||delete this.layerIndexes[r]};var yi,gi=e.pick(_r,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),vi=e.pick(_r,["setCenter","setZoom","setBearing","setPitch"]),_i=function(){var t={},r=e.styleSpec.$version;for(var i in e.styleSpec.$root){var n,o=e.styleSpec.$root[i];o.required&&null!=(n="version"===i?r:"array"===o.type?[]:{})&&(t[i]=n)}return t}(),bi=((yi=e.Evented)&&(xi.__proto__=yi),((xi.prototype=Object.create(yi&&yi.prototype)).constructor=xi).prototype.loadURL=function(t,r){var i=this;void 0===r&&(r={}),this.fire(new e.Event("dataloading",{dataType:"style"}));var n="boolean"==typeof r.validate?r.validate:!e.isMapboxURL(t);t=this.map._requestManager.normalizeStyleURL(t,r.accessToken);var o=this.map._requestManager.transformRequest(t,e.ResourceType.Style);this._request=e.getJSON(o,(function(t,r){i._request=null,t?i.fire(new e.ErrorEvent(t)):r&&i._load(r,n)}))},xi.prototype.loadJSON=function(t,r){var i=this;void 0===r&&(r={}),this.fire(new e.Event("dataloading",{dataType:"style"})),this._request=e.browser.frame((function(){i._request=null,i._load(t,!1!==r.validate)}))},xi.prototype.loadEmpty=function(){this.fire(new e.Event("dataloading",{dataType:"style"})),this._load(_i,!1)},xi.prototype._load=function(t,r){if(!r||!fi(this,e.validateStyle(t))){for(var i in this._loaded=!0,(this.stylesheet=t).sources)this.addSource(i,t.sources[i],{validate:!1});t.sprite?this._loadSprite(t.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(t.glyphs);var n=vr(this.stylesheet.layers);this._order=n.map((function(e){return e.id})),this._layers={},this._serializedLayers={};for(var o=0,a=n;o<a.length;o+=1){var s=a[o];(s=e.createStyleLayer(s)).setEventedParent(this,{layer:{id:s.id}}),this._layers[s.id]=s,this._serializedLayers[s.id]=s.serialize()}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new C(this.stylesheet.light),this.fire(new e.Event("data",{dataType:"style"})),this.fire(new e.Event("style.load"))}},xi.prototype._loadSprite=function(t){var r,i,n,o,a,s,l,u,c,p=this;function h(){if(s)n(s);else if(o&&a){var t=e.browser.getImageData(a),r={};for(var i in o){var l=o[i],u=l.width,c=l.height,p=l.x,h=l.y,d=l.sdf,m=l.pixelRatio,f=l.stretchX,y=l.stretchY,g=l.content,v=new e.RGBAImage({width:u,height:c});e.RGBAImage.copy(t,v,{x:p,y:h},{x:0,y:0},{width:u,height:c}),r[i]={data:v,pixelRatio:m,sdf:d,stretchX:f,stretchY:y,content:g}}n(null,r)}}this._spriteRequest=(r=t,i=this.map._requestManager,n=function(t,r){if(p._spriteRequest=null,t)p.fire(new e.ErrorEvent(t));else if(r)for(var i in r)p.imageManager.addImage(i,r[i]);p.imageManager.setLoaded(!0),p._availableImages=p.imageManager.listImages(),p.dispatcher.broadcast("setImages",p._availableImages),p.fire(new e.Event("data",{dataType:"style"}))},l=1<e.browser.devicePixelRatio?"@2x":"",u=e.getJSON(i.transformRequest(i.normalizeSpriteURL(r,l,".json"),e.ResourceType.SpriteJSON),(function(e,t){u=null,s||(s=e,o=t,h())})),c=e.getImage(i.transformRequest(i.normalizeSpriteURL(r,l,".png"),e.ResourceType.SpriteImage),(function(e,t){c=null,s||(s=e,a=t,h())})),{cancel:function(){u&&(u.cancel(),u=null),c&&(c.cancel(),c=null)}})},xi.prototype._validateLayer=function(t){var r=this.sourceCaches[t.source];if(r){var i=t.sourceLayer;if(i){var n=r.getSource();("geojson"===n.type||n.vectorLayerIds&&-1===n.vectorLayerIds.indexOf(i))&&this.fire(new e.ErrorEvent(new Error('Source layer "'+i+'" does not exist on source "'+n.id+'" as specified by style layer "'+t.id+'"')))}}},xi.prototype.loaded=function(){if(!this._loaded)return!1;if(Object.keys(this._updatedSources).length)return!1;for(var e in this.sourceCaches)if(!this.sourceCaches[e].loaded())return!1;return!!this.imageManager.isLoaded()},xi.prototype._serializeLayers=function(e){for(var t=[],r=0,i=e;r<i.length;r+=1){var n=this._layers[i[r]];"custom"!==n.type&&t.push(n.serialize())}return t},xi.prototype.hasTransitions=function(){if(this.light&&this.light.hasTransition())return!0;for(var e in this.sourceCaches)if(this.sourceCaches[e].hasTransition())return!0;for(var t in this._layers)if(this._layers[t].hasTransition())return!0;return!1},xi.prototype._checkLoaded=function(){if(!this._loaded)throw new Error("Style is not done loading")},xi.prototype.update=function(t){if(this._loaded){var r=this._changed;if(this._changed){var i=Object.keys(this._updatedLayers),n=Object.keys(this._removedLayers);for(var o in(i.length||n.length)&&this._updateWorkerLayers(i,n),this._updatedSources){var a=this._updatedSources[o];"reload"===a?this._reloadSource(o):"clear"===a&&this._clearSource(o)}for(var s in this._updateTilesForChangedImages(),this._updatedPaintProps)this._layers[s].updateTransitions(t);this.light.updateTransitions(t),this._resetUpdates()}for(var l in this.sourceCaches)this.sourceCaches[l].used=!1;for(var u=0,c=this._order;u<c.length;u+=1){var p=this._layers[c[u]];p.recalculate(t,this._availableImages),!p.isHidden(t.zoom)&&p.source&&(this.sourceCaches[p.source].used=!0)}this.light.recalculate(t),this.z=t.zoom,r&&this.fire(new e.Event("data",{dataType:"style"}))}},xi.prototype._updateTilesForChangedImages=function(){var e=Object.keys(this._changedImages);if(e.length){for(var t in this.sourceCaches)this.sourceCaches[t].reloadTilesForDependencies(["icons","patterns"],e);this._changedImages={}}},xi.prototype._updateWorkerLayers=function(e,t){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(e),removedIds:t})},xi.prototype._resetUpdates=function(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}},xi.prototype.setState=function(t){var r=this;if(this._checkLoaded(),fi(this,e.validateStyle(t)))return!1;(t=e.clone$1(t)).layers=vr(t.layers);var i=function(t,r){if(!t)return[{command:_r.setStyle,args:[r]}];var i=[];try{if(!e.deepEqual(t.version,r.version))return[{command:_r.setStyle,args:[r]}];e.deepEqual(t.center,r.center)||i.push({command:_r.setCenter,args:[r.center]}),e.deepEqual(t.zoom,r.zoom)||i.push({command:_r.setZoom,args:[r.zoom]}),e.deepEqual(t.bearing,r.bearing)||i.push({command:_r.setBearing,args:[r.bearing]}),e.deepEqual(t.pitch,r.pitch)||i.push({command:_r.setPitch,args:[r.pitch]}),e.deepEqual(t.sprite,r.sprite)||i.push({command:_r.setSprite,args:[r.sprite]}),e.deepEqual(t.glyphs,r.glyphs)||i.push({command:_r.setGlyphs,args:[r.glyphs]}),e.deepEqual(t.transition,r.transition)||i.push({command:_r.setTransition,args:[r.transition]}),e.deepEqual(t.light,r.light)||i.push({command:_r.setLight,args:[r.light]});var n={},o=[];!function(t,r,i,n){var o,a,s,l;for(o in r=r||{},t=t||{})t.hasOwnProperty(o)&&(r.hasOwnProperty(o)||xr(o,i,n));for(o in r)r.hasOwnProperty(o)&&(t.hasOwnProperty(o)?e.deepEqual(t[o],r[o])||("geojson"===t[o].type&&"geojson"===r[o].type&&wr(t,r,o)?i.push({command:_r.setGeoJSONSourceData,args:[o,r[o].data]}):(s=r,xr(a=o,l=i,n),br(a,s,l))):br(o,r,i))}(t.sources,r.sources,o,n);var a=[];t.layers&&t.layers.forEach((function(e){n[e.source]?i.push({command:_r.removeLayer,args:[e.id]}):a.push(e)})),i=i.concat(o),function(t,r,i){r=r||[];var n,o,a,s,l,u,c,p=(t=t||[]).map(Tr),h=r.map(Tr),d=t.reduce(Cr,{}),m=r.reduce(Cr,{}),f=p.slice(),y=Object.create(null);for(o=n=0;n<p.length;n++)m.hasOwnProperty(a=p[n])?o++:(i.push({command:_r.removeLayer,args:[a]}),f.splice(f.indexOf(a,o),1));for(o=n=0;n<h.length;n++)f[f.length-1-n]!==(a=h[h.length-1-n])&&(d.hasOwnProperty(a)?(i.push({command:_r.removeLayer,args:[a]}),f.splice(f.lastIndexOf(a,f.length-o),1)):o++,i.push({command:_r.addLayer,args:[m[a],u=f[f.length-n]]}),f.splice(f.length-n,0,a),y[a]=!0);for(n=0;n<h.length;n++)if(s=d[a=h[n]],l=m[a],!y[a]&&!e.deepEqual(s,l))if(e.deepEqual(s.source,l.source)&&e.deepEqual(s["source-layer"],l["source-layer"])&&e.deepEqual(s.type,l.type)){for(c in Sr(s.layout,l.layout,i,a,null,_r.setLayoutProperty),Sr(s.paint,l.paint,i,a,null,_r.setPaintProperty),e.deepEqual(s.filter,l.filter)||i.push({command:_r.setFilter,args:[a,l.filter]}),e.deepEqual(s.minzoom,l.minzoom)&&e.deepEqual(s.maxzoom,l.maxzoom)||i.push({command:_r.setLayerZoomRange,args:[a,l.minzoom,l.maxzoom]}),s)s.hasOwnProperty(c)&&"layout"!==c&&"paint"!==c&&"filter"!==c&&"metadata"!==c&&"minzoom"!==c&&"maxzoom"!==c&&(0===c.indexOf("paint.")?Sr(s[c],l[c],i,a,c.slice(6),_r.setPaintProperty):e.deepEqual(s[c],l[c])||i.push({command:_r.setLayerProperty,args:[a,c,l[c]]}));for(c in l)l.hasOwnProperty(c)&&!s.hasOwnProperty(c)&&"layout"!==c&&"paint"!==c&&"filter"!==c&&"metadata"!==c&&"minzoom"!==c&&"maxzoom"!==c&&(0===c.indexOf("paint.")?Sr(s[c],l[c],i,a,c.slice(6),_r.setPaintProperty):e.deepEqual(s[c],l[c])||i.push({command:_r.setLayerProperty,args:[a,c,l[c]]}))}else i.push({command:_r.removeLayer,args:[a]}),u=f[f.lastIndexOf(a)+1],i.push({command:_r.addLayer,args:[l,u]})}(a,r.layers,i)}catch(t){console.warn("Unable to compute style diff:",t),i=[{command:_r.setStyle,args:[r]}]}return i}(this.serialize(),t).filter((function(e){return!(e.command in vi)}));if(0===i.length)return!1;var n=i.filter((function(e){return!(e.command in gi)}));if(0<n.length)throw new Error("Unimplemented: "+n.map((function(e){return e.command})).join(", ")+".");return i.forEach((function(e){"setTransition"!==e.command&&r[e.command].apply(r,e.args)})),this.stylesheet=t,!0},xi.prototype.addImage=function(t,r){if(this.getImage(t))return this.fire(new e.ErrorEvent(new Error("An image with this name already exists.")));this.imageManager.addImage(t,r),this._availableImages=this.imageManager.listImages(),this._changedImages[t]=!0,this._changed=!0,this.fire(new e.Event("data",{dataType:"style"}))},xi.prototype.updateImage=function(e,t){this.imageManager.updateImage(e,t)},xi.prototype.getImage=function(e){return this.imageManager.getImage(e)},xi.prototype.removeImage=function(t){if(!this.getImage(t))return this.fire(new e.ErrorEvent(new Error("No image with this name exists.")));this.imageManager.removeImage(t),this._availableImages=this.imageManager.listImages(),this._changedImages[t]=!0,this._changed=!0,this.fire(new e.Event("data",{dataType:"style"}))},xi.prototype.listImages=function(){return this._checkLoaded(),this.imageManager.listImages()},xi.prototype.addSource=function(t,r,i){var n=this;if(void 0===i&&(i={}),this._checkLoaded(),void 0!==this.sourceCaches[t])throw new Error("There is already a source with this ID");if(!r.type)throw new Error("The type property must be defined, but the only the following properties were given: "+Object.keys(r).join(", ")+".");if(!(0<=["vector","raster","geojson","video","image"].indexOf(r.type)&&this._validate(e.validateStyle.source,"sources."+t,r,null,i))){this.map&&this.map._collectResourceTiming&&(r.collectResourceTiming=!0);var o=this.sourceCaches[t]=new sr(t,r,this.dispatcher);o.style=this,o.setEventedParent(this,(function(){return{isSourceLoaded:n.loaded(),source:o.serialize(),sourceId:t}})),o.onAdd(this.map),this._changed=!0}},xi.prototype.removeSource=function(t){if(this._checkLoaded(),void 0===this.sourceCaches[t])throw new Error("There is no source with this ID");for(var r in this._layers)if(this._layers[r].source===t)return this.fire(new e.ErrorEvent(new Error('Source "'+t+'" cannot be removed while layer "'+r+'" is using it.')));var i=this.sourceCaches[t];delete this.sourceCaches[t],delete this._updatedSources[t],i.fire(new e.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:t})),i.setEventedParent(null),i.clearTiles(),i.onRemove&&i.onRemove(this.map),this._changed=!0},xi.prototype.setGeoJSONSourceData=function(e,t){this._checkLoaded(),this.sourceCaches[e].getSource().setData(t),this._changed=!0},xi.prototype.getSource=function(e){return this.sourceCaches[e]&&this.sourceCaches[e].getSource()},xi.prototype.addLayer=function(t,r,i){void 0===i&&(i={}),this._checkLoaded();var n=t.id;if(this.getLayer(n))this.fire(new e.ErrorEvent(new Error('Layer with id "'+n+'" already exists on this map')));else{var o;if("custom"===t.type){if(fi(this,e.validateCustomStyleLayer(t)))return;o=e.createStyleLayer(t)}else{if("object"==typeof t.source&&(this.addSource(n,t.source),t=e.clone$1(t),t=e.extend(t,{source:n})),this._validate(e.validateStyle.layer,"layers."+n,t,{arrayIndex:-1},i))return;o=e.createStyleLayer(t),this._validateLayer(o),o.setEventedParent(this,{layer:{id:n}}),this._serializedLayers[o.id]=o.serialize()}var a=r?this._order.indexOf(r):this._order.length;if(r&&-1===a)this.fire(new e.ErrorEvent(new Error('Layer with id "'+r+'" does not exist on this map.')));else{if(this._order.splice(a,0,n),this._layerOrderChanged=!0,this._layers[n]=o,this._removedLayers[n]&&o.source&&"custom"!==o.type){var s=this._removedLayers[n];delete this._removedLayers[n],s.type!==o.type?this._updatedSources[o.source]="clear":(this._updatedSources[o.source]="reload",this.sourceCaches[o.source].pause())}this._updateLayer(o),o.onAdd&&o.onAdd(this.map)}}},xi.prototype.moveLayer=function(t,r){if(this._checkLoaded(),this._changed=!0,this._layers[t]){if(t!==r){var i=this._order.indexOf(t);this._order.splice(i,1);var n=r?this._order.indexOf(r):this._order.length;r&&-1===n?this.fire(new e.ErrorEvent(new Error('Layer with id "'+r+'" does not exist on this map.'))):(this._order.splice(n,0,t),this._layerOrderChanged=!0)}}else this.fire(new e.ErrorEvent(new Error("The layer '"+t+"' does not exist in the map's style and cannot be moved.")))},xi.prototype.removeLayer=function(t){this._checkLoaded();var r=this._layers[t];if(r){r.setEventedParent(null);var i=this._order.indexOf(t);this._order.splice(i,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[t]=r,delete this._layers[t],delete this._serializedLayers[t],delete this._updatedLayers[t],delete this._updatedPaintProps[t],r.onRemove&&r.onRemove(this.map)}else this.fire(new e.ErrorEvent(new Error("The layer '"+t+"' does not exist in the map's style and cannot be removed.")))},xi.prototype.getLayer=function(e){return this._layers[e]},xi.prototype.hasLayer=function(e){return e in this._layers},xi.prototype.setLayerZoomRange=function(t,r,i){this._checkLoaded();var n=this.getLayer(t);n?n.minzoom===r&&n.maxzoom===i||(null!=r&&(n.minzoom=r),null!=i&&(n.maxzoom=i),this._updateLayer(n)):this.fire(new e.ErrorEvent(new Error("The layer '"+t+"' does not exist in the map's style and cannot have zoom extent.")))},xi.prototype.setFilter=function(t,r,i){void 0===i&&(i={}),this._checkLoaded();var n=this.getLayer(t);if(n){if(!e.deepEqual(n.filter,r))return null==r?(n.filter=void 0,void this._updateLayer(n)):void(this._validate(e.validateStyle.filter,"layers."+n.id+".filter",r,null,i)||(n.filter=e.clone$1(r),this._updateLayer(n)))}else this.fire(new e.ErrorEvent(new Error("The layer '"+t+"' does not exist in the map's style and cannot be filtered.")))},xi.prototype.getFilter=function(t){return e.clone$1(this.getLayer(t).filter)},xi.prototype.setLayoutProperty=function(t,r,i,n){void 0===n&&(n={}),this._checkLoaded();var o=this.getLayer(t);o?e.deepEqual(o.getLayoutProperty(r),i)||(o.setLayoutProperty(r,i,n),this._updateLayer(o)):this.fire(new e.ErrorEvent(new Error("The layer '"+t+"' does not exist in the map's style and cannot be styled.")))},xi.prototype.getLayoutProperty=function(t,r){var i=this.getLayer(t);if(i)return i.getLayoutProperty(r);this.fire(new e.ErrorEvent(new Error("The layer '"+t+"' does not exist in the map's style.")))},xi.prototype.setPaintProperty=function(t,r,i,n){void 0===n&&(n={}),this._checkLoaded();var o=this.getLayer(t);o?e.deepEqual(o.getPaintProperty(r),i)||(o.setPaintProperty(r,i,n)&&this._updateLayer(o),this._changed=!0,this._updatedPaintProps[t]=!0):this.fire(new e.ErrorEvent(new Error("The layer '"+t+"' does not exist in the map's style and cannot be styled.")))},xi.prototype.getPaintProperty=function(e,t){return this.getLayer(e).getPaintProperty(t)},xi.prototype.setFeatureState=function(t,r){this._checkLoaded();var i=t.source,n=t.sourceLayer,o=this.sourceCaches[i];if(void 0!==o){var a=o.getSource().type;"geojson"===a&&n?this.fire(new e.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):"vector"!==a||n?(void 0===t.id&&this.fire(new e.ErrorEvent(new Error("The feature id parameter must be provided."))),o.setFeatureState(n,t.id,r)):this.fire(new e.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new e.ErrorEvent(new Error("The source '"+i+"' does not exist in the map's style.")))},xi.prototype.removeFeatureState=function(t,r){this._checkLoaded();var i=t.source,n=this.sourceCaches[i];if(void 0!==n){var o=n.getSource().type,a="vector"===o?t.sourceLayer:void 0;"vector"!==o||a?r&&"string"!=typeof t.id&&"number"!=typeof t.id?this.fire(new e.ErrorEvent(new Error("A feature id is requred to remove its specific state property."))):n.removeFeatureState(a,t.id,r):this.fire(new e.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new e.ErrorEvent(new Error("The source '"+i+"' does not exist in the map's style.")))},xi.prototype.getFeatureState=function(t){this._checkLoaded();var r=t.source,i=t.sourceLayer,n=this.sourceCaches[r];if(void 0!==n){if("vector"!==n.getSource().type||i)return void 0===t.id&&this.fire(new e.ErrorEvent(new Error("The feature id parameter must be provided."))),n.getFeatureState(i,t.id);this.fire(new e.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new e.ErrorEvent(new Error("The source '"+r+"' does not exist in the map's style.")))},xi.prototype.getTransition=function(){return e.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)},xi.prototype.serialize=function(){return e.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:e.mapObject(this.sourceCaches,(function(e){return e.serialize()})),layers:this._serializeLayers(this._order)},(function(e){return void 0!==e}))},xi.prototype._updateLayer=function(e){this._updatedLayers[e.id]=!0,e.source&&!this._updatedSources[e.source]&&"raster"!==this.sourceCaches[e.source].getSource().type&&(this._updatedSources[e.source]="reload",this.sourceCaches[e.source].pause()),this._changed=!0},xi.prototype._flattenAndSortRenderedFeatures=function(e){for(var t=this,r=function(e){return"fill-extrusion"===t._layers[e].type},i={},n=[],o=this._order.length-1;0<=o;o--){var a=this._order[o];if(r(a)){i[a]=o;for(var s=0,l=e;s<l.length;s+=1){var u=l[s][a];if(u)for(var c=0,p=u;c<p.length;c+=1)n.push(p[c])}}}n.sort((function(e,t){return t.intersectionZ-e.intersectionZ}));for(var h=[],d=this._order.length-1;0<=d;d--){var m=this._order[d];if(r(m))for(var f=n.length-1;0<=f;f--){var y=n[f].feature;if(i[y.layer.id]<d)break;h.push(y),n.pop()}else for(var g=0,v=e;g<v.length;g+=1){var _=v[g][m];if(_)for(var b=0,x=_;b<x.length;b+=1)h.push(x[b].feature)}}return h},xi.prototype.queryRenderedFeatures=function(t,r,i){r&&r.filter&&this._validate(e.validateStyle.filter,"queryRenderedFeatures.filter",r.filter,null,r);var n={};if(r&&r.layers){if(!Array.isArray(r.layers))return this.fire(new e.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(var o=0,a=r.layers;o<a.length;o+=1){var s=a[o],l=this._layers[s];if(!l)return this.fire(new e.ErrorEvent(new Error("The layer '"+s+"' does not exist in the map's style and cannot be queried for features."))),[];n[l.source]=!0}}var u=[];for(var c in r.availableImages=this._availableImages,this.sourceCaches)r.layers&&!n[c]||u.push(Q(this.sourceCaches[c],this._layers,this._serializedLayers,t,r,i));return this.placement&&u.push(function(e,t,r,i,n,o,a){for(var s={},l=o.queryRenderedSymbols(i),u=[],c=0,p=Object.keys(l).map(Number);c<p.length;c+=1)u.push(a[p[c]]);u.sort(ee);for(var h=function(){var r=m[d],i=r.featureIndex.lookupSymbolFeatures(l[r.bucketInstanceId],t,r.bucketIndex,r.sourceLayerIndex,n.filter,n.layers,n.availableImages,e);for(var o in i){var a=s[o]=s[o]||[],u=i[o];u.sort((function(e,t){var i=r.featureSortOrder;if(i){var n=i.indexOf(e.featureIndex);return i.indexOf(t.featureIndex)-n}return t.featureIndex-e.featureIndex}));for(var c=0,p=u;c<p.length;c+=1)a.push(p[c])}},d=0,m=u;d<m.length;d+=1)h();function f(t){s[t].forEach((function(i){var n=i.feature,o=r[e[t].source].getFeatureState(n.layer["source-layer"],n.id);n.source=n.layer.source,n.layer["source-layer"]&&(n.sourceLayer=n.layer["source-layer"]),n.state=o}))}for(var y in s)f(y);return s}(this._layers,this._serializedLayers,this.sourceCaches,t,r,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(u)},xi.prototype.querySourceFeatures=function(t,r){r&&r.filter&&this._validate(e.validateStyle.filter,"querySourceFeatures.filter",r.filter,null,r);var i=this.sourceCaches[t];return i?function(e,t){for(var r=e.getRenderableIds().map((function(t){return e.getTileByID(t)})),i=[],n={},o=0;o<r.length;o++){var a=r[o],s=a.tileID.canonical.key;n[s]||(n[s]=!0,a.querySourceFeatures(i,t))}return i}(i,r):[]},xi.prototype.addSourceType=function(e,t,r){return xi.getSourceType(e)?r(new Error('A source type called "'+e+'" already exists.')):(xi.setSourceType(e,t),t.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:e,url:t.workerSourceURL},r):r(null,null))},xi.prototype.getLight=function(){return this.light.getLight()},xi.prototype.setLight=function(t,r){void 0===r&&(r={}),this._checkLoaded();var i=this.light.getLight(),n=!1;for(var o in t)if(!e.deepEqual(t[o],i[o])){n=!0;break}if(n){var a={now:e.browser.now(),transition:e.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(t,r),this.light.updateTransitions(a)}},xi.prototype._validate=function(t,r,i,n,o){return void 0===o&&(o={}),(!o||!1!==o.validate)&&fi(this,t.call(e.validateStyle,e.extend({key:r,style:this.serialize(),value:i,styleSpec:e.styleSpec},n)))},xi.prototype._remove=function(){for(var t in this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),e.evented.off("pluginStateChange",this._rtlTextPluginCallback),this._layers)this._layers[t].setEventedParent(null);for(var r in this.sourceCaches)this.sourceCaches[r].clearTiles(),this.sourceCaches[r].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()},xi.prototype._clearSource=function(e){this.sourceCaches[e].clearTiles()},xi.prototype._reloadSource=function(e){this.sourceCaches[e].resume(),this.sourceCaches[e].reload()},xi.prototype._updateSources=function(e){for(var t in this.sourceCaches)this.sourceCaches[t].update(e)},xi.prototype._generateCollisionBoxes=function(){for(var e in this.sourceCaches)this._reloadSource(e)},xi.prototype._updatePlacement=function(t,r,i,n,o){void 0===o&&(o=!1);for(var a=!1,s=!1,l={},u=0,c=this._order;u<c.length;u+=1){var p=this._layers[c[u]];if("symbol"===p.type){if(!l[p.source]){var h=this.sourceCaches[p.source];l[p.source]=h.getRenderableIds(!0).map((function(e){return h.getTileByID(e)})).sort((function(e,t){return t.tileID.overscaledZ-e.tileID.overscaledZ||(e.tileID.isLessThan(t.tileID)?-1:1)}))}var d=this.crossTileSymbolIndex.addLayer(p,l[p.source],t.center.lng);a=a||d}}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((o=o||this._layerOrderChanged||0===i)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(e.browser.now(),t.zoom))&&(this.pauseablePlacement=new ui(t,this._order,o,r,i,n,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,l),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(e.browser.now()),s=!0),a&&this.pauseablePlacement.placement.setStale()),s||a)for(var m=0,f=this._order;m<f.length;m+=1){var y=this._layers[f[m]];"symbol"===y.type&&this.placement.updateLayerOpacities(y,l[y.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(e.browser.now())},xi.prototype._releaseSymbolFadeTiles=function(){for(var e in this.sourceCaches)this.sourceCaches[e].releaseSymbolFadeTiles()},xi.prototype.getImages=function(e,t,r){this.imageManager.getImages(t.icons,r),this._updateTilesForChangedImages();var i=this.sourceCaches[t.source];i&&i.setDependencies(t.tileID.key,t.type,t.icons)},xi.prototype.getGlyphs=function(e,t,r){this.glyphManager.getGlyphs(t.stacks,r)},xi.prototype.getResource=function(t,r,i){return e.makeRequest(r,i)},xi);function xi(t,r){var i=this;void 0===r&&(r={}),yi.call(this),this.map=t,this.dispatcher=new I(yr(),this),this.imageManager=new h,this.imageManager.setEventedParent(this),this.glyphManager=new b(t._requestManager,r.localIdeographFontFamily),this.lineAtlas=new w(256,512),this.crossTileSymbolIndex=new mi,this._layers={},this._serializedLayers={},this._order=[],this.sourceCaches={},this.zoomHistory=new e.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",e.getReferrer());var n=this;this._rtlTextPluginCallback=xi.registerForPluginStateChange((function(t){n.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:t.pluginStatus,pluginURL:t.pluginURL},(function(t,r){if(e.triggerPluginCompletionEvent(t),r&&r.every((function(e){return e})))for(var i in n.sourceCaches)n.sourceCaches[i].reload()}))})),this.on("data",(function(e){if("source"===e.dataType&&"metadata"===e.sourceDataType){var t=i.sourceCaches[e.sourceId];if(t){var r=t.getSource();if(r&&r.vectorLayerIds)for(var n in i._layers){var o=i._layers[n];o.source===r.id&&i._validateLayer(o)}}}}))}bi.getSourceType=function(e){return H[e]},bi.setSourceType=function(e,t){H[e]=t},bi.registerForPluginStateChange=e.registerForPluginStateChange;var wi=e.createLayout([{name:"a_pos",type:"Int16",components:2}]),Si=Xi("#ifdef GL_ES\nprecision mediump float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif","#ifdef GL_ES\nprecision highp float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif\nvec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0\n);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}"),Ti=Xi("uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),Ci=Xi("uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),Ei=Xi("varying vec3 v_data;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main(void) {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,0,1);} else {gl_Position=u_matrix*vec4(circle_center,0,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}"),Ii=Xi("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),Pi=Xi("uniform highp float u_intensity;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#define GAUSS_COEF 0.3989422804014327\nvoid main() {\n#pragma mapbox: initialize highp float weight\nfloat d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\nconst highp float ZERO=1.0/255.0/16.0;\n#define GAUSS_COEF 0.3989422804014327\nvoid main(void) {\n#pragma mapbox: initialize highp float weight\n#pragma mapbox: initialize mediump float radius\nvec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}"),Ri=Xi("uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(0.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),Ni=Xi("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,0.0,1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),Ai=Xi("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),zi=Xi("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,0,1);}"),Mi=Xi("#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_FragColor=color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);}"),ki=Xi("varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}"),Oi=Xi("uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}"),Li=Xi("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}"),Di=Xi("varying vec4 v_color;void main() {gl_FragColor=v_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec4 v_color;\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp vec4 color\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp vec4 color\nvec3 normal=a_normal_ed.xyz;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}"),Bi=Xi("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0\n? a_pos\n: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}"),Fi=Xi("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform float u_maxzoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggeration=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/ pow(2.0,(u_zoom-u_maxzoom)*exaggeration+19.2562-u_zoom);gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),qi=Xi("uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;\n#define PI 3.141592653589793\nvoid main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),Ui=Xi("uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}"),ji=Xi("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp float v_lineprogress;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,vec2(v_lineprogress,0.5));gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define MAX_LINE_DISTANCE 32767.0\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_lineprogress;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_lineprogress=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0/MAX_LINE_DISTANCE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}"),Vi=Xi("uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}"),Gi=Xi("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}"),Hi=Xi("uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),Zi=Xi("uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nlowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),0.0,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));}"),Wi=Xi("#define SDF_PX 8.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}"),Ki=Xi("#define SDF_PX 8.0\n#define SDF 1.0\n#define ICON 0.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\nreturn;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}");function Xi(e,t){var r=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,i=t.match(/attribute ([\w]+) ([\w]+)/g),n=e.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),o=t.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),a=o?o.concat(n):n,s={};return{fragmentSource:e=e.replace(r,(function(e,t,r,i,n){return s[n]=!0,"define"===t?"\n#ifndef HAS_UNIFORM_u_"+n+"\nvarying "+r+" "+i+" "+n+";\n#else\nuniform "+r+" "+i+" u_"+n+";\n#endif\n":"\n#ifdef HAS_UNIFORM_u_"+n+"\n    "+r+" "+i+" "+n+" = u_"+n+";\n#endif\n"})),vertexSource:t=t.replace(r,(function(e,t,r,i,n){var o="float"===i?"vec2":"vec4",a=n.match(/color/)?"color":o;return s[n]?"define"===t?"\n#ifndef HAS_UNIFORM_u_"+n+"\nuniform lowp float u_"+n+"_t;\nattribute "+r+" "+o+" a_"+n+";\nvarying "+r+" "+i+" "+n+";\n#else\nuniform "+r+" "+i+" u_"+n+";\n#endif\n":"vec4"==a?"\n#ifndef HAS_UNIFORM_u_"+n+"\n    "+n+" = a_"+n+";\n#else\n    "+r+" "+i+" "+n+" = u_"+n+";\n#endif\n":"\n#ifndef HAS_UNIFORM_u_"+n+"\n    "+n+" = unpack_mix_"+a+"(a_"+n+", u_"+n+"_t);\n#else\n    "+r+" "+i+" "+n+" = u_"+n+";\n#endif\n":"define"===t?"\n#ifndef HAS_UNIFORM_u_"+n+"\nuniform lowp float u_"+n+"_t;\nattribute "+r+" "+o+" a_"+n+";\n#else\nuniform "+r+" "+i+" u_"+n+";\n#endif\n":"vec4"==a?"\n#ifndef HAS_UNIFORM_u_"+n+"\n    "+r+" "+i+" "+n+" = a_"+n+";\n#else\n    "+r+" "+i+" "+n+" = u_"+n+";\n#endif\n":"\n#ifndef HAS_UNIFORM_u_"+n+"\n    "+r+" "+i+" "+n+" = unpack_mix_"+a+"(a_"+n+", u_"+n+"_t);\n#else\n    "+r+" "+i+" "+n+" = u_"+n+";\n#endif\n"})),staticAttributes:i,staticUniforms:a}}function Yi(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}var Ji=Object.freeze({__proto__:null,prelude:Si,background:Ti,backgroundPattern:Ci,circle:Ei,clippingMask:Ii,heatmap:Pi,heatmapTexture:Ri,collisionBox:Ni,collisionCircle:Ai,debug:zi,fill:Mi,fillOutline:ki,fillOutlinePattern:Oi,fillPattern:Li,fillExtrusion:Di,fillExtrusionPattern:Bi,hillshadePrepare:Fi,hillshade:qi,line:Ui,lineGradient:ji,linePattern:Vi,lineSDF:Gi,raster:Hi,symbolIcon:Zi,symbolSDF:Wi,symbolTextAndIcon:Ki});function $i(e){for(var t=[],r=0;r<e.length;r++)if(null!==e[r]){var i=e[r].split(" ");t.push(i.pop())}return t}function Qi(e,t,r,i,n,o){var a=e.gl;this.program=a.createProgram();for(var s=$i(r.staticAttributes),l=i?i.getBinderAttributes():[],u=s.concat(l),c=r.staticUniforms?$i(r.staticUniforms):[],p=i?i.getBinderUniforms():[],h=[],d=0,m=c.concat(p);d<m.length;d+=1){var f=m[d];h.indexOf(f)<0&&h.push(f)}var y=i?i.defines():[];o&&y.push("#define OVERDRAW_INSPECTOR;");var g=y.concat(Si.fragmentSource,r.fragmentSource).join("\n"),v=y.concat(Si.vertexSource,r.vertexSource).join("\n"),_=a.createShader(a.FRAGMENT_SHADER);if(a.isContextLost())this.failedToCreate=!0;else{a.shaderSource(_,g),a.compileShader(_),a.attachShader(this.program,_);var b=a.createShader(a.VERTEX_SHADER);if(a.isContextLost())this.failedToCreate=!0;else{a.shaderSource(b,v),a.compileShader(b),a.attachShader(this.program,b),this.attributes={};var x={};this.numAttributes=u.length;for(var w=0;w<this.numAttributes;w++)u[w]&&(a.bindAttribLocation(this.program,w,u[w]),this.attributes[u[w]]=w);a.linkProgram(this.program),a.deleteShader(b),a.deleteShader(_);for(var S=0;S<h.length;S++){var T=h[S];if(T&&!x[T]){var C=a.getUniformLocation(this.program,T);C&&(x[T]=C)}}this.fixedUniforms=n(e,x),this.binderUniforms=i?i.getUniforms(e,x):[]}}}function en(e,t,r){var i=1/jr(r,1,t.transform.tileZoom),n=Math.pow(2,r.tileID.overscaledZ),o=r.tileSize*Math.pow(2,t.transform.tileZoom)/n,a=o*(r.tileID.canonical.x+r.tileID.wrap*n),s=o*r.tileID.canonical.y;return{u_image:0,u_texsize:r.imageAtlasTexture.size,u_scale:[i,e.fromScale,e.toScale],u_fade:e.t,u_pixel_coord_upper:[a>>16,s>>16],u_pixel_coord_lower:[65535&a,65535&s]}}function tn(t,r,i,n){var o=r.style.light,a=o.properties.get("position"),s=[a.x,a.y,a.z],l=e.create$1();"viewport"===o.properties.get("anchor")&&e.fromRotation(l,-r.transform.angle),e.transformMat3(s,s,l);var u=o.properties.get("color");return{u_matrix:t,u_lightpos:s,u_lightintensity:o.properties.get("intensity"),u_lightcolor:[u.r,u.g,u.b],u_vertical_gradient:+i,u_opacity:n}}function rn(e){return{u_matrix:e}}function nn(t,r,i,n){return e.extend(rn(t),en(i,r,n))}function on(t,r,i,n){var o,a,s=t.transform;if("map"===n.paint.get("circle-pitch-alignment")){var l=jr(i,1,s.zoom);o=!0,a=[l,l]}else o=!1,a=s.pixelsToGLUnits;return{u_camera_to_center_distance:s.cameraToCenterDistance,u_scale_with_map:+("map"===n.paint.get("circle-pitch-scale")),u_matrix:t.translatePosMatrix(r.posMatrix,i,n.paint.get("circle-translate"),n.paint.get("circle-translate-anchor")),u_pitch_with_map:+o,u_device_pixel_ratio:e.browser.devicePixelRatio,u_extrude_scale:a}}function an(e){return{u_matrix:e}}function sn(t,r,i){var n=t.transform;return{u_matrix:cn(t,r,i),u_ratio:1/jr(r,1,n.zoom),u_device_pixel_ratio:e.browser.devicePixelRatio,u_units_to_pixels:[1/n.pixelsToGLUnits[0],1/n.pixelsToGLUnits[1]]}}Yi.prototype.bind=function(e,t,r,i,n,o,a,s){this.context=e;for(var l=this.boundPaintVertexBuffers.length!==i.length,u=0;!l&&u<i.length;u++)this.boundPaintVertexBuffers[u]!==i[u]&&(l=!0);e.extVertexArrayObject&&this.vao&&this.boundProgram===t&&this.boundLayoutVertexBuffer===r&&!l&&this.boundIndexBuffer===n&&this.boundVertexOffset===o&&this.boundDynamicVertexBuffer===a&&this.boundDynamicVertexBuffer2===s?(e.bindVertexArrayOES.set(this.vao),a&&a.bind(),n&&n.dynamicDraw&&n.bind(),s&&s.bind()):this.freshBind(t,r,i,n,o,a,s)},Yi.prototype.freshBind=function(e,t,r,i,n,o,a){var s,l=e.numAttributes,u=this.context,c=u.gl;if(u.extVertexArrayObject)this.vao&&this.destroy(),this.vao=u.extVertexArrayObject.createVertexArrayOES(),u.bindVertexArrayOES.set(this.vao),s=0,this.boundProgram=e,this.boundLayoutVertexBuffer=t,this.boundPaintVertexBuffers=r,this.boundIndexBuffer=i,this.boundVertexOffset=n,this.boundDynamicVertexBuffer=o,this.boundDynamicVertexBuffer2=a;else{s=u.currentNumAttributes||0;for(var p=l;p<s;p++)c.disableVertexAttribArray(p)}t.enableAttributes(c,e);for(var h=0,d=r;h<d.length;h+=1)d[h].enableAttributes(c,e);o&&o.enableAttributes(c,e),a&&a.enableAttributes(c,e),t.bind(),t.setVertexAttribPointers(c,e,n);for(var m=0,f=r;m<f.length;m+=1){var y=f[m];y.bind(),y.setVertexAttribPointers(c,e,n)}o&&(o.bind(),o.setVertexAttribPointers(c,e,n)),i&&i.bind(),a&&(a.bind(),a.setVertexAttribPointers(c,e,n)),u.currentNumAttributes=l},Yi.prototype.destroy=function(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)},Qi.prototype.draw=function(e,t,r,i,n,o,a,s,l,u,c,p,h,d,m,f){var y,g=e.gl;if(!this.failedToCreate){for(var v in e.program.set(this.program),e.setDepthMode(r),e.setStencilMode(i),e.setColorMode(n),e.setCullFace(o),this.fixedUniforms)this.fixedUniforms[v].set(a[v]);d&&d.setUniforms(e,this.binderUniforms,p,{zoom:h});for(var _=((y={})[g.LINES]=2,y[g.TRIANGLES]=3,y[g.LINE_STRIP]=1,y[t]),b=0,x=c.get();b<x.length;b+=1){var w=x[b],S=w.vaos||(w.vaos={});(S[s]||(S[s]=new Yi)).bind(e,this,l,d?d.getPaintVertexBuffers():[],u,w.vertexOffset,m,f),g.drawElements(t,w.primitiveLength*_,g.UNSIGNED_SHORT,w.primitiveOffset*_*2)}}};var ln=function(e,t,r){return void 0===r&&(r=1),{u_matrix:e,u_color:t,u_overlay:0,u_overlay_scale:r}};function un(e,t){return 1/jr(e,1,t.tileZoom)}function cn(e,t,r){return e.translatePosMatrix(t.tileID.posMatrix,t,r.paint.get("line-translate"),r.paint.get("line-translate-anchor"))}function pn(e,t,r,i,n){return{u_matrix:e,u_tl_parent:t,u_scale_parent:r,u_buffer_scale:1,u_fade_t:i.mix,u_opacity:i.opacity*n.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:n.paint.get("raster-brightness-min"),u_brightness_high:n.paint.get("raster-brightness-max"),u_saturation_factor:0<(a=n.paint.get("raster-saturation"))?1-1/(1.001-a):-a,u_contrast_factor:0<(o=n.paint.get("raster-contrast"))?1/(1-o):1+o,u_spin_weights:function(e){e*=Math.PI/180;var t=Math.sin(e),r=Math.cos(e);return[(2*r+1)/3,(-Math.sqrt(3)*t-r+1)/3,(Math.sqrt(3)*t-r+1)/3]}(n.paint.get("raster-hue-rotate"))};var o,a}function hn(e,t,r,i,n,o,a,s,l,u){var c=n.transform;return{u_is_size_zoom_constant:+("constant"===e||"source"===e),u_is_size_feature_constant:+("constant"===e||"camera"===e),u_size_t:t?t.uSizeT:0,u_size:t?t.uSize:0,u_camera_to_center_distance:c.cameraToCenterDistance,u_pitch:c.pitch/360*2*Math.PI,u_rotate_symbol:+r,u_aspect_ratio:c.width/c.height,u_fade_change:n.options.fadeDuration?n.symbolFadeChange:1,u_matrix:o,u_label_plane_matrix:a,u_coord_matrix:s,u_is_text:+l,u_pitch_with_map:+i,u_texsize:u,u_texture:0}}function dn(t,r,i,n,o,a,s,l,u,c,p){var h=o.transform;return e.extend(hn(t,r,i,n,o,a,s,l,u,c),{u_gamma_scale:n?Math.cos(h._pitch)*h.cameraToCenterDistance:1,u_device_pixel_ratio:e.browser.devicePixelRatio,u_is_halo:+p})}var mn,fn={fillExtrusion:function(t,r){return{u_matrix:new e.UniformMatrix4f(t,r.u_matrix),u_lightpos:new e.Uniform3f(t,r.u_lightpos),u_lightintensity:new e.Uniform1f(t,r.u_lightintensity),u_lightcolor:new e.Uniform3f(t,r.u_lightcolor),u_vertical_gradient:new e.Uniform1f(t,r.u_vertical_gradient),u_opacity:new e.Uniform1f(t,r.u_opacity)}},fillExtrusionPattern:function(t,r){return{u_matrix:new e.UniformMatrix4f(t,r.u_matrix),u_lightpos:new e.Uniform3f(t,r.u_lightpos),u_lightintensity:new e.Uniform1f(t,r.u_lightintensity),u_lightcolor:new e.Uniform3f(t,r.u_lightcolor),u_vertical_gradient:new e.Uniform1f(t,r.u_vertical_gradient),u_height_factor:new e.Uniform1f(t,r.u_height_factor),u_image:new e.Uniform1i(t,r.u_image),u_texsize:new e.Uniform2f(t,r.u_texsize),u_pixel_coord_upper:new e.Uniform2f(t,r.u_pixel_coord_upper),u_pixel_coord_lower:new e.Uniform2f(t,r.u_pixel_coord_lower),u_scale:new e.Uniform3f(t,r.u_scale),u_fade:new e.Uniform1f(t,r.u_fade),u_opacity:new e.Uniform1f(t,r.u_opacity)}},fill:function(t,r){return{u_matrix:new e.UniformMatrix4f(t,r.u_matrix)}},fillPattern:function(t,r){return{u_matrix:new e.UniformMatrix4f(t,r.u_matrix),u_image:new e.Uniform1i(t,r.u_image),u_texsize:new e.Uniform2f(t,r.u_texsize),u_pixel_coord_upper:new e.Uniform2f(t,r.u_pixel_coord_upper),u_pixel_coord_lower:new e.Uniform2f(t,r.u_pixel_coord_lower),u_scale:new e.Uniform3f(t,r.u_scale),u_fade:new e.Uniform1f(t,r.u_fade)}},fillOutline:function(t,r){return{u_matrix:new e.UniformMatrix4f(t,r.u_matrix),u_world:new e.Uniform2f(t,r.u_world)}},fillOutlinePattern:function(t,r){return{u_matrix:new e.UniformMatrix4f(t,r.u_matrix),u_world:new e.Uniform2f(t,r.u_world),u_image:new e.Uniform1i(t,r.u_image),u_texsize:new e.Uniform2f(t,r.u_texsize),u_pixel_coord_upper:new e.Uniform2f(t,r.u_pixel_coord_upper),u_pixel_coord_lower:new e.Uniform2f(t,r.u_pixel_coord_lower),u_scale:new e.Uniform3f(t,r.u_scale),u_fade:new e.Uniform1f(t,r.u_fade)}},circle:function(t,r){return{u_camera_to_center_distance:new e.Uniform1f(t,r.u_camera_to_center_distance),u_scale_with_map:new e.Uniform1i(t,r.u_scale_with_map),u_pitch_with_map:new e.Uniform1i(t,r.u_pitch_with_map),u_extrude_scale:new e.Uniform2f(t,r.u_extrude_scale),u_device_pixel_ratio:new e.Uniform1f(t,r.u_device_pixel_ratio),u_matrix:new e.UniformMatrix4f(t,r.u_matrix)}},collisionBox:function(t,r){return{u_matrix:new e.UniformMatrix4f(t,r.u_matrix),u_camera_to_center_distance:new e.Uniform1f(t,r.u_camera_to_center_distance),u_pixels_to_tile_units:new e.Uniform1f(t,r.u_pixels_to_tile_units),u_extrude_scale:new e.Uniform2f(t,r.u_extrude_scale),u_overscale_factor:new e.Uniform1f(t,r.u_overscale_factor)}},collisionCircle:function(t,r){return{u_matrix:new e.UniformMatrix4f(t,r.u_matrix),u_inv_matrix:new e.UniformMatrix4f(t,r.u_inv_matrix),u_camera_to_center_distance:new e.Uniform1f(t,r.u_camera_to_center_distance),u_viewport_size:new e.Uniform2f(t,r.u_viewport_size)}},debug:function(t,r){return{u_color:new e.UniformColor(t,r.u_color),u_matrix:new e.UniformMatrix4f(t,r.u_matrix),u_overlay:new e.Uniform1i(t,r.u_overlay),u_overlay_scale:new e.Uniform1f(t,r.u_overlay_scale)}},clippingMask:function(t,r){return{u_matrix:new e.UniformMatrix4f(t,r.u_matrix)}},heatmap:function(t,r){return{u_extrude_scale:new e.Uniform1f(t,r.u_extrude_scale),u_intensity:new e.Uniform1f(t,r.u_intensity),u_matrix:new e.UniformMatrix4f(t,r.u_matrix)}},heatmapTexture:function(t,r){return{u_matrix:new e.UniformMatrix4f(t,r.u_matrix),u_world:new e.Uniform2f(t,r.u_world),u_image:new e.Uniform1i(t,r.u_image),u_color_ramp:new e.Uniform1i(t,r.u_color_ramp),u_opacity:new e.Uniform1f(t,r.u_opacity)}},hillshade:function(t,r){return{u_matrix:new e.UniformMatrix4f(t,r.u_matrix),u_image:new e.Uniform1i(t,r.u_image),u_latrange:new e.Uniform2f(t,r.u_latrange),u_light:new e.Uniform2f(t,r.u_light),u_shadow:new e.UniformColor(t,r.u_shadow),u_highlight:new e.UniformColor(t,r.u_highlight),u_accent:new e.UniformColor(t,r.u_accent)}},hillshadePrepare:function(t,r){return{u_matrix:new e.UniformMatrix4f(t,r.u_matrix),u_image:new e.Uniform1i(t,r.u_image),u_dimension:new e.Uniform2f(t,r.u_dimension),u_zoom:new e.Uniform1f(t,r.u_zoom),u_maxzoom:new e.Uniform1f(t,r.u_maxzoom),u_unpack:new e.Uniform4f(t,r.u_unpack)}},line:function(t,r){return{u_matrix:new e.UniformMatrix4f(t,r.u_matrix),u_ratio:new e.Uniform1f(t,r.u_ratio),u_device_pixel_ratio:new e.Uniform1f(t,r.u_device_pixel_ratio),u_units_to_pixels:new e.Uniform2f(t,r.u_units_to_pixels)}},lineGradient:function(t,r){return{u_matrix:new e.UniformMatrix4f(t,r.u_matrix),u_ratio:new e.Uniform1f(t,r.u_ratio),u_device_pixel_ratio:new e.Uniform1f(t,r.u_device_pixel_ratio),u_units_to_pixels:new e.Uniform2f(t,r.u_units_to_pixels),u_image:new e.Uniform1i(t,r.u_image)}},linePattern:function(t,r){return{u_matrix:new e.UniformMatrix4f(t,r.u_matrix),u_texsize:new e.Uniform2f(t,r.u_texsize),u_ratio:new e.Uniform1f(t,r.u_ratio),u_device_pixel_ratio:new e.Uniform1f(t,r.u_device_pixel_ratio),u_image:new e.Uniform1i(t,r.u_image),u_units_to_pixels:new e.Uniform2f(t,r.u_units_to_pixels),u_scale:new e.Uniform3f(t,r.u_scale),u_fade:new e.Uniform1f(t,r.u_fade)}},lineSDF:function(t,r){return{u_matrix:new e.UniformMatrix4f(t,r.u_matrix),u_ratio:new e.Uniform1f(t,r.u_ratio),u_device_pixel_ratio:new e.Uniform1f(t,r.u_device_pixel_ratio),u_units_to_pixels:new e.Uniform2f(t,r.u_units_to_pixels),u_patternscale_a:new e.Uniform2f(t,r.u_patternscale_a),u_patternscale_b:new e.Uniform2f(t,r.u_patternscale_b),u_sdfgamma:new e.Uniform1f(t,r.u_sdfgamma),u_image:new e.Uniform1i(t,r.u_image),u_tex_y_a:new e.Uniform1f(t,r.u_tex_y_a),u_tex_y_b:new e.Uniform1f(t,r.u_tex_y_b),u_mix:new e.Uniform1f(t,r.u_mix)}},raster:function(t,r){return{u_matrix:new e.UniformMatrix4f(t,r.u_matrix),u_tl_parent:new e.Uniform2f(t,r.u_tl_parent),u_scale_parent:new e.Uniform1f(t,r.u_scale_parent),u_buffer_scale:new e.Uniform1f(t,r.u_buffer_scale),u_fade_t:new e.Uniform1f(t,r.u_fade_t),u_opacity:new e.Uniform1f(t,r.u_opacity),u_image0:new e.Uniform1i(t,r.u_image0),u_image1:new e.Uniform1i(t,r.u_image1),u_brightness_low:new e.Uniform1f(t,r.u_brightness_low),u_brightness_high:new e.Uniform1f(t,r.u_brightness_high),u_saturation_factor:new e.Uniform1f(t,r.u_saturation_factor),u_contrast_factor:new e.Uniform1f(t,r.u_contrast_factor),u_spin_weights:new e.Uniform3f(t,r.u_spin_weights)}},symbolIcon:function(t,r){return{u_is_size_zoom_constant:new e.Uniform1i(t,r.u_is_size_zoom_constant),u_is_size_feature_constant:new e.Uniform1i(t,r.u_is_size_feature_constant),u_size_t:new e.Uniform1f(t,r.u_size_t),u_size:new e.Uniform1f(t,r.u_size),u_camera_to_center_distance:new e.Uniform1f(t,r.u_camera_to_center_distance),u_pitch:new e.Uniform1f(t,r.u_pitch),u_rotate_symbol:new e.Uniform1i(t,r.u_rotate_symbol),u_aspect_ratio:new e.Uniform1f(t,r.u_aspect_ratio),u_fade_change:new e.Uniform1f(t,r.u_fade_change),u_matrix:new e.UniformMatrix4f(t,r.u_matrix),u_label_plane_matrix:new e.UniformMatrix4f(t,r.u_label_plane_matrix),u_coord_matrix:new e.UniformMatrix4f(t,r.u_coord_matrix),u_is_text:new e.Uniform1i(t,r.u_is_text),u_pitch_with_map:new e.Uniform1i(t,r.u_pitch_with_map),u_texsize:new e.Uniform2f(t,r.u_texsize),u_texture:new e.Uniform1i(t,r.u_texture)}},symbolSDF:function(t,r){return{u_is_size_zoom_constant:new e.Uniform1i(t,r.u_is_size_zoom_constant),u_is_size_feature_constant:new e.Uniform1i(t,r.u_is_size_feature_constant),u_size_t:new e.Uniform1f(t,r.u_size_t),u_size:new e.Uniform1f(t,r.u_size),u_camera_to_center_distance:new e.Uniform1f(t,r.u_camera_to_center_distance),u_pitch:new e.Uniform1f(t,r.u_pitch),u_rotate_symbol:new e.Uniform1i(t,r.u_rotate_symbol),u_aspect_ratio:new e.Uniform1f(t,r.u_aspect_ratio),u_fade_change:new e.Uniform1f(t,r.u_fade_change),u_matrix:new e.UniformMatrix4f(t,r.u_matrix),u_label_plane_matrix:new e.UniformMatrix4f(t,r.u_label_plane_matrix),u_coord_matrix:new e.UniformMatrix4f(t,r.u_coord_matrix),u_is_text:new e.Uniform1i(t,r.u_is_text),u_pitch_with_map:new e.Uniform1i(t,r.u_pitch_with_map),u_texsize:new e.Uniform2f(t,r.u_texsize),u_texture:new e.Uniform1i(t,r.u_texture),u_gamma_scale:new e.Uniform1f(t,r.u_gamma_scale),u_device_pixel_ratio:new e.Uniform1f(t,r.u_device_pixel_ratio),u_is_halo:new e.Uniform1i(t,r.u_is_halo)}},symbolTextAndIcon:function(t,r){return{u_is_size_zoom_constant:new e.Uniform1i(t,r.u_is_size_zoom_constant),u_is_size_feature_constant:new e.Uniform1i(t,r.u_is_size_feature_constant),u_size_t:new e.Uniform1f(t,r.u_size_t),u_size:new e.Uniform1f(t,r.u_size),u_camera_to_center_distance:new e.Uniform1f(t,r.u_camera_to_center_distance),u_pitch:new e.Uniform1f(t,r.u_pitch),u_rotate_symbol:new e.Uniform1i(t,r.u_rotate_symbol),u_aspect_ratio:new e.Uniform1f(t,r.u_aspect_ratio),u_fade_change:new e.Uniform1f(t,r.u_fade_change),u_matrix:new e.UniformMatrix4f(t,r.u_matrix),u_label_plane_matrix:new e.UniformMatrix4f(t,r.u_label_plane_matrix),u_coord_matrix:new e.UniformMatrix4f(t,r.u_coord_matrix),u_is_text:new e.Uniform1i(t,r.u_is_text),u_pitch_with_map:new e.Uniform1i(t,r.u_pitch_with_map),u_texsize:new e.Uniform2f(t,r.u_texsize),u_texsize_icon:new e.Uniform2f(t,r.u_texsize_icon),u_texture:new e.Uniform1i(t,r.u_texture),u_texture_icon:new e.Uniform1i(t,r.u_texture_icon),u_gamma_scale:new e.Uniform1f(t,r.u_gamma_scale),u_device_pixel_ratio:new e.Uniform1f(t,r.u_device_pixel_ratio),u_is_halo:new e.Uniform1i(t,r.u_is_halo)}},background:function(t,r){return{u_matrix:new e.UniformMatrix4f(t,r.u_matrix),u_opacity:new e.Uniform1f(t,r.u_opacity),u_color:new e.UniformColor(t,r.u_color)}},backgroundPattern:function(t,r){return{u_matrix:new e.UniformMatrix4f(t,r.u_matrix),u_opacity:new e.Uniform1f(t,r.u_opacity),u_image:new e.Uniform1i(t,r.u_image),u_pattern_tl_a:new e.Uniform2f(t,r.u_pattern_tl_a),u_pattern_br_a:new e.Uniform2f(t,r.u_pattern_br_a),u_pattern_tl_b:new e.Uniform2f(t,r.u_pattern_tl_b),u_pattern_br_b:new e.Uniform2f(t,r.u_pattern_br_b),u_texsize:new e.Uniform2f(t,r.u_texsize),u_mix:new e.Uniform1f(t,r.u_mix),u_pattern_size_a:new e.Uniform2f(t,r.u_pattern_size_a),u_pattern_size_b:new e.Uniform2f(t,r.u_pattern_size_b),u_scale_a:new e.Uniform1f(t,r.u_scale_a),u_scale_b:new e.Uniform1f(t,r.u_scale_b),u_pixel_coord_upper:new e.Uniform2f(t,r.u_pixel_coord_upper),u_pixel_coord_lower:new e.Uniform2f(t,r.u_pixel_coord_lower),u_tile_units_to_pixels:new e.Uniform1f(t,r.u_tile_units_to_pixels)}}};function yn(t,r,i,n,o,a,s){for(var l=t.context,u=l.gl,c=t.useProgram("collisionBox"),p=[],h=0,d=0,m=0;m<n.length;m++){var f=n[m],y=r.getTile(f),g=y.getBucket(i);if(g){var v=f.posMatrix;0===o[0]&&0===o[1]||(v=t.translatePosMatrix(f.posMatrix,y,o,a));var _=s?g.textCollisionBox:g.iconCollisionBox,b=g.collisionCircleArray;if(0<b.length){var x=e.create(),w=v;e.mul(x,g.placementInvProjMatrix,t.transform.glCoordMatrix),e.mul(x,x,g.placementViewportMatrix),p.push({circleArray:b,circleOffset:d,transform:w,invTransform:x}),d=h+=b.length/4}_&&c.draw(l,u.LINES,tr.disabled,rr.disabled,t.colorModeForRenderPass(),nr.disabled,(S=v,E=jr(C=y,1,(T=t.transform).zoom),I=Math.pow(2,T.zoom-C.tileID.overscaledZ),P=C.tileID.overscaleFactor(),{u_matrix:S,u_camera_to_center_distance:T.cameraToCenterDistance,u_pixels_to_tile_units:E,u_extrude_scale:[T.pixelsToGLUnits[0]/(E*I),T.pixelsToGLUnits[1]/(E*I)],u_overscale_factor:P}),i.id,_.layoutVertexBuffer,_.indexBuffer,_.segments,null,t.transform.zoom,null,null,_.collisionVertexBuffer)}}var S,T,C,E,I,P,R;if(s&&p.length){var N=t.useProgram("collisionCircle"),A=new e.StructArrayLayout2f1f2i16;A.resize(4*h),A._trim();for(var z=0,M=0,k=p;M<k.length;M+=1)for(var O=k[M],L=0;L<O.circleArray.length/4;L++){var D=4*L,B=O.circleArray[0+D],F=O.circleArray[1+D],q=O.circleArray[2+D],U=O.circleArray[3+D];A.emplace(z++,B,F,q,U,0),A.emplace(z++,B,F,q,U,1),A.emplace(z++,B,F,q,U,2),A.emplace(z++,B,F,q,U,3)}(!mn||mn.length<2*h)&&(mn=function(){var t=2*h,r=new e.StructArrayLayout3ui6;r.resize(t),r._trim();for(var i=0;i<t;i++){var n=6*i;r.uint16[0+n]=4*i+0,r.uint16[1+n]=4*i+1,r.uint16[2+n]=4*i+2,r.uint16[3+n]=4*i+2,r.uint16[4+n]=4*i+3,r.uint16[5+n]=4*i+0}return r}());for(var j=l.createIndexBuffer(mn,!0),V=l.createVertexBuffer(A,e.collisionCircleLayout.members,!0),G=0,H=p;G<H.length;G+=1){var Z=H[G],W={u_matrix:Z.transform,u_inv_matrix:Z.invTransform,u_camera_to_center_distance:(R=t.transform).cameraToCenterDistance,u_viewport_size:[R.width,R.height]};N.draw(l,u.TRIANGLES,tr.disabled,rr.disabled,t.colorModeForRenderPass(),nr.disabled,W,i.id,V,j,e.SegmentVector.simpleSegment(0,2*Z.circleOffset,Z.circleArray.length,Z.circleArray.length/2),null,t.transform.zoom,null,null,null)}V.destroy(),j.destroy()}}var gn=e.identity(new Float32Array(16));function vn(t,r,i,n,o,a,s,l,u,c,p){var h,d,m,f,y,g,v,_,b,x,w=t.text.placedSymbolArray,S=t.text.dynamicLayoutVertexArray,T=t.icon.dynamicLayoutVertexArray,C={};S.clear();for(var E=0;E<w.length;E++){var I=w.get(E),P=I.hidden||!I.crossTileID||t.allowVerticalPlacement&&!I.placedOrientation?null:n[I.crossTileID];if(P){var R=new e.Point(I.anchorX,I.anchorY),N=Nr(R,i?l:s),A=Ar(a.cameraToCenterDistance,N.signedDistanceFromCamera),z=o.evaluateSizeForFeature(t.textSizeData,c,I)*A/e.ONE_EM;i&&(z*=t.tilePixelRatio/u);for(var M=(h=P.anchor,d=P.width,m=P.height,f=P.textOffset,y=P.textBoxScale,g=z,_=-((v=e.getAnchorAlignment(h)).horizontalAlign-.5)*d,b=-(v.verticalAlign-.5)*m,x=e.evaluateVariableOffset(h,f),new e.Point((_/y+x[0])*g,(b/y+x[1])*g)),k=i?Nr(R.add(M),s).point:N.point.add(r?M.rotate(-a.angle):M),O=t.allowVerticalPlacement&&I.placedOrientation===e.WritingMode.vertical?Math.PI/2:0,L=0;L<I.numGlyphs;L++)e.addDynamicAttributes(S,k,O);p&&0<=I.associatedIconIndex&&(C[I.associatedIconIndex]={shiftedAnchor:k,angle:O})}else Fr(I.numGlyphs,S)}if(p){T.clear();for(var D=t.icon.placedSymbolArray,B=0;B<D.length;B++){var F=D.get(B);if(F.hidden)Fr(F.numGlyphs,T);else{var q=C[B];if(q)for(var U=0;U<F.numGlyphs;U++)e.addDynamicAttributes(T,q.shiftedAnchor,q.angle);else Fr(F.numGlyphs,T)}}t.icon.dynamicLayoutVertexBuffer.updateData(T)}t.text.dynamicLayoutVertexBuffer.updateData(S)}function _n(t,r,i,n,o,a,s,l,u,c,p,h){for(var d=t.context,m=d.gl,f=t.transform,y="map"===l,g="map"===u,v=y&&"point"!==i.layout.get("symbol-placement"),_=y&&!g&&!v,b=void 0!==i.layout.get("symbol-sort-key").constantOr(1),x=t.depthModeForSublayer(0,tr.ReadOnly),w=i.layout.get("text-variable-anchor"),S=[],T=0,C=n;T<C.length;T+=1){var E=C[T],I=r.getTile(E),P=I.getBucket(i);if(P){var R=o?P.text:P.icon;if(R&&R.segments.get().length){var N=R.programConfigurations.get(i.id),A=o||P.sdfIcons,z=o?P.textSizeData:P.iconSizeData,M=g||0!==f.pitch,k=t.useProgram((he=A,de=o,P.iconsInText&&de?"symbolTextAndIcon":he?"symbolSDF":"symbolIcon"),N),O=e.evaluateSizeForZoom(z,f.zoom),L=void 0,D=[0,0],B=void 0,F=void 0,q=null,U=void 0;if(o)B=I.glyphAtlasTexture,F=m.LINEAR,L=I.glyphAtlasTexture.size,P.iconsInText&&(D=I.imageAtlasTexture.size,q=I.imageAtlasTexture,U=M||t.options.rotating||t.options.zooming||"composite"===z.kind||"camera"===z.kind?m.LINEAR:m.NEAREST);else{var j=1!==i.layout.get("icon-size").constantOr(0)||P.iconsNeedLinear;B=I.imageAtlasTexture,F=A||t.options.rotating||t.options.zooming||j||M?m.LINEAR:m.NEAREST,L=I.imageAtlasTexture.size}var V=jr(I,1,t.transform.zoom),G=Pr(E.posMatrix,g,y,t.transform,V),H=Rr(E.posMatrix,g,y,t.transform,V),Z=w&&P.hasTextData(),W="none"!==i.layout.get("icon-text-fit")&&Z&&P.hasIconData();v&&zr(P,E.posMatrix,t,o,G,H,g,c);var K=t.translatePosMatrix(E.posMatrix,I,a,s),X=v||o&&w||W?gn:G,Y=t.translatePosMatrix(H,I,a,s,!0),J=A&&0!==i.paint.get(o?"text-halo-width":"icon-halo-width").constantOr(1),$={program:k,buffers:R,uniformValues:A?P.iconsInText?(re=z.kind,ie=O,ne=_,oe=g,ae=t,se=K,le=X,ue=Y,ce=L,pe=D,e.extend(dn(re,ie,ne,oe,ae,se,le,ue,!0,ce,!0),{u_texsize_icon:pe,u_texture_icon:1})):dn(z.kind,O,_,g,t,K,X,Y,o,L,!0):hn(z.kind,O,_,g,t,K,X,Y,o,L),atlasTexture:B,atlasTextureIcon:q,atlasInterpolation:F,atlasInterpolationIcon:U,isSDF:A,hasHalo:J};if(b)for(var Q=0,ee=R.segments.get();Q<ee.length;Q+=1){var te=ee[Q];S.push({segments:new e.SegmentVector([te]),sortKey:te.sortKey,state:$})}else S.push({segments:R.segments,sortKey:0,state:$})}}}var re,ie,ne,oe,ae,se,le,ue,ce,pe,he,de;b&&S.sort((function(e,t){return e.sortKey-t.sortKey}));for(var me=0,fe=S;me<fe.length;me+=1){var ye=fe[me],ge=ye.state;if(d.activeTexture.set(m.TEXTURE0),ge.atlasTexture.bind(ge.atlasInterpolation,m.CLAMP_TO_EDGE),ge.atlasTextureIcon&&(d.activeTexture.set(m.TEXTURE1),ge.atlasTextureIcon&&ge.atlasTextureIcon.bind(ge.atlasInterpolationIcon,m.CLAMP_TO_EDGE)),ge.isSDF){var ve=ge.uniformValues;ge.hasHalo&&(ve.u_is_halo=1,bn(ge.buffers,ye.segments,i,t,ge.program,x,p,h,ve)),ve.u_is_halo=0}bn(ge.buffers,ye.segments,i,t,ge.program,x,p,h,ge.uniformValues)}}function bn(e,t,r,i,n,o,a,s,l){var u=i.context;n.draw(u,u.gl.TRIANGLES,o,a,s,nr.disabled,l,r.id,e.layoutVertexBuffer,e.indexBuffer,t,r.paint,i.transform.zoom,e.programConfigurations.get(r.id),e.dynamicLayoutVertexBuffer,e.opacityVertexBuffer)}function xn(t,r,i,n,o,a,s){var l,u,c,p,h,d,m,f,y,g,v=t.context.gl,_=i.paint.get("fill-pattern"),b=_&&_.constantOr(1),x=i.getCrossfadeParameters();l=s?(u=b&&!i.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",v.LINES):(u=b?"fillPattern":"fill",v.TRIANGLES);for(var w=0,S=n;w<S.length;w+=1){var T=S[w],C=r.getTile(T);if(!b||C.patternsLoaded()){var E=C.getBucket(i);if(E){var I=E.programConfigurations.get(i.id),P=t.useProgram(u,I);b&&(t.context.activeTexture.set(v.TEXTURE0),C.imageAtlasTexture.bind(v.LINEAR,v.CLAMP_TO_EDGE),I.updatePaintBuffers(x));var R=_.constantOr(null);if(R&&C.imageAtlas){var N=C.imageAtlas,A=N.patternPositions[R.to.toString()],z=N.patternPositions[R.from.toString()];A&&z&&I.setConstantPatternPositions(A,z)}var M=t.translatePosMatrix(T.posMatrix,C,i.paint.get("fill-translate"),i.paint.get("fill-translate-anchor"));if(s){p=E.indexBuffer2,h=E.segments2;var k=[v.drawingBufferWidth,v.drawingBufferHeight];c="fillOutlinePattern"===u&&b?(d=M,m=t,f=x,y=C,g=k,e.extend(nn(d,m,f,y),{u_world:g})):{u_matrix:M,u_world:k}}else p=E.indexBuffer,h=E.segments,c=b?nn(M,t,x,C):rn(M);P.draw(t.context,l,o,t.stencilModeForClipping(T),a,nr.disabled,c,i.id,E.layoutVertexBuffer,p,h,i.paint,t.transform.zoom,I)}}}}function wn(t,r,i,n,o,a,s){for(var l=t.context,u=l.gl,c=i.paint.get("fill-extrusion-pattern"),p=c.constantOr(1),h=i.getCrossfadeParameters(),d=i.paint.get("fill-extrusion-opacity"),m=0,f=n;m<f.length;m+=1){var y=f[m],g=r.getTile(y),v=g.getBucket(i);if(v){var _=v.programConfigurations.get(i.id),b=t.useProgram(p?"fillExtrusionPattern":"fillExtrusion",_);p&&(t.context.activeTexture.set(u.TEXTURE0),g.imageAtlasTexture.bind(u.LINEAR,u.CLAMP_TO_EDGE),_.updatePaintBuffers(h));var x=c.constantOr(null);if(x&&g.imageAtlas){var w=g.imageAtlas,S=w.patternPositions[x.to.toString()],T=w.patternPositions[x.from.toString()];S&&T&&_.setConstantPatternPositions(S,T)}var C=t.translatePosMatrix(y.posMatrix,g,i.paint.get("fill-extrusion-translate"),i.paint.get("fill-extrusion-translate-anchor")),E=i.paint.get("fill-extrusion-vertical-gradient"),I=p?(P=C,R=t,N=E,A=d,z=y,M=h,k=g,e.extend(tn(P,R,N,A),en(M,R,k),{u_height_factor:-Math.pow(2,z.overscaledZ)/k.tileSize/8})):tn(C,t,E,d);b.draw(l,l.gl.TRIANGLES,o,a,s,nr.backCCW,I,i.id,v.layoutVertexBuffer,v.indexBuffer,v.segments,i.paint,t.transform.zoom,_)}}var P,R,N,A,z,M,k}function Sn(t,r,i,n,o,a){var s=t.context,l=s.gl,u=r.fbo;if(u){var c=t.useProgram("hillshade");s.activeTexture.set(l.TEXTURE0),l.bindTexture(l.TEXTURE_2D,u.colorAttachment.get());var p=function(t,r,i){var n=i.paint.get("hillshade-shadow-color"),o=i.paint.get("hillshade-highlight-color"),a=i.paint.get("hillshade-accent-color"),s=i.paint.get("hillshade-illumination-direction")*(Math.PI/180);"viewport"===i.paint.get("hillshade-illumination-anchor")&&(s-=t.transform.angle);var l,u,c,p=!t.options.moving;return{u_matrix:t.transform.calculatePosMatrix(r.tileID.toUnwrapped(),p),u_image:0,u_latrange:(l=r.tileID,u=Math.pow(2,l.canonical.z),c=l.canonical.y,[new e.MercatorCoordinate(0,c/u).toLngLat().lat,new e.MercatorCoordinate(0,(c+1)/u).toLngLat().lat]),u_light:[i.paint.get("hillshade-exaggeration"),s],u_shadow:n,u_highlight:o,u_accent:a}}(t,r,i);c.draw(s,l.TRIANGLES,n,o,a,nr.disabled,p,i.id,t.rasterBoundsBuffer,t.quadTriangleIndexBuffer,t.rasterBoundsSegments)}}function Tn(t,r,i,n,o,a,s){var l,u,c,p,h,d=t.context,m=d.gl,f=r.dem;if(f&&f.data){var y=f.dim,g=f.stride,v=f.getPixels();if(d.activeTexture.set(m.TEXTURE1),d.pixelStoreUnpackPremultiplyAlpha.set(!1),r.demTexture=r.demTexture||t.getTileTexture(g),r.demTexture){var _=r.demTexture;_.update(v,{premultiply:!1}),_.bind(m.NEAREST,m.CLAMP_TO_EDGE)}else r.demTexture=new e.Texture(d,v,m.RGBA,{premultiply:!1}),r.demTexture.bind(m.NEAREST,m.CLAMP_TO_EDGE);d.activeTexture.set(m.TEXTURE0);var b=r.fbo;if(!b){var x=new e.Texture(d,{width:y,height:y,data:null},m.RGBA);x.bind(m.LINEAR,m.CLAMP_TO_EDGE),(b=r.fbo=d.createFramebuffer(y,y,!0)).colorAttachment.set(x.texture)}d.bindFramebuffer.set(b.framebuffer),d.viewport.set([0,0,y,y]),t.useProgram("hillshadePrepare").draw(d,m.TRIANGLES,o,a,s,nr.disabled,(l=r.tileID,c=n,p=(u=f).stride,h=e.create(),e.ortho(h,0,e.EXTENT,-e.EXTENT,0,0,1),e.translate(h,h,[0,-e.EXTENT,0]),{u_matrix:h,u_image:1,u_dimension:[p,p],u_zoom:l.overscaledZ,u_maxzoom:c,u_unpack:u.getUnpackVector()}),i.id,t.rasterBoundsBuffer,t.quadTriangleIndexBuffer,t.rasterBoundsSegments),r.needsHillshadePrepare=!1}}function Cn(t,r,i,n,o){var a=n.paint.get("raster-fade-duration");if(0<a){var s=e.browser.now(),l=(s-t.timeAdded)/a,u=r?(s-r.timeAdded)/a:-1,c=i.getSource(),p=o.coveringZoomLevel({tileSize:c.tileSize,roundZoom:c.roundZoom}),h=!r||Math.abs(r.tileID.overscaledZ-p)>Math.abs(t.tileID.overscaledZ-p),d=h&&t.refreshedUponExpiration?1:e.clamp(h?l:1-u,0,1);return t.refreshedUponExpiration&&1<=l&&(t.refreshedUponExpiration=!1),r?{opacity:1,mix:1-d}:{opacity:d,mix:0}}return{opacity:1,mix:0}}var En=new e.Color(1,0,0,1),In=new e.Color(0,1,0,1),Pn=new e.Color(0,0,1,1),Rn=new e.Color(1,0,1,1),Nn=new e.Color(0,1,1,1);function An(e,t,r,i){Mn(e,0,t+r/2,e.transform.width,r,i)}function zn(e,t,r,i){Mn(e,t-r/2,0,r,e.transform.height,i)}function Mn(t,r,i,n,o,a){var s=t.context,l=s.gl;l.enable(l.SCISSOR_TEST),l.scissor(r*e.browser.devicePixelRatio,i*e.browser.devicePixelRatio,n*e.browser.devicePixelRatio,o*e.browser.devicePixelRatio),s.clear({color:a}),l.disable(l.SCISSOR_TEST)}function kn(t,r,i){var n=t.context,o=n.gl,a=i.posMatrix,s=t.useProgram("debug"),l=tr.disabled,u=rr.disabled,c=t.colorModeForRenderPass();n.activeTexture.set(o.TEXTURE0),t.emptyTexture.bind(o.LINEAR,o.CLAMP_TO_EDGE),s.draw(n,o.LINE_STRIP,l,u,c,nr.disabled,ln(a,e.Color.red),"$debug",t.debugBuffer,t.tileBorderIndexBuffer,t.debugSegments);var p=r.getTileByID(i.key).latestRawTileData,h=Math.floor((p&&p.byteLength||0)/1024),d=r.getTile(i).tileSize,m=512/Math.min(d,512)*(i.overscaledZ/t.transform.zoom)*.5,f=i.canonical.toString();i.overscaledZ!==i.canonical.z&&(f+=" => "+i.overscaledZ),function(e,t){e.initDebugOverlayCanvas();var r=e.debugOverlayCanvas,i=e.context.gl,n=e.debugOverlayCanvas.getContext("2d");n.clearRect(0,0,r.width,r.height),n.shadowColor="white",n.shadowBlur=2,n.lineWidth=1.5,n.strokeStyle="white",n.textBaseline="top",n.font="bold 36px Open Sans, sans-serif",n.fillText(t,5,5),n.strokeText(t,5,5),e.debugOverlayTexture.update(r),e.debugOverlayTexture.bind(i.LINEAR,i.CLAMP_TO_EDGE)}(t,f+" "+h+"kb"),s.draw(n,o.TRIANGLES,l,u,ir.alphaBlended,nr.disabled,ln(a,e.Color.transparent,m),"$debug",t.debugBuffer,t.quadTriangleIndexBuffer,t.debugSegments)}function On(e,t){this.context=new or(e),this.transform=t,this._tileTextures={},this.setup(),this.numSublayers=sr.maxUnderzooming+sr.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new mi,this.gpuTimers={}}var Ln={symbol:function(t,r,i,n,o){if("translucent"===t.renderPass){var a=rr.disabled,s=t.colorModeForRenderPass();i.layout.get("text-variable-anchor")&&function(t,r,i,n,o,a,s){for(var l=r.transform,u="map"===o,c="map"===a,p=0,h=t;p<h.length;p+=1){var d=h[p],m=n.getTile(d),f=m.getBucket(i);if(f&&f.text&&f.text.segments.get().length){var y=e.evaluateSizeForZoom(f.textSizeData,l.zoom),g=jr(m,1,r.transform.zoom),v=Pr(d.posMatrix,c,u,r.transform,g),_="none"!==i.layout.get("icon-text-fit")&&f.hasIconData();if(y){var b=Math.pow(2,l.zoom-m.tileID.overscaledZ);vn(f,u,c,s,e.symbolSize,l,v,d.posMatrix,b,y,_)}}}}(n,t,i,r,i.layout.get("text-rotation-alignment"),i.layout.get("text-pitch-alignment"),o),0!==i.paint.get("icon-opacity").constantOr(1)&&_n(t,r,i,n,!1,i.paint.get("icon-translate"),i.paint.get("icon-translate-anchor"),i.layout.get("icon-rotation-alignment"),i.layout.get("icon-pitch-alignment"),i.layout.get("icon-keep-upright"),a,s),0!==i.paint.get("text-opacity").constantOr(1)&&_n(t,r,i,n,!0,i.paint.get("text-translate"),i.paint.get("text-translate-anchor"),i.layout.get("text-rotation-alignment"),i.layout.get("text-pitch-alignment"),i.layout.get("text-keep-upright"),a,s),r.map.showCollisionBoxes&&(yn(t,r,i,n,i.paint.get("text-translate"),i.paint.get("text-translate-anchor"),!0),yn(t,r,i,n,i.paint.get("icon-translate"),i.paint.get("icon-translate-anchor"),!1))}},circle:function(t,r,i,n){if("translucent"===t.renderPass){var o=i.paint.get("circle-opacity"),a=i.paint.get("circle-stroke-width"),s=i.paint.get("circle-stroke-opacity"),l=void 0!==i.layout.get("circle-sort-key").constantOr(1);if(0!==o.constantOr(1)||0!==a.constantOr(1)&&0!==s.constantOr(1)){for(var u=t.context,c=u.gl,p=t.depthModeForSublayer(0,tr.ReadOnly),h=rr.disabled,d=t.colorModeForRenderPass(),m=[],f=0;f<n.length;f++){var y=n[f],g=r.getTile(y),v=g.getBucket(i);if(v){var _=v.programConfigurations.get(i.id),b={programConfiguration:_,program:t.useProgram("circle",_),layoutVertexBuffer:v.layoutVertexBuffer,indexBuffer:v.indexBuffer,uniformValues:on(t,y,g,i)};if(l)for(var x=0,w=v.segments.get();x<w.length;x+=1){var S=w[x];m.push({segments:new e.SegmentVector([S]),sortKey:S.sortKey,state:b})}else m.push({segments:v.segments,sortKey:0,state:b})}}l&&m.sort((function(e,t){return e.sortKey-t.sortKey}));for(var T=0,C=m;T<C.length;T+=1){var E=C[T],I=E.state;I.program.draw(u,c.TRIANGLES,p,h,d,nr.disabled,I.uniformValues,i.id,I.layoutVertexBuffer,I.indexBuffer,E.segments,i.paint,t.transform.zoom,I.programConfiguration)}}}},heatmap:function(t,r,i,n){if(0!==i.paint.get("heatmap-opacity"))if("offscreen"===t.renderPass){var o=t.context,a=o.gl,s=rr.disabled,l=new ir([a.ONE,a.ONE],e.Color.transparent,[!0,!0,!0,!0]);!function(e,t,r){var i=e.gl;e.activeTexture.set(i.TEXTURE1),e.viewport.set([0,0,t.width/4,t.height/4]);var n,o,a,s=r.heatmapFbo;if(s)i.bindTexture(i.TEXTURE_2D,s.colorAttachment.get()),e.bindFramebuffer.set(s.framebuffer);else{var l=i.createTexture();i.bindTexture(i.TEXTURE_2D,l),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.LINEAR),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,i.LINEAR),n=l,o=s=r.heatmapFbo=e.createFramebuffer(t.width/4,t.height/4,!1),(a=e.gl).texImage2D(a.TEXTURE_2D,0,a.RGBA,t.width/4,t.height/4,0,a.RGBA,e.extRenderToTextureHalfFloat?e.extTextureHalfFloat.HALF_FLOAT_OES:a.UNSIGNED_BYTE,null),o.colorAttachment.set(n)}}(o,t,i),o.clear({color:e.Color.transparent});for(var u=0;u<n.length;u++){var c=n[u];if(!r.hasRenderableParent(c)){var p=r.getTile(c),h=p.getBucket(i);if(h){var d=h.programConfigurations.get(i.id);t.useProgram("heatmap",d).draw(o,a.TRIANGLES,tr.disabled,s,l,nr.disabled,(m=c.posMatrix,f=p,y=t.transform.zoom,g=i.paint.get("heatmap-intensity"),{u_matrix:m,u_extrude_scale:jr(f,1,y),u_intensity:g}),i.id,h.layoutVertexBuffer,h.indexBuffer,h.segments,i.paint,t.transform.zoom,d)}}}o.viewport.set([0,0,t.width,t.height])}else"translucent"===t.renderPass&&(t.context.setColorMode(t.colorModeForRenderPass()),function(t,r){var i=t.context,n=i.gl,o=r.heatmapFbo;if(o){i.activeTexture.set(n.TEXTURE0),n.bindTexture(n.TEXTURE_2D,o.colorAttachment.get()),i.activeTexture.set(n.TEXTURE1);var a=r.colorRampTexture;(a=a||(r.colorRampTexture=new e.Texture(i,r.colorRamp,n.RGBA))).bind(n.LINEAR,n.CLAMP_TO_EDGE),t.useProgram("heatmapTexture").draw(i,n.TRIANGLES,tr.disabled,rr.disabled,t.colorModeForRenderPass(),nr.disabled,function(t,r){var i=e.create();e.ortho(i,0,t.width,t.height,0,0,1);var n=t.context.gl;return{u_matrix:i,u_world:[n.drawingBufferWidth,n.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:r.paint.get("heatmap-opacity")}}(t,r),r.id,t.viewportBuffer,t.quadTriangleIndexBuffer,t.viewportSegments,r.paint,t.transform.zoom)}}(t,i));var m,f,y,g},line:function(t,r,i,n){if("translucent"===t.renderPass){var o=i.paint.get("line-opacity"),a=i.paint.get("line-width");if(0!==o.constantOr(1)&&0!==a.constantOr(1)){var s=t.depthModeForSublayer(0,tr.ReadOnly),l=t.colorModeForRenderPass(),u=i.paint.get("line-dasharray"),c=i.paint.get("line-pattern"),p=c.constantOr(1),h=i.paint.get("line-gradient"),d=i.getCrossfadeParameters(),m=p?"linePattern":u?"lineSDF":h?"lineGradient":"line",f=t.context,y=f.gl,g=!0;if(h){f.activeTexture.set(y.TEXTURE0);var v=i.gradientTexture;if(!i.gradient)return;(v=v||(i.gradientTexture=new e.Texture(f,i.gradient,y.RGBA))).bind(y.LINEAR,y.CLAMP_TO_EDGE)}for(var _=0,b=n;_<b.length;_+=1){var x=b[_],w=r.getTile(x);if(!p||w.patternsLoaded()){var S=w.getBucket(i);if(S){var T=S.programConfigurations.get(i.id),C=t.context.program.get(),E=t.useProgram(m,T),I=g||E.program!==C,P=c.constantOr(null);if(P&&w.imageAtlas){var R=w.imageAtlas,N=R.patternPositions[P.to.toString()],A=R.patternPositions[P.from.toString()];N&&A&&T.setConstantPatternPositions(N,A)}var z=p?(Y=i,J=d,Q=un(X=w,$=(K=t).transform),{u_matrix:cn(K,X,Y),u_texsize:X.imageAtlasTexture.size,u_ratio:1/jr(X,1,$.zoom),u_device_pixel_ratio:e.browser.devicePixelRatio,u_image:0,u_scale:[Q,J.fromScale,J.toScale],u_fade:J.t,u_units_to_pixels:[1/$.pixelsToGLUnits[0],1/$.pixelsToGLUnits[1]]}):u?(D=w,B=i,F=u,q=d,U=void 0,U=(L=t).lineAtlas,j=un(D,L.transform),V="round"===B.layout.get("line-cap"),G=U.getDash(F.from,V),H=U.getDash(F.to,V),Z=G.width*q.fromScale,W=H.width*q.toScale,e.extend(sn(L,D,B),{u_patternscale_a:[j/Z,-G.height/2],u_patternscale_b:[j/W,-H.height/2],u_sdfgamma:U.width/(256*Math.min(Z,W)*e.browser.devicePixelRatio)/2,u_image:0,u_tex_y_a:G.y,u_tex_y_b:H.y,u_mix:q.t})):h?(M=t,k=w,O=i,e.extend(sn(M,k,O),{u_image:0})):sn(t,w,i);p?(f.activeTexture.set(y.TEXTURE0),w.imageAtlasTexture.bind(y.LINEAR,y.CLAMP_TO_EDGE),T.updatePaintBuffers(d)):u&&(I||t.lineAtlas.dirty)&&(f.activeTexture.set(y.TEXTURE0),t.lineAtlas.bind(f)),E.draw(f,y.TRIANGLES,s,t.stencilModeForClipping(x),l,nr.disabled,z,i.id,S.layoutVertexBuffer,S.indexBuffer,S.segments,i.paint,t.transform.zoom,T),g=!1}}}}}var M,k,O,L,D,B,F,q,U,j,V,G,H,Z,W,K,X,Y,J,$,Q},fill:function(t,r,i,n){var o=i.paint.get("fill-color"),a=i.paint.get("fill-opacity");if(0!==a.constantOr(1)){var s=t.colorModeForRenderPass(),l=i.paint.get("fill-pattern"),u=t.opaquePassEnabledForLayer()&&!l.constantOr(1)&&1===o.constantOr(e.Color.transparent).a&&1===a.constantOr(0)?"opaque":"translucent";if(t.renderPass===u){var c=t.depthModeForSublayer(1,"opaque"===t.renderPass?tr.ReadWrite:tr.ReadOnly);xn(t,r,i,n,c,s,!1)}if("translucent"===t.renderPass&&i.paint.get("fill-antialias")){var p=t.depthModeForSublayer(i.getPaintProperty("fill-outline-color")?2:0,tr.ReadOnly);xn(t,r,i,n,p,s,!0)}}},"fill-extrusion":function(e,t,r,i){var n=r.paint.get("fill-extrusion-opacity");if(0!==n&&"translucent"===e.renderPass){var o=new tr(e.context.gl.LEQUAL,tr.ReadWrite,e.depthRangeFor3D);if(1!==n||r.paint.get("fill-extrusion-pattern").constantOr(1))wn(e,t,r,i,o,rr.disabled,ir.disabled),wn(e,t,r,i,o,e.stencilModeFor3D(),e.colorModeForRenderPass());else{var a=e.colorModeForRenderPass();wn(e,t,r,i,o,rr.disabled,a)}}},hillshade:function(e,t,r,i){if("offscreen"===e.renderPass||"translucent"===e.renderPass){for(var n=e.context,o=t.getSource().maxzoom,a=e.depthModeForSublayer(0,tr.ReadOnly),s=e.colorModeForRenderPass(),l="translucent"===e.renderPass?e.stencilConfigForOverlap(i):[{},i],u=l[0],c=0,p=l[1];c<p.length;c+=1){var h=p[c],d=t.getTile(h);d.needsHillshadePrepare&&"offscreen"===e.renderPass?Tn(e,d,r,o,a,rr.disabled,s):"translucent"===e.renderPass&&Sn(e,d,r,a,u[h.overscaledZ],s)}n.viewport.set([0,0,e.width,e.height])}},raster:function(e,t,r,i){if("translucent"===e.renderPass&&0!==r.paint.get("raster-opacity")&&i.length)for(var n=e.context,o=n.gl,a=t.getSource(),s=e.useProgram("raster"),l=e.colorModeForRenderPass(),u=a instanceof j?[{},i]:e.stencilConfigForOverlap(i),c=u[0],p=u[1],h=p[p.length-1].overscaledZ,d=!e.options.moving,m=0,f=p;m<f.length;m+=1){var y=f[m],g=e.depthModeForSublayer(y.overscaledZ-h,1===r.paint.get("raster-opacity")?tr.ReadWrite:tr.ReadOnly,o.LESS),v=t.getTile(y),_=e.transform.calculatePosMatrix(y.toUnwrapped(),d);v.registerFadeDuration(r.paint.get("raster-fade-duration"));var b=t.findLoadedParent(y,0),x=Cn(v,b,t,r,e.transform),w=void 0,S=void 0,T="nearest"===r.paint.get("raster-resampling")?o.NEAREST:o.LINEAR;n.activeTexture.set(o.TEXTURE0),v.texture.bind(T,o.CLAMP_TO_EDGE,o.LINEAR_MIPMAP_NEAREST),n.activeTexture.set(o.TEXTURE1),b?(b.texture.bind(T,o.CLAMP_TO_EDGE,o.LINEAR_MIPMAP_NEAREST),w=Math.pow(2,b.tileID.overscaledZ-v.tileID.overscaledZ),S=[v.tileID.canonical.x*w%1,v.tileID.canonical.y*w%1]):v.texture.bind(T,o.CLAMP_TO_EDGE,o.LINEAR_MIPMAP_NEAREST);var C=pn(_,S||[0,0],w||1,x,r);a instanceof j?s.draw(n,o.TRIANGLES,g,rr.disabled,l,nr.disabled,C,r.id,a.boundsBuffer,e.quadTriangleIndexBuffer,a.boundsSegments):s.draw(n,o.TRIANGLES,g,c[y.overscaledZ],l,nr.disabled,C,r.id,e.rasterBoundsBuffer,e.quadTriangleIndexBuffer,e.rasterBoundsSegments)}},background:function(t,r,i){var n,o,a,s,l,u,c,p,h,d,m,f,y,g,v,_,b,x,w,S=i.paint.get("background-color"),T=i.paint.get("background-opacity");if(0!==T){var C=t.context,E=C.gl,I=t.transform,P=I.tileSize,R=i.paint.get("background-pattern");if(!t.isPatternMissing(R)){var N=!R&&1===S.a&&1===T&&t.opaquePassEnabledForLayer()?"opaque":"translucent";if(t.renderPass===N){var A=rr.disabled,z=t.depthModeForSublayer(0,"opaque"==N?tr.ReadWrite:tr.ReadOnly),M=t.colorModeForRenderPass(),k=t.useProgram(R?"backgroundPattern":"background"),O=I.coveringTiles({tileSize:P});R&&(C.activeTexture.set(E.TEXTURE0),t.imageManager.bind(t.context));for(var L=i.getCrossfadeParameters(),D=0,B=O;D<B.length;D+=1){var F=B[D],q=t.transform.calculatePosMatrix(F.toUnwrapped()),U=R?(n=q,o=T,a=t,s=R,l={tileID:F,tileSize:P},u=L,h=c=void 0,e.extend((c=s,p=u,d=l,m=(h=a).imageManager.getPattern(c.from.toString()),f=h.imageManager.getPattern(c.to.toString()),g=(y=h.imageManager.getPixelSize()).width,v=y.height,_=Math.pow(2,d.tileID.overscaledZ),x=(b=d.tileSize*Math.pow(2,h.transform.tileZoom)/_)*(d.tileID.canonical.x+d.tileID.wrap*_),w=b*d.tileID.canonical.y,{u_image:0,u_pattern_tl_a:m.tl,u_pattern_br_a:m.br,u_pattern_tl_b:f.tl,u_pattern_br_b:f.br,u_texsize:[g,v],u_mix:p.t,u_pattern_size_a:m.displaySize,u_pattern_size_b:f.displaySize,u_scale_a:p.fromScale,u_scale_b:p.toScale,u_tile_units_to_pixels:1/jr(d,1,h.transform.tileZoom),u_pixel_coord_upper:[x>>16,w>>16],u_pixel_coord_lower:[65535&x,65535&w]}),{u_matrix:n,u_opacity:o})):{u_matrix:q,u_opacity:T,u_color:S};k.draw(C,E.TRIANGLES,z,A,M,nr.disabled,U,i.id,t.tileExtentBuffer,t.quadTriangleIndexBuffer,t.tileExtentSegments)}}}}},debug:function(e,t,r){for(var i=0;i<r.length;i++)kn(e,t,r[i])},custom:function(e,t,r){var i=e.context,n=r.implementation;if("offscreen"===e.renderPass){var o=n.prerender;o&&(e.setCustomLayerDefaults(),i.setColorMode(e.colorModeForRenderPass()),o.call(n,i.gl,e.transform.customLayerMatrix()),i.setDirty(),e.setBaseState())}else if("translucent"===e.renderPass){e.setCustomLayerDefaults(),i.setColorMode(e.colorModeForRenderPass()),i.setStencilMode(rr.disabled);var a="3d"===n.renderingMode?new tr(e.context.gl.LEQUAL,tr.ReadWrite,e.depthRangeFor3D):e.depthModeForSublayer(0,tr.ReadOnly);i.setDepthMode(a),n.render(i.gl,e.transform.customLayerMatrix()),i.setDirty(),e.setBaseState(),i.bindFramebuffer.set(null)}}};function Dn(e,t){this.points=e,this.planes=t}function Bn(t,r){this.min=t,this.max=r,this.center=e.scale$2([],e.add([],this.min,this.max),.5)}function Fn(e,t,r,i){if(void 0===e&&(e=0),void 0===t&&(t=0),void 0===r&&(r=0),void 0===i&&(i=0),isNaN(e)||e<0||isNaN(t)||t<0||isNaN(r)||r<0||isNaN(i)||i<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=e,this.bottom=t,this.left=r,this.right=i}function qn(t,r,i,n,o){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=void 0===o||o,this._minZoom=t||0,this._maxZoom=r||22,this._minPitch=null==i?0:i,this._maxPitch=null==n?60:n,this.setMaxBounds(),this.width=0,this.height=0,this._center=new e.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new Fn,this._posMatrixCache={},this._alignedPosMatrixCache={}}On.prototype.resize=function(t,r){if(this.width=t*e.browser.devicePixelRatio,this.height=r*e.browser.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(var i=0,n=this.style._order;i<n.length;i+=1)this.style._layers[n[i]].resize()},On.prototype.setup=function(){var t=this.context,r=new e.StructArrayLayout2i4;r.emplaceBack(0,0),r.emplaceBack(e.EXTENT,0),r.emplaceBack(0,e.EXTENT),r.emplaceBack(e.EXTENT,e.EXTENT),this.tileExtentBuffer=t.createVertexBuffer(r,wi.members),this.tileExtentSegments=e.SegmentVector.simpleSegment(0,0,4,2);var i=new e.StructArrayLayout2i4;i.emplaceBack(0,0),i.emplaceBack(e.EXTENT,0),i.emplaceBack(0,e.EXTENT),i.emplaceBack(e.EXTENT,e.EXTENT),this.debugBuffer=t.createVertexBuffer(i,wi.members),this.debugSegments=e.SegmentVector.simpleSegment(0,0,4,5);var n=new e.StructArrayLayout4i8;n.emplaceBack(0,0,0,0),n.emplaceBack(e.EXTENT,0,e.EXTENT,0),n.emplaceBack(0,e.EXTENT,0,e.EXTENT),n.emplaceBack(e.EXTENT,e.EXTENT,e.EXTENT,e.EXTENT),this.rasterBoundsBuffer=t.createVertexBuffer(n,U.members),this.rasterBoundsSegments=e.SegmentVector.simpleSegment(0,0,4,2);var o=new e.StructArrayLayout2i4;o.emplaceBack(0,0),o.emplaceBack(1,0),o.emplaceBack(0,1),o.emplaceBack(1,1),this.viewportBuffer=t.createVertexBuffer(o,wi.members),this.viewportSegments=e.SegmentVector.simpleSegment(0,0,4,2);var a=new e.StructArrayLayout1ui2;a.emplaceBack(0),a.emplaceBack(1),a.emplaceBack(3),a.emplaceBack(2),a.emplaceBack(0),this.tileBorderIndexBuffer=t.createIndexBuffer(a);var s=new e.StructArrayLayout3ui6;s.emplaceBack(0,1,2),s.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=t.createIndexBuffer(s),this.emptyTexture=new e.Texture(t,{width:1,height:1,data:new Uint8Array([0,0,0,0])},t.gl.RGBA);var l=this.context.gl;this.stencilClearMode=new rr({func:l.ALWAYS,mask:0},0,255,l.ZERO,l.ZERO,l.ZERO)},On.prototype.clearStencil=function(){var t=this.context,r=t.gl;this.nextStencilID=1,this.currentStencilSource=void 0;var i=e.create();e.ortho(i,0,this.width,this.height,0,0,1),e.scale(i,i,[r.drawingBufferWidth,r.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(t,r.TRIANGLES,tr.disabled,this.stencilClearMode,ir.disabled,nr.disabled,an(i),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)},On.prototype._renderTileClippingMasks=function(e,t){if(this.currentStencilSource!==e.source&&e.isTileClipped()&&t&&t.length){this.currentStencilSource=e.source;var r=this.context,i=r.gl;256<this.nextStencilID+t.length&&this.clearStencil(),r.setColorMode(ir.disabled),r.setDepthMode(tr.disabled);var n=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(var o=0,a=t;o<a.length;o+=1){var s=a[o],l=this._tileClippingMaskIDs[s.key]=this.nextStencilID++;n.draw(r,i.TRIANGLES,tr.disabled,new rr({func:i.ALWAYS,mask:0},l,255,i.KEEP,i.KEEP,i.REPLACE),ir.disabled,nr.disabled,an(s.posMatrix),"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}},On.prototype.stencilModeFor3D=function(){this.currentStencilSource=void 0,256<this.nextStencilID+1&&this.clearStencil();var e=this.nextStencilID++,t=this.context.gl;return new rr({func:t.NOTEQUAL,mask:255},e,255,t.KEEP,t.KEEP,t.REPLACE)},On.prototype.stencilModeForClipping=function(e){var t=this.context.gl;return new rr({func:t.EQUAL,mask:255},this._tileClippingMaskIDs[e.key],0,t.KEEP,t.KEEP,t.REPLACE)},On.prototype.stencilConfigForOverlap=function(e){var t,r=this.context.gl,i=e.sort((function(e,t){return t.overscaledZ-e.overscaledZ})),n=i[i.length-1].overscaledZ,o=i[0].overscaledZ-n+1;if(1<o){this.currentStencilSource=void 0,256<this.nextStencilID+o&&this.clearStencil();for(var a={},s=0;s<o;s++)a[s+n]=new rr({func:r.GEQUAL,mask:255},s+this.nextStencilID,255,r.KEEP,r.KEEP,r.REPLACE);return this.nextStencilID+=o,[a,i]}return[((t={})[n]=rr.disabled,t),i]},On.prototype.colorModeForRenderPass=function(){var t=this.context.gl;return this._showOverdrawInspector?new ir([t.CONSTANT_COLOR,t.ONE],new e.Color(1/8,1/8,1/8,0),[!0,!0,!0,!0]):"opaque"===this.renderPass?ir.unblended:ir.alphaBlended},On.prototype.depthModeForSublayer=function(e,t,r){if(!this.opaquePassEnabledForLayer())return tr.disabled;var i=1-((1+this.currentLayer)*this.numSublayers+e)*this.depthEpsilon;return new tr(r||this.context.gl.LEQUAL,t,[i,i])},On.prototype.opaquePassEnabledForLayer=function(){return this.currentLayer<this.opaquePassCutoff},On.prototype.render=function(t,r){var i=this;this.style=t,this.options=r,this.lineAtlas=t.lineAtlas,this.imageManager=t.imageManager,this.glyphManager=t.glyphManager,this.symbolFadeChange=t.placement.symbolFadeChange(e.browser.now()),this.imageManager.beginFrame();var n=this.style._order,o=this.style.sourceCaches;for(var a in o){var s=o[a];s.used&&s.prepare(this.context)}var l,u,c={},p={},h={};for(var d in o){var m=o[d];c[d]=m.getVisibleCoordinates(),p[d]=c[d].slice().reverse(),h[d]=m.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(var f=0;f<n.length;f++)if(this.style._layers[n[f]].is3D()){this.opaquePassCutoff=f;break}this.renderPass="offscreen";for(var y=0,g=n;y<g.length;y+=1){var v=this.style._layers[g[y]];if(v.hasOffscreenPass()&&!v.isHidden(this.transform.zoom)){var _=p[v.source];"custom"!==v.type&&!_.length||this.renderLayer(this,o[v.source],v,_)}}for(this.context.bindFramebuffer.set(null),this.context.clear({color:r.showOverdrawInspector?e.Color.black:e.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=r.showOverdrawInspector,this.depthRangeFor3D=[0,1-(t._order.length+2)*this.numSublayers*this.depthEpsilon],this.renderPass="opaque",this.currentLayer=n.length-1;0<=this.currentLayer;this.currentLayer--){var b=this.style._layers[n[this.currentLayer]],x=o[b.source],w=c[b.source];this._renderTileClippingMasks(b,w),this.renderLayer(this,x,b,w)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<n.length;this.currentLayer++){var S=this.style._layers[n[this.currentLayer]],T=o[S.source],C=("symbol"===S.type?h:p)[S.source];this._renderTileClippingMasks(S,c[S.source]),this.renderLayer(this,T,S,C)}this.options.showTileBoundaries&&(e.values(this.style._layers).forEach((function(e){e.source&&!e.isHidden(i.transform.zoom)&&(e.source!==(u&&u.id)&&(u=i.style.sourceCaches[e.source]),(!l||l.getSource().maxzoom<u.getSource().maxzoom)&&(l=u))})),l&&Ln.debug(this,l,l.getVisibleCoordinates())),this.options.showPadding&&function(e){var t=e.transform.padding;An(e,e.transform.height-(t.top||0),3,En),An(e,t.bottom||0,3,In),zn(e,t.left||0,3,Pn),zn(e,e.transform.width-(t.right||0),3,Rn);var r,i,n,o,a=e.transform.centerPoint;Mn(r=e,(i=a.x)-1,(n=e.transform.height-a.y)-10,2,20,o=Nn),Mn(r,i-10,n-1,20,2,o)}(this),this.context.setDefault()},On.prototype.renderLayer=function(e,t,r,i){r.isHidden(this.transform.zoom)||"background"!==r.type&&"custom"!==r.type&&!i.length||(this.id=r.id,this.gpuTimingStart(r),Ln[r.type](e,t,r,i,this.style.placement.variableOffsets),this.gpuTimingEnd())},On.prototype.gpuTimingStart=function(e){if(this.options.gpuTiming){var t=this.context.extTimerQuery,r=this.gpuTimers[e.id];(r=r||(this.gpuTimers[e.id]={calls:0,cpuTime:0,query:t.createQueryEXT()})).calls++,t.beginQueryEXT(t.TIME_ELAPSED_EXT,r.query)}},On.prototype.gpuTimingEnd=function(){if(this.options.gpuTiming){var e=this.context.extTimerQuery;e.endQueryEXT(e.TIME_ELAPSED_EXT)}},On.prototype.collectGpuTimers=function(){var e=this.gpuTimers;return this.gpuTimers={},e},On.prototype.queryGpuTimers=function(e){var t={};for(var r in e){var i=e[r],n=this.context.extTimerQuery,o=n.getQueryObjectEXT(i.query,n.QUERY_RESULT_EXT)/1e6;n.deleteQueryEXT(i.query),t[r]=o}return t},On.prototype.translatePosMatrix=function(t,r,i,n,o){if(!i[0]&&!i[1])return t;var a=o?"map"===n?this.transform.angle:0:"viewport"===n?-this.transform.angle:0;if(a){var s=Math.sin(a),l=Math.cos(a);i=[i[0]*l-i[1]*s,i[0]*s+i[1]*l]}var u=[o?i[0]:jr(r,i[0],this.transform.zoom),o?i[1]:jr(r,i[1],this.transform.zoom),0],c=new Float32Array(16);return e.translate(c,t,u),c},On.prototype.saveTileTexture=function(e){var t=this._tileTextures[e.size[0]];t?t.push(e):this._tileTextures[e.size[0]]=[e]},On.prototype.getTileTexture=function(e){var t=this._tileTextures[e];return t&&0<t.length?t.pop():null},On.prototype.isPatternMissing=function(e){if(!e)return!1;if(!e.from||!e.to)return!0;var t=this.imageManager.getPattern(e.from.toString()),r=this.imageManager.getPattern(e.to.toString());return!t||!r},On.prototype.useProgram=function(e,t){this.cache=this.cache||{};var r=""+e+(t?t.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"");return this.cache[r]||(this.cache[r]=new Qi(this.context,0,Ji[e],t,fn[e],this._showOverdrawInspector)),this.cache[r]},On.prototype.setCustomLayerDefaults=function(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()},On.prototype.setBaseState=function(){var e=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(e.FUNC_ADD)},On.prototype.initDebugOverlayCanvas=function(){null==this.debugOverlayCanvas&&(this.debugOverlayCanvas=e.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new e.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))},On.prototype.destroy=function(){this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()},Dn.fromInvProjectionMatrix=function(t,r,i){var n=Math.pow(2,i),o=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map((function(r){return e.transformMat4([],r,t)})).map((function(t){return e.scale$1([],t,1/t[3]/r*n)})),a=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map((function(t){var r=e.sub([],o[t[0]],o[t[1]]),i=e.sub([],o[t[2]],o[t[1]]),n=e.normalize([],e.cross([],r,i)),a=-e.dot(n,o[t[1]]);return n.concat(a)}));return new Dn(o,a)},Bn.prototype.quadrant=function(t){for(var r=[t%2==0,t<2],i=e.clone$2(this.min),n=e.clone$2(this.max),o=0;o<r.length;o++)i[o]=r[o]?this.min[o]:this.center[o],n[o]=r[o]?this.center[o]:this.max[o];return n[2]=this.max[2],new Bn(i,n)},Bn.prototype.distanceX=function(e){return Math.max(Math.min(this.max[0],e[0]),this.min[0])-e[0]},Bn.prototype.distanceY=function(e){return Math.max(Math.min(this.max[1],e[1]),this.min[1])-e[1]},Bn.prototype.intersects=function(t){for(var r=[[this.min[0],this.min[1],0,1],[this.max[0],this.min[1],0,1],[this.max[0],this.max[1],0,1],[this.min[0],this.max[1],0,1]],i=!0,n=0;n<t.planes.length;n++){for(var o=t.planes[n],a=0,s=0;s<r.length;s++)a+=0<=e.dot$1(o,r[s]);if(0===a)return 0;a!==r.length&&(i=!1)}if(i)return 2;for(var l=0;l<3;l++){for(var u=Number.MAX_VALUE,c=-Number.MAX_VALUE,p=0;p<t.points.length;p++){var h=t.points[p][l]-this.min[l];u=Math.min(u,h),c=Math.max(c,h)}if(c<0||u>this.max[l]-this.min[l])return 0}return 1},Fn.prototype.interpolate=function(t,r,i){return null!=r.top&&null!=t.top&&(this.top=e.number(t.top,r.top,i)),null!=r.bottom&&null!=t.bottom&&(this.bottom=e.number(t.bottom,r.bottom,i)),null!=r.left&&null!=t.left&&(this.left=e.number(t.left,r.left,i)),null!=r.right&&null!=t.right&&(this.right=e.number(t.right,r.right,i)),this},Fn.prototype.getCenter=function(t,r){var i=e.clamp((this.left+t-this.right)/2,0,t),n=e.clamp((this.top+r-this.bottom)/2,0,r);return new e.Point(i,n)},Fn.prototype.equals=function(e){return this.top===e.top&&this.bottom===e.bottom&&this.left===e.left&&this.right===e.right},Fn.prototype.clone=function(){return new Fn(this.top,this.bottom,this.left,this.right)},Fn.prototype.toJSON=function(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}};var Un={minZoom:{configurable:!0},maxZoom:{configurable:!0},minPitch:{configurable:!0},maxPitch:{configurable:!0},renderWorldCopies:{configurable:!0},worldSize:{configurable:!0},centerOffset:{configurable:!0},size:{configurable:!0},bearing:{configurable:!0},pitch:{configurable:!0},fov:{configurable:!0},zoom:{configurable:!0},center:{configurable:!0},padding:{configurable:!0},centerPoint:{configurable:!0},unmodified:{configurable:!0},point:{configurable:!0}};function jn(t){var r,i,n,o;this._hashName=t&&encodeURIComponent(t),e.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=(r=this._updateHashUnthrottled.bind(this),i=!1,n=null,o=function(){n=null,i&&(r(),n=setTimeout(o,300),i=!1)},function(){return i=!0,n||o(),n})}function Vn(e){this._map=e,this.clear()}qn.prototype.clone=function(){var e=new qn(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return e.tileSize=this.tileSize,e.latRange=this.latRange,e.width=this.width,e.height=this.height,e._center=this._center,e.zoom=this.zoom,e.angle=this.angle,e._fov=this._fov,e._pitch=this._pitch,e._unmodified=this._unmodified,e._edgeInsets=this._edgeInsets.clone(),e._calcMatrices(),e},Un.minZoom.get=function(){return this._minZoom},Un.minZoom.set=function(e){this._minZoom!==e&&(this._minZoom=e,this.zoom=Math.max(this.zoom,e))},Un.maxZoom.get=function(){return this._maxZoom},Un.maxZoom.set=function(e){this._maxZoom!==e&&(this._maxZoom=e,this.zoom=Math.min(this.zoom,e))},Un.minPitch.get=function(){return this._minPitch},Un.minPitch.set=function(e){this._minPitch!==e&&(this._minPitch=e,this.pitch=Math.max(this.pitch,e))},Un.maxPitch.get=function(){return this._maxPitch},Un.maxPitch.set=function(e){this._maxPitch!==e&&(this._maxPitch=e,this.pitch=Math.min(this.pitch,e))},Un.renderWorldCopies.get=function(){return this._renderWorldCopies},Un.renderWorldCopies.set=function(e){void 0===e?e=!0:null===e&&(e=!1),this._renderWorldCopies=e},Un.worldSize.get=function(){return this.tileSize*this.scale},Un.centerOffset.get=function(){return this.centerPoint._sub(this.size._div(2))},Un.size.get=function(){return new e.Point(this.width,this.height)},Un.bearing.get=function(){return-this.angle/Math.PI*180},Un.bearing.set=function(t){var r=-e.wrap(t,-180,180)*Math.PI/180;this.angle!==r&&(this._unmodified=!1,this.angle=r,this._calcMatrices(),this.rotationMatrix=e.create$2(),e.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))},Un.pitch.get=function(){return this._pitch/Math.PI*180},Un.pitch.set=function(t){var r=e.clamp(t,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==r&&(this._unmodified=!1,this._pitch=r,this._calcMatrices())},Un.fov.get=function(){return this._fov/Math.PI*180},Un.fov.set=function(e){e=Math.max(.01,Math.min(60,e)),this._fov!==e&&(this._unmodified=!1,this._fov=e/180*Math.PI,this._calcMatrices())},Un.zoom.get=function(){return this._zoom},Un.zoom.set=function(e){var t=Math.min(Math.max(e,this.minZoom),this.maxZoom);this._zoom!==t&&(this._unmodified=!1,this._zoom=t,this.scale=this.zoomScale(t),this.tileZoom=Math.floor(t),this.zoomFraction=t-this.tileZoom,this._constrain(),this._calcMatrices())},Un.center.get=function(){return this._center},Un.center.set=function(e){e.lat===this._center.lat&&e.lng===this._center.lng||(this._unmodified=!1,this._center=e,this._constrain(),this._calcMatrices())},Un.padding.get=function(){return this._edgeInsets.toJSON()},Un.padding.set=function(e){this._edgeInsets.equals(e)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,e,1),this._calcMatrices())},Un.centerPoint.get=function(){return this._edgeInsets.getCenter(this.width,this.height)},qn.prototype.isPaddingEqual=function(e){return this._edgeInsets.equals(e)},qn.prototype.interpolatePadding=function(e,t,r){this._unmodified=!1,this._edgeInsets.interpolate(e,t,r),this._constrain(),this._calcMatrices()},qn.prototype.coveringZoomLevel=function(e){var t=(e.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/e.tileSize));return Math.max(0,t)},qn.prototype.getVisibleUnwrappedCoordinates=function(t){var r=[new e.UnwrappedTileID(0,t)];if(this._renderWorldCopies)for(var i=this.pointCoordinate(new e.Point(0,0)),n=this.pointCoordinate(new e.Point(this.width,0)),o=this.pointCoordinate(new e.Point(this.width,this.height)),a=this.pointCoordinate(new e.Point(0,this.height)),s=Math.floor(Math.min(i.x,n.x,o.x,a.x)),l=Math.floor(Math.max(i.x,n.x,o.x,a.x)),u=s-1;u<=l+1;u++)0!==u&&r.push(new e.UnwrappedTileID(u,t));return r},qn.prototype.coveringTiles=function(t){var r=this.coveringZoomLevel(t),i=r;if(void 0!==t.minzoom&&r<t.minzoom)return[];void 0!==t.maxzoom&&r>t.maxzoom&&(r=t.maxzoom);var n=e.MercatorCoordinate.fromLngLat(this.center),o=Math.pow(2,r),a=[o*n.x,o*n.y,0],s=Dn.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,r),l=t.minzoom||0;function u(e){return{aabb:new Bn([e*o,0,0],[(e+1)*o,o,0]),zoom:0,x:0,y:0,wrap:e,fullyVisible:!1}}this.pitch<=60&&this._edgeInsets.top<.1&&(l=r);var c=[],p=[],h=r,d=t.reparseOverscaled?i:r;if(this._renderWorldCopies)for(var m=1;m<=3;m++)c.push(u(-m)),c.push(u(m));for(c.push(u(0));0<c.length;){var f=c.pop(),y=f.x,g=f.y,v=f.fullyVisible;if(!v){var _=f.aabb.intersects(s);if(0===_)continue;v=2===_}var b=f.aabb.distanceX(a),x=f.aabb.distanceY(a),w=Math.max(Math.abs(b),Math.abs(x));if(f.zoom===h||w>3+(1<<h-f.zoom)-2&&f.zoom>=l)p.push({tileID:new e.OverscaledTileID(f.zoom===h?d:f.zoom,f.wrap,f.zoom,y,g),distanceSq:e.sqrLen([a[0]-.5-y,a[1]-.5-g])});else for(var S=0;S<4;S++){var T=(y<<1)+S%2,C=(g<<1)+(S>>1);c.push({aabb:f.aabb.quadrant(S),zoom:f.zoom+1,x:T,y:C,wrap:f.wrap,fullyVisible:v})}}return p.sort((function(e,t){return e.distanceSq-t.distanceSq})).map((function(e){return e.tileID}))},qn.prototype.resize=function(e,t){this.width=e,this.height=t,this.pixelsToGLUnits=[2/e,-2/t],this._constrain(),this._calcMatrices()},Un.unmodified.get=function(){return this._unmodified},qn.prototype.zoomScale=function(e){return Math.pow(2,e)},qn.prototype.scaleZoom=function(e){return Math.log(e)/Math.LN2},qn.prototype.project=function(t){var r=e.clamp(t.lat,-this.maxValidLatitude,this.maxValidLatitude);return new e.Point(e.mercatorXfromLng(t.lng)*this.worldSize,e.mercatorYfromLat(r)*this.worldSize)},qn.prototype.unproject=function(t){return new e.MercatorCoordinate(t.x/this.worldSize,t.y/this.worldSize).toLngLat()},Un.point.get=function(){return this.project(this.center)},qn.prototype.setLocationAtPoint=function(t,r){var i=this.pointCoordinate(r),n=this.pointCoordinate(this.centerPoint),o=this.locationCoordinate(t),a=new e.MercatorCoordinate(o.x-(i.x-n.x),o.y-(i.y-n.y));this.center=this.coordinateLocation(a),this._renderWorldCopies&&(this.center=this.center.wrap())},qn.prototype.locationPoint=function(e){return this.coordinatePoint(this.locationCoordinate(e))},qn.prototype.pointLocation=function(e){return this.coordinateLocation(this.pointCoordinate(e))},qn.prototype.locationCoordinate=function(t){return e.MercatorCoordinate.fromLngLat(t)},qn.prototype.coordinateLocation=function(e){return e.toLngLat()},qn.prototype.pointCoordinate=function(t){var r=[t.x,t.y,0,1],i=[t.x,t.y,1,1];e.transformMat4(r,r,this.pixelMatrixInverse),e.transformMat4(i,i,this.pixelMatrixInverse);var n=r[3],o=i[3],a=r[1]/n,s=i[1]/o,l=r[2]/n,u=i[2]/o,c=l==u?0:(0-l)/(u-l);return new e.MercatorCoordinate(e.number(r[0]/n,i[0]/o,c)/this.worldSize,e.number(a,s,c)/this.worldSize)},qn.prototype.coordinatePoint=function(t){var r=[t.x*this.worldSize,t.y*this.worldSize,0,1];return e.transformMat4(r,r,this.pixelMatrix),new e.Point(r[0]/r[3],r[1]/r[3])},qn.prototype.getBounds=function(){return(new e.LngLatBounds).extend(this.pointLocation(new e.Point(0,0))).extend(this.pointLocation(new e.Point(this.width,0))).extend(this.pointLocation(new e.Point(this.width,this.height))).extend(this.pointLocation(new e.Point(0,this.height)))},qn.prototype.getMaxBounds=function(){return this.latRange&&2===this.latRange.length&&this.lngRange&&2===this.lngRange.length?new e.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null},qn.prototype.setMaxBounds=function(e){e?(this.lngRange=[e.getWest(),e.getEast()],this.latRange=[e.getSouth(),e.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])},qn.prototype.calculatePosMatrix=function(t,r){void 0===r&&(r=!1);var i=t.key,n=r?this._alignedPosMatrixCache:this._posMatrixCache;if(n[i])return n[i];var o=t.canonical,a=this.worldSize/this.zoomScale(o.z),s=o.x+Math.pow(2,o.z)*t.wrap,l=e.identity(new Float64Array(16));return e.translate(l,l,[s*a,o.y*a,0]),e.scale(l,l,[a/e.EXTENT,a/e.EXTENT,1]),e.multiply(l,r?this.alignedProjMatrix:this.projMatrix,l),n[i]=new Float32Array(l),n[i]},qn.prototype.customLayerMatrix=function(){return this.mercatorMatrix.slice()},qn.prototype._constrain=function(){if(this.center&&this.width&&this.height&&!this._constraining){this._constraining=!0;var t,r,i,n,o=-90,a=90,s=-180,l=180,u=this.size,c=this._unmodified;if(this.latRange){var p=this.latRange;o=e.mercatorYfromLat(p[1])*this.worldSize,t=(a=e.mercatorYfromLat(p[0])*this.worldSize)-o<u.y?u.y/(a-o):0}if(this.lngRange){var h=this.lngRange;s=e.mercatorXfromLng(h[0])*this.worldSize,r=(l=e.mercatorXfromLng(h[1])*this.worldSize)-s<u.x?u.x/(l-s):0}var d=this.point,m=Math.max(r||0,t||0);if(m)return this.center=this.unproject(new e.Point(r?(l+s)/2:d.x,t?(a+o)/2:d.y)),this.zoom+=this.scaleZoom(m),this._unmodified=c,void(this._constraining=!1);if(this.latRange){var f=d.y,y=u.y/2;f-y<o&&(n=o+y),a<f+y&&(n=a-y)}if(this.lngRange){var g=d.x,v=u.x/2;g-v<s&&(i=s+v),l<g+v&&(i=l-v)}void 0===i&&void 0===n||(this.center=this.unproject(new e.Point(void 0!==i?i:d.x,void 0!==n?n:d.y))),this._unmodified=c,this._constraining=!1}},qn.prototype._calcMatrices=function(){if(this.height){var t=this.centerOffset;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height;var r=Math.PI/2+this._pitch,i=this._fov*(.5+t.y/this.height),n=Math.sin(i)*this.cameraToCenterDistance/Math.sin(e.clamp(Math.PI-r-i,.01,Math.PI-.01)),o=this.point,a=o.x,s=o.y,l=1.01*(Math.cos(Math.PI/2-this._pitch)*n+this.cameraToCenterDistance),u=this.height/50,c=new Float64Array(16);e.perspective(c,this._fov,this.width/this.height,u,l),c[8]=2*-t.x/this.width,c[9]=2*t.y/this.height,e.scale(c,c,[1,-1,1]),e.translate(c,c,[0,0,-this.cameraToCenterDistance]),e.rotateX(c,c,this._pitch),e.rotateZ(c,c,this.angle),e.translate(c,c,[-a,-s,0]),this.mercatorMatrix=e.scale([],c,[this.worldSize,this.worldSize,this.worldSize]),e.scale(c,c,[1,1,e.mercatorZfromAltitude(1,this.center.lat)*this.worldSize,1]),this.projMatrix=c,this.invProjMatrix=e.invert([],this.projMatrix);var p=this.width%2/2,h=this.height%2/2,d=Math.cos(this.angle),m=Math.sin(this.angle),f=a-Math.round(a)+d*p+m*h,y=s-Math.round(s)+d*h+m*p,g=new Float64Array(c);if(e.translate(g,g,[.5<f?f-1:f,.5<y?y-1:y,0]),this.alignedProjMatrix=g,c=e.create(),e.scale(c,c,[this.width/2,-this.height/2,1]),e.translate(c,c,[1,-1,0]),this.labelPlaneMatrix=c,c=e.create(),e.scale(c,c,[1,-1,1]),e.translate(c,c,[-1,-1,0]),e.scale(c,c,[2/this.width,2/this.height,1]),this.glCoordMatrix=c,this.pixelMatrix=e.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),!(c=e.invert(new Float64Array(16),this.pixelMatrix)))throw new Error("failed to invert matrix");this.pixelMatrixInverse=c,this._posMatrixCache={},this._alignedPosMatrixCache={}}},qn.prototype.maxPitchScaleFactor=function(){if(!this.pixelMatrixInverse)return 1;var t=this.pointCoordinate(new e.Point(0,0)),r=[t.x*this.worldSize,t.y*this.worldSize,0,1];return e.transformMat4(r,r,this.pixelMatrix)[3]/this.cameraToCenterDistance},qn.prototype.getCameraPoint=function(){var t=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new e.Point(0,t))},qn.prototype.getCameraQueryGeometry=function(t){var r=this.getCameraPoint();if(1===t.length)return[t[0],r];for(var i=r.x,n=r.y,o=r.x,a=r.y,s=0,l=t;s<l.length;s+=1){var u=l[s];i=Math.min(i,u.x),n=Math.min(n,u.y),o=Math.max(o,u.x),a=Math.max(a,u.y)}return[new e.Point(i,n),new e.Point(o,n),new e.Point(o,a),new e.Point(i,a),new e.Point(i,n)]},Object.defineProperties(qn.prototype,Un),jn.prototype.addTo=function(t){return this._map=t,e.window.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this},jn.prototype.remove=function(){return e.window.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this},jn.prototype.getHashString=function(t){var r=this._map.getCenter(),i=Math.round(100*this._map.getZoom())/100,n=Math.ceil((i*Math.LN2+Math.log(512/360/.5))/Math.LN10),o=Math.pow(10,n),a=Math.round(r.lng*o)/o,s=Math.round(r.lat*o)/o,l=this._map.getBearing(),u=this._map.getPitch(),c="";if(c+=t?"/"+a+"/"+s+"/"+i:i+"/"+s+"/"+a,(l||u)&&(c+="/"+Math.round(10*l)/10),u&&(c+="/"+Math.round(u)),this._hashName){var p=this._hashName,h=!1,d=e.window.location.hash.slice(1).split("&").map((function(e){var t=e.split("=")[0];return t===p?(h=!0,t+"="+c):e})).filter((function(e){return e}));return h||d.push(p+"="+c),"#"+d.join("&")}return"#"+c},jn.prototype._getCurrentHash=function(){var t,r=this,i=e.window.location.hash.replace("#","");return this._hashName?(i.split("&").map((function(e){return e.split("=")})).forEach((function(e){e[0]===r._hashName&&(t=e)})),(t&&t[1]||"").split("/")):i.split("/")},jn.prototype._onHashChange=function(){var e=this._getCurrentHash();if(3<=e.length&&!e.some((function(e){return isNaN(e)}))){var t=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(e[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+e[2],+e[1]],zoom:+e[0],bearing:t,pitch:+(e[4]||0)}),!0}return!1},jn.prototype._updateHashUnthrottled=function(){var t=this.getHashString();try{e.window.history.replaceState(e.window.history.state,"",t)}catch(t){}};var Gn={linearity:.3,easing:e.bezier(0,0,.3,1)},Hn=e.extend({deceleration:2500,maxSpeed:1400},Gn),Zn=e.extend({deceleration:20,maxSpeed:1400},Gn),Wn=e.extend({deceleration:1e3,maxSpeed:360},Gn),Kn=e.extend({deceleration:1e3,maxSpeed:90},Gn);function Xn(e,t){(!e.duration||e.duration<t.duration)&&(e.duration=t.duration,e.easing=t.easing)}function Yn(t,r,i){var n=i.maxSpeed,o=i.linearity,a=i.deceleration,s=e.clamp(t*o/(r/1e3),-n,n),l=Math.abs(s)/(a*o);return{easing:i.easing,duration:1e3*l,amount:s*(l/2)}}function Jn(e,t){this._map=e,this._clickTolerance=t.clickTolerance}Vn.prototype.clear=function(){this._inertiaBuffer=[]},Vn.prototype.record=function(t){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:e.browser.now(),settings:t})},Vn.prototype._drainInertiaBuffer=function(){for(var t=this._inertiaBuffer,r=e.browser.now();0<t.length&&160<r-t[0].time;)t.shift()},Vn.prototype._onMoveEnd=function(t){if(this._drainInertiaBuffer(),!(this._inertiaBuffer.length<2)){for(var r={zoom:0,bearing:0,pitch:0,pan:new e.Point(0,0),pinchAround:void 0,around:void 0},i=0,n=this._inertiaBuffer;i<n.length;i+=1){var o=n[i].settings;r.zoom+=o.zoomDelta||0,r.bearing+=o.bearingDelta||0,r.pitch+=o.pitchDelta||0,o.panDelta&&r.pan._add(o.panDelta),o.around&&(r.around=o.around),o.pinchAround&&(r.pinchAround=o.pinchAround)}var a=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,s={};if(r.pan.mag()){var l=Yn(r.pan.mag(),a,e.extend({},Hn,t||{}));s.offset=r.pan.mult(l.amount/r.pan.mag()),s.center=this._map.transform.center,Xn(s,l)}if(r.zoom){var u=Yn(r.zoom,a,Zn);s.zoom=this._map.transform.zoom+u.amount,Xn(s,u)}if(r.bearing){var c=Yn(r.bearing,a,Wn);s.bearing=this._map.transform.bearing+e.clamp(c.amount,-179,179),Xn(s,c)}if(r.pitch){var p=Yn(r.pitch,a,Kn);s.pitch=this._map.transform.pitch+p.amount,Xn(s,p)}if(s.zoom||s.bearing){var h=void 0===r.pinchAround?r.around:r.pinchAround;s.around=h?this._map.unproject(h):this._map.getCenter()}return this.clear(),e.extend(s,{noMoveStart:!0})}};var $n=function(t){function i(i,n,o,a){void 0===a&&(a={});var s=r.mousePos(n.getCanvasContainer(),o),l=n.unproject(s);t.call(this,i,e.extend({point:s,lngLat:l,originalEvent:o},a)),this._defaultPrevented=!1,this.target=n}t&&(i.__proto__=t);var n={defaultPrevented:{configurable:!0}};return((i.prototype=Object.create(t&&t.prototype)).constructor=i).prototype.preventDefault=function(){this._defaultPrevented=!0},n.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(i.prototype,n),i}(e.Event),Qn=function(t){function i(i,n,o){var a="touchend"===i?o.changedTouches:o.touches,s=r.touchPos(n.getCanvasContainer(),a),l=s.map((function(e){return n.unproject(e)})),u=s.reduce((function(e,t,r,i){return e.add(t.div(i.length))}),new e.Point(0,0)),c=n.unproject(u);t.call(this,i,{points:s,point:u,lngLats:l,lngLat:c,originalEvent:o}),this._defaultPrevented=!1}t&&(i.__proto__=t);var n={defaultPrevented:{configurable:!0}};return((i.prototype=Object.create(t&&t.prototype)).constructor=i).prototype.preventDefault=function(){this._defaultPrevented=!0},n.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(i.prototype,n),i}(e.Event),eo=function(e){function t(t,r,i){e.call(this,t,{originalEvent:i}),this._defaultPrevented=!1}e&&(t.__proto__=e);var r={defaultPrevented:{configurable:!0}};return((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.preventDefault=function(){this._defaultPrevented=!0},r.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(t.prototype,r),t}(e.Event);function to(e){this._map=e}function ro(e,t){this._map=e,this._el=e.getCanvasContainer(),this._container=e.getContainer(),this._clickTolerance=t.clickTolerance||1}function io(e,t){for(var r={},i=0;i<e.length;i++)r[e[i].identifier]=t[i];return r}function no(e){this.reset(),this.numTouches=e.numTouches}function oo(e){this.singleTap=new no(e),this.numTaps=e.numTaps,this.reset()}function ao(){this._zoomIn=new oo({numTouches:1,numTaps:2}),this._zoomOut=new oo({numTouches:2,numTaps:1}),this.reset()}function so(e){this.reset(),this._clickTolerance=e.clickTolerance||1}Jn.prototype.reset=function(){delete this._mousedownPos},Jn.prototype.wheel=function(e){return this._firePreventable(new eo(e.type,this._map,e))},Jn.prototype.mousedown=function(e,t){return this._mousedownPos=t,this._firePreventable(new $n(e.type,this._map,e))},Jn.prototype.mouseup=function(e){this._map.fire(new $n(e.type,this._map,e))},Jn.prototype.click=function(e,t){this._mousedownPos&&this._mousedownPos.dist(t)>=this._clickTolerance||this._map.fire(new $n(e.type,this._map,e))},Jn.prototype.dblclick=function(e){return this._firePreventable(new $n(e.type,this._map,e))},Jn.prototype.mouseover=function(e){this._map.fire(new $n(e.type,this._map,e))},Jn.prototype.mouseout=function(e){this._map.fire(new $n(e.type,this._map,e))},Jn.prototype.touchstart=function(e){return this._firePreventable(new Qn(e.type,this._map,e))},Jn.prototype.touchmove=function(e){this._map.fire(new Qn(e.type,this._map,e))},Jn.prototype.touchend=function(e){this._map.fire(new Qn(e.type,this._map,e))},Jn.prototype.touchcancel=function(e){this._map.fire(new Qn(e.type,this._map,e))},Jn.prototype._firePreventable=function(e){if(this._map.fire(e),e.defaultPrevented)return{}},Jn.prototype.isEnabled=function(){return!0},Jn.prototype.isActive=function(){return!1},Jn.prototype.enable=function(){},Jn.prototype.disable=function(){},to.prototype.reset=function(){this._delayContextMenu=!1,delete this._contextMenuEvent},to.prototype.mousemove=function(e){this._map.fire(new $n(e.type,this._map,e))},to.prototype.mousedown=function(){this._delayContextMenu=!0},to.prototype.mouseup=function(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new $n("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)},to.prototype.contextmenu=function(e){this._delayContextMenu?this._contextMenuEvent=e:this._map.fire(new $n(e.type,this._map,e)),this._map.listens("contextmenu")&&e.preventDefault()},to.prototype.isEnabled=function(){return!0},to.prototype.isActive=function(){return!1},to.prototype.enable=function(){},to.prototype.disable=function(){},ro.prototype.isEnabled=function(){return!!this._enabled},ro.prototype.isActive=function(){return!!this._active},ro.prototype.enable=function(){this.isEnabled()||(this._enabled=!0)},ro.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},ro.prototype.mousedown=function(e,t){this.isEnabled()&&e.shiftKey&&0===e.button&&(r.disableDrag(),this._startPos=this._lastPos=t,this._active=!0)},ro.prototype.mousemoveWindow=function(e,t){if(this._active){var i=t;if(!(this._lastPos.equals(i)||!this._box&&i.dist(this._startPos)<this._clickTolerance)){var n=this._startPos;this._lastPos=i,this._box||(this._box=r.create("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",e));var o=Math.min(n.x,i.x),a=Math.max(n.x,i.x),s=Math.min(n.y,i.y),l=Math.max(n.y,i.y);r.setTransform(this._box,"translate("+o+"px,"+s+"px)"),this._box.style.width=a-o+"px",this._box.style.height=l-s+"px"}}},ro.prototype.mouseupWindow=function(t,i){var n=this;if(this._active&&0===t.button){var o=this._startPos,a=i;if(this.reset(),r.suppressClick(),o.x!==a.x||o.y!==a.y)return this._map.fire(new e.Event("boxzoomend",{originalEvent:t})),{cameraAnimation:function(e){return e.fitScreenCoordinates(o,a,n._map.getBearing(),{linear:!0})}};this._fireEvent("boxzoomcancel",t)}},ro.prototype.keydown=function(e){this._active&&27===e.keyCode&&(this.reset(),this._fireEvent("boxzoomcancel",e))},ro.prototype.reset=function(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(r.remove(this._box),this._box=null),r.enableDrag(),delete this._startPos,delete this._lastPos},ro.prototype._fireEvent=function(t,r){return this._map.fire(new e.Event(t,{originalEvent:r}))},no.prototype.reset=function(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1},no.prototype.touchstart=function(t,r,i){(this.centroid||i.length>this.numTouches)&&(this.aborted=!0),this.aborted||(void 0===this.startTime&&(this.startTime=t.timeStamp),i.length===this.numTouches&&(this.centroid=function(t){for(var r=new e.Point(0,0),i=0,n=t;i<n.length;i+=1)r._add(n[i]);return r.div(t.length)}(r),this.touches=io(i,r)))},no.prototype.touchmove=function(e,t,r){if(!this.aborted&&this.centroid){var i=io(r,t);for(var n in this.touches){var o=i[n];(!o||30<o.dist(this.touches[n]))&&(this.aborted=!0)}}},no.prototype.touchend=function(e,t,r){if((!this.centroid||500<e.timeStamp-this.startTime)&&(this.aborted=!0),0===r.length){var i=!this.aborted&&this.centroid;if(this.reset(),i)return i}},oo.prototype.reset=function(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()},oo.prototype.touchstart=function(e,t,r){this.singleTap.touchstart(e,t,r)},oo.prototype.touchmove=function(e,t,r){this.singleTap.touchmove(e,t,r)},oo.prototype.touchend=function(e,t,r){var i=this.singleTap.touchend(e,t,r);if(i){var n=e.timeStamp-this.lastTime<500,o=!this.lastTap||this.lastTap.dist(i)<30;if(n&&o||this.reset(),this.count++,this.lastTime=e.timeStamp,this.lastTap=i,this.count===this.numTaps)return this.reset(),i}},ao.prototype.reset=function(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()},ao.prototype.touchstart=function(e,t,r){this._zoomIn.touchstart(e,t,r),this._zoomOut.touchstart(e,t,r)},ao.prototype.touchmove=function(e,t,r){this._zoomIn.touchmove(e,t,r),this._zoomOut.touchmove(e,t,r)},ao.prototype.touchend=function(e,t,r){var i=this,n=this._zoomIn.touchend(e,t,r),o=this._zoomOut.touchend(e,t,r);return n?(this._active=!0,e.preventDefault(),setTimeout((function(){return i.reset()}),0),{cameraAnimation:function(t){return t.easeTo({duration:300,zoom:t.getZoom()+1,around:t.unproject(n)},{originalEvent:e})}}):o?(this._active=!0,e.preventDefault(),setTimeout((function(){return i.reset()}),0),{cameraAnimation:function(t){return t.easeTo({duration:300,zoom:t.getZoom()-1,around:t.unproject(o)},{originalEvent:e})}}):void 0},ao.prototype.touchcancel=function(){this.reset()},ao.prototype.enable=function(){this._enabled=!0},ao.prototype.disable=function(){this._enabled=!1,this.reset()},ao.prototype.isEnabled=function(){return this._enabled},ao.prototype.isActive=function(){return this._active};var lo={0:1,2:2};function uo(e){this._minTouches=1,this._clickTolerance=e.clickTolerance||1,this.reset()}so.prototype.reset=function(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton},so.prototype._correctButton=function(e,t){return!1},so.prototype._move=function(e,t){return{}},so.prototype.mousedown=function(e,t){if(!this._lastPoint){var i=r.mouseButton(e);this._correctButton(e,i)&&(this._lastPoint=t,this._eventButton=i)}},so.prototype.mousemoveWindow=function(e,t){var r,i,n=this._lastPoint;if(n)if(e.preventDefault(),r=this._eventButton,i=lo[r],void 0===e.buttons||(e.buttons&i)!==i)this.reset();else if(this._moved||!(t.dist(n)<this._clickTolerance))return this._moved=!0,this._lastPoint=t,this._move(n,t)},so.prototype.mouseupWindow=function(e){this._lastPoint&&r.mouseButton(e)===this._eventButton&&(this._moved&&r.suppressClick(),this.reset())},so.prototype.enable=function(){this._enabled=!0},so.prototype.disable=function(){this._enabled=!1,this.reset()},so.prototype.isEnabled=function(){return this._enabled},so.prototype.isActive=function(){return this._active};var co,po,ho,mo=(_o.__proto__=ho=so,((_o.prototype=Object.create(ho&&ho.prototype)).constructor=_o).prototype.mousedown=function(e,t){ho.prototype.mousedown.call(this,e,t),this._lastPoint&&(this._active=!0)},_o.prototype._correctButton=function(e,t){return 0===t&&!e.ctrlKey},_o.prototype._move=function(e,t){return{around:t,panDelta:t.sub(e)}},_o),fo=(vo.__proto__=po=so,((vo.prototype=Object.create(po&&po.prototype)).constructor=vo).prototype._correctButton=function(e,t){return 0===t&&e.ctrlKey||2===t},vo.prototype._move=function(e,t){var r=.8*(t.x-e.x);if(r)return this._active=!0,{bearingDelta:r}},vo.prototype.contextmenu=function(e){e.preventDefault()},vo),yo=(go.__proto__=co=so,((go.prototype=Object.create(co&&co.prototype)).constructor=go).prototype._correctButton=function(e,t){return 0===t&&e.ctrlKey||2===t},go.prototype._move=function(e,t){var r=-.5*(t.y-e.y);if(r)return this._active=!0,{pitchDelta:r}},go.prototype.contextmenu=function(e){e.preventDefault()},go);function go(){co.apply(this,arguments)}function vo(){po.apply(this,arguments)}function _o(){ho.apply(this,arguments)}function bo(){this.reset()}function xo(e,t,r){for(var i=0;i<e.length;i++)if(e[i].identifier===r)return t[i]}function wo(e,t){return Math.log(e/t)/Math.LN2}uo.prototype.reset=function(){this._active=!1,this._touches={},this._sum=new e.Point(0,0)},uo.prototype.touchstart=function(e,t,r){return this._calculateTransform(e,t,r)},uo.prototype.touchmove=function(e,t,r){if(this._active)return e.preventDefault(),this._calculateTransform(e,t,r)},uo.prototype.touchend=function(e,t,r){this._calculateTransform(e,t,r),this._active&&r.length<this._minTouches&&this.reset()},uo.prototype.touchcancel=function(){this.reset()},uo.prototype._calculateTransform=function(t,r,i){0<i.length&&(this._active=!0);var n=io(i,r),o=new e.Point(0,0),a=new e.Point(0,0),s=0;for(var l in n){var u=n[l],c=this._touches[l];c&&(o._add(u),a._add(u.sub(c)),s++,n[l]=u)}if(this._touches=n,!(s<this._minTouches)&&a.mag()){var p=a.div(s);if(this._sum._add(p),!(this._sum.mag()<this._clickTolerance))return{around:o.div(s),panDelta:p}}},uo.prototype.enable=function(){this._enabled=!0},uo.prototype.disable=function(){this._enabled=!1,this.reset()},uo.prototype.isEnabled=function(){return this._enabled},uo.prototype.isActive=function(){return this._active},bo.prototype.reset=function(){this._active=!1,delete this._firstTwoTouches},bo.prototype._start=function(e){},bo.prototype._move=function(e,t,r){return{}},bo.prototype.touchstart=function(e,t,r){this._firstTwoTouches||r.length<2||(this._firstTwoTouches=[r[0].identifier,r[1].identifier],this._start([t[0],t[1]]))},bo.prototype.touchmove=function(e,t,r){if(this._firstTwoTouches){e.preventDefault();var i=this._firstTwoTouches,n=i[1],o=xo(r,t,i[0]),a=xo(r,t,n);if(o&&a){var s=this._aroundCenter?null:o.add(a).div(2);return this._move([o,a],s,e)}}},bo.prototype.touchend=function(e,t,i){if(this._firstTwoTouches){var n=this._firstTwoTouches,o=n[1],a=xo(i,t,n[0]),s=xo(i,t,o);a&&s||(this._active&&r.suppressClick(),this.reset())}},bo.prototype.touchcancel=function(){this.reset()},bo.prototype.enable=function(e){this._enabled=!0,this._aroundCenter=!!e&&"center"===e.around},bo.prototype.disable=function(){this._enabled=!1,this.reset()},bo.prototype.isEnabled=function(){return this._enabled},bo.prototype.isActive=function(){return this._active};var So,To=(Co.__proto__=So=bo,((Co.prototype=Object.create(So&&So.prototype)).constructor=Co).prototype.reset=function(){So.prototype.reset.call(this),delete this._distance,delete this._startDistance},Co.prototype._start=function(e){this._startDistance=this._distance=e[0].dist(e[1])},Co.prototype._move=function(e,t){var r=this._distance;if(this._distance=e[0].dist(e[1]),this._active||!(Math.abs(wo(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:wo(this._distance,r),pinchAround:t}},Co);function Co(){So.apply(this,arguments)}function Eo(e,t){return 180*e.angleWith(t)/Math.PI}var Io,Po=(Ro.__proto__=Io=bo,((Ro.prototype=Object.create(Io&&Io.prototype)).constructor=Ro).prototype.reset=function(){Io.prototype.reset.call(this),delete this._minDiameter,delete this._startVector,delete this._vector},Ro.prototype._start=function(e){this._startVector=this._vector=e[0].sub(e[1]),this._minDiameter=e[0].dist(e[1])},Ro.prototype._move=function(e,t){var r=this._vector;if(this._vector=e[0].sub(e[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Eo(this._vector,r),pinchAround:t}},Ro.prototype._isBelowThreshold=function(e){this._minDiameter=Math.min(this._minDiameter,e.mag());var t=25/(Math.PI*this._minDiameter)*360,r=Eo(e,this._startVector);return Math.abs(r)<t},Ro);function Ro(){Io.apply(this,arguments)}function No(e){return Math.abs(e.y)>Math.abs(e.x)}function Ao(){var e=ko;this._panStep=e.panStep,this._bearingStep=e.bearingStep,this._pitchStep=e.pitchStep}var zo,Mo=(Oo.__proto__=zo=bo,((Oo.prototype=Object.create(zo&&zo.prototype)).constructor=Oo).prototype.reset=function(){zo.prototype.reset.call(this),this._valid=void 0,delete this._firstMove,delete this._lastPoints},Oo.prototype._start=function(e){No((this._lastPoints=e)[0].sub(e[1]))&&(this._valid=!1)},Oo.prototype._move=function(e,t,r){var i=e[0].sub(this._lastPoints[0]),n=e[1].sub(this._lastPoints[1]);if(this._valid=this.gestureBeginsVertically(i,n,r.timeStamp),this._valid)return this._lastPoints=e,this._active=!0,{pitchDelta:(i.y+n.y)/2*-.5}},Oo.prototype.gestureBeginsVertically=function(e,t,r){if(void 0!==this._valid)return this._valid;var i=2<=e.mag(),n=2<=t.mag();if(i||n){if(!i||!n)return void 0===this._firstMove&&(this._firstMove=r),r-this._firstMove<100&&void 0;var o=0<e.y==0<t.y;return No(e)&&No(t)&&o}},Oo),ko={panStep:100,bearingStep:15,pitchStep:10};function Oo(){zo.apply(this,arguments)}function Lo(e){return e*(2-e)}function Do(t,r){this._map=t,this._el=t.getCanvasContainer(),this._handler=r,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=1/450,e.bindAll(["_onWheel","_onTimeout","_onScrollFrame","_onScrollFinished"],this)}function Bo(e,t){this._clickZoom=e,this._tapZoom=t}function Fo(){this.reset()}function qo(){this._tap=new oo({numTouches:1,numTaps:1}),this.reset()}function Uo(e,t,r){this._el=e,this._mousePan=t,this._touchPan=r}function jo(e,t,r){this._pitchWithRotate=e.pitchWithRotate,this._mouseRotate=t,this._mousePitch=r}function Vo(e,t,r,i){this._el=e,this._touchZoom=t,this._touchRotate=r,this._tapDragZoom=i,this._rotationDisabled=!1,this._enabled=!0}function Go(e){return e.zoom||e.drag||e.pitch||e.rotate}Ao.prototype.reset=function(){this._active=!1},Ao.prototype.keydown=function(e){var t=this;if(!(e.altKey||e.ctrlKey||e.metaKey)){var r=0,i=0,n=0,o=0,a=0;switch(e.keyCode){case 61:case 107:case 171:case 187:r=1;break;case 189:case 109:case 173:r=-1;break;case 37:e.shiftKey?i=-1:(e.preventDefault(),o=-1);break;case 39:e.shiftKey?i=1:(e.preventDefault(),o=1);break;case 38:e.shiftKey?n=1:(e.preventDefault(),a=-1);break;case 40:e.shiftKey?n=-1:(e.preventDefault(),a=1);break;default:return}return{cameraAnimation:function(s){var l=s.getZoom();s.easeTo({duration:300,easeId:"keyboardHandler",easing:Lo,zoom:r?Math.round(l)+r*(e.shiftKey?2:1):l,bearing:s.getBearing()+i*t._bearingStep,pitch:s.getPitch()+n*t._pitchStep,offset:[-o*t._panStep,-a*t._panStep],center:s.getCenter()},{originalEvent:e})}}}},Ao.prototype.enable=function(){this._enabled=!0},Ao.prototype.disable=function(){this._enabled=!1,this.reset()},Ao.prototype.isEnabled=function(){return this._enabled},Ao.prototype.isActive=function(){return this._active},Do.prototype.setZoomRate=function(e){this._defaultZoomRate=e},Do.prototype.setWheelZoomRate=function(e){this._wheelZoomRate=e},Do.prototype.isEnabled=function(){return!!this._enabled},Do.prototype.isActive=function(){return!!this._active||void 0!==this._finishTimeout},Do.prototype.isZooming=function(){return!!this._zooming},Do.prototype.enable=function(e){this.isEnabled()||(this._enabled=!0,this._aroundCenter=e&&"center"===e.around)},Do.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},Do.prototype.wheel=function(t){if(this.isEnabled()){var r=t.deltaMode===e.window.WheelEvent.DOM_DELTA_LINE?40*t.deltaY:t.deltaY,i=e.browser.now(),n=i-(this._lastWheelEventTime||0);this._lastWheelEventTime=i,0!==r&&r%4.000244140625==0?this._type="wheel":0!==r&&Math.abs(r)<4?this._type="trackpad":400<n?(this._type=null,this._lastValue=r,this._timeout=setTimeout(this._onTimeout,40,t)):this._type||(this._type=Math.abs(n*r)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,r+=this._lastValue)),t.shiftKey&&r&&(r/=4),this._type&&(this._lastWheelEvent=t,this._delta-=r,this._active||this._start(t)),t.preventDefault()}},Do.prototype._onTimeout=function(e){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(e)},Do.prototype._start=function(t){if(this._delta){this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);var i=r.mousePos(this._el,t);this._around=e.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(i)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}},Do.prototype.renderFrame=function(){return this._onScrollFrame()},Do.prototype._onScrollFrame=function(){var t=this;if(this._frameId&&(this._frameId=null,this.isActive())){var r=this._map.transform;if(0!==this._delta){var i="wheel"===this._type&&4.000244140625<Math.abs(this._delta)?this._wheelZoomRate:this._defaultZoomRate,n=2/(1+Math.exp(-Math.abs(this._delta*i)));this._delta<0&&0!==n&&(n=1/n);var o="number"==typeof this._targetZoom?r.zoomScale(this._targetZoom):r.scale;this._targetZoom=Math.min(r.maxZoom,Math.max(r.minZoom,r.scaleZoom(o*n))),"wheel"===this._type&&(this._startZoom=r.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}var a,s="number"==typeof this._targetZoom?this._targetZoom:r.zoom,l=this._startZoom,u=this._easing,c=!1;if("wheel"===this._type&&l&&u){var p=Math.min((e.browser.now()-this._lastWheelEventTime)/200,1),h=u(p);a=e.number(l,s,h),p<1?this._frameId||(this._frameId=!0):c=!0}else a=s,c=!0;return this._active=!0,c&&(this._active=!1,this._finishTimeout=setTimeout((function(){t._zooming=!1,t._handler._triggerRenderFrame(),delete t._targetZoom,delete t._finishTimeout}),200)),{noInertia:!0,needsRenderFrame:!c,zoomDelta:a-r.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}},Do.prototype._smoothOutEasing=function(t){var r=e.ease;if(this._prevEase){var i=this._prevEase,n=(e.browser.now()-i.start)/i.duration,o=i.easing(.01+n)-i.easing(n),a=.27/Math.sqrt(o*o+1e-4)*.01,s=Math.sqrt(.0729-a*a);r=e.bezier(a,s,.25,1)}return this._prevEase={start:e.browser.now(),duration:t,easing:r},r},Do.prototype.reset=function(){this._active=!1},Bo.prototype.enable=function(){this._clickZoom.enable(),this._tapZoom.enable()},Bo.prototype.disable=function(){this._clickZoom.disable(),this._tapZoom.disable()},Bo.prototype.isEnabled=function(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()},Bo.prototype.isActive=function(){return this._clickZoom.isActive()||this._tapZoom.isActive()},Fo.prototype.reset=function(){this._active=!1},Fo.prototype.dblclick=function(e,t){return e.preventDefault(),{cameraAnimation:function(r){r.easeTo({duration:300,zoom:r.getZoom()+(e.shiftKey?-1:1),around:r.unproject(t)},{originalEvent:e})}}},Fo.prototype.enable=function(){this._enabled=!0},Fo.prototype.disable=function(){this._enabled=!1,this.reset()},Fo.prototype.isEnabled=function(){return this._enabled},Fo.prototype.isActive=function(){return this._active},qo.prototype.reset=function(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()},qo.prototype.touchstart=function(e,t,r){this._swipePoint||(this._tapTime&&500<e.timeStamp-this._tapTime&&this.reset(),this._tapTime?0<r.length&&(this._swipePoint=t[0],this._swipeTouch=r[0].identifier):this._tap.touchstart(e,t,r))},qo.prototype.touchmove=function(e,t,r){if(this._tapTime){if(this._swipePoint){if(r[0].identifier!==this._swipeTouch)return;var i=t[0],n=i.y-this._swipePoint.y;return this._swipePoint=i,e.preventDefault(),this._active=!0,{zoomDelta:n/128}}}else this._tap.touchmove(e,t,r)},qo.prototype.touchend=function(e,t,r){this._tapTime?this._swipePoint&&0===r.length&&this.reset():this._tap.touchend(e,t,r)&&(this._tapTime=e.timeStamp)},qo.prototype.touchcancel=function(){this.reset()},qo.prototype.enable=function(){this._enabled=!0},qo.prototype.disable=function(){this._enabled=!1,this.reset()},qo.prototype.isEnabled=function(){return this._enabled},qo.prototype.isActive=function(){return this._active},Uo.prototype.enable=function(e){this._inertiaOptions=e||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")},Uo.prototype.disable=function(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")},Uo.prototype.isEnabled=function(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()},Uo.prototype.isActive=function(){return this._mousePan.isActive()||this._touchPan.isActive()},jo.prototype.enable=function(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()},jo.prototype.disable=function(){this._mouseRotate.disable(),this._mousePitch.disable()},jo.prototype.isEnabled=function(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())},jo.prototype.isActive=function(){return this._mouseRotate.isActive()||this._mousePitch.isActive()},Vo.prototype.enable=function(e){this._touchZoom.enable(e),this._rotationDisabled||this._touchRotate.enable(e),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")},Vo.prototype.disable=function(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")},Vo.prototype.isEnabled=function(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()},Vo.prototype.isActive=function(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()},Vo.prototype.disableRotation=function(){this._rotationDisabled=!0,this._touchRotate.disable()},Vo.prototype.enableRotation=function(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()};var Ho,Zo=((Ho=e.Event)&&(Wo.__proto__=Ho),(Wo.prototype=Object.create(Ho&&Ho.prototype)).constructor=Wo);function Wo(){Ho.apply(this,arguments)}function Ko(e){return e.panDelta&&e.panDelta.mag()||e.zoomDelta||e.bearingDelta||e.pitchDelta}function Xo(t,i){this._map=t,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Vn(t),this._bearingSnap=i.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(i),e.bindAll(["handleEvent","handleWindowEvent"],this);var n=this._el;this._listeners=[[n,"touchstart",{passive:!0}],[n,"touchmove",{passive:!1}],[n,"touchend",void 0],[n,"touchcancel",void 0],[n,"mousedown",void 0],[n,"mousemove",void 0],[n,"mouseup",void 0],[e.window.document,"mousemove",{capture:!0}],[e.window.document,"mouseup",void 0],[n,"mouseover",void 0],[n,"mouseout",void 0],[n,"dblclick",void 0],[n,"click",void 0],[n,"keydown",{capture:!1}],[n,"keyup",void 0],[n,"wheel",{passive:!1}],[n,"contextmenu",void 0],[e.window,"blur",void 0]];for(var o=0,a=this._listeners;o<a.length;o+=1){var s=a[o],l=s[0];r.addEventListener(l,s[1],l===e.window.document?this.handleWindowEvent:this.handleEvent,s[2])}}function Yo(t){void 0===t&&(t={}),this.options=t,e.bindAll(["_updateEditLink","_updateData","_updateCompact"],this)}Xo.prototype.destroy=function(){for(var t=0,i=this._listeners;t<i.length;t+=1){var n=i[t],o=n[0];r.removeEventListener(o,n[1],o===e.window.document?this.handleWindowEvent:this.handleEvent,n[2])}},Xo.prototype._addDefaultHandlers=function(e){var t=this._map,r=t.getCanvasContainer();this._add("mapEvent",new Jn(t,e));var i=t.boxZoom=new ro(t,e);this._add("boxZoom",i);var n=new ao,o=new Fo;t.doubleClickZoom=new Bo(o,n),this._add("tapZoom",n),this._add("clickZoom",o);var a=new qo;this._add("tapDragZoom",a);var s=t.touchPitch=new Mo;this._add("touchPitch",s);var l=new fo(e),u=new yo(e);t.dragRotate=new jo(e,l,u),this._add("mouseRotate",l,["mousePitch"]),this._add("mousePitch",u,["mouseRotate"]);var c=new mo(e),p=new uo(e);t.dragPan=new Uo(r,c,p),this._add("mousePan",c),this._add("touchPan",p,["touchZoom","touchRotate"]);var h=new Po,d=new To;t.touchZoomRotate=new Vo(r,d,h,a),this._add("touchRotate",h,["touchPan","touchZoom"]),this._add("touchZoom",d,["touchPan","touchRotate"]);var m=t.scrollZoom=new Do(t,this);this._add("scrollZoom",m,["mousePan"]);var f=t.keyboard=new Ao;this._add("keyboard",f),this._add("blockableMapEvent",new to(t));for(var y=0,g=["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"];y<g.length;y+=1){var v=g[y];e.interactive&&e[v]&&t[v].enable(e[v])}},Xo.prototype._add=function(e,t,r){this._handlers.push({handlerName:e,handler:t,allowed:r}),this._handlersById[e]=t},Xo.prototype.stop=function(){if(!this._updatingCamera){for(var e=0,t=this._handlers;e<t.length;e+=1)t[e].handler.reset();this._inertia.clear(),this._fireEvents({},{}),this._changes=[]}},Xo.prototype.isActive=function(){for(var e=0,t=this._handlers;e<t.length;e+=1)if(t[e].handler.isActive())return!0;return!1},Xo.prototype.isZooming=function(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()},Xo.prototype.isRotating=function(){return!!this._eventsInProgress.rotate},Xo.prototype.isMoving=function(){return Boolean(Go(this._eventsInProgress))||this.isZooming()},Xo.prototype._blockedByActive=function(e,t,r){for(var i in e)if(i!==r&&(!t||t.indexOf(i)<0))return!0;return!1},Xo.prototype.handleWindowEvent=function(e){this.handleEvent(e,e.type+"Window")},Xo.prototype._getMapTouches=function(e){for(var t=[],r=0,i=e;r<i.length;r+=1){var n=i[r];this._el.contains(n.target)&&t.push(n)}return t},Xo.prototype.handleEvent=function(e,t){if("blur"!==e.type){this._updatingCamera=!0;for(var i="renderFrame"===e.type?void 0:e,n={needsRenderFrame:!1},o={},a={},s=e.touches?this._getMapTouches(e.touches):void 0,l=s?r.touchPos(this._el,s):r.mousePos(this._el,e),u=0,c=this._handlers;u<c.length;u+=1){var p=c[u],h=p.handlerName,d=p.handler,m=p.allowed;if(d.isEnabled()){var f=void 0;this._blockedByActive(a,m,h)?d.reset():d[t||e.type]&&(f=d[t||e.type](e,l,s),this.mergeHandlerResult(n,o,f,h,i),f&&f.needsRenderFrame&&this._triggerRenderFrame()),(f||d.isActive())&&(a[h]=d)}}var y={};for(var g in this._previousActiveHandlers)a[g]||(y[g]=i);this._previousActiveHandlers=a,(Object.keys(y).length||Ko(n))&&(this._changes.push([n,o,y]),this._triggerRenderFrame()),(Object.keys(a).length||Ko(n))&&this._map._stop(!0),this._updatingCamera=!1;var v=n.cameraAnimation;v&&(this._inertia.clear(),this._fireEvents({},{}),this._changes=[],v(this._map))}else this.stop()},Xo.prototype.mergeHandlerResult=function(t,r,i,n,o){if(i){e.extend(t,i);var a={handlerName:n,originalEvent:i.originalEvent||o};void 0!==i.zoomDelta&&(r.zoom=a),void 0!==i.panDelta&&(r.drag=a),void 0!==i.pitchDelta&&(r.pitch=a),void 0!==i.bearingDelta&&(r.rotate=a)}},Xo.prototype._applyChanges=function(){for(var t={},r={},i={},n=0,o=this._changes;n<o.length;n+=1){var a=o[n],s=a[0],l=a[1],u=a[2];s.panDelta&&(t.panDelta=(t.panDelta||new e.Point(0,0))._add(s.panDelta)),s.zoomDelta&&(t.zoomDelta=(t.zoomDelta||0)+s.zoomDelta),s.bearingDelta&&(t.bearingDelta=(t.bearingDelta||0)+s.bearingDelta),s.pitchDelta&&(t.pitchDelta=(t.pitchDelta||0)+s.pitchDelta),void 0!==s.around&&(t.around=s.around),void 0!==s.pinchAround&&(t.pinchAround=s.pinchAround),s.noInertia&&(t.noInertia=s.noInertia),e.extend(r,l),e.extend(i,u)}this._updateMapTransform(t,r,i),this._changes=[]},Xo.prototype._updateMapTransform=function(e,t,r){var i=this._map,n=i.transform;if(!Ko(e))return this._fireEvents(t,r);var o=e.panDelta,a=e.zoomDelta,s=e.bearingDelta,l=e.pitchDelta,u=e.around,c=e.pinchAround;void 0!==c&&(u=c),i._stop(!0),u=u||i.transform.centerPoint;var p=n.pointLocation(o?u.sub(o):u);s&&(n.bearing+=s),l&&(n.pitch+=l),a&&(n.zoom+=a),n.setLocationAtPoint(p,u),this._map._update(),e.noInertia||this._inertia.record(e),this._fireEvents(t,r)},Xo.prototype._fireEvents=function(t,r){var i=this,n=Go(this._eventsInProgress),o=Go(t),a={};for(var s in t)this._eventsInProgress[s]||(a[s+"start"]=t[s].originalEvent),this._eventsInProgress[s]=t[s];for(var l in!n&&o&&this._fireEvent("movestart",o.originalEvent),a)this._fireEvent(l,a[l]);for(var u in t.rotate&&(this._bearingChanged=!0),o&&this._fireEvent("move",o.originalEvent),t)this._fireEvent(u,t[u].originalEvent);var c,p={};for(var h in this._eventsInProgress){var d=this._eventsInProgress[h],m=d.handlerName,f=d.originalEvent;this._handlersById[m].isActive()||(delete this._eventsInProgress[h],p[h+"end"]=c=r[m]||f)}for(var y in p)this._fireEvent(y,p[y]);var g=Go(this._eventsInProgress);if((n||o)&&!g){this._updatingCamera=!0;var v=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),_=function(e){return 0!==e&&-i._bearingSnap<e&&e<i._bearingSnap};v?(_(v.bearing||this._map.getBearing())&&(v.bearing=0),this._map.easeTo(v,{originalEvent:c})):(this._map.fire(new e.Event("moveend",{originalEvent:c})),_(this._map.getBearing())&&this._map.resetNorth()),this._bearingChanged=!1,this._updatingCamera=!1}},Xo.prototype._fireEvent=function(t,r){this._map.fire(new e.Event(t,r?{originalEvent:r}:{}))},Xo.prototype._requestFrame=function(){var e=this;return this._map.triggerRepaint(),this._map._renderTaskQueue.add((function(t){delete e._frameId,e.handleEvent(new Zo("renderFrame",{timeStamp:t})),e._applyChanges()}))},Xo.prototype._triggerRenderFrame=function(){void 0===this._frameId&&(this._frameId=this._requestFrame())};var Jo,$o=((Jo=e.Evented)&&(Qo.__proto__=Jo),((Qo.prototype=Object.create(Jo&&Jo.prototype)).constructor=Qo).prototype.getCenter=function(){return new e.LngLat(this.transform.center.lng,this.transform.center.lat)},Qo.prototype.setCenter=function(e,t){return this.jumpTo({center:e},t)},Qo.prototype.panBy=function(t,r,i){return t=e.Point.convert(t).mult(-1),this.panTo(this.transform.center,e.extend({offset:t},r),i)},Qo.prototype.panTo=function(t,r,i){return this.easeTo(e.extend({center:t},r),i)},Qo.prototype.getZoom=function(){return this.transform.zoom},Qo.prototype.setZoom=function(e,t){return this.jumpTo({zoom:e},t),this},Qo.prototype.zoomTo=function(t,r,i){return this.easeTo(e.extend({zoom:t},r),i)},Qo.prototype.zoomIn=function(e,t){return this.zoomTo(this.getZoom()+1,e,t),this},Qo.prototype.zoomOut=function(e,t){return this.zoomTo(this.getZoom()-1,e,t),this},Qo.prototype.getBearing=function(){return this.transform.bearing},Qo.prototype.setBearing=function(e,t){return this.jumpTo({bearing:e},t),this},Qo.prototype.getPadding=function(){return this.transform.padding},Qo.prototype.setPadding=function(e,t){return this.jumpTo({padding:e},t),this},Qo.prototype.rotateTo=function(t,r,i){return this.easeTo(e.extend({bearing:t},r),i)},Qo.prototype.resetNorth=function(t,r){return this.rotateTo(0,e.extend({duration:1e3},t),r),this},Qo.prototype.resetNorthPitch=function(t,r){return this.easeTo(e.extend({bearing:0,pitch:0,duration:1e3},t),r),this},Qo.prototype.snapToNorth=function(e,t){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(e,t):this},Qo.prototype.getPitch=function(){return this.transform.pitch},Qo.prototype.setPitch=function(e,t){return this.jumpTo({pitch:e},t),this},Qo.prototype.cameraForBounds=function(t,r){return t=e.LngLatBounds.convert(t),this._cameraForBoxAndBearing(t.getNorthWest(),t.getSouthEast(),0,r)},Qo.prototype._cameraForBoxAndBearing=function(t,r,i,n){var o={top:0,bottom:0,right:0,left:0};if("number"==typeof(n=e.extend({padding:o,offset:[0,0],maxZoom:this.transform.maxZoom},n)).padding){var a=n.padding;n.padding={top:a,bottom:a,right:a,left:a}}n.padding=e.extend(o,n.padding);var s=this.transform,l=s.padding,u=s.project(e.LngLat.convert(t)),c=s.project(e.LngLat.convert(r)),p=u.rotate(-i*Math.PI/180),h=c.rotate(-i*Math.PI/180),d=new e.Point(Math.max(p.x,h.x),Math.max(p.y,h.y)),m=new e.Point(Math.min(p.x,h.x),Math.min(p.y,h.y)),f=d.sub(m),y=(s.width-(l.left+l.right+n.padding.left+n.padding.right))/f.x,g=(s.height-(l.top+l.bottom+n.padding.top+n.padding.bottom))/f.y;if(!(g<0||y<0)){var v=Math.min(s.scaleZoom(s.scale*Math.min(y,g)),n.maxZoom),_=e.Point.convert(n.offset),b=new e.Point(_.x+(n.padding.left-n.padding.right)/2,_.y+(n.padding.top-n.padding.bottom)/2).mult(s.scale/s.zoomScale(v));return{center:s.unproject(u.add(c).div(2).sub(b)),zoom:v,bearing:i}}e.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")},Qo.prototype.fitBounds=function(e,t,r){return this._fitInternal(this.cameraForBounds(e,t),t,r)},Qo.prototype.fitScreenCoordinates=function(t,r,i,n,o){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(e.Point.convert(t)),this.transform.pointLocation(e.Point.convert(r)),i,n),n,o)},Qo.prototype._fitInternal=function(t,r,i){return t?(delete(r=e.extend(t,r)).padding,r.linear?this.easeTo(r,i):this.flyTo(r,i)):this},Qo.prototype.jumpTo=function(t,r){this.stop();var i=this.transform,n=!1,o=!1,a=!1;return"zoom"in t&&i.zoom!==+t.zoom&&(n=!0,i.zoom=+t.zoom),void 0!==t.center&&(i.center=e.LngLat.convert(t.center)),"bearing"in t&&i.bearing!==+t.bearing&&(o=!0,i.bearing=+t.bearing),"pitch"in t&&i.pitch!==+t.pitch&&(a=!0,i.pitch=+t.pitch),null==t.padding||i.isPaddingEqual(t.padding)||(i.padding=t.padding),this.fire(new e.Event("movestart",r)).fire(new e.Event("move",r)),n&&this.fire(new e.Event("zoomstart",r)).fire(new e.Event("zoom",r)).fire(new e.Event("zoomend",r)),o&&this.fire(new e.Event("rotatestart",r)).fire(new e.Event("rotate",r)).fire(new e.Event("rotateend",r)),a&&this.fire(new e.Event("pitchstart",r)).fire(new e.Event("pitch",r)).fire(new e.Event("pitchend",r)),this.fire(new e.Event("moveend",r))},Qo.prototype.easeTo=function(t,r){var i=this;this._stop(!1,t.easeId),(!1===(t=e.extend({offset:[0,0],duration:500,easing:e.ease},t)).animate||!t.essential&&e.browser.prefersReducedMotion)&&(t.duration=0);var n=this.transform,o=this.getZoom(),a=this.getBearing(),s=this.getPitch(),l=this.getPadding(),u="zoom"in t?+t.zoom:o,c="bearing"in t?this._normalizeBearing(t.bearing,a):a,p="pitch"in t?+t.pitch:s,h="padding"in t?t.padding:n.padding,d=e.Point.convert(t.offset),m=n.centerPoint.add(d),f=n.pointLocation(m),y=e.LngLat.convert(t.center||f);this._normalizeCenter(y);var g,v,_=n.project(f),b=n.project(y).sub(_),x=n.zoomScale(u-o);t.around&&(g=e.LngLat.convert(t.around),v=n.locationPoint(g));var w={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||u!==o,this._rotating=this._rotating||a!==c,this._pitching=this._pitching||p!==s,this._padding=!n.isPaddingEqual(h),this._easeId=t.easeId,this._prepareEase(r,t.noMoveStart,w),clearTimeout(this._easeEndTimeoutID),this._ease((function(t){if(i._zooming&&(n.zoom=e.number(o,u,t)),i._rotating&&(n.bearing=e.number(a,c,t)),i._pitching&&(n.pitch=e.number(s,p,t)),i._padding&&(n.interpolatePadding(l,h,t),m=n.centerPoint.add(d)),g)n.setLocationAtPoint(g,v);else{var f=n.zoomScale(n.zoom-o),y=o<u?Math.min(2,x):Math.max(.5,x),w=Math.pow(y,1-t),S=n.unproject(_.add(b.mult(t*w)).mult(f));n.setLocationAtPoint(n.renderWorldCopies?S.wrap():S,m)}i._fireMoveEvents(r)}),(function(e){i._afterEase(r,e)}),t),this},Qo.prototype._prepareEase=function(t,r,i){void 0===i&&(i={}),this._moving=!0,r||i.moving||this.fire(new e.Event("movestart",t)),this._zooming&&!i.zooming&&this.fire(new e.Event("zoomstart",t)),this._rotating&&!i.rotating&&this.fire(new e.Event("rotatestart",t)),this._pitching&&!i.pitching&&this.fire(new e.Event("pitchstart",t))},Qo.prototype._fireMoveEvents=function(t){this.fire(new e.Event("move",t)),this._zooming&&this.fire(new e.Event("zoom",t)),this._rotating&&this.fire(new e.Event("rotate",t)),this._pitching&&this.fire(new e.Event("pitch",t))},Qo.prototype._afterEase=function(t,r){if(!this._easeId||!r||this._easeId!==r){delete this._easeId;var i=this._zooming,n=this._rotating,o=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,i&&this.fire(new e.Event("zoomend",t)),n&&this.fire(new e.Event("rotateend",t)),o&&this.fire(new e.Event("pitchend",t)),this.fire(new e.Event("moveend",t))}},Qo.prototype.flyTo=function(t,r){var i=this;if(!t.essential&&e.browser.prefersReducedMotion){var n=e.pick(t,["center","zoom","bearing","pitch","around"]);return this.jumpTo(n,r)}this.stop(),t=e.extend({offset:[0,0],speed:1.2,curve:1.42,easing:e.ease},t);var o=this.transform,a=this.getZoom(),s=this.getBearing(),l=this.getPitch(),u=this.getPadding(),c="zoom"in t?e.clamp(+t.zoom,o.minZoom,o.maxZoom):a,p="bearing"in t?this._normalizeBearing(t.bearing,s):s,h="pitch"in t?+t.pitch:l,d="padding"in t?t.padding:o.padding,m=o.zoomScale(c-a),f=e.Point.convert(t.offset),y=o.centerPoint.add(f),g=o.pointLocation(y),v=e.LngLat.convert(t.center||g);this._normalizeCenter(v);var _=o.project(g),b=o.project(v).sub(_),x=t.curve,w=Math.max(o.width,o.height),S=w/m,T=b.mag();if("minZoom"in t){var C=e.clamp(Math.min(t.minZoom,a,c),o.minZoom,o.maxZoom),E=w/o.zoomScale(C-a);x=Math.sqrt(E/T*2)}var I=x*x;function P(e){var t=(S*S-w*w+(e?-1:1)*I*I*T*T)/(2*(e?S:w)*I*T);return Math.log(Math.sqrt(t*t+1)-t)}function R(e){return(Math.exp(e)-Math.exp(-e))/2}function N(e){return(Math.exp(e)+Math.exp(-e))/2}var A=P(0),z=function(e){return N(A)/N(A+x*e)},M=function(e){return w*((N(A)*(R(t=A+x*e)/N(t))-R(A))/I)/T;var t},k=(P(1)-A)/x;if(Math.abs(T)<1e-6||!isFinite(k)){if(Math.abs(w-S)<1e-6)return this.easeTo(t,r);var O=S<w?-1:1;k=Math.abs(Math.log(S/w))/x,M=function(){return 0},z=function(e){return Math.exp(O*x*e)}}return t.duration="duration"in t?+t.duration:1e3*k/("screenSpeed"in t?t.screenSpeed/x:+t.speed),t.maxDuration&&t.duration>t.maxDuration&&(t.duration=0),this._zooming=!0,this._rotating=s!==p,this._pitching=h!==l,this._padding=!o.isPaddingEqual(d),this._prepareEase(r,!1),this._ease((function(t){var n=t*k,m=1/z(n);o.zoom=1===t?c:a+o.scaleZoom(m),i._rotating&&(o.bearing=e.number(s,p,t)),i._pitching&&(o.pitch=e.number(l,h,t)),i._padding&&(o.interpolatePadding(u,d,t),y=o.centerPoint.add(f));var g=1===t?v:o.unproject(_.add(b.mult(M(n))).mult(m));o.setLocationAtPoint(o.renderWorldCopies?g.wrap():g,y),i._fireMoveEvents(r)}),(function(){return i._afterEase(r)}),t),this},Qo.prototype.isEasing=function(){return!!this._easeFrameId},Qo.prototype.stop=function(){return this._stop()},Qo.prototype._stop=function(e,t){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){var r=this._onEaseEnd;delete this._onEaseEnd,r.call(this,t)}if(!e){var i=this.handlers;i&&i.stop()}return this},Qo.prototype._ease=function(t,r,i){!1===i.animate||0===i.duration?(t(1),r()):(this._easeStart=e.browser.now(),this._easeOptions=i,this._onEaseFrame=t,this._onEaseEnd=r,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))},Qo.prototype._renderFrameCallback=function(){var t=Math.min((e.browser.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(t)),t<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},Qo.prototype._normalizeBearing=function(t,r){t=e.wrap(t,-180,180);var i=Math.abs(t-r);return Math.abs(t-360-r)<i&&(t-=360),Math.abs(t+360-r)<i&&(t+=360),t},Qo.prototype._normalizeCenter=function(e){var t=this.transform;if(t.renderWorldCopies&&!t.lngRange){var r=e.lng-t.center.lng;e.lng+=180<r?-360:r<-180?360:0}},Qo);function Qo(t,r){Jo.call(this),this._moving=!1,this._zooming=!1,this.transform=t,this._bearingSnap=r.bearingSnap,e.bindAll(["_renderFrameCallback"],this)}function ea(){e.bindAll(["_updateLogo"],this),e.bindAll(["_updateCompact"],this)}function ta(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}Yo.prototype.getDefaultPosition=function(){return"bottom-right"},Yo.prototype.onAdd=function(e){var t=this.options&&this.options.compact;return this._map=e,this._container=r.create("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._innerContainer=r.create("div","mapboxgl-ctrl-attrib-inner",this._container),t&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),void 0===t&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container},Yo.prototype.onRemove=function(){r.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0},Yo.prototype._updateEditLink=function(){var t=this._editLink;t=t||(this._editLink=this._container.querySelector(".mapbox-improve-map"));var r=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||e.config.ACCESS_TOKEN}];if(t){var i=r.reduce((function(e,t,i){return t.value&&(e+=t.key+"="+t.value+(i<r.length-1?"&":"")),e}),"?");t.href=e.config.FEEDBACK_URL+"/"+i+(this._map._hash?this._map._hash.getHashString(!0):""),t.rel="noopener nofollow"}},Yo.prototype._updateData=function(e){!e||"metadata"!==e.sourceDataType&&"style"!==e.dataType||(this._updateAttributions(),this._updateEditLink())},Yo.prototype._updateAttributions=function(){if(this._map.style){var e=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?e=e.concat(this.options.customAttribution.map((function(e){return"string"!=typeof e?"":e}))):"string"==typeof this.options.customAttribution&&e.push(this.options.customAttribution)),this._map.style.stylesheet){var t=this._map.style.stylesheet;this.styleOwner=t.owner,this.styleId=t.id}var r=this._map.style.sourceCaches;for(var i in r){var n=r[i];if(n.used){var o=n.getSource();o.attribution&&e.indexOf(o.attribution)<0&&e.push(o.attribution)}}e.sort((function(e,t){return e.length-t.length}));var a=(e=e.filter((function(t,r){for(var i=r+1;i<e.length;i++)if(0<=e[i].indexOf(t))return!1;return!0}))).join(" | ");a!==this._attribHTML&&(this._attribHTML=a,e.length?(this._innerContainer.innerHTML=a,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}},Yo.prototype._updateCompact=function(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact")},ea.prototype.onAdd=function(e){this._map=e,this._container=r.create("div","mapboxgl-ctrl");var t=r.create("a","mapboxgl-ctrl-logo");return t.target="_blank",t.rel="noopener nofollow",t.href="https://www.mapbox.com/",t.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),t.setAttribute("rel","noopener nofollow"),this._container.appendChild(t),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container},ea.prototype.onRemove=function(){r.remove(this._container),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)},ea.prototype.getDefaultPosition=function(){return"bottom-left"},ea.prototype._updateLogo=function(e){e&&"metadata"!==e.sourceDataType||(this._container.style.display=this._logoRequired()?"block":"none")},ea.prototype._logoRequired=function(){if(this._map.style){var e=this._map.style.sourceCaches;for(var t in e)if(e[t].getSource().mapbox_logo)return!0;return!1}},ea.prototype._updateCompact=function(){var e=this._container.children;if(e.length){var t=e[0];this._map.getCanvasContainer().offsetWidth<250?t.classList.add("mapboxgl-compact"):t.classList.remove("mapboxgl-compact")}},ta.prototype.add=function(e){var t=++this._id;return this._queue.push({callback:e,id:t,cancelled:!1}),t},ta.prototype.remove=function(e){for(var t=this._currentlyRunning,r=0,i=t?this._queue.concat(t):this._queue;r<i.length;r+=1){var n=i[r];if(n.id===e)return void(n.cancelled=!0)}},ta.prototype.run=function(e){void 0===e&&(e=0);var t=this._currentlyRunning=this._queue;this._queue=[];for(var r=0,i=t;r<i.length;r+=1){var n=i[r];if(!n.cancelled&&(n.callback(e),this._cleared))break}this._cleared=!1,this._currentlyRunning=!1},ta.prototype.clear=function(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]};var ra={"FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm"},ia=e.window.HTMLImageElement,na=e.window.HTMLElement,oa=e.window.ImageBitmap,aa={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0},sa=function(i){function n(t){var r=this;if(null!=(t=e.extend({},aa,t)).minZoom&&null!=t.maxZoom&&t.minZoom>t.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(null!=t.minPitch&&null!=t.maxPitch&&t.minPitch>t.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(null!=t.minPitch&&t.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(null!=t.maxPitch&&60<t.maxPitch)throw new Error("maxPitch must be less than or equal to 60");var n=new qn(t.minZoom,t.maxZoom,t.minPitch,t.maxPitch,t.renderWorldCopies);if(i.call(this,n,t),this._interactive=t.interactive,this._maxTileCacheSize=t.maxTileCacheSize,this._failIfMajorPerformanceCaveat=t.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=t.preserveDrawingBuffer,this._antialias=t.antialias,this._trackResize=t.trackResize,this._bearingSnap=t.bearingSnap,this._refreshExpiredTiles=t.refreshExpiredTiles,this._fadeDuration=t.fadeDuration,this._crossSourceCollisions=t.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=t.collectResourceTiming,this._renderTaskQueue=new ta,this._controls=[],this._mapId=e.uniqueId(),this._locale=e.extend({},ra,t.locale),this._requestManager=new e.RequestManager(t.transformRequest,t.accessToken),"string"==typeof t.container){if(this._container=e.window.document.getElementById(t.container),!this._container)throw new Error("Container '"+t.container+"' not found.")}else{if(!(t.container instanceof na))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=t.container}if(t.maxBounds&&this.setMaxBounds(t.maxBounds),e.bindAll(["_onWindowOnline","_onWindowResize","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),void 0===this.painter)throw new Error("Failed to initialize WebGL.");this.on("move",(function(){return r._update(!1)})),this.on("moveend",(function(){return r._update(!1)})),this.on("zoom",(function(){return r._update(!0)})),void 0!==e.window&&(e.window.addEventListener("online",this._onWindowOnline,!1),e.window.addEventListener("resize",this._onWindowResize,!1)),this.handlers=new Xo(this,t),this._hash=t.hash&&new jn("string"==typeof t.hash&&t.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:t.center,zoom:t.zoom,bearing:t.bearing,pitch:t.pitch}),t.bounds&&(this.resize(),this.fitBounds(t.bounds,e.extend({},t.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=t.localIdeographFontFamily,t.style&&this.setStyle(t.style,{localIdeographFontFamily:t.localIdeographFontFamily}),t.attributionControl&&this.addControl(new Yo({customAttribution:t.customAttribution})),this.addControl(new ea,t.logoPosition),this.on("style.load",(function(){r.transform.unmodified&&r.jumpTo(r.style.stylesheet)})),this.on("data",(function(t){r._update("style"===t.dataType),r.fire(new e.Event(t.dataType+"data",t))})),this.on("dataloading",(function(t){r.fire(new e.Event(t.dataType+"dataloading",t))}))}i&&(n.__proto__=i);var o={showTileBoundaries:{configurable:!0},showPadding:{configurable:!0},showCollisionBoxes:{configurable:!0},showOverdrawInspector:{configurable:!0},repaint:{configurable:!0},vertices:{configurable:!0},version:{configurable:!0}};return((n.prototype=Object.create(i&&i.prototype)).constructor=n).prototype._getMapId=function(){return this._mapId},n.prototype.addControl=function(t,r){if(void 0===r&&t.getDefaultPosition&&(r=t.getDefaultPosition()),void 0===r&&(r="top-right"),!t||!t.onAdd)return this.fire(new e.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));var i=t.onAdd(this);this._controls.push(t);var n=this._controlPositions[r];return-1!==r.indexOf("bottom")?n.insertBefore(i,n.firstChild):n.appendChild(i),this},n.prototype.removeControl=function(t){if(!t||!t.onRemove)return this.fire(new e.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));var r=this._controls.indexOf(t);return-1<r&&this._controls.splice(r,1),t.onRemove(this),this},n.prototype.resize=function(t){var r=this._containerDimensions(),i=r[0],n=r[1];this._resizeCanvas(i,n),this.transform.resize(i,n),this.painter.resize(i,n);var o=!this._moving;return o&&(this.stop(),this.fire(new e.Event("movestart",t)).fire(new e.Event("move",t))),this.fire(new e.Event("resize",t)),o&&this.fire(new e.Event("moveend",t)),this},n.prototype.getBounds=function(){return this.transform.getBounds()},n.prototype.getMaxBounds=function(){return this.transform.getMaxBounds()},n.prototype.setMaxBounds=function(t){return this.transform.setMaxBounds(e.LngLatBounds.convert(t)),this._update()},n.prototype.setMinZoom=function(e){if(-2<=(e=null==e?-2:e)&&e<=this.transform.maxZoom)return this.transform.minZoom=e,this._update(),this.getZoom()<e&&this.setZoom(e),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")},n.prototype.getMinZoom=function(){return this.transform.minZoom},n.prototype.setMaxZoom=function(e){if((e=null==e?22:e)>=this.transform.minZoom)return this.transform.maxZoom=e,this._update(),this.getZoom()>e&&this.setZoom(e),this;throw new Error("maxZoom must be greater than the current minZoom")},n.prototype.getMaxZoom=function(){return this.transform.maxZoom},n.prototype.setMinPitch=function(e){if((e=null==e?0:e)<0)throw new Error("minPitch must be greater than or equal to 0");if(0<=e&&e<=this.transform.maxPitch)return this.transform.minPitch=e,this._update(),this.getPitch()<e&&this.setPitch(e),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")},n.prototype.getMinPitch=function(){return this.transform.minPitch},n.prototype.setMaxPitch=function(e){if(60<(e=null==e?60:e))throw new Error("maxPitch must be less than or equal to 60");if(e>=this.transform.minPitch)return this.transform.maxPitch=e,this._update(),this.getPitch()>e&&this.setPitch(e),this;throw new Error("maxPitch must be greater than the current minPitch")},n.prototype.getMaxPitch=function(){return this.transform.maxPitch},n.prototype.getRenderWorldCopies=function(){return this.transform.renderWorldCopies},n.prototype.setRenderWorldCopies=function(e){return this.transform.renderWorldCopies=e,this._update()},n.prototype.project=function(t){return this.transform.locationPoint(e.LngLat.convert(t))},n.prototype.unproject=function(t){return this.transform.pointLocation(e.Point.convert(t))},n.prototype.isMoving=function(){return this._moving||this.handlers.isMoving()},n.prototype.isZooming=function(){return this._zooming||this.handlers.isZooming()},n.prototype.isRotating=function(){return this._rotating||this.handlers.isRotating()},n.prototype._createDelegatedListener=function(e,t,r){var i,n=this;if("mouseenter"===e||"mouseover"===e){var o=!1;return{layer:t,listener:r,delegates:{mousemove:function(i){var a=n.getLayer(t)?n.queryRenderedFeatures(i.point,{layers:[t]}):[];a.length?o||(o=!0,r.call(n,new $n(e,n,i.originalEvent,{features:a}))):o=!1},mouseout:function(){o=!1}}}}if("mouseleave"!==e&&"mouseout"!==e)return{layer:t,listener:r,delegates:((i={})[e]=function(e){var i=n.getLayer(t)?n.queryRenderedFeatures(e.point,{layers:[t]}):[];i.length&&(e.features=i,r.call(n,e),delete e.features)},i)};var a=!1;return{layer:t,listener:r,delegates:{mousemove:function(i){(n.getLayer(t)?n.queryRenderedFeatures(i.point,{layers:[t]}):[]).length?a=!0:a&&(a=!1,r.call(n,new $n(e,n,i.originalEvent)))},mouseout:function(t){a&&(a=!1,r.call(n,new $n(e,n,t.originalEvent)))}}}},n.prototype.on=function(e,t,r){if(void 0===r)return i.prototype.on.call(this,e,t);var n=this._createDelegatedListener(e,t,r);for(var o in this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[e]=this._delegatedListeners[e]||[],this._delegatedListeners[e].push(n),n.delegates)this.on(o,n.delegates[o]);return this},n.prototype.once=function(e,t,r){if(void 0===r)return i.prototype.once.call(this,e,t);var n=this._createDelegatedListener(e,t,r);for(var o in n.delegates)this.once(o,n.delegates[o]);return this},n.prototype.off=function(e,t,r){var n=this;return void 0===r?i.prototype.off.call(this,e,t):(this._delegatedListeners&&this._delegatedListeners[e]&&function(i){for(var o=i[e],a=0;a<o.length;a++){var s=o[a];if(s.layer===t&&s.listener===r){for(var l in s.delegates)n.off(l,s.delegates[l]);return o.splice(a,1)}}}(this._delegatedListeners),this)},n.prototype.queryRenderedFeatures=function(t,r){if(!this.style)return[];var i;if(void 0!==r||void 0===t||t instanceof e.Point||Array.isArray(t)||(r=t,t=void 0),r=r||{},(t=t||[[0,0],[this.transform.width,this.transform.height]])instanceof e.Point||"number"==typeof t[0])i=[e.Point.convert(t)];else{var n=e.Point.convert(t[0]),o=e.Point.convert(t[1]);i=[n,new e.Point(o.x,n.y),o,new e.Point(n.x,o.y),n]}return this.style.queryRenderedFeatures(i,r,this.transform)},n.prototype.querySourceFeatures=function(e,t){return this.style.querySourceFeatures(e,t)},n.prototype.setStyle=function(t,r){return!1!==(r=e.extend({},{localIdeographFontFamily:this._localIdeographFontFamily},r)).diff&&r.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&t?(this._diffStyle(t,r),this):(this._localIdeographFontFamily=r.localIdeographFontFamily,this._updateStyle(t,r))},n.prototype._getUIString=function(e){var t=this._locale[e];if(null==t)throw new Error("Missing UI string '"+e+"'");return t},n.prototype._updateStyle=function(e,t){return this.style&&(this.style.setEventedParent(null),this.style._remove()),e?(this.style=new bi(this,t||{}),this.style.setEventedParent(this,{style:this.style}),"string"==typeof e?this.style.loadURL(e):this.style.loadJSON(e)):delete this.style,this},n.prototype._lazyInitEmptyStyle=function(){this.style||(this.style=new bi(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())},n.prototype._diffStyle=function(t,r){var i=this;if("string"==typeof t){var n=this._requestManager.normalizeStyleURL(t),o=this._requestManager.transformRequest(n,e.ResourceType.Style);e.getJSON(o,(function(t,n){t?i.fire(new e.ErrorEvent(t)):n&&i._updateDiff(n,r)}))}else"object"==typeof t&&this._updateDiff(t,r)},n.prototype._updateDiff=function(t,r){try{this.style.setState(t)&&this._update(!0)}catch(i){e.warnOnce("Unable to perform style diff: "+(i.message||i.error||i)+".  Rebuilding the style from scratch."),this._updateStyle(t,r)}},n.prototype.getStyle=function(){if(this.style)return this.style.serialize()},n.prototype.isStyleLoaded=function(){return this.style?this.style.loaded():e.warnOnce("There is no style added to the map.")},n.prototype.addSource=function(e,t){return this._lazyInitEmptyStyle(),this.style.addSource(e,t),this._update(!0)},n.prototype.isSourceLoaded=function(t){var r=this.style&&this.style.sourceCaches[t];if(void 0!==r)return r.loaded();this.fire(new e.ErrorEvent(new Error("There is no source with ID '"+t+"'")))},n.prototype.areTilesLoaded=function(){var e=this.style&&this.style.sourceCaches;for(var t in e){var r=e[t]._tiles;for(var i in r){var n=r[i];if("loaded"!==n.state&&"errored"!==n.state)return!1}}return!0},n.prototype.addSourceType=function(e,t,r){return this._lazyInitEmptyStyle(),this.style.addSourceType(e,t,r)},n.prototype.removeSource=function(e){return this.style.removeSource(e),this._update(!0)},n.prototype.getSource=function(e){return this.style.getSource(e)},n.prototype.addImage=function(t,r,i){void 0===i&&(i={});var n=i.pixelRatio;void 0===n&&(n=1);var o=i.sdf;void 0===o&&(o=!1);var a=i.stretchX,s=i.stretchY,l=i.content;if(this._lazyInitEmptyStyle(),r instanceof ia||oa&&r instanceof oa){var u=e.browser.getImageData(r);this.style.addImage(t,{data:new e.RGBAImage({width:u.width,height:u.height},u.data),pixelRatio:n,stretchX:a,stretchY:s,content:l,sdf:o,version:0})}else{if(void 0===r.width||void 0===r.height)return this.fire(new e.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));var c=r;this.style.addImage(t,{data:new e.RGBAImage({width:r.width,height:r.height},new Uint8Array(r.data)),pixelRatio:n,stretchX:a,stretchY:s,content:l,sdf:o,version:0,userImage:c}),c.onAdd&&c.onAdd(this,t)}},n.prototype.updateImage=function(t,r){var i=this.style.getImage(t);if(!i)return this.fire(new e.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));var n=r instanceof ia||oa&&r instanceof oa?e.browser.getImageData(r):r,o=n.width,a=n.height,s=n.data;return void 0===o||void 0===a?this.fire(new e.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`"))):o!==i.data.width||a!==i.data.height?this.fire(new e.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image"))):(i.data.replace(s,!(r instanceof ia||oa&&r instanceof oa)),void this.style.updateImage(t,i))},n.prototype.hasImage=function(t){return t?!!this.style.getImage(t):(this.fire(new e.ErrorEvent(new Error("Missing required image id"))),!1)},n.prototype.removeImage=function(e){this.style.removeImage(e)},n.prototype.loadImage=function(t,r){e.getImage(this._requestManager.transformRequest(t,e.ResourceType.Image),r)},n.prototype.listImages=function(){return this.style.listImages()},n.prototype.addLayer=function(e,t){return this._lazyInitEmptyStyle(),this.style.addLayer(e,t),this._update(!0)},n.prototype.moveLayer=function(e,t){return this.style.moveLayer(e,t),this._update(!0)},n.prototype.removeLayer=function(e){return this.style.removeLayer(e),this._update(!0)},n.prototype.getLayer=function(e){return this.style.getLayer(e)},n.prototype.setLayerZoomRange=function(e,t,r){return this.style.setLayerZoomRange(e,t,r),this._update(!0)},n.prototype.setFilter=function(e,t,r){return void 0===r&&(r={}),this.style.setFilter(e,t,r),this._update(!0)},n.prototype.getFilter=function(e){return this.style.getFilter(e)},n.prototype.setPaintProperty=function(e,t,r,i){return void 0===i&&(i={}),this.style.setPaintProperty(e,t,r,i),this._update(!0)},n.prototype.getPaintProperty=function(e,t){return this.style.getPaintProperty(e,t)},n.prototype.setLayoutProperty=function(e,t,r,i){return void 0===i&&(i={}),this.style.setLayoutProperty(e,t,r,i),this._update(!0)},n.prototype.getLayoutProperty=function(e,t){return this.style.getLayoutProperty(e,t)},n.prototype.setLight=function(e,t){return void 0===t&&(t={}),this._lazyInitEmptyStyle(),this.style.setLight(e,t),this._update(!0)},n.prototype.getLight=function(){return this.style.getLight()},n.prototype.setFeatureState=function(e,t){return this.style.setFeatureState(e,t),this._update()},n.prototype.removeFeatureState=function(e,t){return this.style.removeFeatureState(e,t),this._update()},n.prototype.getFeatureState=function(e){return this.style.getFeatureState(e)},n.prototype.getContainer=function(){return this._container},n.prototype.getCanvasContainer=function(){return this._canvasContainer},n.prototype.getCanvas=function(){return this._canvas},n.prototype._containerDimensions=function(){var e=0,t=0;return this._container&&(e=this._container.clientWidth||400,t=this._container.clientHeight||300),[e,t]},n.prototype._detectMissingCSS=function(){"rgb(250, 128, 114)"!==e.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")&&e.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")},n.prototype._setupContainer=function(){var e=this._container;e.classList.add("mapboxgl-map"),(this._missingCSSCanary=r.create("div","mapboxgl-canary",e)).style.visibility="hidden",this._detectMissingCSS();var t=this._canvasContainer=r.create("div","mapboxgl-canvas-container",e);this._interactive&&t.classList.add("mapboxgl-interactive"),this._canvas=r.create("canvas","mapboxgl-canvas",t),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map");var i=this._containerDimensions();this._resizeCanvas(i[0],i[1]);var n=this._controlContainer=r.create("div","mapboxgl-control-container",e),o=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach((function(e){o[e]=r.create("div","mapboxgl-ctrl-"+e,n)}))},n.prototype._resizeCanvas=function(t,r){var i=e.browser.devicePixelRatio||1;this._canvas.width=i*t,this._canvas.height=i*r,this._canvas.style.width=t+"px",this._canvas.style.height=r+"px"},n.prototype._setupPainter=function(){var r=e.extend({},t.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),i=this._canvas.getContext("webgl",r)||this._canvas.getContext("experimental-webgl",r);i?(this.painter=new On(i,this.transform),e.webpSupported.testSupport(i)):this.fire(new e.ErrorEvent(new Error("Failed to initialize WebGL")))},n.prototype._contextLost=function(t){t.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new e.Event("webglcontextlost",{originalEvent:t}))},n.prototype._contextRestored=function(t){this._setupPainter(),this.resize(),this._update(),this.fire(new e.Event("webglcontextrestored",{originalEvent:t}))},n.prototype.loaded=function(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()},n.prototype._update=function(e){return this.style&&(this._styleDirty=this._styleDirty||e,this._sourcesDirty=!0,this.triggerRepaint()),this},n.prototype._requestRenderFrame=function(e){return this._update(),this._renderTaskQueue.add(e)},n.prototype._cancelRenderFrame=function(e){this._renderTaskQueue.remove(e)},n.prototype._render=function(t){var r,i=this,n=0,o=this.painter.context.extTimerQuery;if(this.listens("gpu-timing-frame")&&(r=o.createQueryEXT(),o.beginQueryEXT(o.TIME_ELAPSED_EXT,r),n=e.browser.now()),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(t),!this._removed){var a=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;var s=this.transform.zoom,l=e.browser.now();this.style.zoomHistory.update(s,l);var u=new e.EvaluationParameters(s,{now:l,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),c=u.crossFadingFactor();1===c&&c===this._crossFadingFactor||(a=!0,this._crossFadingFactor=c),this.style.update(u)}if(this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:this._fadeDuration,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer")}),this.fire(new e.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new e.Event("load"))),this.style&&(this.style.hasTransitions()||a)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){var p=e.browser.now()-n;o.endQueryEXT(o.TIME_ELAPSED_EXT,r),setTimeout((function(){var t=o.getQueryObjectEXT(r,o.QUERY_RESULT_EXT)/1e6;o.deleteQueryEXT(r),i.fire(new e.Event("gpu-timing-frame",{cpuTime:p,gpuTime:t}))}),50)}if(this.listens("gpu-timing-layer")){var h=this.painter.collectGpuTimers();setTimeout((function(){var t=i.painter.queryGpuTimers(h);i.fire(new e.Event("gpu-timing-layer",{layerTimes:t}))}),50)}var d=this._sourcesDirty||this._styleDirty||this._placementDirty;return d||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new e.Event("idle")),!this._loaded||this._fullyLoaded||d||(this._fullyLoaded=!0),this}},n.prototype.remove=function(){this._hash&&this._hash.remove();for(var t=0,r=this._controls;t<r.length;t+=1)r[t].onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),void 0!==e.window&&(e.window.removeEventListener("resize",this._onWindowResize,!1),e.window.removeEventListener("online",this._onWindowOnline,!1));var i=this.painter.context.gl.getExtension("WEBGL_lose_context");i&&i.loseContext(),la(this._canvasContainer),la(this._controlContainer),la(this._missingCSSCanary),this._container.classList.remove("mapboxgl-map"),this._removed=!0,this.fire(new e.Event("remove"))},n.prototype.triggerRepaint=function(){var t=this;this.style&&!this._frame&&(this._frame=e.browser.frame((function(e){t._frame=null,t._render(e)})))},n.prototype._onWindowOnline=function(){this._update()},n.prototype._onWindowResize=function(e){this._trackResize&&this.resize({originalEvent:e})._update()},o.showTileBoundaries.get=function(){return!!this._showTileBoundaries},o.showTileBoundaries.set=function(e){this._showTileBoundaries!==e&&(this._showTileBoundaries=e,this._update())},o.showPadding.get=function(){return!!this._showPadding},o.showPadding.set=function(e){this._showPadding!==e&&(this._showPadding=e,this._update())},o.showCollisionBoxes.get=function(){return!!this._showCollisionBoxes},o.showCollisionBoxes.set=function(e){this._showCollisionBoxes!==e&&((this._showCollisionBoxes=e)?this.style._generateCollisionBoxes():this._update())},o.showOverdrawInspector.get=function(){return!!this._showOverdrawInspector},o.showOverdrawInspector.set=function(e){this._showOverdrawInspector!==e&&(this._showOverdrawInspector=e,this._update())},o.repaint.get=function(){return!!this._repaint},o.repaint.set=function(e){this._repaint!==e&&(this._repaint=e,this.triggerRepaint())},o.vertices.get=function(){return!!this._vertices},o.vertices.set=function(e){this._vertices=e,this._update()},n.prototype._setCacheLimits=function(t,r){e.setCacheLimits(t,r)},o.version.get=function(){return e.version},Object.defineProperties(n.prototype,o),n}($o);function la(e){e.parentNode&&e.parentNode.removeChild(e)}function ua(t){var i=this;this.options=e.extend({},ca,t),this._container=r.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",(function(e){return e.preventDefault()})),this.options.showZoom&&(e.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",(function(e){return i._map.zoomIn({},{originalEvent:e})})),r.create("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden",!0),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",(function(e){return i._map.zoomOut({},{originalEvent:e})})),r.create("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden",!0)),this.options.showCompass&&(e.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",(function(e){i.options.visualizePitch?i._map.resetNorthPitch({},{originalEvent:e}):i._map.resetNorth({},{originalEvent:e})})),this._compassIcon=r.create("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden",!0))}var ca={showCompass:!0,showZoom:!0,visualizePitch:!1};ua.prototype._updateZoomButtons=function(){var e=this._map.getZoom();this._zoomInButton.disabled=e===this._map.getMaxZoom(),this._zoomOutButton.disabled=e===this._map.getMinZoom()},ua.prototype._rotateCompassArrow=function(){var e=this.options.visualizePitch?"scale("+1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)+") rotateX("+this._map.transform.pitch+"deg) rotateZ("+this._map.transform.angle*(180/Math.PI)+"deg)":"rotate("+this._map.transform.angle*(180/Math.PI)+"deg)";this._compassIcon.style.transform=e},ua.prototype.onAdd=function(e){return this._map=e,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new pa(this._map,this._compass,this.options.visualizePitch)),this._container},ua.prototype.onRemove=function(){r.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map},ua.prototype._createButton=function(e,t){var i=r.create("button",e,this._container);return i.type="button",i.addEventListener("click",t),i},ua.prototype._setButtonTitle=function(e,t){var r=this._map._getUIString("NavigationControl."+t);e.title=r,e.setAttribute("aria-label",r)};var pa=function(t,i,n){void 0===n&&(n=!1),this._clickTolerance=10,this.element=i,this.mouseRotate=new fo({clickTolerance:t.dragRotate._mouseRotate._clickTolerance}),this.map=t,n&&(this.mousePitch=new yo({clickTolerance:t.dragRotate._mousePitch._clickTolerance})),e.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),r.addEventListener(i,"mousedown",this.mousedown),r.addEventListener(i,"touchstart",this.touchstart,{passive:!1}),r.addEventListener(i,"touchmove",this.touchmove),r.addEventListener(i,"touchend",this.touchend),r.addEventListener(i,"touchcancel",this.reset)};function ha(t,r,i){if(t=new e.LngLat(t.lng,t.lat),r){var n=new e.LngLat(t.lng-360,t.lat),o=new e.LngLat(t.lng+360,t.lat),a=i.locationPoint(t).distSqr(r);i.locationPoint(n).distSqr(r)<a?t=n:i.locationPoint(o).distSqr(r)<a&&(t=o)}for(;180<Math.abs(t.lng-i.center.lng);){var s=i.locationPoint(t);if(0<=s.x&&0<=s.y&&s.x<=i.width&&s.y<=i.height)break;t.lng>i.center.lng?t.lng-=360:t.lng+=360}return t}pa.prototype.down=function(e,t){this.mouseRotate.mousedown(e,t),this.mousePitch&&this.mousePitch.mousedown(e,t),r.disableDrag()},pa.prototype.move=function(e,t){var r=this.map,i=this.mouseRotate.mousemoveWindow(e,t);if(i&&i.bearingDelta&&r.setBearing(r.getBearing()+i.bearingDelta),this.mousePitch){var n=this.mousePitch.mousemoveWindow(e,t);n&&n.pitchDelta&&r.setPitch(r.getPitch()+n.pitchDelta)}},pa.prototype.off=function(){var e=this.element;r.removeEventListener(e,"mousedown",this.mousedown),r.removeEventListener(e,"touchstart",this.touchstart,{passive:!1}),r.removeEventListener(e,"touchmove",this.touchmove),r.removeEventListener(e,"touchend",this.touchend),r.removeEventListener(e,"touchcancel",this.reset),this.offTemp()},pa.prototype.offTemp=function(){r.enableDrag(),r.removeEventListener(e.window,"mousemove",this.mousemove),r.removeEventListener(e.window,"mouseup",this.mouseup)},pa.prototype.mousedown=function(t){this.down(e.extend({},t,{ctrlKey:!0,preventDefault:function(){return t.preventDefault()}}),r.mousePos(this.element,t)),r.addEventListener(e.window,"mousemove",this.mousemove),r.addEventListener(e.window,"mouseup",this.mouseup)},pa.prototype.mousemove=function(e){this.move(e,r.mousePos(this.element,e))},pa.prototype.mouseup=function(e){this.mouseRotate.mouseupWindow(e),this.mousePitch&&this.mousePitch.mouseupWindow(e),this.offTemp()},pa.prototype.touchstart=function(e){1!==e.targetTouches.length?this.reset():(this._startPos=this._lastPos=r.touchPos(this.element,e.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:function(){return e.preventDefault()}},this._startPos))},pa.prototype.touchmove=function(e){1!==e.targetTouches.length?this.reset():(this._lastPos=r.touchPos(this.element,e.targetTouches)[0],this.move({preventDefault:function(){return e.preventDefault()}},this._lastPos))},pa.prototype.touchend=function(e){0===e.targetTouches.length&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()},pa.prototype.reset=function(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()};var da={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function ma(e,t,r){var i=e.classList;for(var n in da)i.remove("mapboxgl-"+r+"-anchor-"+n);i.add("mapboxgl-"+r+"-anchor-"+t)}function fa(t){this.options=e.extend({},Ta,t),e.bindAll(["_onMove","setUnit"],this)}var ya,ga,va,_a=((va=e.Evented)&&(Ea.__proto__=va),((Ea.prototype=Object.create(va&&va.prototype)).constructor=Ea).prototype.addTo=function(e){return this.remove(),(this._map=e).getCanvasContainer().appendChild(this._element),e.on("move",this._update),e.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this},Ea.prototype.remove=function(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),r.remove(this._element),this._popup&&this._popup.remove(),this},Ea.prototype.getLngLat=function(){return this._lngLat},Ea.prototype.setLngLat=function(t){return this._lngLat=e.LngLat.convert(t),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this},Ea.prototype.getElement=function(){return this._element},Ea.prototype.setPopup=function(e){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),e){if(!("offset"in e.options)){var t=Math.sqrt(Math.pow(13.5,2)/2);e.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[t,-1*(24.6+t)],"bottom-right":[-t,-1*(24.6+t)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=e,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this},Ea.prototype._onKeyPress=function(e){var t=e.code,r=e.charCode||e.keyCode;"Space"!==t&&"Enter"!==t&&32!==r&&13!==r||this.togglePopup()},Ea.prototype._onMapClick=function(e){var t=e.originalEvent.target,r=this._element;this._popup&&(t===r||r.contains(t))&&this.togglePopup()},Ea.prototype.getPopup=function(){return this._popup},Ea.prototype.togglePopup=function(){var e=this._popup;return e&&(e.isOpen()?e.remove():e.addTo(this._map)),this},Ea.prototype._update=function(e){if(this._map){this._map.transform.renderWorldCopies&&(this._lngLat=ha(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);var t="";"viewport"===this._rotationAlignment||"auto"===this._rotationAlignment?t="rotateZ("+this._rotation+"deg)":"map"===this._rotationAlignment&&(t="rotateZ("+(this._rotation-this._map.getBearing())+"deg)");var i="";"viewport"===this._pitchAlignment||"auto"===this._pitchAlignment?i="rotateX(0deg)":"map"===this._pitchAlignment&&(i="rotateX("+this._map.getPitch()+"deg)"),e&&"moveend"!==e.type||(this._pos=this._pos.round()),r.setTransform(this._element,da[this._anchor]+" translate("+this._pos.x+"px, "+this._pos.y+"px) "+i+" "+t)}},Ea.prototype.getOffset=function(){return this._offset},Ea.prototype.setOffset=function(t){return this._offset=e.Point.convert(t),this._update(),this},Ea.prototype._onMove=function(t){this._pos=t.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none","pending"===this._state&&(this._state="active",this.fire(new e.Event("dragstart"))),this.fire(new e.Event("drag"))},Ea.prototype._onUp=function(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),"active"===this._state&&this.fire(new e.Event("dragend")),this._state="inactive"},Ea.prototype._addDragHandler=function(e){this._element.contains(e.originalEvent.target)&&(e.preventDefault(),this._positionDelta=e.point.sub(this._pos).add(this._offset),this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},Ea.prototype.setDraggable=function(e){return this._draggable=!!e,this._map&&(e?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this},Ea.prototype.isDraggable=function(){return this._draggable},Ea.prototype.setRotation=function(e){return this._rotation=e||0,this._update(),this},Ea.prototype.getRotation=function(){return this._rotation},Ea.prototype.setRotationAlignment=function(e){return this._rotationAlignment=e||"auto",this._update(),this},Ea.prototype.getRotationAlignment=function(){return this._rotationAlignment},Ea.prototype.setPitchAlignment=function(e){return this._pitchAlignment=e&&"auto"!==e?e:this._rotationAlignment,this._update(),this},Ea.prototype.getPitchAlignment=function(){return this._pitchAlignment},Ea),ba={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0},xa=0,wa=!1,Sa=((ga=e.Evented)&&(Ca.__proto__=ga),((Ca.prototype=Object.create(ga&&ga.prototype)).constructor=Ca).prototype.onAdd=function(t){var i;return this._map=t,this._container=r.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),i=this._setupUI,void 0!==ya?i(ya):void 0!==e.window.navigator.permissions?e.window.navigator.permissions.query({name:"geolocation"}).then((function(e){i(ya="denied"!==e.state)})):i(ya=!!e.window.navigator.geolocation),this._container},Ca.prototype.onRemove=function(){void 0!==this._geolocationWatchID&&(e.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),r.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,xa=0,wa=!1},Ca.prototype._isOutOfMapMaxBounds=function(e){var t=this._map.getMaxBounds(),r=e.coords;return t&&(r.longitude<t.getWest()||r.longitude>t.getEast()||r.latitude<t.getSouth()||r.latitude>t.getNorth())},Ca.prototype._setErrorState=function(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}},Ca.prototype._onSuccess=function(t){if(this._map){if(this._isOutOfMapMaxBounds(t))return this._setErrorState(),this.fire(new e.Event("outofmaxbounds",t)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=t,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&"OFF"!==this._watchState&&this._updateMarker(t),this.options.trackUserLocation&&"ACTIVE_LOCK"!==this._watchState||this._updateCamera(t),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new e.Event("geolocate",t)),this._finish()}},Ca.prototype._updateCamera=function(t){var r=new e.LngLat(t.coords.longitude,t.coords.latitude),i=t.coords.accuracy,n=this._map.getBearing(),o=e.extend({bearing:n},this.options.fitBoundsOptions);this._map.fitBounds(r.toBounds(i),o,{geolocateSource:!0})},Ca.prototype._updateMarker=function(t){if(t){var r=new e.LngLat(t.coords.longitude,t.coords.latitude);this._accuracyCircleMarker.setLngLat(r).addTo(this._map),this._userLocationDotMarker.setLngLat(r).addTo(this._map),this._accuracy=t.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},Ca.prototype._updateCircleRadius=function(){var e=this._map._container.clientHeight/2,t=this._map.unproject([0,e]),r=this._map.unproject([1,e]),i=t.distanceTo(r),n=Math.ceil(2*this._accuracy/i);this._circleElement.style.width=n+"px",this._circleElement.style.height=n+"px"},Ca.prototype._onZoom=function(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},Ca.prototype._onError=function(t){if(this._map){if(this.options.trackUserLocation)if(1===t.code){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;var r=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=r,this._geolocateButton.setAttribute("aria-label",r),void 0!==this._geolocationWatchID&&this._clearWatch()}else{if(3===t.code&&wa)return;this._setErrorState()}"OFF"!==this._watchState&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new e.Event("error",t)),this._finish()}},Ca.prototype._finish=function(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},Ca.prototype._setupUI=function(t){var i=this;if(this._container.addEventListener("contextmenu",(function(e){return e.preventDefault()})),this._geolocateButton=r.create("button","mapboxgl-ctrl-geolocate",this._container),r.create("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden",!0),!(this._geolocateButton.type="button")===t){e.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");var n=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=n,this._geolocateButton.setAttribute("aria-label",n)}else{var o=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=o,this._geolocateButton.setAttribute("aria-label",o)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=r.create("div","mapboxgl-user-location-dot"),this._userLocationDotMarker=new _a(this._dotElement),this._circleElement=r.create("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new _a({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",(function(t){t.geolocateSource||"ACTIVE_LOCK"!==i._watchState||t.originalEvent&&"resize"===t.originalEvent.type||(i._watchState="BACKGROUND",i._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),i._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),i.fire(new e.Event("trackuserlocationend")))}))},Ca.prototype.trigger=function(){if(!this._setup)return e.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new e.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":xa--,wa=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new e.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new e.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if("OFF"===this._watchState&&void 0!==this._geolocationWatchID)this._clearWatch();else if(void 0===this._geolocationWatchID){var t;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),wa=1<++xa?(t={maximumAge:6e5,timeout:0},!0):(t=this.options.positionOptions,!1),this._geolocationWatchID=e.window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,t)}}else e.window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0},Ca.prototype._clearWatch=function(){e.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)},Ca),Ta={maxWidth:100,unit:"metric"};function Ca(t){ga.call(this),this.options=e.extend({},ba,t),e.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}function Ea(t,i){var n=this;if(va.call(this),(t instanceof e.window.HTMLElement||i)&&(t=e.extend({element:t},i)),e.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=t&&t.anchor||"center",this._color=t&&t.color||"#3FB1CE",this._scale=t&&t.scale||1,this._draggable=t&&t.draggable||!1,this._state="inactive",this._rotation=t&&t.rotation||0,this._rotationAlignment=t&&t.rotationAlignment||"auto",this._pitchAlignment=t&&t.pitchAlignment&&"auto"!==t.pitchAlignment?t.pitchAlignment:this._rotationAlignment,t&&t.element)this._element=t.element,this._offset=e.Point.convert(t&&t.offset||[0,0]);else{this._defaultMarker=!0,this._element=r.create("div"),this._element.setAttribute("aria-label","Map marker");var o=r.createNS("http://www.w3.org/2000/svg","svg");o.setAttributeNS(null,"display","block"),o.setAttributeNS(null,"height","41px"),o.setAttributeNS(null,"width","27px"),o.setAttributeNS(null,"viewBox","0 0 27 41");var a=r.createNS("http://www.w3.org/2000/svg","g");a.setAttributeNS(null,"stroke","none"),a.setAttributeNS(null,"stroke-width","1"),a.setAttributeNS(null,"fill","none"),a.setAttributeNS(null,"fill-rule","evenodd");var s=r.createNS("http://www.w3.org/2000/svg","g");s.setAttributeNS(null,"fill-rule","nonzero");var l=r.createNS("http://www.w3.org/2000/svg","g");l.setAttributeNS(null,"transform","translate(3.0, 29.0)"),l.setAttributeNS(null,"fill","#000000");for(var u=0,c=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];u<c.length;u+=1){var p=c[u],h=r.createNS("http://www.w3.org/2000/svg","ellipse");h.setAttributeNS(null,"opacity","0.04"),h.setAttributeNS(null,"cx","10.5"),h.setAttributeNS(null,"cy","5.80029008"),h.setAttributeNS(null,"rx",p.rx),h.setAttributeNS(null,"ry",p.ry),l.appendChild(h)}var d=r.createNS("http://www.w3.org/2000/svg","g");d.setAttributeNS(null,"fill",this._color);var m=r.createNS("http://www.w3.org/2000/svg","path");m.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),d.appendChild(m);var f=r.createNS("http://www.w3.org/2000/svg","g");f.setAttributeNS(null,"opacity","0.25"),f.setAttributeNS(null,"fill","#000000");var y=r.createNS("http://www.w3.org/2000/svg","path");y.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),f.appendChild(y);var g=r.createNS("http://www.w3.org/2000/svg","g");g.setAttributeNS(null,"transform","translate(6.0, 7.0)"),g.setAttributeNS(null,"fill","#FFFFFF");var v=r.createNS("http://www.w3.org/2000/svg","g");v.setAttributeNS(null,"transform","translate(8.0, 8.0)");var _=r.createNS("http://www.w3.org/2000/svg","circle");_.setAttributeNS(null,"fill","#000000"),_.setAttributeNS(null,"opacity","0.25"),_.setAttributeNS(null,"cx","5.5"),_.setAttributeNS(null,"cy","5.5"),_.setAttributeNS(null,"r","5.4999962");var b=r.createNS("http://www.w3.org/2000/svg","circle");b.setAttributeNS(null,"fill","#FFFFFF"),b.setAttributeNS(null,"cx","5.5"),b.setAttributeNS(null,"cy","5.5"),b.setAttributeNS(null,"r","5.4999962"),v.appendChild(_),v.appendChild(b),s.appendChild(l),s.appendChild(d),s.appendChild(f),s.appendChild(g),s.appendChild(v),o.appendChild(s),o.setAttributeNS(null,"height",41*this._scale+"px"),o.setAttributeNS(null,"width",27*this._scale+"px"),this._element.appendChild(o),this._offset=e.Point.convert(t&&t.offset||[0,-14])}this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",(function(e){e.preventDefault()})),this._element.addEventListener("mousedown",(function(e){e.preventDefault()})),this._element.addEventListener("focus",(function(){var e=n._map.getContainer();e.scrollTop=0,e.scrollLeft=0})),ma(this._element,this._anchor,"marker"),this._popup=null}function Ia(e,t,r){var i=r&&r.maxWidth||100,n=e._container.clientHeight/2,o=e.unproject([0,n]),a=e.unproject([i,n]),s=o.distanceTo(a);if(r&&"imperial"===r.unit){var l=3.2808*s;5280<l?Pa(t,i,l/5280,e._getUIString("ScaleControl.Miles")):Pa(t,i,l,e._getUIString("ScaleControl.Feet"))}else r&&"nautical"===r.unit?Pa(t,i,s/1852,e._getUIString("ScaleControl.NauticalMiles")):1e3<=s?Pa(t,i,s/1e3,e._getUIString("ScaleControl.Kilometers")):Pa(t,i,s,e._getUIString("ScaleControl.Meters"))}function Pa(e,t,r,i){var n,o,a,s,l,u=(n=r,(o=Math.pow(10,(""+Math.floor(n)).length-1))*(a=10<=(a=n/o)?10:5<=a?5:3<=a?3:2<=a?2:1<=a?1:(s=a,l=Math.pow(10,Math.ceil(-Math.log(s)/Math.LN10)),Math.round(s*l)/l)));e.style.width=t*(u/r)+"px",e.innerHTML=u+"&nbsp;"+i}function Ra(t){this._fullscreen=!1,t&&t.container&&(t.container instanceof e.window.HTMLElement?this._container=t.container:e.warnOnce("Full screen control 'container' must be a DOM element.")),e.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in e.window.document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in e.window.document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in e.window.document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in e.window.document&&(this._fullscreenchange="MSFullscreenChange")}fa.prototype.getDefaultPosition=function(){return"bottom-left"},fa.prototype._onMove=function(){Ia(this._map,this._container,this.options)},fa.prototype.onAdd=function(e){return this._map=e,this._container=r.create("div","mapboxgl-ctrl mapboxgl-ctrl-scale",e.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container},fa.prototype.onRemove=function(){r.remove(this._container),this._map.off("move",this._onMove),this._map=void 0},fa.prototype.setUnit=function(e){this.options.unit=e,Ia(this._map,this._container,this.options)},Ra.prototype.onAdd=function(t){return this._map=t,this._container||(this._container=this._map.getContainer()),this._controlContainer=r.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",e.warnOnce("This device does not support fullscreen mode.")),this._controlContainer},Ra.prototype.onRemove=function(){r.remove(this._controlContainer),this._map=null,e.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)},Ra.prototype._checkFullscreenSupport=function(){return!!(e.window.document.fullscreenEnabled||e.window.document.mozFullScreenEnabled||e.window.document.msFullscreenEnabled||e.window.document.webkitFullscreenEnabled)},Ra.prototype._setupUI=function(){var t=this._fullscreenButton=r.create("button","mapboxgl-ctrl-fullscreen",this._controlContainer);r.create("span","mapboxgl-ctrl-icon",t).setAttribute("aria-hidden",!0),t.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),e.window.document.addEventListener(this._fullscreenchange,this._changeIcon)},Ra.prototype._updateTitle=function(){var e=this._getTitle();this._fullscreenButton.setAttribute("aria-label",e),this._fullscreenButton.title=e},Ra.prototype._getTitle=function(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")},Ra.prototype._isFullscreen=function(){return this._fullscreen},Ra.prototype._changeIcon=function(){(e.window.document.fullscreenElement||e.window.document.mozFullScreenElement||e.window.document.webkitFullscreenElement||e.window.document.msFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())},Ra.prototype._onClickFullscreen=function(){this._isFullscreen()?e.window.document.exitFullscreen?e.window.document.exitFullscreen():e.window.document.mozCancelFullScreen?e.window.document.mozCancelFullScreen():e.window.document.msExitFullscreen?e.window.document.msExitFullscreen():e.window.document.webkitCancelFullScreen&&e.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()};var Na,Aa={closeButton:!0,closeOnClick:!0,className:"",maxWidth:"240px"},za=((Na=e.Evented)&&(ka.__proto__=Na),((ka.prototype=Object.create(Na&&Na.prototype)).constructor=ka).prototype.addTo=function(t){return this._map&&this.remove(),this._map=t,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new e.Event("open")),this},ka.prototype.isOpen=function(){return!!this._map},ka.prototype.remove=function(){return this._content&&r.remove(this._content),this._container&&(r.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new e.Event("close")),this},ka.prototype.getLngLat=function(){return this._lngLat},ka.prototype.setLngLat=function(t){return this._lngLat=e.LngLat.convert(t),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("mapboxgl-track-pointer")),this},ka.prototype.trackPointer=function(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")),this},ka.prototype.getElement=function(){return this._container},ka.prototype.setText=function(t){return this.setDOMContent(e.window.document.createTextNode(t))},ka.prototype.setHTML=function(t){var r,i=e.window.document.createDocumentFragment(),n=e.window.document.createElement("body");for(n.innerHTML=t;r=n.firstChild;)i.appendChild(r);return this.setDOMContent(i)},ka.prototype.getMaxWidth=function(){return this._container&&this._container.style.maxWidth},ka.prototype.setMaxWidth=function(e){return this.options.maxWidth=e,this._update(),this},ka.prototype.setDOMContent=function(e){return this._createContent(),this._content.appendChild(e),this._update(),this},ka.prototype.addClassName=function(e){this._container&&this._container.classList.add(e)},ka.prototype.removeClassName=function(e){this._container&&this._container.classList.remove(e)},ka.prototype.toggleClassName=function(e){if(this._container)return this._container.classList.toggle(e)},ka.prototype._createContent=function(){this._content&&r.remove(this._content),this._content=r.create("div","mapboxgl-popup-content",this._container),this.options.closeButton&&(this._closeButton=r.create("button","mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))},ka.prototype._onMouseUp=function(e){this._update(e.point)},ka.prototype._onMouseMove=function(e){this._update(e.point)},ka.prototype._onDrag=function(e){this._update(e.point)},ka.prototype._update=function(t){var i=this;if(this._map&&(this._lngLat||this._trackPointer)&&this._content&&(this._container||(this._container=r.create("div","mapboxgl-popup",this._map.getContainer()),this._tip=r.create("div","mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach((function(e){return i._container.classList.add(e)})),this._trackPointer&&this._container.classList.add("mapboxgl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=ha(this._lngLat,this._pos,this._map.transform)),!this._trackPointer||t)){var n=this._pos=this._trackPointer&&t?t:this._map.project(this._lngLat),o=this.options.anchor,a=function t(r){if(r){if("number"==typeof r){var i=Math.round(Math.sqrt(.5*Math.pow(r,2)));return{center:new e.Point(0,0),top:new e.Point(0,r),"top-left":new e.Point(i,i),"top-right":new e.Point(-i,i),bottom:new e.Point(0,-r),"bottom-left":new e.Point(i,-i),"bottom-right":new e.Point(-i,-i),left:new e.Point(r,0),right:new e.Point(-r,0)}}if(r instanceof e.Point||Array.isArray(r)){var n=e.Point.convert(r);return{center:n,top:n,"top-left":n,"top-right":n,bottom:n,"bottom-left":n,"bottom-right":n,left:n,right:n}}return{center:e.Point.convert(r.center||[0,0]),top:e.Point.convert(r.top||[0,0]),"top-left":e.Point.convert(r["top-left"]||[0,0]),"top-right":e.Point.convert(r["top-right"]||[0,0]),bottom:e.Point.convert(r.bottom||[0,0]),"bottom-left":e.Point.convert(r["bottom-left"]||[0,0]),"bottom-right":e.Point.convert(r["bottom-right"]||[0,0]),left:e.Point.convert(r.left||[0,0]),right:e.Point.convert(r.right||[0,0])}}return t(new e.Point(0,0))}(this.options.offset);if(!o){var s,l=this._container.offsetWidth,u=this._container.offsetHeight;s=n.y+a.bottom.y<u?["top"]:n.y>this._map.transform.height-u?["bottom"]:[],n.x<l/2?s.push("left"):n.x>this._map.transform.width-l/2&&s.push("right"),o=0===s.length?"bottom":s.join("-")}var c=n.add(a[o]).round();r.setTransform(this._container,da[o]+" translate("+c.x+"px,"+c.y+"px)"),ma(this._container,o,"popup")}},ka.prototype._onClose=function(){this.remove()},ka),Ma={version:e.version,supported:t,setRTLTextPlugin:e.setRTLTextPlugin,getRTLTextPluginStatus:e.getRTLTextPluginStatus,Map:sa,NavigationControl:ua,GeolocateControl:Sa,AttributionControl:Yo,ScaleControl:fa,FullscreenControl:Ra,Popup:za,Marker:_a,Style:bi,LngLat:e.LngLat,LngLatBounds:e.LngLatBounds,Point:e.Point,MercatorCoordinate:e.MercatorCoordinate,Evented:e.Evented,config:e.config,prewarm:function(){yr().acquire(hr)},clearPrewarmedResources:function(){var e=mr;e&&(e.isPreloaded()&&1===e.numActive()?(e.release(hr),mr=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return e.config.ACCESS_TOKEN},set accessToken(t){e.config.ACCESS_TOKEN=t},get baseApiUrl(){return e.config.API_URL},set baseApiUrl(t){e.config.API_URL=t},get workerCount(){return dr.workerCount},set workerCount(e){dr.workerCount=e},get maxParallelImageRequests(){return e.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(t){e.config.MAX_PARALLEL_IMAGE_REQUESTS=t},clearStorage:function(t){e.clearTileCache(t)},workerUrl:""};function ka(t){Na.call(this),this.options=e.extend(Object.create(Aa),t),e.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}return Ma})),o)})),o=(n.Map,n.setRTLTextPlugin),a=(n.supported,n.Marker),s="atlas.microsoft.com",l="atlas.microsoft.com",u="e96cb745-c6f5-409c-a775-c4313e468c1d",c="{azMapsDomain}",p="https://atlas.microsoft.com/",h=function(e,t){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};function d(e,t){function r(){this.constructor=e}h(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var m=function(){return(m=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)};function f(e,t,r,i){return new(r=r||Promise)((function(n,o){function a(e){try{l(i.next(e))}catch(e){o(e)}}function s(e){try{l(i.throw(e))}catch(e){o(e)}}function l(e){e.done?n(e.value):new r((function(t){t(e.value)})).then(a,s)}l((i=i.apply(e,t||[])).next())}))}function y(e,t){var r,i,n,o,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,i&&(n=2&o[0]?i.return:o[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,o[1])).done)return n;switch(i=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,i=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(n=0<(n=a.trys).length&&n[n.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){a.label=o[1];break}if(6===o[0]&&a.label<n[1]){a.label=n[1],n=o;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(o);break}n[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],i=0}finally{r=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}var g=(v.prototype.merge=function(){for(var e,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];for(var i=0,n=t;i<n.length;i++){var o=n[i];if(o)for(var a in o)o.hasOwnProperty(a)&&this.hasOwnProperty(a)&&(void 0!==o[a]&&null!=o[a]?this[a]instanceof v?this[a].merge(o[a]):this[a]=o[a]:(e=e||new(Object.getPrototypeOf(this).constructor),this[a]=e[a]))}return this},v);function v(){}var _,b=(d(x,_=g),x);function x(){var e=null!==_&&_.apply(this,arguments)||this;return e.domain=void 0,e.headers={},e.path="",e.protocol="https",e.queryParams={},e.subdomain="",e}var w=(S.prototype.get=function(){return fetch(this.toString(),{method:"GET",mode:"cors",headers:new Headers(this.options.headers)}).then((function(e){if(e.ok)return e.json();throw new Error("HTTP "+e.status+": "+e.statusText)}))},S.prototype.toString=function(){var e=Object.entries(this.options.queryParams).map((function(e){return e[0]+"="+e[1]})).join("&"),t=[];return S.protoRegEx.test(this.options.domain)||(t.push(this.options.protocol+"://"),t.push(this.options.subdomain?this.options.subdomain+".":"")),t.push(this.options.domain),t.push(this.options.path?"/"+this.options.path:""),t.push(e?"?"+e:""),t.join("")},S.protoRegEx=new RegExp(/^\w+:\/\//),S);function S(e){this.options=(new b).merge(e)}var T,C="2.0.31",E=(I.getFullVersion=function(){return C},I.getEndpointVersion=function(){var e=C.indexOf(".");return-1===(e=C.indexOf(".",e+1))?C:C.substring(0,e)},I);function I(){}(T=t.ControlPosition||(t.ControlPosition={})).TopLeft="top-left",T.TopRight="top-right",T.BottomLeft="bottom-left",T.BottomRight="bottom-right",T.NonFixed="non-fixed";var P,R=(d(N,P=g),N);function N(){var e=null!==P&&P.apply(this,arguments)||this;return e.position=t.ControlPosition.NonFixed,e}var A={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},z=i((function(e){var t=Array.prototype.concat,r=Array.prototype.slice,i=e.exports=function(e){for(var i,n=[],o=0,a=e.length;o<a;o++){var s=e[o];(i=s)&&"string"!=typeof i&&(i instanceof Array||Array.isArray(i)||0<=i.length&&(i.splice instanceof Function||Object.getOwnPropertyDescriptor(i,i.length-1)&&"String"!==i.constructor.name))?n=t.call(n,r.call(s)):n.push(s)}return n};i.wrap=function(e){return function(){return e(i(arguments))}}})),M=i((function(e){var t={};for(var r in A)A.hasOwnProperty(r)&&(t[A[r]]=r);var i=e.exports={to:{},get:{}};function n(e,t,r){return Math.min(Math.max(t,e),r)}function o(e){var t=e.toString(16).toUpperCase();return t.length<2?"0"+t:t}i.get=function(e){var t,r;switch(e.substring(0,3).toLowerCase()){case"hsl":t=i.get.hsl(e),r="hsl";break;case"hwb":t=i.get.hwb(e),r="hwb";break;default:t=i.get.rgb(e),r="rgb"}return t?{model:r,value:t}:null},i.get.rgb=function(e){if(!e)return null;var t,r,i,o=[0,0,0,1];if(t=e.match(/^#([a-f0-9]{6})([a-f0-9]{2})?$/i)){for(i=t[2],t=t[1],r=0;r<3;r++){var a=2*r;o[r]=parseInt(t.slice(a,2+a),16)}i&&(o[3]=Math.round(parseInt(i,16)/255*100)/100)}else if(t=e.match(/^#([a-f0-9]{3,4})$/i)){for(i=(t=t[1])[3],r=0;r<3;r++)o[r]=parseInt(t[r]+t[r],16);i&&(o[3]=Math.round(parseInt(i+i,16)/255*100)/100)}else if(t=e.match(/^rgba?\(\s*([+-]?\d+)\s*,\s*([+-]?\d+)\s*,\s*([+-]?\d+)\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/)){for(r=0;r<3;r++)o[r]=parseInt(t[r+1],0);t[4]&&(o[3]=parseFloat(t[4]))}else{if(!(t=e.match(/^rgba?\(\s*([+-]?[\d\.]+)\%\s*,\s*([+-]?[\d\.]+)\%\s*,\s*([+-]?[\d\.]+)\%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/)))return(t=e.match(/(\D+)/))?"transparent"===t[1]?[0,0,0,0]:(o=A[t[1]])?(o[3]=1,o):null:null;for(r=0;r<3;r++)o[r]=Math.round(2.55*parseFloat(t[r+1]));t[4]&&(o[3]=parseFloat(t[4]))}for(r=0;r<3;r++)o[r]=n(o[r],0,255);return o[3]=n(o[3],0,1),o},i.get.hsl=function(e){if(!e)return null;var t=e.match(/^hsla?\(\s*([+-]?(?:\d*\.)?\d+)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/);if(t){var r=parseFloat(t[4]);return[(parseFloat(t[1])+360)%360,n(parseFloat(t[2]),0,100),n(parseFloat(t[3]),0,100),n(isNaN(r)?1:r,0,1)]}return null},i.get.hwb=function(e){if(!e)return null;var t=e.match(/^hwb\(\s*([+-]?\d*[\.]?\d+)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/);if(t){var r=parseFloat(t[4]);return[(parseFloat(t[1])%360+360)%360,n(parseFloat(t[2]),0,100),n(parseFloat(t[3]),0,100),n(isNaN(r)?1:r,0,1)]}return null},i.to.hex=function(){var e=z(arguments);return"#"+o(e[0])+o(e[1])+o(e[2])+(e[3]<1?o(Math.round(255*e[3])):"")},i.to.rgb=function(){var e=z(arguments);return e.length<4||1===e[3]?"rgb("+Math.round(e[0])+", "+Math.round(e[1])+", "+Math.round(e[2])+")":"rgba("+Math.round(e[0])+", "+Math.round(e[1])+", "+Math.round(e[2])+", "+e[3]+")"},i.to.rgb.percent=function(){var e=z(arguments),t=Math.round(e[0]/255*100),r=Math.round(e[1]/255*100),i=Math.round(e[2]/255*100);return e.length<4||1===e[3]?"rgb("+t+"%, "+r+"%, "+i+"%)":"rgba("+t+"%, "+r+"%, "+i+"%, "+e[3]+")"},i.to.hsl=function(){var e=z(arguments);return e.length<4||1===e[3]?"hsl("+e[0]+", "+e[1]+"%, "+e[2]+"%)":"hsla("+e[0]+", "+e[1]+"%, "+e[2]+"%, "+e[3]+")"},i.to.hwb=function(){var e=z(arguments),t="";return 4<=e.length&&1!==e[3]&&(t=", "+e[3]),"hwb("+e[0]+", "+e[1]+"%, "+e[2]+"%"+t+")"},i.to.keyword=function(e){return t[e.slice(0,3)]}})),k=(M.to,M.get,i((function(e){var t={};for(var r in A)A.hasOwnProperty(r)&&(t[A[r]]=r);var i=e.exports={rgb:{channels:3,labels:"rgb"},hsl:{channels:3,labels:"hsl"},hsv:{channels:3,labels:"hsv"},hwb:{channels:3,labels:"hwb"},cmyk:{channels:4,labels:"cmyk"},xyz:{channels:3,labels:"xyz"},lab:{channels:3,labels:"lab"},lch:{channels:3,labels:"lch"},hex:{channels:1,labels:["hex"]},keyword:{channels:1,labels:["keyword"]},ansi16:{channels:1,labels:["ansi16"]},ansi256:{channels:1,labels:["ansi256"]},hcg:{channels:3,labels:["h","c","g"]},apple:{channels:3,labels:["r16","g16","b16"]},gray:{channels:1,labels:["gray"]}};for(var n in i)if(i.hasOwnProperty(n)){if(!("channels"in i[n]))throw new Error("missing channels property: "+n);if(!("labels"in i[n]))throw new Error("missing channel labels property: "+n);if(i[n].labels.length!==i[n].channels)throw new Error("channel and label counts mismatch: "+n);var o=i[n].channels,a=i[n].labels;delete i[n].channels,delete i[n].labels,Object.defineProperty(i[n],"channels",{value:o}),Object.defineProperty(i[n],"labels",{value:a})}i.rgb.hsl=function(e){var t,r,i=e[0]/255,n=e[1]/255,o=e[2]/255,a=Math.min(i,n,o),s=Math.max(i,n,o),l=s-a;return s===a?t=0:i===s?t=(n-o)/l:n===s?t=2+(o-i)/l:o===s&&(t=4+(i-n)/l),(t=Math.min(60*t,360))<0&&(t+=360),r=(a+s)/2,[t,100*(s===a?0:r<=.5?l/(s+a):l/(2-s-a)),100*r]},i.rgb.hsv=function(e){function t(e){return(c-e)/6/p+.5}var r,i,n,o,a,s=e[0]/255,l=e[1]/255,u=e[2]/255,c=Math.max(s,l,u),p=c-Math.min(s,l,u);return 0==p?o=a=0:(a=p/c,r=t(s),i=t(l),n=t(u),s===c?o=n-i:l===c?o=1/3+r-n:u===c&&(o=2/3+i-r),o<0?o+=1:1<o&&--o),[360*o,100*a,100*c]},i.rgb.hwb=function(e){var t=e[0],r=e[1],n=e[2];return[i.rgb.hsl(e)[0],1/255*Math.min(t,Math.min(r,n))*100,100*(n=1-1/255*Math.max(t,Math.max(r,n)))]},i.rgb.cmyk=function(e){var t,r=e[0]/255,i=e[1]/255,n=e[2]/255;return[100*((1-r-(t=Math.min(1-r,1-i,1-n)))/(1-t)||0),100*((1-i-t)/(1-t)||0),100*((1-n-t)/(1-t)||0),100*t]},i.rgb.keyword=function(e){var r=t[e];if(r)return r;var i,n,o,a=1/0;for(var s in A)if(A.hasOwnProperty(s)){var l=(n=e,o=A[s],Math.pow(n[0]-o[0],2)+Math.pow(n[1]-o[1],2)+Math.pow(n[2]-o[2],2));l<a&&(a=l,i=s)}return i},i.keyword.rgb=function(e){return A[e]},i.rgb.xyz=function(e){var t=e[0]/255,r=e[1]/255,i=e[2]/255;return[100*(.4124*(t=.04045<t?Math.pow((t+.055)/1.055,2.4):t/12.92)+.3576*(r=.04045<r?Math.pow((r+.055)/1.055,2.4):r/12.92)+.1805*(i=.04045<i?Math.pow((i+.055)/1.055,2.4):i/12.92)),100*(.2126*t+.7152*r+.0722*i),100*(.0193*t+.1192*r+.9505*i)]},i.rgb.lab=function(e){var t=i.rgb.xyz(e),r=t[0],n=t[1],o=t[2];return n/=100,o/=108.883,r=.008856<(r/=95.047)?Math.pow(r,1/3):7.787*r+16/116,[116*(n=.008856<n?Math.pow(n,1/3):7.787*n+16/116)-16,500*(r-n),200*(n-(o=.008856<o?Math.pow(o,1/3):7.787*o+16/116))]},i.hsl.rgb=function(e){var t,r,i,n,o,a=e[0]/360,s=e[1]/100,l=e[2]/100;if(0==s)return[o=255*l,o,o];t=2*l-(r=l<.5?l*(1+s):l+s-l*s),n=[0,0,0];for(var u=0;u<3;u++)(i=a+1/3*-(u-1))<0&&i++,1<i&&i--,o=6*i<1?t+6*(r-t)*i:2*i<1?r:3*i<2?t+(r-t)*(2/3-i)*6:t,n[u]=255*o;return n},i.hsl.hsv=function(e){var t=e[0],r=e[1]/100,i=e[2]/100,n=r,o=Math.max(i,.01);return r*=(i*=2)<=1?i:2-i,n*=o<=1?o:2-o,[t,100*(0===i?2*n/(o+n):2*r/(i+r)),(i+r)/2*100]},i.hsv.rgb=function(e){var t=e[0]/60,r=e[1]/100,i=e[2]/100,n=Math.floor(t)%6,o=t-Math.floor(t),a=255*i*(1-r),s=255*i*(1-r*o),l=255*i*(1-r*(1-o));switch(i*=255,n){case 0:return[i,l,a];case 1:return[s,i,a];case 2:return[a,i,l];case 3:return[a,s,i];case 4:return[l,a,i];case 5:return[i,a,s]}},i.hsv.hsl=function(e){var t,r,i,n=e[0],o=e[1]/100,a=e[2]/100,s=Math.max(a,.01);return i=(2-o)*a,r=o*s,[n,100*(r=(r/=(t=(2-o)*s)<=1?t:2-t)||0),100*(i/=2)]},i.hwb.rgb=function(e){var t,r,i,n,o,a,s,l=e[0]/360,u=e[1]/100,c=e[2]/100,p=u+c;switch(1<p&&(u/=p,c/=p),i=6*l-(t=Math.floor(6*l)),0!=(1&t)&&(i=1-i),n=u+i*((r=1-c)-u),t){default:case 6:case 0:o=r,a=n,s=u;break;case 1:o=n,a=r,s=u;break;case 2:o=u,a=r,s=n;break;case 3:o=u,a=n,s=r;break;case 4:o=n,a=u,s=r;break;case 5:o=r,a=u,s=n}return[255*o,255*a,255*s]},i.cmyk.rgb=function(e){var t=e[0]/100,r=e[1]/100,i=e[2]/100,n=e[3]/100;return[255*(1-Math.min(1,t*(1-n)+n)),255*(1-Math.min(1,r*(1-n)+n)),255*(1-Math.min(1,i*(1-n)+n))]},i.xyz.rgb=function(e){var t,r,i,n=e[0]/100,o=e[1]/100,a=e[2]/100;return r=-.9689*n+1.8758*o+.0415*a,i=.0557*n+-.204*o+1.057*a,t=.0031308<(t=3.2406*n+-1.5372*o+-.4986*a)?1.055*Math.pow(t,1/2.4)-.055:12.92*t,r=.0031308<r?1.055*Math.pow(r,1/2.4)-.055:12.92*r,i=.0031308<i?1.055*Math.pow(i,1/2.4)-.055:12.92*i,[255*(t=Math.min(Math.max(0,t),1)),255*(r=Math.min(Math.max(0,r),1)),255*(i=Math.min(Math.max(0,i),1))]},i.xyz.lab=function(e){var t=e[0],r=e[1],i=e[2];return r/=100,i/=108.883,t=.008856<(t/=95.047)?Math.pow(t,1/3):7.787*t+16/116,[116*(r=.008856<r?Math.pow(r,1/3):7.787*r+16/116)-16,500*(t-r),200*(r-(i=.008856<i?Math.pow(i,1/3):7.787*i+16/116))]},i.lab.xyz=function(e){var t,r,i,n=e[0];t=e[1]/500+(r=(n+16)/116),i=r-e[2]/200;var o=Math.pow(r,3),a=Math.pow(t,3),s=Math.pow(i,3);return r=.008856<o?o:(r-16/116)/7.787,t=.008856<a?a:(t-16/116)/7.787,i=.008856<s?s:(i-16/116)/7.787,[t*=95.047,r*=100,i*=108.883]},i.lab.lch=function(e){var t,r=e[0],i=e[1],n=e[2];return(t=360*Math.atan2(n,i)/2/Math.PI)<0&&(t+=360),[r,Math.sqrt(i*i+n*n),t]},i.lch.lab=function(e){var t,r=e[0],i=e[1];return t=e[2]/360*2*Math.PI,[r,i*Math.cos(t),i*Math.sin(t)]},i.rgb.ansi16=function(e){var t=e[0],r=e[1],n=e[2],o=1 in arguments?arguments[1]:i.rgb.hsv(e)[2];if(0===(o=Math.round(o/50)))return 30;var a=30+(Math.round(n/255)<<2|Math.round(r/255)<<1|Math.round(t/255));return 2===o&&(a+=60),a},i.hsv.ansi16=function(e){return i.rgb.ansi16(i.hsv.rgb(e),e[2])},i.rgb.ansi256=function(e){var t=e[0],r=e[1],i=e[2];return t===r&&r===i?t<8?16:248<t?231:Math.round((t-8)/247*24)+232:16+36*Math.round(t/255*5)+6*Math.round(r/255*5)+Math.round(i/255*5)},i.ansi16.rgb=function(e){var t=e%10;if(0===t||7===t)return 50<e&&(t+=3.5),[t=t/10.5*255,t,t];var r=.5*(1+~~(50<e));return[(1&t)*r*255,(t>>1&1)*r*255,(t>>2&1)*r*255]},i.ansi256.rgb=function(e){if(232<=e){var t=10*(e-232)+8;return[t,t,t]}var r;return e-=16,[Math.floor(e/36)/5*255,Math.floor((r=e%36)/6)/5*255,r%6/5*255]},i.rgb.hex=function(e){var t=(((255&Math.round(e[0]))<<16)+((255&Math.round(e[1]))<<8)+(255&Math.round(e[2]))).toString(16).toUpperCase();return"000000".substring(t.length)+t},i.hex.rgb=function(e){var t=e.toString(16).match(/[a-f0-9]{6}|[a-f0-9]{3}/i);if(!t)return[0,0,0];var r=t[0];3===t[0].length&&(r=r.split("").map((function(e){return e+e})).join(""));var i=parseInt(r,16);return[i>>16&255,i>>8&255,255&i]},i.rgb.hcg=function(e){var t,r=e[0]/255,i=e[1]/255,n=e[2]/255,o=Math.max(Math.max(r,i),n),a=Math.min(Math.min(r,i),n),s=o-a;return t=s<=0?0:o===r?(i-n)/s%6:o===i?2+(n-r)/s:4+(r-i)/s+4,t/=6,[360*(t%=1),100*s,100*(s<1?a/(1-s):0)]},i.hsl.hcg=function(e){var t,r=e[1]/100,i=e[2]/100,n=0;return(t=i<.5?2*r*i:2*r*(1-i))<1&&(n=(i-.5*t)/(1-t)),[e[0],100*t,100*n]},i.hsv.hcg=function(e){var t=e[1]/100,r=e[2]/100,i=t*r,n=0;return i<1&&(n=(r-i)/(1-i)),[e[0],100*i,100*n]},i.hcg.rgb=function(e){var t=e[0]/360,r=e[1]/100,i=e[2]/100;if(0==r)return[255*i,255*i,255*i];var n,o=[0,0,0],a=t%1*6,s=a%1,l=1-s;switch(Math.floor(a)){case 0:o[0]=1,o[1]=s,o[2]=0;break;case 1:o[0]=l,o[1]=1,o[2]=0;break;case 2:o[0]=0,o[1]=1,o[2]=s;break;case 3:o[0]=0,o[1]=l,o[2]=1;break;case 4:o[0]=s,o[1]=0,o[2]=1;break;default:o[0]=1,o[1]=0,o[2]=l}return n=(1-r)*i,[255*(r*o[0]+n),255*(r*o[1]+n),255*(r*o[2]+n)]},i.hcg.hsv=function(e){var t=e[1]/100,r=t+e[2]/100*(1-t),i=0;return 0<r&&(i=t/r),[e[0],100*i,100*r]},i.hcg.hsl=function(e){var t=e[1]/100,r=e[2]/100*(1-t)+.5*t,i=0;return 0<r&&r<.5?i=t/(2*r):.5<=r&&r<1&&(i=t/(2*(1-r))),[e[0],100*i,100*r]},i.hcg.hwb=function(e){var t=e[1]/100,r=t+e[2]/100*(1-t);return[e[0],100*(r-t),100*(1-r)]},i.hwb.hcg=function(e){var t=e[1]/100,r=1-e[2]/100,i=r-t,n=0;return i<1&&(n=(r-i)/(1-i)),[e[0],100*i,100*n]},i.apple.rgb=function(e){return[e[0]/65535*255,e[1]/65535*255,e[2]/65535*255]},i.rgb.apple=function(e){return[e[0]/255*65535,e[1]/255*65535,e[2]/255*65535]},i.gray.rgb=function(e){return[e[0]/100*255,e[0]/100*255,e[0]/100*255]},i.gray.hsl=i.gray.hsv=function(e){return[0,0,e[0]]},i.gray.hwb=function(e){return[0,100,e[0]]},i.gray.cmyk=function(e){return[0,0,0,e[0]]},i.gray.lab=function(e){return[e[0],0,0]},i.gray.hex=function(e){var t=255&Math.round(e[0]/100*255),r=((t<<16)+(t<<8)+t).toString(16).toUpperCase();return"000000".substring(r.length)+r},i.rgb.gray=function(e){return[(e[0]+e[1]+e[2])/3/255*100]}})));function O(e,t){return function(r){return t(e(r))}}function L(e,t){for(var r=[t[e].parent,e],i=k[t[e].parent][e],n=t[e].parent;t[n].parent;)r.unshift(t[n].parent),i=O(k[t[n].parent][n],i),n=t[n].parent;return i.conversion=r,i}k.rgb,k.hsl,k.hsv,k.hwb,k.cmyk,k.xyz,k.lab,k.lch,k.hex,k.keyword,k.ansi16,k.ansi256,k.hcg,k.apple,k.gray;var D={};Object.keys(k).forEach((function(e){D[e]={},Object.defineProperty(D[e],"channels",{value:k[e].channels}),Object.defineProperty(D[e],"labels",{value:k[e].labels});var t=function(e){for(var t=function(e){var t=function(){for(var e={},t=Object.keys(k),r=t.length,i=0;i<r;i++)e[t[i]]={distance:-1,parent:null};return e}(),r=[e];for(t[e].distance=0;r.length;)for(var i=r.pop(),n=Object.keys(k[i]),o=n.length,a=0;a<o;a++){var s=n[a],l=t[s];-1===l.distance&&(l.distance=t[i].distance+1,l.parent=i,r.unshift(s))}return t}(e),r={},i=Object.keys(t),n=i.length,o=0;o<n;o++){var a=i[o];null!==t[a].parent&&(r[a]=L(a,t))}return r}(e);Object.keys(t).forEach((function(r){var i=t[r];D[e][r]=function(e){function t(t){if(null==t)return t;1<arguments.length&&(t=Array.prototype.slice.call(arguments));var r=e(t);if("object"==typeof r)for(var i=r.length,n=0;n<i;n++)r[n]=Math.round(r[n]);return r}return"conversion"in e&&(t.conversion=e.conversion),t}(i),D[e][r].raw=function(e){function t(t){return null==t?t:(1<arguments.length&&(t=Array.prototype.slice.call(arguments)),e(t))}return"conversion"in e&&(t.conversion=e.conversion),t}(i)}))}));var B=D,F=[].slice,q=["keyword","gray","hex"],U={};Object.keys(B).forEach((function(e){U[F.call(B[e].labels).sort().join("")]=e}));var j={};function V(e,t){if(!(this instanceof V))return new V(e,t);if(t&&t in q&&(t=null),t&&!(t in B))throw new Error("Unknown model: "+t);var r,i;if(null==e)this.model="rgb",this.color=[0,0,0],this.valpha=1;else if(e instanceof V)this.model=e.model,this.color=e.color.slice(),this.valpha=e.valpha;else if("string"==typeof e){var n=M.get(e);if(null===n)throw new Error("Unable to parse color from string: "+e);this.model=n.model,i=B[this.model].channels,this.color=n.value.slice(0,i),this.valpha="number"==typeof n.value[i]?n.value[i]:1}else if(e.length){this.model=t||"rgb",i=B[this.model].channels;var o=F.call(e,0,i);this.color=Z(o,i),this.valpha="number"==typeof e[i]?e[i]:1}else if("number"==typeof e)e&=16777215,this.model="rgb",this.color=[e>>16&255,e>>8&255,255&e],this.valpha=1;else{this.valpha=1;var a=Object.keys(e);"alpha"in e&&(a.splice(a.indexOf("alpha"),1),this.valpha="number"==typeof e.alpha?e.alpha:0);var s=a.sort().join("");if(!(s in U))throw new Error("Unable to parse color from object: "+JSON.stringify(e));this.model=U[s];var l=B[this.model].labels,u=[];for(r=0;r<l.length;r++)u.push(e[l[r]]);this.color=Z(u)}if(j[this.model])for(i=B[this.model].channels,r=0;r<i;r++){var c=j[this.model][r];c&&(this.color[r]=c(this.color[r]))}this.valpha=Math.max(0,Math.min(1,this.valpha)),Object.freeze&&Object.freeze(this)}function G(e,t,r){return(e=Array.isArray(e)?e:[e]).forEach((function(e){(j[e]||(j[e]=[]))[t]=r})),e=e[0],function(i){var n;return arguments.length?(r&&(i=r(i)),(n=this[e]()).color[t]=i):(n=this[e]().color[t],r&&(n=r(n))),n}}function H(e){return function(t){return Math.max(0,Math.min(e,t))}}function Z(e,t){for(var r=0;r<t;r++)"number"!=typeof e[r]&&(e[r]=0);return e}V.prototype={toString:function(){return this.string()},toJSON:function(){return this[this.model]()},string:function(e){var t=this.model in M.to?this:this.rgb(),r=1===(t=t.round("number"==typeof e?e:1)).valpha?t.color:t.color.concat(this.valpha);return M.to[t.model](r)},percentString:function(e){var t=this.rgb().round("number"==typeof e?e:1),r=1===t.valpha?t.color:t.color.concat(this.valpha);return M.to.rgb.percent(r)},array:function(){return 1===this.valpha?this.color.slice():this.color.concat(this.valpha)},object:function(){for(var e={},t=B[this.model].channels,r=B[this.model].labels,i=0;i<t;i++)e[r[i]]=this.color[i];return 1!==this.valpha&&(e.alpha=this.valpha),e},unitArray:function(){var e=this.rgb().color;return e[0]/=255,e[1]/=255,e[2]/=255,1!==this.valpha&&e.push(this.valpha),e},unitObject:function(){var e=this.rgb().object();return e.r/=255,e.g/=255,e.b/=255,1!==this.valpha&&(e.alpha=this.valpha),e},round:function(e){return e=Math.max(e||0,0),new V(this.color.map((t=e,function(e){return r=t,Number(e.toFixed(r));var r})).concat(this.valpha),this.model);var t},alpha:function(e){return arguments.length?new V(this.color.concat(Math.max(0,Math.min(1,e))),this.model):this.valpha},red:G("rgb",0,H(255)),green:G("rgb",1,H(255)),blue:G("rgb",2,H(255)),hue:G(["hsl","hsv","hsl","hwb","hcg"],0,(function(e){return(e%360+360)%360})),saturationl:G("hsl",1,H(100)),lightness:G("hsl",2,H(100)),saturationv:G("hsv",1,H(100)),value:G("hsv",2,H(100)),chroma:G("hcg",1,H(100)),gray:G("hcg",2,H(100)),white:G("hwb",1,H(100)),wblack:G("hwb",2,H(100)),cyan:G("cmyk",0,H(100)),magenta:G("cmyk",1,H(100)),yellow:G("cmyk",2,H(100)),black:G("cmyk",3,H(100)),x:G("xyz",0,H(100)),y:G("xyz",1,H(100)),z:G("xyz",2,H(100)),l:G("lab",0,H(100)),a:G("lab",1),b:G("lab",2),keyword:function(e){return arguments.length?new V(e):B[this.model].keyword(this.color)},hex:function(e){return arguments.length?new V(e):M.to.hex(this.rgb().round().color)},rgbNumber:function(){var e=this.rgb().color;return(255&e[0])<<16|(255&e[1])<<8|255&e[2]},luminosity:function(){for(var e=this.rgb().color,t=[],r=0;r<e.length;r++){var i=e[r]/255;t[r]=i<=.03928?i/12.92:Math.pow((.055+i)/1.055,2.4)}return.2126*t[0]+.7152*t[1]+.0722*t[2]},contrast:function(e){var t=this.luminosity(),r=e.luminosity();return r<t?(t+.05)/(r+.05):(r+.05)/(t+.05)},level:function(e){var t=this.contrast(e);return 7.1<=t?"AAA":4.5<=t?"AA":""},isDark:function(){var e=this.rgb().color;return(299*e[0]+587*e[1]+114*e[2])/1e3<128},isLight:function(){return!this.isDark()},negate:function(){for(var e=this.rgb(),t=0;t<3;t++)e.color[t]=255-e.color[t];return e},lighten:function(e){var t=this.hsl();return t.color[2]+=t.color[2]*e,t},darken:function(e){var t=this.hsl();return t.color[2]-=t.color[2]*e,t},saturate:function(e){var t=this.hsl();return t.color[1]+=t.color[1]*e,t},desaturate:function(e){var t=this.hsl();return t.color[1]-=t.color[1]*e,t},whiten:function(e){var t=this.hwb();return t.color[1]+=t.color[1]*e,t},blacken:function(e){var t=this.hwb();return t.color[2]+=t.color[2]*e,t},grayscale:function(){var e=this.rgb().color,t=.3*e[0]+.59*e[1]+.11*e[2];return V.rgb(t,t,t)},fade:function(e){return this.alpha(this.valpha-this.valpha*e)},opaquer:function(e){return this.alpha(this.valpha+this.valpha*e)},rotate:function(e){var t=this.hsl(),r=t.color[0];return r=(r=(r+e)%360)<0?360+r:r,t.color[0]=r,t},mix:function(e,t){if(!e||!e.rgb)throw new Error('Argument to "mix" was not a Color instance, but rather an instance of '+typeof e);var r=e.rgb(),i=this.rgb(),n=void 0===t?.5:t,o=2*n-1,a=r.alpha()-i.alpha(),s=(1+(o*a==-1?o:(o+a)/(1+o*a)))/2,l=1-s;return V.rgb(s*r.red()+l*i.red(),s*r.green()+l*i.green(),s*r.blue()+l*i.blue(),r.alpha()*n+i.alpha()*(1-n))}},Object.keys(B).forEach((function(e){if(-1===q.indexOf(e)){var t=B[e].channels;V.prototype[e]=function(){if(this.model===e)return new V(this);if(arguments.length)return new V(arguments,e);var r,i="number"==typeof arguments[t]?t:this.valpha;return new V((r=B[this.model][e].raw(this.color),(Array.isArray(r)?r:[r]).concat(i)),e)},V[e]=function(r){return"number"==typeof r&&(r=Z(F.call(arguments),t)),new V(r,e)}}}));var W,K=V;(W=t.ControlStyle||(t.ControlStyle={})).light="light",W.dark="dark",W.auto="auto";var X=(Y.prototype.onRemove=function(){this._container&&(this._container.remove(),delete this._container),this._map&&(this._map.events.remove("styledata",this._onStyleChange),delete this._map),this._observer&&(this._observer.disconnect(),delete this._observer),delete this._theme},Y.prototype.buildContainer=function(e,r,i,n){var o=this;return this._map=e,this._container=document.createElement(n||"div"),this._container.classList.add("azure-maps-control-container"),"string"==typeof i&&this._container.setAttribute("aria-label",i),r.toLowerCase()===t.ControlStyle.auto?this._map.styles.initialize().then((function(){o._onStyleChange(),o._map.events.add("styledata",o._onStyleChange)})):this._container.classList.add(r),this._container},Y.prototype._setTheme=function(e){this._theme!==e&&(this._container.classList.remove(this._theme),this._container.classList.add(e),this._theme=e)},Y.activateClickDelay=100,Y);function Y(){var e=this;this._onStyleChange=function(){if(e._map.getStyle().style.toLowerCase().startsWith("blank"))e._observer||(e._onBackgroundChange(),e._observer=new MutationObserver(e._onBackgroundChange),e._observer.observe(e._map.getMapContainer(),{attributes:!0,attributeFilter:["style"]}));else{e._observer&&(e._observer.disconnect(),delete e._observer);var t=e._map.styles.getTheme(e._map.getStyle());e._setTheme(t)}},this._onBackgroundChange=function(){try{var r=.5<K(e._map.getMapContainer().style.backgroundColor).luminosity()?t.ControlStyle.light:t.ControlStyle.dark;e._setTheme(r)}catch(r){e._setTheme(t.ControlStyle.light)}}}var J,$=(d(Q,J=g),Q);function Q(){var e=null!==J&&J.apply(this,arguments)||this;return e.rotationDegreesDelta=15,e.style=t.ControlStyle.light,e}var ee,te=(d(re,ee=X),re.prototype.onAdd=function(e,t){var r=this,i=this.buildContainer(e,this.options.style,"Rotation Control"),n=this.constructRotationButton(e),o=this.constructRotationGrid(e,t);return i.addEventListener("mouseover",(function(e){r.lastActiveTime=r.lastActiveTime||e.timeStamp,r.hasMouse=!0,i.classList.add("in-use"),o.classList.remove("hidden-accessible-element")})),i.addEventListener("focusin",(function(e){r.lastActiveTime=r.lastActiveTime||e.timeStamp,r.hasFocus=!0,i.classList.add("in-use"),o.classList.remove("hidden-accessible-element")})),i.addEventListener("mouseleave",(function(){r.hasMouse=!1,r.hasFocus||(delete r.lastActiveTime,i.classList.remove("in-use"),o.classList.add("hidden-accessible-element"))})),i.addEventListener("focusout",(function(e){e.relatedTarget instanceof Node&&i.contains(e.relatedTarget)||(r.hasFocus=!1,r.hasMouse||(delete r.lastActiveTime,i.classList.remove("in-use"),o.classList.add("hidden-accessible-element")))})),t&&re.InvertOrderPositions.includes(t.position)?(i.appendChild(o),i.appendChild(n)):(i.appendChild(n),i.appendChild(o)),i},re.prototype.constructRotationGrid=function(e,t){var r=document.createElement("div");r.classList.add("sub-container"),r.classList.add("hidden-accessible-element");var i=this.constructRightRotationButton(e),n=this.constructLeftRotationButton(e);return t&&re.InvertOrderPositions.includes(t.position)?(r.appendChild(i),r.appendChild(n)):(r.appendChild(n),r.appendChild(i)),r},re.prototype.constructRotationButton=function(e){var t=this,r=document.createElement("button");r.classList.add("azure-maps-control-button"),r.classList.add("rotation"),r.setAttribute("title","Reset to Default Rotation"),r.setAttribute("alt","Reset to Default Rotation"),r.setAttribute("type","button");var i=document.createElement("div");return r.appendChild(i),r.addEventListener("click",(function(r){r.timeStamp-t.lastActiveTime>X.activateClickDelay&&e.setCamera({bearing:re.DefaultRotation},!0)})),e.events.add("rotate",(function(e){i.style.transform="rotate("+-e.map.getCamera().bearing+"deg)"})),r},re.prototype.constructRightRotationButton=function(e){var t=this,r=document.createElement("button");return r.classList.add("azure-maps-control-button"),r.classList.add("rotation-right"),r.setAttribute("title","Rotate Right"),r.setAttribute("alt","Rotate Right"),r.setAttribute("type","button"),r.addEventListener("click",(function(){e.setCamera({bearing:e.getCamera().bearing+t.options.rotationDegreesDelta,duration:re.RotationDuration,type:"ease"},!0)})),r},re.prototype.constructLeftRotationButton=function(e){var t=this,r=document.createElement("button");return r.classList.add("azure-maps-control-button"),r.classList.add("rotation-left"),r.setAttribute("title","Rotate Left"),r.setAttribute("alt","Rotate Left"),r.setAttribute("type","button"),r.addEventListener("click",(function(){e.setCamera({bearing:e.getCamera().bearing-t.options.rotationDegreesDelta,duration:re.RotationDuration,type:"ease"},!0)})),r},re.DefaultRotation=0,re.RotationDuration=100,re.InvertOrderPositions=[t.ControlPosition.BottomRight,t.ControlPosition.TopRight],re);function re(e){var t=ee.call(this)||this;return t.hasMouse=!1,t.hasFocus=!1,t.options=(new $).merge(e),t}var ie,ne=(d(oe,ie=g),oe);function oe(){var e=null!==ie&&ie.apply(this,arguments)||this;return e.pitchDegreesDelta=10,e.style=t.ControlStyle.light,e}var ae,se=(d(le,ae=X),le.prototype.onAdd=function(e,t){var r=this,i=this.buildContainer(e,this.options.style,"Pitch Control"),n=this.constructPitchButton(e),o=this.constructPitchGrid(e,t);return i.addEventListener("mouseover",(function(e){r.lastActiveTime=r.lastActiveTime||e.timeStamp,r.hasMouse=!0,i.classList.add("in-use"),o.classList.remove("hidden-accessible-element")})),i.addEventListener("focusin",(function(e){r.lastActiveTime=r.lastActiveTime||e.timeStamp,r.hasFocus=!0,i.classList.add("in-use"),o.classList.remove("hidden-accessible-element")})),i.addEventListener("mouseleave",(function(){r.hasMouse=!1,r.hasFocus||(delete r.lastActiveTime,i.classList.remove("in-use"),o.classList.add("hidden-accessible-element"))})),i.addEventListener("focusout",(function(e){e.relatedTarget instanceof Node&&i.contains(e.relatedTarget)||(r.hasFocus=!1,r.hasMouse||(delete r.lastActiveTime,i.classList.remove("in-use"),o.classList.add("hidden-accessible-element")))})),t&&le.INVERT_ORDER_POSITIONS.includes(t.position)?(i.appendChild(o),i.appendChild(n)):(i.appendChild(n),i.appendChild(o)),i},le.prototype.constructPitchGrid=function(e,t){var r=document.createElement("div");r.classList.add("sub-container"),r.classList.add("hidden-accessible-element");var i=this.constructPitchIncrementButton(e),n=this.constructPitchDecrementButton(e);return t&&le.INVERT_ORDER_POSITIONS.includes(t.position)?(r.appendChild(n),r.appendChild(i)):(r.appendChild(i),r.appendChild(n)),r},le.prototype.constructPitchButton=function(e){var t=this,r=document.createElement("button");return r.classList.add("azure-maps-control-button"),r.classList.add("pitch"),r.setAttribute("title","Reset to Default Pitch"),r.setAttribute("alt","Reset to Default Pitch"),r.setAttribute("type","button"),r.addEventListener("click",(function(){event.timeStamp-t.lastActiveTime>X.activateClickDelay&&e.setCamera({pitch:le.DEFAULT_PITCH},!0)})),r},le.prototype.constructPitchDecrementButton=function(e){var t=this,r=document.createElement("button");return r.classList.add("azure-maps-control-button"),r.classList.add("pitch-down"),r.setAttribute("title","Decrease Pitch"),r.setAttribute("alt","Decrease Pitch"),r.setAttribute("type","button"),r.addEventListener("click",(function(){e.setCamera({pitch:e.getCamera().pitch-t.options.pitchDegreesDelta,duration:le.PITCH_DURATION_MS,type:"ease"},!0)})),r},le.prototype.constructPitchIncrementButton=function(e){var t=this,r=document.createElement("button");return r.classList.add("azure-maps-control-button"),r.classList.add("pitch-up"),r.setAttribute("title","Increase Pitch"),r.setAttribute("alt","Increase Pitch"),r.setAttribute("type","button"),r.addEventListener("click",(function(){e.setCamera({pitch:e.getCamera().pitch+t.options.pitchDegreesDelta,duration:le.PITCH_DURATION_MS,type:"ease"},!0)})),r},le.PITCH_DURATION_MS=100,le.DEFAULT_PITCH=0,le.INVERT_ORDER_POSITIONS=[t.ControlPosition.BottomRight,t.ControlPosition.TopRight],le);function le(e){var t=ae.call(this)||this;return t.hasMouse=!1,t.hasFocus=!1,t.options=(new ne).merge(e),t}var ue=function(e,t){return e===t||e!=e&&t!=t},ce=function(e,t){for(var r=e.length;r--;)if(ue(e[r][0],t))return r;return-1},pe=Array.prototype.splice;function he(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var i=e[t];this.set(i[0],i[1])}}he.prototype.clear=function(){this.__data__=[],this.size=0},he.prototype.delete=function(e){var t=this.__data__,r=ce(t,e);return!(r<0||(r==t.length-1?t.pop():pe.call(t,r,1),--this.size,0))},he.prototype.get=function(e){var t=this.__data__,r=ce(t,e);return r<0?void 0:t[r][1]},he.prototype.has=function(e){return-1<ce(this.__data__,e)},he.prototype.set=function(e,t){var r=this.__data__,i=ce(r,e);return i<0?(++this.size,r.push([e,t])):r[i][1]=t,this};var de,me=he,fe="object"==typeof r&&r&&r.Object===Object&&r,ye="object"==typeof self&&self&&self.Object===Object&&self,ge=fe||ye||Function("return this")(),ve=ge.Symbol,_e=Object.prototype,be=_e.hasOwnProperty,xe=_e.toString,we=ve?ve.toStringTag:void 0,Se=function(e){var t=be.call(e,we),r=e[we];try{var i=!(e[we]=void 0)}catch(e){}var n=xe.call(e);return i&&(t?e[we]=r:delete e[we]),n},Te=Object.prototype.toString,Ce=function(e){return Te.call(e)},Ee=ve?ve.toStringTag:void 0,Ie=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":(Ee&&Ee in Object(e)?Se:Ce)(e)},Pe=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)},Re=function(e){if(!Pe(e))return!1;var t=Ie(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t},Ne=ge["__core-js_shared__"],Ae=(de=/[^.]+$/.exec(Ne&&Ne.keys&&Ne.keys.IE_PROTO||""))?"Symbol(src)_1."+de:"",ze=Function.prototype.toString,Me=function(e){if(null!=e){try{return ze.call(e)}catch(e){}try{return e+""}catch(e){}}return""},ke=/^\[object .+?Constructor\]$/,Oe=Function.prototype,Le=Object.prototype,De=Oe.toString,Be=Le.hasOwnProperty,Fe=RegExp("^"+De.call(Be).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),qe=function(e){return!(!Pe(e)||function(e){return!!Ae&&Ae in e}(e))&&(Re(e)?Fe:ke).test(Me(e))},Ue=function(e,t){var r=function(e,t){return null==e?void 0:e[t]}(e,t);return qe(r)?r:void 0},je=Ue(ge,"Map"),Ve=Ue(Object,"create"),Ge=Object.prototype.hasOwnProperty,He=Object.prototype.hasOwnProperty;function Ze(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var i=e[t];this.set(i[0],i[1])}}Ze.prototype.clear=function(){this.__data__=Ve?Ve(null):{},this.size=0},Ze.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},Ze.prototype.get=function(e){var t=this.__data__;if(Ve){var r=t[e];return"__lodash_hash_undefined__"===r?void 0:r}return Ge.call(t,e)?t[e]:void 0},Ze.prototype.has=function(e){var t=this.__data__;return Ve?void 0!==t[e]:He.call(t,e)},Ze.prototype.set=function(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=Ve&&void 0===t?"__lodash_hash_undefined__":t,this};var We=Ze,Ke=function(e,t){var r=e.__data__;return function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}(t)?r["string"==typeof t?"string":"hash"]:r.map};function Xe(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var i=e[t];this.set(i[0],i[1])}}Xe.prototype.clear=function(){this.size=0,this.__data__={hash:new We,map:new(je||me),string:new We}},Xe.prototype.delete=function(e){var t=Ke(this,e).delete(e);return this.size-=t?1:0,t},Xe.prototype.get=function(e){return Ke(this,e).get(e)},Xe.prototype.has=function(e){return Ke(this,e).has(e)},Xe.prototype.set=function(e,t){var r=Ke(this,e),i=r.size;return r.set(e,t),this.size+=r.size==i?0:1,this};var Ye=Xe;function Je(e){var t=this.__data__=new me(e);this.size=t.size}Je.prototype.clear=function(){this.__data__=new me,this.size=0},Je.prototype.delete=function(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r},Je.prototype.get=function(e){return this.__data__.get(e)},Je.prototype.has=function(e){return this.__data__.has(e)},Je.prototype.set=function(e,t){var r=this.__data__;if(r instanceof me){var i=r.__data__;if(!je||i.length<199)return i.push([e,t]),this.size=++r.size,this;r=this.__data__=new Ye(i)}return r.set(e,t),this.size=r.size,this};var $e=Je,Qe=function(){try{var e=Ue(Object,"defineProperty");return e({},"",{}),e}catch(e){}}(),et=function(e,t,r){"__proto__"==t&&Qe?Qe(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r},tt=Object.prototype.hasOwnProperty,rt=function(e,t,r){var i=e[t];tt.call(e,t)&&ue(i,r)&&(void 0!==r||t in e)||et(e,t,r)},it=function(e,t,r,i){var n=!r;r=r||{};for(var o=-1,a=t.length;++o<a;){var s=t[o],l=i?i(r[s],e[s],s,r,e):void 0;void 0===l&&(l=e[s]),(n?et:rt)(r,s,l)}return r},nt=function(e){return null!=e&&"object"==typeof e},ot=function(e){return nt(e)&&"[object Arguments]"==Ie(e)},at=Object.prototype,st=at.hasOwnProperty,lt=at.propertyIsEnumerable,ut=ot(function(){return arguments}())?ot:function(e){return nt(e)&&st.call(e,"callee")&&!lt.call(e,"callee")},ct=Array.isArray;function pt(){return!1}var ht=i((function(e,t){var r=t&&!t.nodeType&&t,i=r&&e&&!e.nodeType&&e,n=i&&i.exports===r?ge.Buffer:void 0,o=(n?n.isBuffer:void 0)||pt;e.exports=o})),dt=/^(?:0|[1-9]\d*)$/,mt=function(e,t){var r=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==r||"symbol"!=r&&dt.test(e))&&-1<e&&e%1==0&&e<t},ft=function(e){return"number"==typeof e&&-1<e&&e%1==0&&e<=9007199254740991},yt={};yt["[object Float32Array]"]=yt["[object Float64Array]"]=yt["[object Int8Array]"]=yt["[object Int16Array]"]=yt["[object Int32Array]"]=yt["[object Uint8Array]"]=yt["[object Uint8ClampedArray]"]=yt["[object Uint16Array]"]=yt["[object Uint32Array]"]=!0,yt["[object Arguments]"]=yt["[object Array]"]=yt["[object ArrayBuffer]"]=yt["[object Boolean]"]=yt["[object DataView]"]=yt["[object Date]"]=yt["[object Error]"]=yt["[object Function]"]=yt["[object Map]"]=yt["[object Number]"]=yt["[object Object]"]=yt["[object RegExp]"]=yt["[object Set]"]=yt["[object String]"]=yt["[object WeakMap]"]=!1;var gt=function(e){return function(t){return e(t)}},vt=i((function(e,t){var r=t&&!t.nodeType&&t,i=r&&e&&!e.nodeType&&e,n=i&&i.exports===r&&fe.process,o=function(){try{var e=i&&i.require&&i.require("util").types;return e||n&&n.binding&&n.binding("util")}catch(e){}}();e.exports=o})),_t=vt&&vt.isTypedArray,bt=_t?gt(_t):function(e){return nt(e)&&ft(e.length)&&!!yt[Ie(e)]},xt=Object.prototype.hasOwnProperty,wt=function(e,t){var r=ct(e),i=!r&&ut(e),n=!r&&!i&&ht(e),o=!r&&!i&&!n&&bt(e),a=r||i||n||o,s=a?function(e,t){for(var r=-1,i=Array(e);++r<e;)i[r]=t(r);return i}(e.length,String):[],l=s.length;for(var u in e)!t&&!xt.call(e,u)||a&&("length"==u||n&&("offset"==u||"parent"==u)||o&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||mt(u,l))||s.push(u);return s},St=Object.prototype,Tt=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||St)},Ct=function(e,t){return function(r){return e(t(r))}},Et=Ct(Object.keys,Object),It=Object.prototype.hasOwnProperty,Pt=function(e){if(!Tt(e))return Et(e);var t=[];for(var r in Object(e))It.call(e,r)&&"constructor"!=r&&t.push(r);return t},Rt=function(e){return null!=e&&ft(e.length)&&!Re(e)},Nt=function(e){return(Rt(e)?wt:Pt)(e)},At=Object.prototype.hasOwnProperty,zt=function(e){if(!Pe(e))return function(e){var t=[];if(null!=e)for(var r in Object(e))t.push(r);return t}(e);var t=Tt(e),r=[];for(var i in e)("constructor"!=i||!t&&At.call(e,i))&&r.push(i);return r},Mt=function(e){return Rt(e)?wt(e,!0):zt(e)},kt=i((function(e,t){var r=t&&!t.nodeType&&t,i=r&&e&&!e.nodeType&&e,n=i&&i.exports===r?ge.Buffer:void 0,o=n?n.allocUnsafe:void 0;e.exports=function(e,t){if(t)return e.slice();var r=e.length,i=o?o(r):new e.constructor(r);return e.copy(i),i}})),Ot=function(e,t){var r=-1,i=e.length;for(t=t||Array(i);++r<i;)t[r]=e[r];return t};function Lt(){return[]}var Dt=Object.prototype.propertyIsEnumerable,Bt=Object.getOwnPropertySymbols,Ft=Bt?function(e){return null==e?[]:(e=Object(e),function(e,t){for(var r=-1,i=null==e?0:e.length,n=0,o=[];++r<i;){var a=e[r];t(a,r,e)&&(o[n++]=a)}return o}(Bt(e),(function(t){return Dt.call(e,t)})))}:Lt,qt=function(e,t){for(var r=-1,i=t.length,n=e.length;++r<i;)e[n+r]=t[r];return e},Ut=Ct(Object.getPrototypeOf,Object),jt=Object.getOwnPropertySymbols?function(e){for(var t=[];e;)qt(t,Ft(e)),e=Ut(e);return t}:Lt,Vt=function(e,t,r){var i=t(e);return ct(e)?i:qt(i,r(e))},Gt=function(e){return Vt(e,Nt,Ft)},Ht=function(e){return Vt(e,Mt,jt)},Zt=Ue(ge,"DataView"),Wt=Ue(ge,"Promise"),Kt=Ue(ge,"Set"),Xt=Ue(ge,"WeakMap"),Yt="[object Map]",Jt="[object Promise]",$t="[object Set]",Qt="[object WeakMap]",er="[object DataView]",tr=Me(Zt),rr=Me(je),ir=Me(Wt),nr=Me(Kt),or=Me(Xt),ar=Ie;(Zt&&ar(new Zt(new ArrayBuffer(1)))!=er||je&&ar(new je)!=Yt||Wt&&ar(Wt.resolve())!=Jt||Kt&&ar(new Kt)!=$t||Xt&&ar(new Xt)!=Qt)&&(ar=function(e){var t=Ie(e),r="[object Object]"==t?e.constructor:void 0,i=r?Me(r):"";if(i)switch(i){case tr:return er;case rr:return Yt;case ir:return Jt;case nr:return $t;case or:return Qt}return t});var sr=ar,lr=Object.prototype.hasOwnProperty,ur=ge.Uint8Array,cr=function(e){var t=new e.constructor(e.byteLength);return new ur(t).set(new ur(e)),t},pr=/\w*$/,hr=ve?ve.prototype:void 0,dr=hr?hr.valueOf:void 0,mr=function(e,t){var r=t?cr(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.length)},fr=function(e,t,r){var i=e.constructor;switch(t){case"[object ArrayBuffer]":return cr(e);case"[object Boolean]":case"[object Date]":return new i(+e);case"[object DataView]":return function(e,t){var r=t?cr(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.byteLength)}(e,r);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return mr(e,r);case"[object Map]":return new i;case"[object Number]":case"[object String]":return new i(e);case"[object RegExp]":return function(e){var t=new e.constructor(e.source,pr.exec(e));return t.lastIndex=e.lastIndex,t}(e);case"[object Set]":return new i;case"[object Symbol]":return function(e){return dr?Object(dr.call(e)):{}}(e)}},yr=Object.create;function gr(){}var vr=function(e){return"function"!=typeof e.constructor||Tt(e)?{}:function(e){if(!Pe(e))return{};if(yr)return yr(e);gr.prototype=e;var t=new gr;return gr.prototype=void 0,t}(Ut(e))},_r=vt&&vt.isMap,br=_r?gt(_r):function(e){return nt(e)&&"[object Map]"==sr(e)},xr=vt&&vt.isSet,wr=xr?gt(xr):function(e){return nt(e)&&"[object Set]"==sr(e)},Sr="[object Arguments]",Tr="[object Function]",Cr="[object Object]",Er={};Er[Sr]=Er["[object Array]"]=Er["[object ArrayBuffer]"]=Er["[object DataView]"]=Er["[object Boolean]"]=Er["[object Date]"]=Er["[object Float32Array]"]=Er["[object Float64Array]"]=Er["[object Int8Array]"]=Er["[object Int16Array]"]=Er["[object Int32Array]"]=Er["[object Map]"]=Er["[object Number]"]=Er[Cr]=Er["[object RegExp]"]=Er["[object Set]"]=Er["[object String]"]=Er["[object Symbol]"]=Er["[object Uint8Array]"]=Er["[object Uint8ClampedArray]"]=Er["[object Uint16Array]"]=Er["[object Uint32Array]"]=!0,Er["[object Error]"]=Er[Tr]=Er["[object WeakMap]"]=!1;var Ir,Pr=function e(t,r,i,n,o,a){var s,l=1&r,u=2&r,c=4&r;if(i&&(s=o?i(t,n,o,a):i(t)),void 0!==s)return s;if(!Pe(t))return t;var p=ct(t);if(p){if(s=function(e){var t=e.length,r=new e.constructor(t);return t&&"string"==typeof e[0]&&lr.call(e,"index")&&(r.index=e.index,r.input=e.input),r}(t),!l)return Ot(t,s)}else{var h=sr(t),d=h==Tr||"[object GeneratorFunction]"==h;if(ht(t))return kt(t,l);if(h==Cr||h==Sr||d&&!o){if(s=u||d?{}:vr(t),!l)return u?function(e,t){return it(e,jt(e),t)}(t,function(e,t){return e&&it(t,Mt(t),e)}(s,t)):function(e,t){return it(e,Ft(e),t)}(t,function(e,t){return e&&it(t,Nt(t),e)}(s,t))}else{if(!Er[h])return o?t:{};s=fr(t,h,l)}}var m=(a=a||new $e).get(t);if(m)return m;a.set(t,s),wr(t)?t.forEach((function(n){s.add(e(n,r,i,n,t,a))})):br(t)&&t.forEach((function(n,o){s.set(o,e(n,r,i,o,t,a))}));var f=c?u?Ht:Gt:u?keysIn:Nt,y=p?void 0:f(t);return function(e,t){for(var r=-1,i=null==e?0:e.length;++r<i&&!1!==t(e[r],r,e););}(y||t,(function(n,o){y&&(n=t[o=n]),rt(s,o,e(n,r,i,o,t,a))})),s},Rr=function(e){return Pr(e,5)},Nr=Map,Ar=(d(zr,Ir=g),zr);function zr(){var e=null!==Ir&&Ir.apply(this,arguments)||this;return e.layout="icons",e.mapStyles=["road","grayscale_light","grayscale_dark","night","road_shaded_relief"],e.style=t.ControlStyle.light,e}var Mr,kr=(d(Or,Mr=X),Or.prototype.onAdd=function(e,t){var r=this;this.map=e;var i=this.buildContainer(e,this.options.style,"Map Style Control"),n=this.buildStyleOpsGrid(i),o=this.buildCurrStyleBtn(i,n);return i.addEventListener("mouseover",(function(){r.hasMouse=!0,i.classList.add(Or.Css.inUse),n.classList.remove("hidden-accessible-element")})),i.addEventListener("focusin",(function(){r.hasFocus=!0,i.classList.add(Or.Css.inUse),n.classList.remove("hidden-accessible-element")})),i.addEventListener("mouseleave",(function(){r.hasMouse=!1,r.hasFocus||(i.classList.remove(Or.Css.inUse),n.classList.add("hidden-accessible-element"))})),i.addEventListener("focusout",(function(e){e.relatedTarget instanceof Node&&i.contains(e.relatedTarget)||(r.hasFocus=!1,r.hasMouse||(i.classList.remove(Or.Css.inUse),n.classList.add("hidden-accessible-element")))})),t&&Or.InvertOrderPositions.includes(t.position)?(i.appendChild(n),i.appendChild(o)):(i.appendChild(o),i.appendChild(n)),i},Or.prototype.onRemove=function(){Mr.prototype.onRemove.call(this),this.map.events.remove("styledata",this.onStyleChange)},Or.prototype.buildSelectStyleBtn=function(e,t){var r=this,i=document.createElement("button"),n=this.mapToFriendlyStyleName(e);i.setAttribute("title",n),i.setAttribute("alt",n),i.setAttribute("type","button");var o=new Image;return o.src=t,o.alt=n,i.appendChild(o),"icons"===this.options.layout?i.classList.add(Or.Css.button):i.appendChild(document.createTextNode(n)),i.addEventListener("click",(function(){r.map.setStyle({style:e})})),i},Or.prototype.buildCurrStyleBtn=function(e,t){var r=document.createElement("button");r.classList.add(Or.Css.button),r.classList.add(Or.Css.currentStyle),r.setAttribute("title","Select Style"),r.setAttribute("alt","Select Style"),r.setAttribute("type","button"),this.currStyleImage=new Image,r.appendChild(this.currStyleImage);var i=document.createElement("div");return i.classList.add("icon"),r.appendChild(i),r},Or.prototype.buildStyleOpsGrid=function(e){var t=this,r=document.createElement("div");return r.classList.add(Or.Css.styleOptions),r.classList.add(this.options.layout),r.setAttribute("aria-label","Style Options"),r.classList.add("hidden-accessible-element"),this.map.styles.initialize().then((function(){for(var e=t.map.styles.getDef(),i=t.map.getStyle().style,n=0,o=e.styles;n<o.length;n++){var a=o[n],s=new w({domain:e.domain,path:a.iconPath}).toString();t.styleIcons.set(a.name,s),a.name===i&&(t.currStyleImage.src=s,t.currStyleImage.alt=t.mapToFriendlyStyleName(a.name))}"all"===t.options.mapStyles?t.styleIcons.forEach((function(e,i){var n=t.buildSelectStyleBtn(i,e);r.appendChild(n)})):t.options.mapStyles.filter((function(e){return t.styleIcons.has(e)})).forEach((function(e){var i=t.styleIcons.get(e),n=t.buildSelectStyleBtn(e,i);r.appendChild(n)})),t.map.events.add("styledata",t.onStyleChange)})),r},Or.prototype.mapToFriendlyStyleName=function(e){return Or.StyleNamesMap[e]?Or.StyleNamesMap[e]:e},Or.InvertOrderPositions=[t.ControlPosition.TopRight,t.ControlPosition.BottomRight],Or.Css={button:"azure-maps-control-button",currentStyle:"curr-style",inUse:"in-use",styleOptions:"style-options"},Or.StyleNamesMap={road:"Road",satellite:"Satellite",satellite_road_labels:"Hybrid",grayscale_dark:"Grayscale (Dark)",grayscale_light:"Grayscale (Light)",night:"Night",road_shaded_relief:"Terra",blank:"Blank",blank_accessible:"Blank (Accessible)",high_contrast_dark:"High contrast"},Or);function Or(e){var t=Mr.call(this)||this;return t.hasMouse=!1,t.hasFocus=!1,t.styleIcons=new Nr,t.onStyleChange=function(){var e=t.map.getStyle().style;t.styleIcons.has(e)&&(t.currStyleImage.src=t.styleIcons.get(e),t.currStyleImage.alt=t.mapToFriendlyStyleName(e))},t.options=(new Ar).merge(Rr(e)),t}var Lr,Dr=(d(Br,Lr=g),Br);function Br(){var e=null!==Lr&&Lr.apply(this,arguments)||this;return e.flow="relative",e.incidents=!0,e.isActive=!1,e.style=t.ControlStyle.light,e}var Fr,qr=(d(Ur,Fr=X),Ur.prototype.onAdd=function(e){this.container=this.buildContainer(e,this.options.style,"Traffic Control"),this.container.style.flexDirection="column";var t=this.constructTrafficButton(e);return this.container.appendChild(t),this.container},Ur.prototype.getOptions=function(){return Rr(this.options)},Ur.prototype.constructTrafficButton=function(e){var t=this,r=document.createElement("button");return r.classList.add("azure-maps-control-button"),r.classList.add("traffic"),r.setAttribute("title","toggle traffic display"),r.setAttribute("alt","toggle traffic display"),r.setAttribute("type","button"),r.addEventListener("click",(function(){var r=e.getTraffic();t.options.isActive=!("none"!==r.flow||r.incidents),t.options.isActive?(e.setTraffic({flow:t.options.flow,incidents:t.options.incidents}),t.container.classList.add("in-use")):(e.setTraffic({flow:"none",incidents:!1}),t.container.classList.remove("in-use"))})),e.events.add("ready",(function(){t.options.isActive&&r.dispatchEvent(new Event("click"))})),r},Ur);function Ur(e){var t=Fr.call(this)||this;return t.hasMouse=!1,t.hasFocus=!1,t.options=(new Dr).merge(e),t}var jr,Vr=(d(Gr,jr=X),Gr.prototype.onAdd=function(e){var r=this.buildContainer(e,t.ControlStyle.auto,"Traffic Legend"),i=this.buildTrafficLegendDiv(e);return r.appendChild(i),r},Gr.prototype.buildTrafficLegendDiv=function(e){var t=document.createElement("div");t.classList.add("traffic-legend","hidden"),t.setAttribute("title","Traffic Legend"),t.setAttribute("alt","Traffic Legend");var r=document.createElement("table"),i=document.createElement("tr"),n=document.createElement("td");n.setAttribute("title","Traffic"),n.setAttribute("alt","Traffic"),n.appendChild(document.createTextNode("Traffic")),n.classList.add("traffic-legend-title"),n.colSpan=6,i.appendChild(n),r.appendChild(i);for(var o=document.createElement("tr"),a=0,s=this.table;a<s.length;a++){var l=s[a],u=document.createElement("td");if("Fast"===l||"Slow"===l)u.setAttribute("title",l),u.setAttribute("alt",l),u.appendChild(document.createTextNode(l)),u.classList.add("traffic-legend-text");else{u.classList.add("traffic-legend-colors");for(var c=0,p=l;c<p.length;c++){var h=p[c],d=document.createElement("div");d.classList.add(h),u.appendChild(d)}}o.appendChild(u)}return r.appendChild(o),t.appendChild(r),e.events.add("sourceadded",(function(e){"vectorTilesTraffic"===e.getId()&&t.classList.remove("hidden")})),e.events.add("sourceremoved",(function(e){"vectorTilesTraffic"===e.getId()&&t.classList.add("hidden")})),t},Gr);function Gr(){var e=jr.call(this)||this;return e.table=["Fast",["green","yellow","red","dark-red"],"Slow"],e}var Hr,Zr=(d(Wr,Hr=g),Wr);function Wr(){var e=null!==Hr&&Hr.apply(this,arguments)||this;return e.zoomDelta=1,e.style=t.ControlStyle.light,e}var Kr,Xr=(d(Yr,Kr=X),Yr.prototype.onAdd=function(e){var t=this.buildContainer(e,this.options.style,"Zoom Control");t.style.flexDirection="column";var r=this.constructZoomInButton(e),i=this.constructZoomOutButton(e);return t.appendChild(r),t.appendChild(i),t},Yr.prototype.constructZoomInButton=function(e){var t=this,r=document.createElement("button");return r.classList.add("azure-maps-control-button"),r.classList.add("zoom-in"),r.setAttribute("title","Zoom In"),r.setAttribute("alt","Zoom In"),r.setAttribute("type","button"),r.addEventListener("click",(function(){e.setCamera({zoom:e.getCamera().zoom+t.options.zoomDelta,duration:Yr.ZOOM_DURATION_MS,type:"ease"},!0)})),r},Yr.prototype.constructZoomOutButton=function(e){var t=this,r=document.createElement("button");return r.classList.add("azure-maps-control-button"),r.classList.add("zoom-out"),r.setAttribute("title","Zoom Out"),r.setAttribute("alt","Zoom Out"),r.setAttribute("type","button"),r.addEventListener("click",(function(){e.setCamera({zoom:e.getCamera().zoom-t.options.zoomDelta,duration:Yr.ZOOM_DURATION_MS,type:"ease"},!0)})),r},Yr.ZOOM_DURATION_MS=200,Yr);function Yr(e){var t=Kr.call(this)||this;return t.options=(new Zr).merge(e),t}var Jr=Object.freeze({__proto__:null,PitchControl:se,CompassControl:te,ZoomControl:Xr,StyleControl:kr,TrafficControl:qr,TrafficLegendControl:Vr});function $r(e){var t=-1,r=null==e?0:e.length;for(this.__data__=new Ye;++t<r;)this.add(e[t])}$r.prototype.add=$r.prototype.push=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this},$r.prototype.has=function(e){return this.__data__.has(e)};var Qr=$r,ei=function(e,t){for(var r=-1,i=null==e?0:e.length;++r<i;)if(t(e[r],r,e))return!0;return!1},ti=function(e,t){return e.has(t)},ri=function(e,t,r,i,n,o){var a=1&r,s=e.length,l=t.length;if(s!=l&&!(a&&s<l))return!1;var u=o.get(e);if(u&&o.get(t))return u==t;var c=-1,p=!0,h=2&r?new Qr:void 0;for(o.set(e,t),o.set(t,e);++c<s;){var d=e[c],m=t[c];if(i)var f=a?i(m,d,c,t,e,o):i(d,m,c,e,t,o);if(void 0!==f){if(f)continue;p=!1;break}if(h){if(!ei(t,(function(e,t){if(!ti(h,t)&&(d===e||n(d,e,r,i,o)))return h.push(t)}))){p=!1;break}}else if(d!==m&&!n(d,m,r,i,o)){p=!1;break}}return o.delete(e),o.delete(t),p};function ii(e){var t=-1,r=Array(e.size);return e.forEach((function(e,i){r[++t]=[i,e]})),r}function ni(e){var t=-1,r=Array(e.size);return e.forEach((function(e){r[++t]=e})),r}var oi,ai=ve?ve.prototype:void 0,si=ai?ai.valueOf:void 0,li=Object.prototype.hasOwnProperty,ui="[object Arguments]",ci="[object Array]",pi="[object Object]",hi=Object.prototype.hasOwnProperty,di=function(e,t,r,i,n,o){var a=ct(e),s=ct(t),l=a?ci:sr(e),u=s?ci:sr(t),c=(l=l==ui?pi:l)==pi,p=(u=u==ui?pi:u)==pi,h=l==u;if(h&&ht(e)){if(!ht(t))return!1;c=!(a=!0)}if(h&&!c)return o=o||new $e,a||bt(e)?ri(e,t,r,i,n,o):function(e,t,r,i,n,o,a){switch(r){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":return!(e.byteLength!=t.byteLength||!o(new ur(e),new ur(t)));case"[object Boolean]":case"[object Date]":case"[object Number]":return ue(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case"[object Map]":var s=ii;case"[object Set]":var l=1&i;if(s=s||ni,e.size!=t.size&&!l)return!1;var u=a.get(e);if(u)return u==t;i|=2,a.set(e,t);var c=ri(s(e),s(t),i,n,o,a);return a.delete(e),c;case"[object Symbol]":if(si)return si.call(e)==si.call(t)}return!1}(e,t,l,r,i,n,o);if(!(1&r)){var d=c&&hi.call(e,"__wrapped__"),m=p&&hi.call(t,"__wrapped__");if(d||m)return n(d?e.value():e,m?t.value():t,r,i,o=o||new $e)}return h&&function(e,t,r,i,n,o){var a=1&r,s=Gt(e),l=s.length;if(l!=Gt(t).length&&!a)return!1;for(var u=l;u--;){var c=s[u];if(!(a?c in t:li.call(t,c)))return!1}var p=o.get(e);if(p&&o.get(t))return p==t;var h=!0;o.set(e,t),o.set(t,e);for(var d=a;++u<l;){var m=e[c=s[u]],f=t[c];if(i)var y=a?i(f,m,c,t,e,o):i(m,f,c,e,t,o);if(!(void 0===y?m===f||n(m,f,r,i,o):y)){h=!1;break}d=d||"constructor"==c}if(h&&!d){var g=e.constructor,v=t.constructor;g!=v&&"constructor"in e&&"constructor"in t&&!("function"==typeof g&&g instanceof g&&"function"==typeof v&&v instanceof v)&&(h=!1)}return o.delete(e),o.delete(t),h}(e,t,r,i,n,o=o||new $e)},mi=function(e,t){return function e(t,r,i,n,o){return t===r||(null==t||null==r||!nt(t)&&!nt(r)?t!=t&&r!=r:di(t,r,i,n,e,o))}(e,t)},fi=(oi=Object.freeze({__proto__:null,default:{}}))&&oi.default||oi,yi=i((function(e){!function(){var t,r,i,n=0,o=[];for(s.BUFFER_SIZE=512,s.bin=a,s.test=function(e){if("string"==typeof e)return/^[0-9a-f]{8}-[0-9a-f]{4}-4[0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/.test(e)},r=0;r<256;r++)o[r]=(r+256).toString(16).substr(1);function a(){var e=function(e){var o;if(void 0!==i){if(void 0===t||s.BUFFER_SIZE<n+16)if(n=0,i.getRandomValues)t=new Uint8Array(s.BUFFER_SIZE),i.getRandomValues(t);else{if(!i.randomBytes)throw new Error("Non-standard crypto library");t=i.randomBytes(s.BUFFER_SIZE)}return t.slice(n,n+=16)}for(o=[],r=0;r<16;r++)o.push(Math.floor(255*Math.random())+0);return o}();return e[6]=15&e[6]|64,e[8]=63&e[8]|128,e}function s(){var e=a();return o[e[0]]+o[e[1]]+o[e[2]]+o[e[3]]+"-"+o[e[4]]+o[e[5]]+"-"+o[e[6]]+o[e[7]]+"-"+o[e[8]]+o[e[9]]+"-"+o[e[10]]+o[e[11]]+o[e[12]]+o[e[13]]+o[e[14]]+o[e[15]]}"undefined"!=typeof crypto?i=crypto:"undefined"!=typeof window&&void 0!==window.msCrypto&&(i=window.msCrypto),i=i||fi,e.exports=s}()})),gi=(vi.TYPE="Feature",vi);function vi(e,t,r,i){this.type="Feature",this.type=vi.TYPE,this.properties=t||{},this.id=r,this.geometry=e,this.bbox=i}var _i,bi=(d(xi,_i=Array),xi.fromData=function(e){var t=NaN,r=NaN,i=new Set(["y"]),n=new Set(["x"]);return Object.keys(e).forEach((function(o){var a=o.toLowerCase();isNaN(t)&&i.has(a)&&"number"==typeof e[o]?t=e[o]:isNaN(r)&&n.has(a)&&"number"==typeof e[o]&&(r=e[o])})),isNaN(t)||isNaN(r)?null:new xi(t,r)},xi.getX=function(e){return 0<e.length?e[0]:NaN},xi.getY=function(e){return 1<e.length?e[1]:NaN},xi.getDestination=function(e,t,r){return new xi(xi.getX(e)+r*Math.cos((t+270)*Math.PI/180),xi.getY(e)+r*Math.sin((t+270)*Math.PI/180))},xi.getDistance=function(e,t){var r=xi.getX(e)-xi.getX(t),i=xi.getY(e)-xi.getY(t);return Math.sqrt(r*r+i*i)},xi.getHeading=function(e,t){var r=xi.getX(t)-xi.getX(e),i=xi.getY(e)-xi.getY(t);return 180*(2.5*Math.PI-Math.atan2(i,r))/Math.PI%360},xi);function xi(e,t){return _i.call(this,e,t)||this}var wi=(Si.TYPE="Point",Si);function Si(e){this.type="Point",this.type=Si.TYPE,this.coordinates=e}var Ti,Ci,Ei,Ii,Pi,Ri,Ni,Ai,zi,Mi,ki=6378137,Oi=Math.PI/180,Li=180/Math.PI,Di=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9];function Bi(e){return e*Oi}function Fi(e){return e*Li}function qi(e,t,r){return Math.min(Math.max(e,t),r)}function Ui(e,t){var r=Bi(t[1]-e[1]),i=Bi(t[0]-e[0]),n=Math.pow(Math.sin(r/2),2)+Math.cos(Bi(e[1]))*Math.cos(Bi(t[1]))*Math.pow(Math.sin(i/2),2),o=2*Math.atan2(Math.sqrt(n),Math.sqrt(1-n));return Math.round(ki*o*100)/100}function ji(e){if(e)switch(e.toLowerCase()){case"feet":case"foot":case"ft":return Ei.feet;case"kilometers":case"kilometer":case"kilometres":case"kilometre":case"km":case"kms":return Ei.kilometers;case"miles":case"mile":case"mi":return Ei.miles;case"nauticalmiles":case"nauticalmile":case"nms":case"nm":return Ei.nauticalMiles;case"yards":case"yard":case"yds":case"yrd":case"yrds":return Ei.yards;case"meters":case"metres":case"m":default:return Ei.meters}return Ei.meters}function Vi(e){if(e)switch(e.toLowerCase()){case"milespersecondsquared":case"milepersecondsquared":case"mi/s^2":case"mi/s2":return zi.milesPerSecondSquared;case"kilometerspersecondsquared":case"kilometrespersecondsquared":case"kilometerpersecondsquared":case"kilometrepersecondsquared":case"km/s^2":case"km/s2":return zi.kilometersPerSecondSquared;case"knotspersecond":case"knotpersecond":case"knts/s":case"kn/s":case"kt/s":return zi.knotsPerSecond;case"standardgravity":case"g":return zi.standardGravity;case"feetpersecondsquared":case"footpersecondsquared":case"ft/s^2":case"ft/s2":return zi.feetPerSecondSquared;case"yardspersecondsquared":case"yardpersecondsquared":case"yds/s^2":case"yds/s2":case"yd/s^2":case"yd/s2":return zi.yardsPerSecondSquared;case"milesperhoursecond":case"mileperhoursecond":case"milesperhourseconds":case"mileperhourseconds":case"mi/h/s":return zi.milesPerHourSecond;case"kilometersperhoursecond":case"kilometrespersoursecond":case"kilometerperhoursecond":case"kilometrepersoursecond":case"kilometersperhourssecond":case"kilometrespersourssecond":case"kilometerperhourssecond":case"kilometrepersourssecond":case"kmhs":case"km/h/s":return zi.kilometersPerHourSecond;case"meterspersecondsquared":case"metrespersecondsquared":case"meterpersecondsquared":case"metrepersecondsquared":case"m/s^2":case"m/s2":default:return zi.metersPerSecondSquared}return zi.metersPerSecondSquared}function Gi(e){if(e)switch(e){case"acres":case"ac":return Ti.acres;case"hectares":case"ha":return Ti.hectares;case"squareFeet":case"ft^2":case"ft2":return Ti.squareFeet;case"squareYards":case"squareYard":case"yds^2":case"yds2":case"yd^2":case"yd2":return Ti.squareYards;case"squareKilometers":case"squareKilometres":case"squareKilometer":case"squareKilometre":case"km^2":case"km2":return Ti.squareKilometers;case"squareMiles":case"squareMile":case"mi^2":case"mi2":return Ti.squareMiles;case"squareMeters":case"squareMetres":case"squareMeter":case"squareMetre":case"m^2":case"m2":default:return Ti.squareMeters}return Ti.squareMeters}function Hi(e){if(e)switch(e.toLowerCase()){case"feetpersecond":case"footsecond":case"ftps":case"ft/s":return Ni.feetPerSecond;case"milesperhour":case"mileperhour":case"mph":case"mi/hr":case"mi/h":return Ni.milesPerHour;case"knots":case"knot":case"knts":case"knt":case"kn":case"kt":return Ni.knots;case"mach":case"m":return Ni.mach;case"kilometersperhour":case"kilometresperhour":case"kmperhour":case"kmph":case"km/hr":case"km/h":return Ni.kilometersPerHour;case"meterspersecond":case"metrespersecond":case"mps":case"ms":case"m/s":default:return Ni.metersPerSecond}return Ni.metersPerSecond}function Zi(e){if(e)switch(e.toLowerCase()){case"milliseconds":case"ms":return Pi.ms;case"minutes":case"minute":case"mins":case"min":return Pi.minutes;case"hours":case"hour":case"hr":case"h":return Pi.hours;case"days":case"day":case"d":return Pi.days;case"seconds":case"second":case"secs":case"sec":case"s":default:return Pi.seconds}return Pi.seconds}function Wi(e){var t=0;if(e&&0<e.length){t=Math.abs(Ki(e[0]));for(var r=1,i=e.length;r<i;r++)t-=Math.abs(Ki(e[r]))}return t}function Ki(e){var t=0;if(3<=e.length){for(var r=void 0,i=void 0,n=0,o=e.length;n<o;n++)t+=(Bi(e[n===o-2?(r=o-2,i=o-1,0):n===o-1?(r=o-1,i=0,1):(i=(r=n)+1,n+2)][0])-Bi(e[r][0]))*Math.sin(Bi(e[i][1]));t=t*ki*ki/2}return t}function Xi(e,t,r){return(e[0]-r[0])*(t[1]-r[1])-(e[1]-r[1])*(t[0]-r[0])}function Yi(e,t,r){if(2<=r.length){for(var i=1/0,n=void 0,o=null,a=hn(r,22),s=void 0,l=0,u=a.length-1;l<u;l++)s=Ji(t,a[l],a[l+1]),(n=bi.getDistance(t,s))<i&&(i=n,o=s);if(o){var c=pn([o],22)[0];return new gi(new wi(c),{distance:tn(e,c)})}}else if(1===r.length)return new gi(new wi(r[0]),{distance:tn(e,r[0])});return null}function Ji(e,t,r){if(t[0]===r[0]&&t[1]===r[1])return t;var i=e[0]-t[0],n=e[1]-t[1],o=r[0]-t[0],a=r[1]-t[1],s=(o*i+a*n)/(o*o+a*a);return s<0?t:1<s?r:[t[0]+o*s,t[1]+a*s]}function $i(e,t){var r;!isNaN(e)&&"number"==typeof t&&0<=t&&(r=t<Di.length?Di[t]:Math.pow(10,t),e=Math.round(e*r)/r);return e}function Qi(e,t,r,i){switch(ji(t)){case Ei.meters:e/=1e3;break;case Ei.feet:e/=3280.8399;break;case Ei.miles:e/=.62137119;break;case Ei.yards:e/=1093.6133;break;case Ei.nauticalMiles:e/=.5399568;break;case Ei.kilometers:}switch(ji(r)){case Ei.meters:e*=1e3;break;case Ei.feet:e*=3280.8399;break;case Ei.miles:e*=.62137119;break;case Ei.yards:e*=1093.6133;break;case Ei.nauticalMiles:e*=.5399568;break;case Ei.kilometers:}if("number"==typeof i&&0<=i){var n=Math.pow(10,i);e=Math.round(e*n)/n}return e}function en(e,t,r,i){i=i||"meters",e=wn(e);var n=rn(i),o=Bi(e[1]),a=Bi(e[0]),s=Bi(t),l=r/n,u=Math.asin(Math.sin(o)*Math.cos(l)+Math.cos(o)*Math.sin(l)*Math.cos(s)),c=a+Math.atan2(Math.sin(s)*Math.sin(l)*Math.cos(o),Math.cos(l)-Math.sin(o)*Math.sin(u)),p=qi(ln(Fi(u)),-85,85);return[un(Fi(c)),p]}function tn(e,t,r){var i=Ui(e=wn(e),t=wn(t));return"meters"===r?i:Qi(i,"meters",r||"meters")}function rn(e){var t=ji(e);return Qi(ki,Ei.meters,t)}function nn(e,t){if(e=wn(e),t=wn(t),e&&2<=e.length&&t&&2<=t.length){var r=Bi(e[1]),i=Bi(t[1]),n=Bi(t[0]-e[0]),o=Math.sin(n)*Math.cos(i),a=Math.cos(r)*Math.sin(i)-Math.sin(r)*Math.cos(i)*Math.cos(n);return(Fi(Math.atan2(o,a))+360)%360}return NaN}function on(e,t){var r,i=0;Array.isArray(e)?r=e:e.type&&"LineString"===e.type&&(r=e.coordinates);for(var n=0,o=r.length-1;n<o;n++)i+=Ui(r[n],r[n+1]);return Qi(i,"meters",t||"meters")}function an(e,t,r){r=r||"meters";var i,n,o=0;if(Array.isArray(e)?n=e:e.type&&"LineString"===e.type&&(n=e.coordinates),2<=n.length){for(var a=n.length,s=1;s<a;s++){if(t<=o+(i=tn(n[s-1],n[s],r))){var l=nn(n[s-1],n[s]);return en(n[s-1],l,t-o,r)}o+=i}return o<=t?n[a-1]:n[0]}return null}function sn(e,t,r,i,n){i=i||"meters",n=n||0,e=wn(e);for(var o=[],a=360/r,s=0;s<=r;s++)o.push(en(e,(s*a+n)%360,t,i));return o}function ln(e){return 90<e?180<(e=(e+90)%360)?90-(e-180):e-90:e<-90?(e=(e-90)%360)<-180?-90-(e+180):e+90:e}function un(e){return 180<e?(e+180)%360-180:e<-180?(e-180)%360+180:e}function cn(e,t,r){if(0===r)return Object.assign({},e);t=wn(t);for(var i,n,o=[],a=0,s=e.length;a<s;a++)i=tn(t,e[a]),n=nn(t,e[a]),o.push(en(t,n+r,i));return o}function pn(e,t){for(var r,i,n=512*Math.pow(2,t),o=[],a=0,s=e.length;a<s;a++)r=e[a][0]/n-.5,i=.5-e[a][1]/n,o.push([360*r,90-360*Math.atan(Math.exp(2*-i*Math.PI))/Math.PI]);return o}function hn(e,t){for(var r,i,n,o=512*Math.pow(2,t),a=[],s=0,l=e.length;s<l;s++)n=Math.sin(e[s][1]*Math.PI/180),r=(e[s][0]+180)/360,i=.5-Math.log((1+n)/(1-n))/(4*Math.PI),a.push([Math.round(r*o),Math.round(i*o)]);return a}function dn(e,t,r,i){switch(Vi(t)){case zi.kilometersPerHourSecond:e/=3.6;break;case zi.milesPerHourSecond:e/=2.236936292054;break;case zi.knotsPerSecond:e/=1.943844492441;break;case zi.standardGravity:e/=.1019716212978;break;case zi.kilometersPerSecondSquared:e/=.001;break;case zi.milesPerSecondSquared:e/=.000621371192;break;case zi.feetPerSecondSquared:e/=3.280839895012;break;case zi.yardsPerSecondSquared:e/=1.093613298338;break;case zi.metersPerSecondSquared:}switch(Vi(r)){case zi.kilometersPerHourSecond:e*=3.6;break;case zi.milesPerHourSecond:e*=2.236936292054;break;case zi.knotsPerSecond:e*=1.943844492441;break;case zi.standardGravity:e*=.1019716212978;break;case zi.kilometersPerSecondSquared:e*=.001;break;case zi.milesPerSecondSquared:e*=.000621371192;break;case zi.feetPerSecondSquared:e*=3.280839895012;break;case zi.yardsPerSecondSquared:e*=1.093613298338;break;case zi.metersPerSecondSquared:}return $i(e,i)}function mn(e,t,r,i){switch(Gi(t)){case Ti.acres:e*=4046.8564224;break;case Ti.hectares:e*=1e4;break;case Ti.squareFeet:e*=.09290304;break;case Ti.squareKilometers:e*=1e6;break;case Ti.squareMiles:e*=259e4;break;case Ti.squareYards:e*=.83612736;break;case Ti.squareMeters:}switch(Gi(r)){case Ti.acres:e/=4046.8564224;break;case Ti.hectares:e/=1e4;break;case Ti.squareFeet:e/=.09290304;break;case Ti.squareKilometers:e/=1e6;break;case Ti.squareMiles:e/=259e4;break;case Ti.squareYards:e/=.83612736;break;case Ti.squareMeters:}return $i(e,i)}function fn(e,t,r,i){switch(Hi(t)){case Ni.feetPerSecond:e*=1.09728;break;case Ni.milesPerHour:e*=1.6093;break;case Ni.knots:e*=1.852;break;case Ni.metersPerSecond:e*=3.6;break;case Ni.mach:e*=1234.8;break;case Ni.kilometersPerHour:}switch(Hi(r)){case Ni.feetPerSecond:e/=1.09728;break;case Ni.milesPerHour:e/=1.6093;break;case Ni.knots:e/=1.852;break;case Ni.metersPerSecond:e/=3.6;break;case Ni.mach:e/=1234.8;break;case Ni.kilometersPerHour:}return $i(e,i)}function yn(e,t,r,i){switch(Zi(t)){case Pi.ms:e/=1e3;break;case Pi.hours:e*=3600;break;case Pi.minutes:e*=60;break;case Pi.days:e*=86400;break;case Pi.seconds:}switch(Zi(r)){case Pi.ms:e*=1e3;break;case Pi.hours:e/=3600;break;case Pi.minutes:e/=60;break;case Pi.days:e/=86400;break;case Pi.seconds:}return $i(e,i)}function gn(e,t,r,i,n,o,a,s){var l=Qi(t,n,Ei.meters),u=yn(r,o,Pi.seconds);return dn(2*(l-fn(e,i,Ni.metersPerSecond)*u)/(u*u),zi.metersPerSecondSquared,a,s)}function vn(e,t,r,i,n,o,a){var s=fn(e,i,Ni.metersPerSecond);return dn((fn(t,i,Ni.metersPerSecond)-s)/yn(r,n,Pi.seconds),zi.metersPerSecondSquared,o,a)}function _n(e,t,r,i){var n=bn(e),o=bn(t);return null!=n&&null!=o?yn(o.getTime()-n.getTime(),Pi.ms,r,i):NaN}function bn(e){if("[object Date]"===Object.prototype.toString.call(e))return e;if("string"==typeof e){var t,r=Date.parse(e);if(!isNaN(r))return new Date(r);if(0<=e.indexOf("Date("))return t=0<(e=e.replace("/Date(","").replace(")/","")).indexOf("+")?parseInt(e.substr(0,e.indexOf("+")),10):0<e.indexOf("-")?parseInt(e.substr(0,e.indexOf("-")),10):parseInt(e,10),new Date(t)}else if("number"==typeof e)return new Date(e);return null}function xn(e){var t=[],r=null,i=null;if(Array.isArray(e)&&0<e.length)if(Array.isArray(e[0])&&"number"==typeof e[0][0])t=e;else for(var n=e.length,o=0;o<n;o++)t=t.concat(xn(e[o]));else if(e.type)switch(e.type){case"Point":t=[e.coordinates];break;case"LineString":t=e.coordinates;break;case"Polygon":r=e.coordinates;break;case"MultiPoint":t=e.coordinates;break;case"MultiLineString":r=e.coordinates;break;case"MultiPolygon":i=e.coordinates;break;case"Feature":var a=e;t=Dn._isCircle(a)?Dn._getCirclePositions(a):xn(a.geometry);break;case"FeatureCollection":t=xn(e.features);break;case"GeometryCollection":t=xn(e.geometries)}else if(e instanceof Dn)return xn(e.toJson());if(r)for(n=r.length,o=0;o<n;o++)t=t.concat(r[o]);else if(i){var s=i.length;for(o=0;o<s;o++)for(var l=i[o].length,u=0;u<l;u++)t=t.concat(i[o][u])}return t}function wn(e){if(Array.isArray(e)&&"number"==typeof e[0])return e;if(e.type){if("Point"===e.type)return e.coordinates;if("Feature"===e.type&&"Point"===e.geometry.type)return e.geometry.coordinates}else if(e instanceof Dn&&"Point"===e.getType())return e.getCoordinates();return null}function Sn(e,t,r){r=r||"meters";var i,n,o=0;if(Array.isArray(e)?n=e:e.type&&"LineString"===e.type&&(n=e.coordinates),2<=n.length){for(var a=n.length,s=1;s<a;s++){if(t<=o+(i=tn(n[s-1],n[s],r))){var l=nn(n[s-1],n[s]),u=en(n[s-1],l,t-o,r);return new gi(new wi(u),{heading:l})}o+=i}return o<=t?new gi(new wi(n[a-1]),{heading:nn(n[a-2],n[a-1])}):new gi(new wi(n[0]),{heading:nn(n[0],n[1])})}return null}function Tn(e,t,r,i){var n,o=wn(e),a=hn([o],22)[0],s=null,l=1/0;switch((t=t instanceof Dn?t.toJson():t).type){case"Feature":return Tn(e,t.geometry,r);case"Point":n=[[t.coordinates]];break;case"MultiPoint":for(var u=void 0,c=t.coordinates,p=0,h=c.length;p<h;p++)(u=tn(o,c[p]))<l&&(l=u,s=new gi(new wi(c[p]),{distance:u}));break;case"LineString":n=[t.coordinates];break;case"Polygon":case"MultiLineString":n=t.coordinates;break;case"MultiPolygon":var d=t.coordinates;if(0<d.length)for(n=d[0],p=1,h=d.length;p<h;p++)n=n.concat(d[p])}if(n){var m=void 0;for(p=0,h=n.length;p<h;p++)(m=Yi(o,a,n[p]))&&m.properties.distance<l&&(l=m.properties.distance,s=m)}return s&&(s.properties.distance=Qi(s.properties.distance,"meters",r,i)),s}(Ci=Ti=Ti||{}).squareMeters="squareMeters",Ci.acres="acres",Ci.hectares="hectares",Ci.squareFeet="squareFeet",Ci.squareKilometers="squareKilometers",Ci.squareMiles="squareMiles",Ci.squareYards="squareYards",(Ii=Ei=Ei||{}).meters="meters",Ii.kilometers="kilometers",Ii.feet="feet",Ii.miles="miles",Ii.nauticalMiles="nauticalMiles",Ii.yards="yards",(Ri=Pi=Pi||{}).seconds="seconds",Ri.hours="hours",Ri.ms="ms",Ri.minutes="minutes",Ri.days="days",(Ai=Ni=Ni||{}).metersPerSecond="metersPerSecond",Ai.kilometersPerHour="kilometersPerHour",Ai.feetPerSecond="feetPerSecond",Ai.milesPerHour="milesPerHour",Ai.knots="knots",Ai.mach="mach",(Mi=zi=zi||{}).milesPerSecondSquared="milesPerSecondSquared",Mi.kilometersPerSecondSquared="kilometersPerSecondSquared",Mi.knotsPerSecond="knotsPerSecond",Mi.standardGravity="standardGravity",Mi.feetPerSecondSquared="feetPerSecondSquared",Mi.yardsPerSecondSquared="yardsPerSecondSquared",Mi.milesPerHourSecond="milesPerHourSecond",Mi.kilometersPerHourSecond="kilometersPerHourSecond",Mi.metersPerSecondSquared="metersPerSecondSquared";var Cn,En=(d(In,Cn=Array),In.fromPosition=function(e){return 2===e.length?new In(e[0],e[1]):2<e.length?new In(e[0],e[1],e[2]):null},In.areEqual=function(e,t,r){if(void 0===r&&(r=6),e&&2<=e.length&&t&&2<=t.length){var i=Math.pow(10,r),n=ln(e[1]),o=ln(t[1]),a=un(e[0]),s=un(t[0]);if(0!=Math.round((n-o)*i)/i)return!1;var l=Math.round((a-s)*i)/i;return 0==l||360==l}return!1},In.fromLatLng=function(e,t,r){var i=[];if("number"==typeof e)i.push(e),"number"==typeof t&&i.push(t),"number"==typeof r&&i.push(r);else if(Array.isArray(e))2<=e.length&&"number"==typeof e[0]&&"number"==typeof e[1]&&(3<=e.length&&"number"==typeof e[2]?i.push(e[0],e[1],e[2]):i.push(e[0],e[1]));else if("object"==typeof e){var n=["lat","latitude","y"],o=["lng","longitude","lon","x"],a=["elv","elevation","alt","altitude","z"],s=NaN,l=NaN,u=NaN;Object.keys(e).forEach((function(t,r,i){var c=t.toLowerCase();isNaN(s)&&0<=n.indexOf(c)&&"number"==typeof e[t]?s=e[t]:isNaN(l)&&0<=o.indexOf(c)&&"number"==typeof e[t]?l=e[t]:isNaN(u)&&0<=a.indexOf(c)&&"number"==typeof e[t]&&(u=e[t])})),isNaN(s)||isNaN(l)||(i.push(l,s),isNaN(u)||i.push(u))}return 2<=i.length?i:null},In.fromLatLngs=function(e){var t=[];if(Array.isArray(e))for(var r=0,i=e.length;r<i;r++){var n=In.fromLatLng(e[r]);n&&t.push(n)}return t},In._getDimensions=function(e){for(var t=0;Array.isArray(e);)e=e[0],t++;return"number"==typeof e&&t--,t},In);function In(e,t,r){return r?Cn.call(this,e,t,r)||this:Cn.call(this,e,t)||this}var Pn=(Rn.TYPE="Polygon",Rn);function Rn(e,t){this.type="Polygon",this.type=Rn.TYPE,1===En._getDimensions(e)?this.coordinates=[e]:this.coordinates=e,this.bbox=t}var Nn=(An.prototype._addEventListener=function(e,t,r){this.listeners.has(e)||this.listeners.set(e,new Nr),this.listeners.get(e).set(t,r)},An.prototype._removeEventListener=function(e,t){this.listeners.has(e)&&this.listeners.get(e).delete(t)},An.prototype._invokeEvent=function(e,t){var r=this;this.listeners.has(e)&&this.listeners.get(e).forEach((function(i,n){i&&r._removeEventListener(e,n);try{n(t)}catch(i){console.error(i)}}))},An);function An(){this.listeners=new Nr}var zn=Object.freeze({__proto__:null,EventEmitter:Nn}),Mn=(kn.prototype.toTarget=function(e,t){return this.transformArray(e,this.M,t)},kn.prototype.toSource=function(e,t){return this.transformArray(e,this.inverseM,t)},kn.prototype.transformArray=function(e,t,r){if(e&&Array.isArray(e)&&Array.isArray(e[0])){for(var i=[],n=0,o=e;n<o.length;n++){var a=o[n];i.push(this.transform(a,t,r))}return i}return null},kn.prototype.transform=function(e,t,r){var i=e[0]*t[0][3]+e[1]*t[1][3]+t[2][3],n=e[0]*t[0][4]+e[1]*t[1][4]+t[2][4];return"number"==typeof r&&0<=r?[$i(i,r),$i(n,r)]:[$i(i,6),$i(n,6)]},kn._calculateAffineTransform=function(e,t){if(e.length!==t.length||e.length<1)throw new Error("Error: source and target arrays must have the same length.");var r=Math.min(e[0].length,t[0].length),i=r+1;if(e.length<r)throw new Error("Erorr: At least "+r+" reference points required.");for(var n=[],o=[],a=0;a<i;a++){o[a]=[];for(var s=0;s<i;s++){s<r&&(n[s]=0);for(var l=o[a][s]=0;l<e.length;l++)s<r&&(n[s]+=a<r?e[l][a]*t[l][s]:t[l][s]),o[a][s]+=r<=a&&r<=s?1:r<=a?e[l][s]:r<=s?e[l][a]:e[l][a]*e[l][s]}o[a]=o[a].concat(n)}if(!this._gaussJordanElimination(o))throw new Error("Error: Singular matrix. Points are likely coplanar.");return o},kn._gaussJordanElimination=function(e){for(var t,r,i=e.length,n=2*i-1,o=0;o<i;o++){for(var a=o,s=o+1;s<i;s++)Math.abs(e[s][o])>Math.abs(e[a][o])&&(a=s);if(r=e[a],e[a]=e[o],e[o]=r,Math.abs(e[o][o])<=1e-10)return!1;for(var l=o+1;l<i;l++){t=e[l][o]/e[o][o];for(var u=o;u<n;u++)e[l][u]-=e[o][u]*t}}for(o=i-1;-1<o;o--){for(t=e[o][o],s=0;s<o;s++)for(var c=n-1;o-1<c;c--)e[s][c]-=e[o][c]*e[s][o]/t;e[o][o]/=t;for(var p=i;p<n;p++)e[o][p]/=t}return!0},kn);function kn(e,t){this.M=kn._calculateAffineTransform(e,t),this.inverseM=kn._calculateAffineTransform(t,e)}var On,Ln=Object.freeze({__proto__:null,AffineTransform:Mn,_precision:$i,get AreaUnits(){return Ti},get DistanceUnits(){return Ei},get TimeUnits(){return Pi},get SpeedUnits(){return Ni},get AccelerationUnits(){return zi},boundingBoxToPolygon:function(e){var t=un(qn.getWest(e)),r=un(qn.getEast(e)),i=ln(qn.getNorth(e)),n=ln(qn.getSouth(e)),o=qn.getCenter(e),a=[[t,i],[t,n],[o[0],n],[r,n],[r,i],[o[0],i],[t,i]];return new Pn([a])},convertDistance:Qi,getCardinalSpline:function(e,t,r,i){var n;if(!e||e.length<=2)return n;"number"!=typeof t&&(t=.5),("number"!=typeof r||r<=0)&&(r=15);var o=e.length;n=e.slice(0),i?(En.areEqual(n[0],n[o-1])&&(n.pop(),o--),n.unshift(e[o-1]),n.push(e[0]),n.push(e[1]),o++):(n.unshift(e[0]),n.push(e[o-1]));var a,s,l,u=[];u.push([1,0,0,0]);for(var c=1;c<r-1;c++)l=(a=c/r)*(s=a*a),u.push([2*l-3*s+1,-2*l+3*s,l-2*s+a,l-s]);u.push([0,1,0,0]);var p,h,d,m,f,y,g,v=[];for(c=1;c<o;c++)for(h=t*(n[c+1][0]-n[c-1][0]),d=t*(n[c+1][1]-n[c-1][1]),m=t*(n[c+2][0]-n[c][0]),f=t*(n[c+2][1]-n[c][1]),a=0;a<r;a++)g=(p=u[a])[0]*n[c][0]+p[1]*n[c+1][0]+p[2]*h+p[3]*m,y=qi(y=p[0]*n[c][1]+p[1]*n[c+1][1]+p[2]*d+p[3]*f,-85,85),v.push([g,y]);return v},getDestination:en,getDistanceTo:tn,getEarthRadius:rn,getGeodesicPath:function(e,t){var r;(!t||t<=0)&&(t=15),Array.isArray(e)?r=e:e.type&&"LineString"===e.type&&(r=e.coordinates);for(var i=r.length-1,n=[],o=0;o<i;o++)for(var a=Bi(r[o][1]),s=Bi(r[o][0]),l=Bi(r[o+1][1]),u=Bi(r[o+1][0]),c=2*Math.asin(Math.sqrt(Math.pow(Math.sin((a-l)/2),2)+Math.cos(a)*Math.cos(l)*Math.pow(Math.sin((s-u)/2),2))),p=0;p<=t;p++){var h=p/t,d=Math.sin((1-h)*c)/Math.sin(c),m=Math.sin(h*c)/Math.sin(c),f=d*Math.cos(a)*Math.cos(s)+m*Math.cos(l)*Math.cos(u),y=d*Math.cos(a)*Math.sin(s)+m*Math.cos(l)*Math.sin(u),g=d*Math.sin(a)+m*Math.sin(l),v=Math.atan2(g,Math.sqrt(Math.pow(f,2)+Math.pow(y,2))),_=Math.atan2(y,f);v=qi(Fi(v),-85,85),_=Fi(_),n.push([_,v])}return n},getHeading:nn,getLengthOfPath:on,getPositionAlongPath:an,getRegularPolygonPath:sn,interpolate:function(e,t,r){r=void 0===r?.5:r;var i=tn(e=wn(e),t=wn(t),"kilometers");return en(e,nn(e,t),i*r,"kilometers")},normalizeLatitude:ln,normalizeLongitude:un,rotatePositions:cn,getPixelHeading:function(e,t){var r=hn([e=wn(e),t=wn(t)],21),i=r[0],n=r[1],o=n[0]-i[0],a=i[1]-n[1];return(2.5*Math.PI-Math.atan2(a,o))*Li%360},mercatorPixelsToPositions:pn,mercatorPositionsToPixels:hn,convertAcceleration:dn,convertArea:mn,convertSpeed:fn,convertTimespan:yn,getAcceleration:gn,getAccelerationFromSpeeds:vn,getAccelerationFromFeatures:function(e,t,r,i,n,o,a){if("string"==typeof r&&"Feature"===e.type&&"Point"===e.geometry.type&&"Feature"===t.type&&"Point"===t.geometry.type){var s=_n(e.properties[r],t.properties[r],Pi.seconds);if(!isNaN(s)){var l=0;if(i&&"string"==typeof i){var u=e.properties[i],c=t.properties[i];if("number"==typeof u&&(l=u,"number"==typeof c))return vn(u,c,s,n,Pi.seconds,o,a)}return gn(l,tn(e.geometry.coordinates,t.geometry.coordinates,Ei.meters),s,n,Ei.meters,Pi.seconds,o,a)}}return NaN},getArea:function e(t,r,i){if(t){var n=0;switch((t=t instanceof Dn?t.toJson():t).type){case"Feature":if(t.geometry)return e(t.geometry,r,i);break;case"Polygon":t.coordinates&&(n=Wi(t.coordinates));break;case"MultiPolygon":var o=t;if(o.coordinates)for(var a=0,s=o.coordinates.length;a<s;a++)n+=Wi(o.coordinates[a])}return mn(n,Ti.squareMeters,r,i)}return 0},getSpeed:function(e,t,r,i,n,o){var a=wn(e),s=wn(t);if(a&&s){var l=yn(r,i,Pi.seconds);return fn(tn(a,s,Ei.meters)/l,Ni.metersPerSecond,n,o)}return 0},getSpeedFromFeatures:function(e,t,r,i,n){if("string"==typeof r&&"Feature"===e.type&&"Point"===e.geometry.type&&"Feature"===t.type&&"Point"===t.geometry.type){var o=this.getTimespan(e.properties[r],t.properties[r],Pi.seconds);if(!isNaN(o)){var a=this.getDistanceTo(e.geometry.coordinates,t.geometry.coordinates,Ei.meters);return this.convertSpeed(a/o,Ni.metersPerSecond,i,n)}}return NaN},getTimespan:_n,getTravelDistance:function(e,t,r,i,n,o,a,s){t=this.convertTimespan(t,n,Pi.seconds);var l=(r=this.convertSpeed(r,o,Ni.metersPerSecond))*t;return"number"==typeof i&&(l+=.5*this.convertAcceleration(i,a,zi.metersPerSecondSquared)*t*t),this.convertDistance(l,Ei.meters,e,s)},parseTimestamp:bn,getConvexHull:function(e){var t=xn(e).map((function(e){return[un(e[0]),ln(e[1])]}));t.sort((function(e,t){return e[0]===t[0]?e[1]-t[1]:e[0]-t[0]}));for(var r=[],i=0,n=t;i<n.length;i++){for(var o=n[i];2<=r.length&&Xi(r[r.length-2],r[r.length-1],o)<=0;)r.pop();r.push(o)}for(var a=[],s=t.length-1;0<=s;s--){for(;2<=a.length&&Xi(a[a.length-2],a[a.length-1],t[s])<=0;)a.pop();a.push(t[s])}return new Pn([r.concat(a)])},getPositions:xn,getPosition:wn,getPositionsAlongPath:function(e,t){if(t<2)return[];for(var r=[],i=on(e,Ei.meters)/(t-1),n=0;n<t;n++){var o=an(e,i*n,Ei.meters);null!=o&&r.push(o)}return r},getPointWithHeadingAlongPath:Sn,getPointsWithHeadingsAlongPath:function(e,t){if(t<=0)return[];for(var r=[],i=on(e,Ei.meters)/(t-1),n=0;n<t;n++){var o=Sn(e,i*n,Ei.meters);null!=o&&r.push(o)}return r},getClosestPointOnGeometry:Tn}),Dn=(d(Bn,On=Nn),Bn.prototype.addProperty=function(e,t){mi(this.data.properties[e],t)||(this.data.properties[e]=Rr(t),"subType"!==e&&"radius"!==e||this._handleCircle(),this.dataSource&&this.dataSource._updateSource(),this._invokeEvent("shapechanged",this))},Bn.prototype.getBounds=function(){var e,t=this.getCoordinates(),r=this.getType();if("Point"===r)if(this.circlePolygon){var i=this.circlePolygon.geometry.coordinates;e=qn.fromPositions(i[0])}else e=new qn(i=t,i);else if("MultiPoint"===r||"LineString"===r)i=t,e=qn.fromPositions(i);else if("Polygon"===r)i=t,e=qn.fromPositions(i[0]);else if("MultiLineString"===r)for(var n=0,o=i=t;n<o.length;n++){var a=o[n];e=qn.merge(e,qn.fromPositions(a))}else if("MultiPolygon"===r)for(var s=0,l=i=t;s<l.length;s++){var u=l[s];e=qn.merge(e,qn.fromPositions(u[0]))}return e},Bn.prototype.getCoordinates=function(){return Rr(this.data.geometry.coordinates)},Bn.prototype.getCircleCoordinates=function(){return this.circlePolygon?Rr(this.circlePolygon.geometry.coordinates[0]):null},Bn.prototype.getId=function(){return this.data.id},Bn.prototype.getProperties=function(){return Rr(this.data.properties)},Bn.prototype.getType=function(){return this.data.geometry.type},Bn.prototype.isCircle=function(){return Bn._isCircle(this.data)},Bn.prototype.isRectangle=function(){return Bn._isRectangle(this.data)},Bn.prototype.setCoordinates=function(e){var t;t="Polygon"===this.getType()&&1===En._getDimensions(e)?[e]:e,mi(this.data.geometry.coordinates,t)||(this.data.geometry.coordinates=Rr(t),this._handleCircle(),this.dataSource&&this.dataSource._updateSource(),this._invokeEvent("shapechanged",this))},Bn.prototype.setProperties=function(e){e[Bn._shapeIdPropName]=this.data.id,mi(this.data.properties,e)||(this.data.properties=Rr(e),this._handleCircle(),this.dataSource&&this.dataSource._updateSource(),this._invokeEvent("shapechanged",this))},Bn.prototype.toJson=function(){return JSON.parse(JSON.stringify(this.data))},Bn.prototype._toJson=function(){return this.circlePolygon||this.data},Bn.prototype._setDataSource=function(e){void 0===e||null==e?delete this.dataSource:this.dataSource=e},Bn.prototype._handleCircle=function(){if(this.isCircle()){var e=Bn._getCirclePositions(this.data);this.circlePolygon=new gi(new Pn([e]),this.data.properties,this.data.id),this.data.properties.subType="Circle"}else delete this.circlePolygon},Bn._isCircle=function(e){return e&&e.geometry&&"Point"===e.geometry.type&&e.geometry.coordinates&&e.properties&&"string"==typeof e.properties.subType&&"circle"===e.properties.subType.toLowerCase()&&"number"==typeof e.properties.radius},Bn._isRectangle=function(e){if("Polygon"===e.geometry.type&&e.geometry.coordinates&&"string"==typeof e.properties.subType&&"rectangle"===e.properties.subType.toLowerCase()){var t=e.geometry.coordinates;if(1===t.length){var r=t[0];if(5===r.length)return r[0][0]===r[4][0]&&r[0][1]===r[4][1];if(4===r.length)return!0}}return!1},Bn._getCirclePositions=function(e){return sn(e.geometry.coordinates,e.properties.radius,72,"meters")},Bn._shapeIdPropName="_azureMapsShapeId",Bn);function Bn(e,t,r){var i,n=On.call(this)||this;if("Feature"===e.type){var o=e;i=Rr(o.geometry),r=o.properties?Rr(o.properties):{},t=null==o.id||""===o.id?yi():o.id}else i=Rr(e),t=null==t||""===t?yi():t,r=r?Rr(r):{};return r[Bn._shapeIdPropName]=t,n.data=new gi(i,r,t),n._handleCircle(),n}var Fn,qn=(d(Un,Fn=Array),Un.fromBoundingBox=function(e){var t=Un.getWest(e),r=Un.getSouth(e),i=Un.getEast(e),n=Un.getNorth(e);return new Un([t,r,i,n])},Un.fromDimensions=function(e,t,r){var i=e[0],n=e[1],o=Math.min(Math.max(n+r/2,-85.5),85.5),a=Math.min(Math.max(n-r/2,-85.5),85.5),s=un(i+t/2);return new Un([un(i-t/2),a,s,o])},Un.fromEdges=function(e,t,r,i){return new Un([e,t,r,i])},Un.containsPosition=function(e,t){var r=Un.getCenter(e),i=Math.abs(r[1]-t[1]),n=Math.abs(r[0]-t[0]);180<n&&(n=360-n);var o=Un.getHeight(e),a=Un.getWidth(e);return i<=o/2+1e-8&&n<=a/2+1e-8},Un.crossesAntimeridian=function(e){return un(Un.getEast(e))-un(Un.getWest(e))<0},Un.getCenter=function(e){var t=un(Un.getEast(e)),r=un(Un.getWest(e));t<r&&(t+=360);var i=un((r+t)/2),n=ln(Un.getSouth(e)),o=ln(Un.getNorth(e));return[i,ln((n+o)/2)]},Un.getHeight=function(e){var t=ln(Un.getNorth(e))-ln(Un.getSouth(e));return isNaN(t)?0:t},Un.getWidth=function(e){var t=un(Un.getEast(e))-un(Un.getWest(e));return isNaN(t)?0:t<0?t+=360:t},Un.getSouthWest=function(e){var t=this.getSouth(e),r=this.getWest(e);return isNaN(t)||isNaN(r)?null:[r,t]},Un.getNorthEast=function(e){var t=this.getNorth(e),r=this.getEast(e);return isNaN(t)||isNaN(r)?null:[r,t]},Un.getNorthWest=function(e){var t=this.getNorth(e),r=this.getWest(e);return isNaN(t)||isNaN(r)?null:[r,t]},Un.getSouthEast=function(e){var t=this.getSouth(e),r=this.getEast(e);return isNaN(t)||isNaN(r)?null:[r,t]},Un.getSouth=function(e){return e&&4<=e.length?Number(e[1]):NaN},Un.getWest=function(e){return e&&4<=e.length?Number(e[0]):NaN},Un.getNorth=function(e){if(e){if(4===e.length)return Number(e[3]);if(6===e.length)return Number(e[4])}return NaN},Un.getEast=function(e){if(e){if(4===e.length)return Number(e[2]);if(6===e.length)return Number(e[3])}return NaN},Un.intersect=function(e,t){var r=Un.getCenter(e),i=Un.getCenter(t),n=Math.abs(r[1]-i[1]),o=Math.abs(r[0]-i[0]);180<o&&(o=360-o);var a=Un.getHeight(e),s=Un.getWidth(e),l=Un.getHeight(t),u=Un.getWidth(t);return n<=a/2+l/2&&o<=s/2+u/2},Un.merge=function(e,t){var r=e&&4===e.length,i=t&&4===t.length;if(r&&!i)return e;if(i&&!r)return t;if(!r&&!i)return null;var n=Math.max(ln(Un.getNorth(e)),ln(Un.getNorth(t))),o=Math.min(ln(Un.getSouth(e)),ln(Un.getSouth(t))),a=[e,t],s=[],l=0;for(l=0;l<a.length;l++){var u=a[l],c=un(Un.getWest(u)),p=un(Un.getEast(u));Un.crossesAntimeridian(u)?(s.push([c,180]),s.push([-180,p])):s.push([c,p])}s.sort((function(e,t){return e[0]===t[0]?e[1]-t[1]:e[0]-t[0]}));var h=[],d=s[0];for(l=1;l<s.length;){var m=s[l];d[1]>=m[0]?d[1]=Math.max(d[1],m[1]):(h.push(d),d=m),l++}h.push(d);var f=h.length,y=h[0][0]+360-h[f-1][1],g=[h[f-1][1],h[0][0]];for(l=1;l<f;l++){var v=h[l][0]-h[l-1][1];y<v&&(y=v,g=[h[l-1][1],h[l][0]])}return new Un([g[1],o],[g[0],n])},Un.fromPositions=function(e){for(var t,r=NaN,i=NaN,n=NaN,o=NaN,a=e.length,s=new Array(a),l=0;a--;)if((t=e[a])&&2<=t.length){var u=ln(t[1]);r=isNaN(r)?u:Math.max(r,u),i=isNaN(i)?u:Math.min(i,u),s[l++]=un(t[0])}if(l){s.length=l,s.sort((function(e,t){return e-t}));var c=s[0]+360-s[l-1],p=0;for(a=1;a<l;a++){var h=s[a]-s[a-1];c<h&&(c=h,p=a)}n=s[p],o=s[(p||l)-1]}return isNaN(n)||isNaN(i)||isNaN(o)||isNaN(r)?null:new Un([n,i,o,r])},Un.fromLatLngs=function(e){return Un.fromPositions(En.fromLatLngs(e))},Un.fromData=function(e){var t,r=null;if(Array.isArray(e)&&0<e.length){for(var i=0,n=e;i<n.length;i++){var o=n[i];null!=(t=Un.fromData(o))&&(r=null===r?t:Un.merge(r,t))}return r}if(e instanceof Dn)return e.getBounds();if(e&&e.type){var a=e;if(a.bbox&&4===a.bbox.length)return a.bbox;switch(a.type){case"FeatureCollection":return Un.fromData(a.features);case"Feature":return Dn._isCircle(a)?Un.fromPositions(Dn._getCirclePositions(a)):Un.fromData(a.geometry);case"GeometryCollection":return Un.fromData(a.geometries);case"Point":var s=a.coordinates;if(s&&2<=s.length)return[s[0],s[1],s[0],s[1]];break;case"LineString":case"MultiPoint":return Un.fromPositions(a.coordinates);case"Polygon":case"MultiLineString":var l=a.coordinates;if(l&&0<l.length){for(var u=0,c=l.length;u<c;u++)null!=(t=Un.fromPositions(l[u]))&&(r=null===r?t:Un.merge(r,t));if(null!=r)return r}break;case"MultiPolygon":var p=a.coordinates;if(p&&0<p.length){for(u=0,c=p.length;u<c;u++)for(var h=0,d=p[u].length;h<d;h++)null!=(t=Un.fromPositions(p[u][h]))&&(r=null===r?t:Un.merge(r,t));return r}}}return null},Un.splitOnAntimeridian=function(e){var t=[];if(Un.crossesAntimeridian(e)){var r,i=void 0,n=un(Un.getWest(e)),o=un(Un.getEast(e)),a=ln(Un.getNorth(e)),s=ln(Un.getSouth(e));r=6<=e.length?(i=new Un([n,s,e[2],180,a,e[5]]),new Un([-180,s,e[2],o,a,e[5]])):(i=new Un([n,s,180,a]),new Un([-180,s,o,a])),t.push(i,r)}else t.push(new Un(e));return t},Un);function Un(e,t){var r=this;if(e&&t){var i=e;r=i[2]&&t[2]?Fn.call(this,i[0],i[1],i[2]||0,t[0],t[1],t[2]||0)||this:Fn.call(this,i[0],i[1],t[0],t[1])||this}else if(e){var n=e;n&&(4===n.length?r=Fn.call(this,n[0],n[1],n[2],n[3])||this:6<=n.length&&(r=Fn.call(this,n[0],n[1],n[2],n[3],n[4],n[5])||this))}return r}var jn=(Vn.TYPE="FeatureCollection",Vn);function Vn(e,t){this.type="FeatureCollection",this.type=Vn.TYPE,this.features=e,this.bbox=t}var Gn=(Hn.TYPE="GeometryCollection",Hn);function Hn(e){this.type="GeometryCollection",this.type=Hn.TYPE,this.geometries=e}var Zn=(Wn.TYPE="LineString",Wn);function Wn(e,t){this.type="LineString",this.type=Wn.TYPE,this.coordinates=e,this.bbox=t}var Kn=(Xn.TYPE="MultiLineString",Xn);function Xn(e,t){this.type="MultiLineString",this.type=Xn.TYPE,this.coordinates=e,this.bbox=t}var Yn=(Jn.TYPE="MultiPoint",Jn);function Jn(e,t){this.type="MultiPoint",this.type=Jn.TYPE,this.coordinates=e,this.bbox=t}var $n=(Qn.TYPE="MultiPolygon",Qn);function Qn(e,t){this.type="MultiPolygon",this.type=Qn.TYPE,this.coordinates=e,this.bbox=t}var eo,to=Object.freeze({__proto__:null,Feature:gi,FeatureCollection:jn,LineString:Zn,Point:wi,Polygon:Pn,Position:En,BoundingBox:qn,MultiLineString:Kn,MultiPoint:Yn,MultiPolygon:$n,GeometryCollection:Gn}),ro=function(e,t){return Pr(e,5,t="function"==typeof t?t:void 0)},io=(d(no,eo=g),no);function no(){var e=null!==eo&&eo.apply(this,arguments)||this;return e.buffer=128,e.maxZoom=18,e.cluster=!1,e.clusterRadius=50,e.clusterMaxZoom=void 0,e.clusterProperties=void 0,e.lineMetrics=!1,e.tolerance=.375,e}var oo,ao=(d(so,oo=Nn),so.prototype.getId=function(){return this.id},so.prototype._setMap=function(e){if(null==e||void 0===e){var t=this.map;delete this.map,this._invokeEvent("sourceremoved",this),t&&t.events.invoke("sourceremoved",this)}else this.map=e,this._invokeEvent("sourceadded",this),this.map.events.invoke("sourceadded",this)},so);function so(e){var t=oo.call(this)||this;return t.id=e||yi(),t}var lo,uo=(d(co,lo=ao),co.prototype.add=function(e,t){this._addNoUpdate(e,t),this._updateSource()},co.prototype.clear=function(){this._clearNoUpdate(),this._updateSource()},co.prototype.dispose=function(){this.options=null,this.shapes=null,this.shapesMap=null,this.map=null},co.prototype.getClusterExpansionZoom=function(e){var t=this;return new Promise((function(r,i){if(t.map){var n=t.map._getMap().getSource(t.getId());n&&"geojson"===n.type&&n.getClusterExpansionZoom(e,(function(e,t){e?i(e):"number"!=typeof t||r(t)}))}else i("The DataSource hasn't been added to a map.")}))},co.prototype.getClusterChildren=function(e){var t=this;return new Promise((function(r,i){if(t.map){var n=t.map._getMap().getSource(t.getId());n&&"geojson"===n.type&&n.getClusterChildren(e,(function(e,n){e?i(e):n&&r(t.map.sources._mapFeaturesToShapes(n,!1,t))}))}else i("The DataSource hasn't been added to a map.")}))},co.prototype.getClusterLeaves=function(e,t,r){var i=this;return new Promise((function(n,o){if(i.map){var a=i.map._getMap().getSource(i.getId());a&&"geojson"===a.type&&a.getClusterLeaves(e,t,r,(function(e,t){e?o(e):t&&n(i.map.sources._mapFeaturesToShapes(t,!1,i))}))}else o("The DataSource hasn't been added to a map.")}))},co.prototype.getOptions=function(){return Rr(this.options)},co.prototype.getShapes=function(){return Array.from(this.shapes)},co.prototype.importDataFromUrl=function(e){var t=this;return fetch(e,{method:"GET",mode:"cors"}).then((function(e){if(e.ok)return e.json();throw new Error("HTTP "+e.status+": "+e.statusText)})).then((function(e){t.add(e)}))},co.prototype.getShapeById=function(e){return this.shapes[this.shapesMap.get(e)]||null},co.prototype.remove=function(e){for(var t=0,r=Array.isArray(e)?e:[e];t<r.length;t++){var i=r[t];"number"==typeof i?this._removeByIndex(i):this._removeById(i)}this._updateSource()},co.prototype.removeById=function(e){for(var t=0,r=Array.isArray(e)?e:[e];t<r.length;t++){var i=r[t];this._removeById(i)}this._updateSource()},co.prototype.setOptions=function(e){var t=(new io).merge(this.options,Rr(e));mi(this.options,t)||(this._invokeEvent("datasourceupdated",this),this.options=t,this.map&&this.map._rebuildStyle())},co.prototype.setShapes=function(e){this._clearNoUpdate(),this.add(e)},co.prototype.toJson=function(){return new jn(this.shapes.map((function(e){return e.toJson()})))},co.prototype._toJson=function(){return new jn(this.shapes.map((function(e){return e._toJson()})))},co.prototype._buildSource=function(){var e={type:"geojson",data:this._toJson(),maxzoom:this.options.maxZoom,cluster:this.options.cluster,clusterRadius:this.options.clusterRadius,tolerance:this.options.tolerance,lineMetrics:this.options.lineMetrics,clusterProperties:this.options.clusterProperties,buffer:this.options.buffer};return"number"==typeof this.options.clusterMaxZoom&&(e.clusterMaxZoom=this.options.clusterMaxZoom),e},co.prototype._addNoUpdate=function(e,t){var r;if(e instanceof Dn)this._addToSources(e,t),r=[e];else if(Array.isArray(e))r=e.map((function(e){return e instanceof Dn?e:new Dn(e)})),this._addToSources(r,t);else if("FeatureCollection"===e.type)r=e.features.map((function(e){return new Dn(e)})),this._addToSources(r,t);else if("GeometryCollection"===e.type)r=e.geometries.map((function(e){return new Dn(e)})),this._addToSources(r,t);else{var i=new Dn(e);this._addToSources(i,t),r=[i]}this._invokeEvent("dataadded",r)},co.prototype._clearNoUpdate=function(){var e=this.shapes;this.shapes=[],this.shapesMap=new Nr,e&&0<e.length&&this._invokeEvent("dataremoved",e)},co.prototype._updateSource=function(){var e=this;void 0===this.requestId&&(this.requestId=requestAnimationFrame((function(){e._updateMboxSource(),e.requestId=void 0})))},co.prototype._addToSources=function(e,t){if(e=Array.isArray(e)?e:[e],"number"!=typeof t)for(var r=0,i=e;r<i.length;r++){var n=i[r];this.shapes.push(n),this.shapesMap.set(n.getId(),this.shapes.length-1)}else for(var o=e.length-1;0<=o;o--)this.shapes.splice(t,0,e[o]),this._updateShapesMap(t);for(var a=0,s=e;a<s.length;a++)(n=s[a])._setDataSource(this)},co.prototype._removeById=function(e){var t,r=e instanceof Dn?e.getId():"string"==typeof e||"number"==typeof e?e:e.id;(t=this.shapes[this.shapesMap.get(r)])._setDataSource(null),this.shapes.splice(this.shapesMap.get(r),1),this._updateShapesMap(this.shapesMap.get(r)),this.shapesMap.delete(r),this._invokeEvent("dataremoved",[t])},co.prototype._removeByIndex=function(e){var t;if(e>=this.shapes.length)throw new Error("The specified remove index '"+e+"' is greater than the maximum possible index '"+(this.shapes.length-1)+"'");t=this.shapes[e],this.shapesMap.delete(t.getId()),t._setDataSource(null),this.shapes.splice(e,1),this._updateShapesMap(e),this._invokeEvent("dataremoved",[t])},co.prototype._updateShapesMap=function(e){for(var t=e;t<this.shapes.length;t++)this.shapesMap.set(this.shapes[t].getId(),t)},co.prototype._updateMboxSource=function(){if(this.map&&this.map._getMap()){var e=this.map._getMap().getSource(this.getId());e&&"geojson"===e.type&&e.setData(this._toJson())}},co);function co(e,t){var r=lo.call(this,e)||this;return r.requestId=void 0,r.options=(new io).merge(Rr(t)),r.shapes=[],r.shapesMap=new Nr,r}var po,ho=(d(mo,po=g),mo);function mo(){var e=null!==po&&po.apply(this,arguments)||this;return e.bounds=void 0,e.minZoom=0,e.maxZoom=22,e.isTMS=!1,e.tiles=void 0,e.tileSize=512,e.url=void 0,e}var fo,yo=(d(go,fo=ao),go.prototype.getOptions=function(){return Rr(this.options)},go.prototype.getShape=function(e,t){return this.map._getMap().querySourceFeatures(this.getId(),{sourceLayer:e,filter:t})},go.prototype._buildSource=function(){var e={type:"vector"};return this.options.bounds&&(e.bounds=this.options.bounds),this.options.tiles?(e.tiles=this.options.tiles,e.minzoom=this.options.minZoom,e.maxzoom=this.options.maxZoom):this.options.url&&(e.url=this.options.url),this.options.isTMS&&(e.scheme="tms"),this.options.tileSize&&(e.tileSize=this.options.tileSize),e},go);function go(e,t){var r=fo.call(this,e)||this;return r.options=(new ho).merge(Rr(t)),r}var vo,_o=Object.freeze({__proto__:null,Source:ao,DataSource:uo,VectorTileSource:yo}),bo=(d(xo,vo=Nn),xo.prototype.getId=function(){return this.id},xo.prototype.getMap=function(){return this.map||null},xo.prototype.onAdd=function(e){this.map=e,this._invokeEvent("layeradded",this),this.map.events.invoke("layeradded",this)},xo.prototype.onRemove=function(){var e=this.map;delete this.map,this._invokeEvent("layerremoved",this),e&&e.events.invoke("layerremoved",this)},xo._isMBoxEvent=function(e){return!this.LayerEvents.hasOwnProperty(e)},xo.prototype._updateBaseProperties=function(e,t){this._updateFilter(e.filter,t.filter),this._updateZoomRange(e.minZoom,t.minZoom,e.maxZoom,t.maxZoom),this._updateLayoutProperty("visibility",e.visible,t.visible,e.visible?"visible":"none")},xo.prototype._updateFilter=function(e,t){mi(e,t)||this.map._getMap().setFilter(this.id,e)},xo.prototype._updatePaintProperty=function(e,t,r,i){mi(t,r)||this.map._getMap().setPaintProperty(this.id,e,i||t)},xo.prototype._updateLayoutProperty=function(e,t,r,i){mi(t,r)||this.map._getMap().setLayoutProperty(this.id,e,i||t)},xo.prototype._updateZoomRange=function(e,t,r,i){e===t&&i===r||this.map._getMap().setLayerZoomRange(this.id,e,r)},xo.LayerEvents={layeradded:void 0,layerremoved:void 0},xo);function xo(e){var t=vo.call(this)||this;return t.id=e||yi(),t}var wo,So=(d(To,wo=g),To._cloneCustomizer=function(e){if(e instanceof ao)return e},To);function To(){var e=null!==wo&&wo.apply(this,arguments)||this;return e.filter=void 0,e.minZoom=0,e.maxZoom=24,e.visible=!0,e}var Co,Eo=(d(Io,Co=So),Io);function Io(){var e=null!==Co&&Co.apply(this,arguments)||this;return e.source=void 0,e.sourceLayer=void 0,e.color="#1A73AA",e.blur=0,e.opacity=1,e.strokeColor="#FFFFFF",e.strokeOpacity=1,e.strokeWidth=2,e.pitchAlignment="viewport",e.radius=8,e}var Po,Ro=(d(No,Po=bo),No.prototype.getOptions=function(){return ro(this.options,Eo._cloneCustomizer)},No.prototype.getSource=function(){return this.options.source},No.prototype.setOptions=function(e){var t=(new Eo).merge(this.options,ro(e,Eo._cloneCustomizer));if(this.map){if(t.source!==this.options.source||t.sourceLayer!==this.options.sourceLayer)return this.options=t,void this.map.layers.add(this);this._updateBaseProperties(t,this.options),this._updatePaintProperty("circle-blur",t.blur,this.options.blur),this._updatePaintProperty("circle-color",t.color,this.options.color),this._updatePaintProperty("circle-opacity",t.opacity,this.options.opacity),this._updatePaintProperty("circle-radius",t.radius,this.options.radius),this._updatePaintProperty("circle-stroke-color",t.strokeColor,this.options.strokeColor),this._updatePaintProperty("circle-stroke-opacity",t.strokeOpacity,this.options.strokeOpacity),this._updatePaintProperty("circle-stroke-width",t.strokeWidth,this.options.strokeWidth),this._updatePaintProperty("circle-pitch-alignment",t.pitchAlignment,this.options.pitchAlignment)}this.options=t},No.prototype._buildLayers=function(){var e={id:this.id,type:"circle",source:this.options.source instanceof ao?this.options.source.getId():this.options.source,layout:{visibility:this.options.visible?"visible":"none"},paint:{"circle-color":this.options.color,"circle-blur":this.options.blur,"circle-opacity":this.options.opacity,"circle-stroke-color":this.options.strokeColor,"circle-stroke-opacity":this.options.strokeOpacity,"circle-stroke-width":this.options.strokeWidth,"circle-pitch-alignment":this.options.pitchAlignment,"circle-radius":this.options.radius},minzoom:this.options.minZoom,maxzoom:this.options.maxZoom};return this.options.filter&&(e.filter=this.options.filter),this.options.sourceLayer&&(e["source-layer"]=this.options.sourceLayer),[e]},No.prototype._getLayerIds=function(){return[this.id]},No.prototype._getSourceIds=function(){var e=new Set;return this.options.source instanceof ao?e.add(this.options.source.getId()):e.add(this.options.source),e},No);function No(e,t,r){var i=Po.call(this,t)||this;return i.options=(new Eo).merge(ro(r,Eo._cloneCustomizer)),i.options.source=e||i.options.source,i}var Ao,zo=(d(Mo,Ao=So),Mo._cloneCustomizer=function(e){if(e instanceof ao)return e},Mo);function Mo(){var e=null!==Ao&&Ao.apply(this,arguments)||this;return e.source=void 0,e.sourceLayer=void 0,e.color=["interpolate",["linear"],["heatmap-density"],0,"rgba(0,0, 255,0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],e.intensity=1,e.opacity=1,e.radius=30,e.weight=1,e}var ko,Oo=(d(Lo,ko=bo),Lo.prototype.getOptions=function(){return ro(this.options,zo._cloneCustomizer)},Lo.prototype.getSource=function(){return this.options.source},Lo.prototype.setOptions=function(e){var t=(new zo).merge(this.options,ro(e,zo._cloneCustomizer));if(this.map){if(t.source!==this.options.source||t.sourceLayer!==this.options.sourceLayer)return this.options=t,void this.map.layers.add(this);this._updateBaseProperties(t,this.options),this._updatePaintProperty("heatmap-color",t.color,this.options.color),this._updatePaintProperty("heatmap-intensity",t.intensity,this.options.intensity),this._updatePaintProperty("heatmap-opacity",t.opacity,this.options.opacity),this._updatePaintProperty("heatmap-radius",t.radius,this.options.radius),this._updatePaintProperty("heatmap-weight",t.weight,this.options.weight)}this.options=t},Lo.prototype._buildLayers=function(){var e={id:this.id,type:"heatmap",source:this.options.source instanceof ao?this.options.source.getId():this.options.source,layout:{visibility:this.options.visible?"visible":"none"},paint:{"heatmap-color":this.options.color,"heatmap-intensity":this.options.intensity,"heatmap-opacity":this.options.opacity,"heatmap-radius":this.options.radius,"heatmap-weight":this.options.weight},minzoom:this.options.minZoom,maxzoom:this.options.maxZoom};return this.options.filter&&(e.filter=this.options.filter),this.options.sourceLayer&&(e["source-layer"]=this.options.sourceLayer),[e]},Lo.prototype._getLayerIds=function(){return[this.id]},Lo.prototype._getSourceIds=function(){var e=new Set;return this.options.source instanceof ao?e.add(this.options.source.getId()):e.add(this.options.source),e},Lo);function Lo(e,t,r){var i=ko.call(this,t)||this;return i.options=(new zo).merge(ro(r,zo._cloneCustomizer)),i.options.source=e||i.options.source,i}var Do,Bo=(d(Fo,Do=So),Fo);function Fo(){var e=null!==Do&&Do.apply(this,arguments)||this;return e.contrast=0,e.fadeDuration=300,e.hueRotation=0,e.maxBrightness=1,e.minBrightness=0,e.opacity=1,e.saturation=0,e}var qo,Uo=(d(jo,qo=Bo),jo._cloneCustomizer=function(e){if(e instanceof ao)return e},jo);function jo(){var e=null!==qo&&qo.apply(this,arguments)||this;return e.url=void 0,e.coordinates=void 0,e}var Vo,Go=(d(Ho,Vo=bo),Ho.prototype._getSourceIds=function(){var e=new Set;return e.add(this._getSourceId()),e},Ho);function Ho(){return null!==Vo&&Vo.apply(this,arguments)||this}var Zo,Wo=(d(Ko,Zo=Go),Ko.prototype.getOptions=function(){return ro(this.options,Uo._cloneCustomizer)},Ko.prototype.setOptions=function(e){var t=(new Uo).merge(this.options,ro(e,Uo._cloneCustomizer)),r="string"==typeof e.url&&e.url!==this.getOptions().url,i=void 0!==e.coordinates&&e.coordinates!==this.getOptions().coordinates;if(this.map){this._updateBaseProperties(t,this.options),this._updatePaintProperty("raster-contrast",t.contrast,this.options.contrast),this._updatePaintProperty("raster-fade-duration",t.fadeDuration,this.options.fadeDuration),this._updatePaintProperty("raster-hue-rotate",t.hueRotation,this.options.hueRotation),this._updatePaintProperty("raster-brightness-max",t.maxBrightness,this.options.maxBrightness),this._updatePaintProperty("raster-opacity",t.opacity,this.options.opacity),this._updatePaintProperty("raster-saturation",t.saturation,this.options.saturation);var n=this.map._getMap().getSource(this._getSourceId());n&&n.updateImage(t)}this.options=t,r?this.reloadImage():i&&this.updateTransform()},Ko.prototype.getPositions=function(e){return this.transform.then((function(t){return t.toTarget(e)}))},Ko.prototype.getPixels=function(e){return this.transform.then((function(t){return t.toSource(e)}))},Ko.getCoordinatesFromRefPoints=function(e,t,r,i){return new Mn(r,i).toTarget([[0,0],[e,0],[e,t],[0,t]])},Ko.getCoordinatesFromEdges=function(e,t,r,i,n){"number"!=typeof n&&(n=0);var o=[Math.min(i,r),t,Math.max(i,r),e],a=qn.getCenter(o);return cn([qn.getNorthWest(o),qn.getNorthEast(o),qn.getSouthEast(o),qn.getSouthWest(o)],a,n)},Ko.prototype._buildLayers=function(){var e={id:this.id,type:"raster",source:this._getSourceId(),layout:{visibility:this.options.visible?"visible":"none"},paint:{"raster-opacity":this.options.opacity,"raster-hue-rotate":this.options.hueRotation,"raster-brightness-min":this.options.minBrightness,"raster-brightness-max":this.options.maxBrightness,"raster-saturation":this.options.saturation,"raster-contrast":this.options.contrast,"raster-fade-duration":this.options.fadeDuration},minzoom:this.options.minZoom,maxzoom:this.options.maxZoom};return this.options.filter&&(e.filter=this.options.filter),[e]},Ko.prototype._getLayerIds=function(){return[this.id]},Ko.prototype._buildSource=function(){return{type:"image",url:this.options.url,coordinates:this.options.coordinates}},Ko.prototype._getSourceId=function(){return this.getId()+"-ImageSource"},Ko.prototype.reloadImage=function(){var e=this;this.options.url&&(this.transform=new Promise((function(t,r){e.img.onload=function(){var r=[[0,0],[e.img.width,0],[e.img.width,e.img.height],[0,e.img.height]];t(new Mn(r,e.options.coordinates)),e.isLoading=!1},e.img.onerror=e.img.onabort=function(){r("Failed to load image")},e.isLoading=!0,e.img.src=e.options.url})))},Ko.prototype.updateTransform=function(){if(!this.isLoading){var e=[[0,0],[this.img.width,0],[this.img.width,this.img.height],[0,this.img.height]];this.transform=Promise.resolve(new Mn(e,this.options.coordinates))}},Ko);function Ko(e,t){var r=Zo.call(this,t)||this;return r.isLoading=!1,r.options=(new Uo).merge(ro(e,Uo._cloneCustomizer)),r.img=new Image,r.reloadImage(),r}var Xo,Yo=(d(Jo,Xo=So),Jo);function Jo(){var e=null!==Xo&&Xo.apply(this,arguments)||this;return e.source=void 0,e.sourceLayer=void 0,e.lineCap="round",e.lineJoin="round",e.blur=0,e.strokeColor="#1E90FF",e.strokeDashArray=void 0,e.strokeGradient=void 0,e.offset=0,e.strokeOpacity=1,e.translate=new bi(0,0),e.translateAnchor="map",e.strokeWidth=2,e}var $o,Qo=(d(ea,$o=bo),ea.prototype.getOptions=function(){return ro(this.options,Yo._cloneCustomizer)},ea.prototype.getSource=function(){return this.options.source},ea.prototype.setOptions=function(e){var t=(new Yo).merge(this.options,ro(e,Yo._cloneCustomizer));if(this.map){if(t.source!==this.options.source||t.sourceLayer!==this.options.sourceLayer)return this.options=t,void this.map.layers.add(this);this._updateBaseProperties(t,this.options),this._updatePaintProperty("line-blur",t.blur,this.options.blur),this._updateLayoutProperty("line-cap",t.lineCap,this.options.lineCap),this._updateLayoutProperty("line-join",t.lineJoin,this.options.lineJoin),this._updatePaintProperty("line-offset",t.offset,this.options.offset),this._updatePaintProperty("line-color",t.strokeColor,this.options.strokeColor),this._updatePaintProperty("line-dasharray",t.strokeDashArray,this.options.strokeDashArray),this._updatePaintProperty("line-gradient",t.strokeGradient,this.options.strokeGradient),this._updatePaintProperty("line-opacity",t.strokeOpacity,this.options.strokeOpacity),this._updatePaintProperty("line-width",t.strokeWidth,this.options.strokeWidth),this._updatePaintProperty("line-translate",t.translate,this.options.translate),this._updatePaintProperty("line-translate-anchor",t.translateAnchor,this.options.translateAnchor)}this.options=t},ea.prototype._buildLayers=function(){return[m(m(m(m({id:this.id,type:"line"},this.options.sourceLayer&&{"source-layer":this.options.sourceLayer}),{source:this.options.source instanceof ao?this.options.source.getId():this.options.source,layout:{visibility:this.options.visible?"visible":"none","line-cap":this.options.lineCap,"line-join":this.options.lineJoin},paint:m(m(m({"line-blur":this.options.blur,"line-color":this.options.strokeColor},this.options.strokeDashArray&&{"line-dasharray":this.options.strokeDashArray}),this.options.strokeGradient&&{"line-gradient":this.options.strokeGradient}),{"line-offset":this.options.offset,"line-opacity":this.options.strokeOpacity,"line-translate":this.options.translate,"line-translate-anchor":this.options.translateAnchor,"line-width":this.options.strokeWidth})}),this.options.filter&&{filter:this.options.filter}),{minzoom:this.options.minZoom,maxzoom:this.options.maxZoom})]},ea.prototype._getLayerIds=function(){return[this.id]},ea.prototype._getSourceIds=function(){var e=new Set;return this.options.source instanceof ao?e.add(this.options.source.getId()):e.add(this.options.source),e},ea);function ea(e,t,r){var i=$o.call(this,t)||this;return i.options=(new Yo).merge(ro(r,Yo._cloneCustomizer)),i.options.source=e||i.options.source,i}var ta,ra=(d(ia,ta=So),ia);function ia(){var e=null!==ta&&ta.apply(this,arguments)||this;return e.source=void 0,e.sourceLayer=void 0,e.base=0,e.fillColor="#1E90FF",e.height=0,e.fillOpacity=1,e.fillPattern=void 0,e.translate=new bi(0,0),e.translateAnchor="map",e.verticalGradient=!0,e}var na,oa=(d(aa,na=bo),aa.prototype.getOptions=function(){return ro(this.options,ra._cloneCustomizer)},aa.prototype.getSource=function(){return this.options.source},aa.prototype.setOptions=function(e){var t=(new ra).merge(this.options,ro(e,ra._cloneCustomizer));if(this.map){if(t.source!==this.options.source||t.sourceLayer!==this.options.sourceLayer)return this.options=t,void this.map.layers.add(this);this._updateBaseProperties(t,this.options),this._updatePaintProperty("fill-extrusion-base",t.base,this.options.base),this._updatePaintProperty("fill-extrusion-color",t.fillColor,this.options.fillColor),this._updatePaintProperty("fill-extrusion-height",t.height,this.options.height),this._updatePaintProperty("fill-extrusion-opacity",t.fillOpacity,this.options.fillOpacity),this._updatePaintProperty("fill-extrusion-pattern",t.fillPattern,this.options.fillPattern),this._updatePaintProperty("fill-extrusion-translate",t.translate,this.options.translate),this._updatePaintProperty("fill-extrusion-translate-anchor",t.translateAnchor,this.options.translateAnchor),this._updatePaintProperty("fill-extrusion-vertical-gradient",t.verticalGradient,this.options.verticalGradient)}this.options=t},aa.prototype._buildLayers=function(){return[m(m(m(m({id:this.id,type:"fill-extrusion"},this.options.sourceLayer&&{"source-layer":this.options.sourceLayer}),{source:this.options.source instanceof ao?this.options.source.getId():this.options.source,layout:{visibility:this.options.visible?"visible":"none"},paint:m(m({"fill-extrusion-base":this.options.base,"fill-extrusion-height":this.options.height,"fill-extrusion-opacity":this.options.fillOpacity},this.options.fillPattern?{"fill-extrusion-pattern":this.options.fillPattern}:{"fill-extrusion-color":this.options.fillColor}),{"fill-extrusion-translate":this.options.translate,"fill-extrusion-translate-anchor":this.options.translateAnchor,"fill-extrusion-vertical-gradient":this.options.verticalGradient})}),this.options.filter&&{filter:this.options.filter}),{minzoom:this.options.minZoom,maxzoom:this.options.maxZoom})]},aa.prototype._getLayerIds=function(){return[this.id]},aa.prototype._getSourceIds=function(){var e=new Set;return this.options.source instanceof ao?e.add(this.options.source.getId()):e.add(this.options.source),e},aa);function aa(e,t,r){var i=na.call(this,t)||this;return i.options=(new ra).merge(ro(r,ra._cloneCustomizer)),i.options.source=e||i.options.source,i}var sa,la=(d(ua,sa=So),ua.prototype.merge=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var r=!1,i=!1,n=0,o=e;n<o.length;n++){var a=o[n];a&&(a.hasOwnProperty("fillColor")?i=!(r=!0):a.hasOwnProperty("fillPattern")&&(r=!(i=!0)))}var s=sa.prototype.merge.apply(this,e);return r?s.fillPattern=void 0:i&&(s.fillColor=void 0),s},ua);function ua(){var e=null!==sa&&sa.apply(this,arguments)||this;return e.source=void 0,e.sourceLayer=void 0,e.fillColor="#1E90FF",e.fillOpacity=.5,e.fillPattern=void 0,e}var ca,pa=(d(ha,ca=bo),ha.prototype.getOptions=function(){return ro(this.options,la._cloneCustomizer)},ha.prototype.getSource=function(){return this.options.source},ha.prototype.setOptions=function(e){var t=(new la).merge(this.options,ro(e,la._cloneCustomizer));if(this.map){if(t.source!==this.options.source||t.sourceLayer!==this.options.sourceLayer)return this.options=t,void this.map.layers.add(this);this._updateBaseProperties(t,this.options),this._updatePaintProperty("fill-color",t.fillColor,this.options.fillColor),this._updatePaintProperty("fill-opacity",t.fillOpacity,this.options.fillOpacity),this._updatePaintProperty("fill-pattern",t.fillPattern,this.options.fillPattern)}this.options=t},ha.prototype._buildLayers=function(){var e={id:this.id,type:"fill",source:this.options.source instanceof ao?this.options.source.getId():this.options.source,layout:{visibility:this.options.visible?"visible":"none"},paint:{"fill-opacity":this.options.fillOpacity},minzoom:this.options.minZoom,maxzoom:this.options.maxZoom};return this.options.filter&&(e.filter=this.options.filter),this.options.sourceLayer&&(e["source-layer"]=this.options.sourceLayer),this.options.fillPattern?e.paint["fill-pattern"]=this.options.fillPattern:e.paint["fill-color"]=this.options.fillColor,[e]},ha.prototype._getLayerIds=function(){return[this.id]},ha.prototype._getSourceIds=function(){var e=new Set;return this.options.source instanceof ao?e.add(this.options.source.getId()):e.add(this.options.source),e},ha);function ha(e,t,r){var i=ca.call(this,t)||this;return i.options=(new la).merge(ro(r,la._cloneCustomizer)),i.options.source=e||i.options.source,i}var da,ma=(d(fa,da=g),fa);function fa(){var e=null!==da&&da.apply(this,arguments)||this;return e.allowOverlap=!1,e.anchor="bottom",e.ignorePlacement=!1,e.image="marker-blue",e.offset=new bi(0,0),e.optional=!1,e.pitchAlignment="auto",e.rotation=0,e.rotationAlignment="auto",e.size=1,e.opacity=1,e}var ya,ga=(d(va,ya=g),va);function va(){var e=null!==ya&&ya.apply(this,arguments)||this;return e.allowOverlap=!1,e.anchor="center",e.textField=void 0,e.font=["StandardFont-Regular"],e.ignorePlacement=!1,e.offset=new bi(0,0),e.optional=!1,e.pitchAlignment="auto",e.rotation=0,e.rotationAlignment="auto",e.size=16,e.color="#000000",e.haloBlur=0,e.haloColor="rgba(0,0,0,0)",e.haloWidth=0,e.opacity=1,e}var _a,ba=(d(xa,_a=So),xa);function xa(){var e=null!==_a&&_a.apply(this,arguments)||this;return e.source=void 0,e.sourceLayer=void 0,e.iconOptions=new ma,e.textOptions=new ga,e.placement="point",e.lineSpacing=250,e}var wa,Sa=(d(Ta,wa=bo),Ta.prototype.getOptions=function(){return ro(this.options,ba._cloneCustomizer)},Ta.prototype.getSource=function(){return this.options.source},Ta.prototype.setOptions=function(e){var t=(new ba).merge(this.options,ro(e,ba._cloneCustomizer));if(this.map){if(t.source!==this.options.source||t.sourceLayer!==this.options.sourceLayer)return this.options=t,void this.map.layers.add(this);this._updateBaseProperties(t,this.options),this._updateLayoutProperty("symbol-spacing",t.lineSpacing,this.options.lineSpacing),this._updateLayoutProperty("symbol-placement",t.placement,this.options.placement),this._updateLayoutProperty("icon-allow-overlap",t.iconOptions.allowOverlap,this.options.iconOptions.allowOverlap),this._updateLayoutProperty("icon-anchor",t.iconOptions.anchor,this.options.iconOptions.anchor),this._updateLayoutProperty("icon-ignore-placement",t.iconOptions.ignorePlacement,this.options.iconOptions.ignorePlacement),this._updateLayoutProperty("icon-image",t.iconOptions.image,this.options.iconOptions.image),this._updateLayoutProperty("icon-offset",t.iconOptions.offset,this.options.iconOptions.offset),this._updatePaintProperty("icon-opacity",t.iconOptions.opacity,this.options.iconOptions.opacity),this._updateLayoutProperty("icon-optional",t.iconOptions.optional,this.options.iconOptions.optional),this._updateLayoutProperty("icon-pitch-alignment",t.iconOptions.pitchAlignment,this.options.iconOptions.pitchAlignment),this._updateLayoutProperty("icon-rotate",t.iconOptions.rotation,this.options.iconOptions.rotation),this._updateLayoutProperty("icon-rotation-alignment",t.iconOptions.rotationAlignment,this.options.iconOptions.rotationAlignment),this._updateLayoutProperty("icon-size",t.iconOptions.size,this.options.iconOptions.size),this._updateLayoutProperty("text-allow-overlap",t.textOptions.allowOverlap,this.options.textOptions.allowOverlap),this._updateLayoutProperty("text-anchor",t.textOptions.anchor,this.options.textOptions.anchor),this._updatePaintProperty("text-color",t.textOptions.color,this.options.textOptions.color),this._updateLayoutProperty("text-font",t.textOptions.font,this.options.textOptions.font),this._updateLayoutProperty("text-ignore-placement",t.textOptions.ignorePlacement,this.options.textOptions.ignorePlacement),this._updatePaintProperty("text-halo-blur",t.textOptions.haloBlur,this.options.textOptions.haloBlur),this._updatePaintProperty("text-halo-color",t.textOptions.haloColor,this.options.textOptions.haloColor),this._updatePaintProperty("text-halo-width",t.textOptions.haloWidth,this.options.textOptions.haloWidth),this._updateLayoutProperty("text-offset",t.textOptions.offset,this.options.textOptions.offset),this._updatePaintProperty("text-opacity",t.textOptions.opacity,this.options.textOptions.opacity),this._updateLayoutProperty("text-optional",t.textOptions.optional,this.options.textOptions.optional),this._updateLayoutProperty("text-pitch-alignment",t.textOptions.pitchAlignment,this.options.textOptions.pitchAlignment),this._updateLayoutProperty("text-rotate",t.textOptions.rotation,this.options.textOptions.rotation),this._updateLayoutProperty("text-rotation-alignment",t.textOptions.rotationAlignment,this.options.textOptions.rotationAlignment),this._updateLayoutProperty("text-size",t.textOptions.size,this.options.textOptions.size),this._updateLayoutProperty("text-field",t.textOptions.textField,this.options.textOptions.textField)}this.options=t},Ta.prototype._buildLayers=function(){return[m(m(m(m({id:this.id,type:"symbol"},this.options.sourceLayer&&{"source-layer":this.options.sourceLayer}),{source:this.options.source instanceof ao?this.options.source.getId():this.options.source,layout:m(m({visibility:this.options.visible?"visible":"none","symbol-placement":this.options.placement,"symbol-spacing":this.options.lineSpacing,"text-allow-overlap":this.options.textOptions.allowOverlap,"text-anchor":this.options.textOptions.anchor},this.options.textOptions.textField&&{"text-field":this.options.textOptions.textField}),{"text-font":this.options.textOptions.font,"text-ignore-placement":this.options.textOptions.ignorePlacement,"text-offset":this.options.textOptions.offset,"text-optional":this.options.textOptions.optional,"text-pitch-alignment":this.options.textOptions.pitchAlignment,"text-rotate":this.options.textOptions.rotation,"text-rotation-alignment":this.options.textOptions.rotationAlignment,"text-size":this.options.textOptions.size,"icon-allow-overlap":this.options.iconOptions.allowOverlap,"icon-anchor":this.options.iconOptions.anchor,"icon-ignore-placement":this.options.iconOptions.ignorePlacement,"icon-image":this.options.iconOptions.image,"icon-offset":this.options.iconOptions.offset,"icon-optional":this.options.iconOptions.optional,"icon-pitch-alignment":this.options.iconOptions.pitchAlignment,"icon-rotate":this.options.iconOptions.rotation,"icon-rotation-alignment":this.options.iconOptions.rotationAlignment,"icon-size":this.options.iconOptions.size}),paint:{"text-color":this.options.textOptions.color,"text-halo-blur":this.options.textOptions.haloBlur,"text-halo-color":this.options.textOptions.haloColor,"text-halo-width":this.options.textOptions.haloWidth,"text-opacity":this.options.textOptions.opacity,"icon-opacity":this.options.iconOptions.opacity}}),this.options.filter&&{filter:this.options.filter}),{minzoom:this.options.minZoom,maxzoom:this.options.maxZoom})]},Ta.prototype._getLayerIds=function(){return[this.id]},Ta.prototype._getSourceIds=function(){var e=new Set;return this.options.source instanceof ao?e.add(this.options.source.getId()):e.add(this.options.source),e},Ta);function Ta(e,t,r){var i=wa.call(this,t)||this;return i.options=(new ba).merge(ro(r,ba._cloneCustomizer)),i.options.source=e||i.options.source,i}var Ca,Ea=(d(Ia,Ca=Bo),Ia);function Ia(){var e=null!==Ca&&Ca.apply(this,arguments)||this;return e.bounds=[-180,-85.0511,180,85.0511],e.minSourceZoom=0,e.maxSourceZoom=22,e.tileSize=512,e.isTMS=!1,e.subdomains=void 0,e.tileUrl=void 0,e}var Pa,Ra=(d(Na,Pa=Go),Na.prototype.getOptions=function(){return ro(this.options,Ea._cloneCustomizer)},Na.prototype.setOptions=function(e){var t=(new Ea).merge(this.options,ro(e,Ea._cloneCustomizer));if(this.map){if(!mi(t.bounds,this.options.bounds)||t.isTMS!==this.options.isTMS||t.maxSourceZoom!==this.options.maxSourceZoom||t.minSourceZoom!==this.options.minSourceZoom||!mi(t.subdomains,this.options.subdomains)||t.tileSize!==this.options.tileSize||t.tileUrl!==this.options.tileUrl)return this.options=t,void this.map.layers.add(this);this._updateBaseProperties(t,this.options),this._updatePaintProperty("raster-contrast",t.contrast,this.options.contrast),this._updatePaintProperty("raster-fade-duration",t.fadeDuration,this.options.fadeDuration),this._updatePaintProperty("raster-hue-rotate",t.hueRotation,this.options.hueRotation),this._updatePaintProperty("raster-brightness-max",t.maxBrightness,this.options.maxBrightness),this._updatePaintProperty("raster-opacity",t.opacity,this.options.opacity),this._updatePaintProperty("raster-saturation",t.saturation,this.options.saturation)}this.options=t},Na.prototype._setOptionsNoUpdate=function(e){this.options=(new Ea).merge(this.options,ro(e,Ea._cloneCustomizer))},Na.prototype._buildLayers=function(){return[m(m({id:this.id,type:"raster",source:this._getSourceId(),layout:{visibility:this.options.visible?"visible":"none"},paint:{"raster-contrast":this.options.contrast,"raster-fade-duration":this.options.fadeDuration,"raster-hue-rotate":this.options.hueRotation,"raster-brightness-max":this.options.maxBrightness,"raster-brightness-min":this.options.minBrightness,"raster-opacity":this.options.opacity,"raster-saturation":this.options.saturation}},this.options.filter&&{filter:this.options.filter}),{minzoom:this.options.minZoom,maxzoom:this.options.maxZoom})]},Na.prototype._getLayerIds=function(){return[this.id]},Na.prototype._buildSource=function(){var e;if(this.options.tileUrl){if(-1===this.options.tileUrl.indexOf("{"))return{type:"raster",url:this.options.tileUrl};if(-1!==this.options.tileUrl.indexOf("{subdomain}")){if(!(this.options.subdomains&&0<this.options.subdomains.length))throw new Error("The {subdomain} placeholder was included in the tileUrl but no subdomains were specified");for(var t=[],r=0,i=this.options.subdomains;r<i.length;r++){var n=i[r];t.push(this.options.tileUrl.replace(/{subdomain}/g,n))}e=t}else e=[this.options.tileUrl]}return m({type:"raster",bounds:this.options.bounds,maxzoom:this.options.maxSourceZoom,minzoom:this.options.minSourceZoom,scheme:this.options.isTMS?"tms":"xyz",tileSize:this.options.tileSize},e&&{tiles:e})},Na.prototype._getSourceId=function(){return this.getId()+"-RasterSource"},Na);function Na(e,t){var r=Pa.call(this,t)||this;return e&&r.setOptions(e),r}var Aa=Object.freeze({__proto__:null,BubbleLayer:Ro,Layer:bo,LineLayer:Qo,PolygonExtrusionLayer:oa,PolygonLayer:pa,SymbolLayer:Sa,TileLayer:Ra,HeatMapLayer:Oo,ImageLayer:Wo}),za=(Ma.convertHtmlString=function(e){if("string"!=typeof e)return e;var t=document.createElement("div");return t.innerHTML=e,t},Ma);function Ma(){}var ka,Oa=Function.prototype,La=Object.prototype,Da=Oa.toString,Ba=La.hasOwnProperty,Fa=Da.call(Object),qa=function(e){if(!nt(e)||"[object Object]"!=Ie(e))return!1;var t=Ut(e);if(null===t)return!0;var r=Ba.call(t,"constructor")&&t.constructor;return"function"==typeof r&&r instanceof r&&Da.call(r)==Fa},Ua=function(e){return nt(e)&&1===e.nodeType&&!qa(e)},ja=(d(Va,ka=g),Va._cloneCustomizer=function(e){if(Ua(e))return e},Va);function Va(){var e=null!==ka&&ka.apply(this,arguments)||this;return e.anchor="none",e.draggable=!1,e.closeButton=!0,e.content=document.createElement("span"),e.fillColor="#FFFFFF",e.pixelOffset=new bi(0,0),e.position=new En(0,0),e.showPointer=!0,e}var Ga,Ha=(d(Za,Ga=Nn),Za.prototype.setPopupOptions=function(e){this.setOptions(e)},Za.prototype.setOptions=function(e){var t=(new ja).merge(this.options,ro(e,ja._cloneCustomizer));t.content!==this.options.content?(this.htmlContent.remove(),this.htmlContent=this._createHtmlContent(t),this.contentDiv.prepend(this.htmlContent)):t.draggable!==this.options.draggable&&this._setDraggable(this.htmlContent,t.draggable),t.closeButton&&!this.closeBtn?(this.closeBtn=this._createCloseButton(),this.contentDiv.appendChild(this.closeBtn)):!t.closeButton&&this.closeBtn&&(this.contentDiv.removeChild(this.closeBtn),delete this.closeBtn),t.showPointer&&!this.arrowDiv?(this.arrowDiv=this._createArrowDiv(),this.containerDiv.appendChild(this.arrowDiv)):!t.showPointer&&this.arrowDiv&&(this.containerDiv.removeChild(this.arrowDiv),delete this.arrowDiv),t.fillColor!==this.options.fillColor&&(this.containerDiv.style.borderColor=t.fillColor,this.contentDiv.style.backgroundColor=t.fillColor),this.marker&&(t.anchor!==this.options.anchor?"none"===this.options.anchor?(this.autoAnchor!==t.anchor&&this._replaceMarker(this.map,t),this.map.events.remove("move",this._onMove),delete this.autoAnchor):(this._replaceMarker(this.map,t),"none"===t.anchor&&this.map.events.add("move",this._onMove)):(mi(t.position,this.options.position)||this.marker.setLngLat(t.position),mi(t.pixelOffset,this.options.pixelOffset)||this.marker.setOffset(t.pixelOffset))),this.options=t},Za.prototype.getPopupOptions=function(){return this.getOptions()},Za.prototype.getOptions=function(){return ro(this.options,ja._cloneCustomizer)},Za.prototype._dragToPixel=function(e){this.dragging||(this.dragging=!0,this.contentDiv.style.pointerEvents="none",this._invokeEvent("dragstart",{type:"dragstart",target:this}));var t=[e[0]+this.dragOffset[0],e[1]+this.dragOffset[1]],r=this.map.pixelsToPositions([t])[0];this.options.position=r,this.marker.setLngLat(this.options.position),this._invokeEvent("drag",{type:"drag",target:this})},Za.prototype._onUp=function(){this.dragging&&(this.contentDiv.style.pointerEvents="",this._invokeEvent("dragend",{type:"dragend",target:this}),"none"===this.options.anchor&&this._onMove()),delete this.dragOffset,delete this.dragging},Za.prototype._createContainerDiv=function(e){var t=this,r=document.createElement("div");r.classList.add(Za.Css.container),r.classList.add(Za.Css.hidden),r.style.borderColor=e.fillColor,r.setAttribute("role","dialog"),r.setAttribute("aria-label","Map Information Window");var i=!1;return r.addEventListener("keydown",(function(e){"Tab"!==e.key&&"Escape"!==e.key&&"Esc"!==e.key||(i=!0)})),r.addEventListener("keyup",(function(e){"Tab"!==e.key&&"Escape"!==e.key&&"Esc"!==e.key||(i=!1)})),r.addEventListener("focusin",(function(e){t.map&&!t.isOpen()&&(t.open(t.map),e.target instanceof HTMLElement&&e.target.focus())})),r.addEventListener("focusout",(function(e){i&&e.relatedTarget instanceof Node&&!r.contains(e.relatedTarget)&&(i=!1,t.isOpen()&&t.close())})),r},Za.prototype._createContentDiv=function(e){var t=document.createElement("div");return t.classList.add(Za.Css.content),t.style.backgroundColor=e.fillColor,t.setAttribute("tabindex","0"),this.htmlContent=this._createHtmlContent(e),t.appendChild(this.htmlContent),t},Za.prototype._createArrowDiv=function(){var e=document.createElement("div");return e.classList.add(Za.Css.arrow),e},Za.prototype._createCloseButton=function(){var e=document.createElement("button");return e.addEventListener("click",this.close),e.classList.add(Za.Css.close),e.setAttribute("aria-label","close"),e.setAttribute("title","close"),e.setAttribute("tabindex","0"),e.innerHTML="&times;",e},Za.prototype._createHtmlContent=function(e){var t=za.convertHtmlString(e.content);return e.draggable&&this._setDraggable(t,e.draggable),t},Za.prototype._createMarker=function(e,t){var r=this.marker?this.marker.getLngLat():e.position;return"none"===e.anchor?(this.autoAnchor=t||"bottom",this.containerDiv.classList.add(this.autoAnchor),new a({anchor:this.autoAnchor,element:this.containerDiv,offset:e.pixelOffset}).setLngLat(r)):(this.containerDiv.classList.add(e.anchor),new a({anchor:e.anchor,element:this.containerDiv,offset:e.pixelOffset}).setLngLat(r))},Za.prototype._getAutoAnchor=function(e,t){var r,i,n=this.containerDiv.offsetWidth,o=this.containerDiv.offsetHeight;if(this.marker){var a=e._getMap().project(this.marker.getLngLat());r=a.x,i=a.y}else{var s=e.positionsToPixels([t.position])[0];r=s[0],i=s[1]}var l=[];return i<o?l.push("top"):i>e.getCanvas().offsetHeight-o&&l.push("bottom"),r<n/2?l.push("left"):r>e.getCanvas().offsetWidth-n/2&&l.push("right"),0<l.length?l.join("-"):"bottom"},Za.prototype._replaceMarker=function(e,t,r){var i=this.containerDiv.nextElementSibling;this.marker.remove(),this.containerDiv.classList.remove(this.autoAnchor||this.options.anchor),this.marker=this._createMarker(t,r),this.marker.addTo(e._getMap()),e.popups._getCollectionDiv().insertBefore(this.containerDiv,i||null)},Za.prototype._setDraggable=function(e,t){t?(e.addEventListener("mousedown",this._onDown),e.addEventListener("touchstart",this._onDown),e.addEventListener("dragstart",this._onDragStart)):(e.removeEventListener("mousedown",this._onDown),e.removeEventListener("touchstart",this._onDown),e.removeEventListener("dragstart",this._onDragStart))},Za.Css={arrow:"popup-arrow",close:"popup-close",container:"popup-container",content:"popup-content-container",hidden:"hidden-accessible-element"},Za);function Za(e){var t=Ga.call(this)||this;return t.attach=function(e){t.map!==e&&(t.map&&t.remove(),t.map=e,t.marker=t._createMarker(t.options),t.marker.addTo(t.map._getMap()),t.map.popups._getCollectionDiv().appendChild(t.containerDiv),t.map.popups.add(t))},t.open=function(e){if(!e&&!t.map)throw new Error("Must specify a map to open on or attach to a map in advance");t.attach(e||t.map),t.containerDiv.classList.remove(Za.Css.hidden),t.map.events.add("move",t._onMove),t._onMove(),t._invokeEvent("open",{target:t,type:"open"})},t.close=function(){t.map&&t.map.events.remove("move",t._onMove),t.containerDiv.classList.add(Za.Css.hidden),t._invokeEvent("close",{target:t,type:"close"})},t.remove=function(){t.map&&(t.marker.remove(),t.containerDiv.classList.remove(t.autoAnchor||t.options.anchor),t.map.events.remove("move",t._onMove),t.map.popups.remove(t),delete t.map,delete t.marker,delete t.autoAnchor)},t.isOpen=function(){return t.map&&!t.containerDiv.classList.contains(Za.Css.hidden)},t._onMove=function(){var e=t._getAutoAnchor(t.map,t.options);e!==t.autoAnchor&&(t._replaceMarker(t.map,t.options,e),t.map.events.add("move",t._onMove))},t._onDown=function(e){t.map.popups._addDraggedPopup(t);var r=t.map.positionsToPixels([t.options.position])[0];"mousedown"===e.type?(e=e,t.dragOffset=[r[0]-e.clientX,r[1]-e.clientY]):"touchstart"===e.type&&(e=e,t.dragOffset=[r[0]-e.touches[0].clientX,r[1]-e.touches[0].clientY])},t._onDragStart=function(e){e.preventDefault()},t.options=(new ja).merge(ro(e,ja._cloneCustomizer)),t.containerDiv=t._createContainerDiv(t.options),t.contentDiv=t._createContentDiv(t.options),t.containerDiv.appendChild(t.contentDiv),t.options.showPointer&&(t.arrowDiv=t._createArrowDiv(),t.containerDiv.appendChild(t.arrowDiv)),t.options.closeButton&&(t.closeBtn=t._createCloseButton(),t.contentDiv.appendChild(t.closeBtn)),t}var Wa,Ka=(d(Xa,Wa=g),Xa._cloneCustomizer=function(e){if(e instanceof Ha||Ua(e))return e},Xa);function Xa(){var e=null!==Wa&&Wa.apply(this,arguments)||this;return e.anchor="bottom",e.color="#1A73AA",e.draggable=!1,e.htmlContent='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24.5 36.5" id="marker_'+yi()+'" width="24.5" height="36.5" display="block"><path d="M12.25.25a12.2543,12.2543,0,0,0-12,12.4937c0,6.4436,6.4879,12.1093,11.059,22.5641.5493,1.2563,1.3327,1.2563,1.882,0C17.7621,24.8529,24.25,19.1857,24.25,12.7437A12.2543,12.2543,0,0,0,12.25.25Z"   fill="{color}" stroke="{secondaryColor}" stroke-width="0.5"/><text style="font-family: Arial, Helvetica, sans-serif; font-size: 14px; fill: white;" text-anchor="middle" x="12" y="18">{text}</text></svg>',e.pixelOffset=new bi(0,0),e.position=new En(0,0),e.popup=void 0,e.secondaryColor="white",e.text=void 0,e.visible=!0,e}var Ya,Ja=(d($a,Ya=Nn),$a.prototype.getOptions=function(){return ro(this.options,Ka._cloneCustomizer)},$a.prototype.setOptions=function(e){var t=(new Ka).merge(this.options,ro(e,Ka._cloneCustomizer));mi(t.htmlContent,this.options.htmlContent)&&t.anchor===this.options.anchor?("string"!=typeof t.htmlContent||t.color===this.options.color&&t.text===this.options.text&&t.secondaryColor===this.options.secondaryColor||(this.element.innerHTML=this._getSubbedHtmlString(t)),t.draggable!==this.options.draggable&&(this._setDraggable(t.draggable),this.marker.setDraggable(t.draggable)),mi(t.pixelOffset,this.options.pixelOffset)||this.marker.setOffset(t.pixelOffset),mi(t.position,this.options.position)||this.marker.setLngLat(t.position),t.visible!==this.options.visible&&(t.visible?this.element.classList.remove($a.hiddenClass):this.element.classList.add($a.hiddenClass))):(this.marker.remove(),this._buildMarker(t),this.map&&(this.marker.addTo(this.map._getMap()),this._getCollectionContainer().appendChild(this.element))),this.options=t},$a.prototype.togglePopup=function(){if(this.options.popup)if(this.options.popup.isOpen())this.options.popup.close();else{if(!this.map)throw new Error("The marker must be added to a map before calling togglePopup().");this.options.popup.setOptions({position:this.options.position}),this.options.popup.open(this.map)}},$a.prototype._addToMap=function(e,t){this.map&&this.map!==e&&this._removeFromMap(),t&&(this.options.position=Rr(t),this.marker.setLngLat(this.options.position)),this.map!==e&&(this.map=e,this.marker.addTo(e._getMap()),this._getCollectionContainer().appendChild(this.element))},$a.prototype._removeFromMap=function(){this.map&&(this.marker.remove(),delete this.map)},$a.prototype._getId=function(){if(this.element)return"string"==typeof this.options.htmlContent?this.element.firstChild.id:this.element.id},$a.prototype._buildMarker=function(e){if("string"==typeof e.htmlContent){var t=this._getSubbedHtmlString(e);this.element=za.convertHtmlString(t)}else this.element=e.htmlContent;this.element.classList.add($a.containerClass),e.draggable&&this._setDraggable(!0),e.visible||this.element.classList.add($a.hiddenClass),this.marker=new a({element:this.element,offset:e.pixelOffset,draggable:e.draggable,anchor:e.anchor}).setLngLat(e.position),this.marker.on("drag",this._onDrag),this.marker.on("dragstart",this._onDragStart),this.marker.on("dragend",this._onDragEnd),this.element.addEventListener("click",this._bubbleElementEvent),this.element.addEventListener("dblclick",this._bubbleElementEvent),this.element.addEventListener("contextmenu",this._bubbleElementEvent),this.element.addEventListener("keydown",this._bubbleElementEvent),this.element.addEventListener("keypress",this._bubbleElementEvent),this.element.addEventListener("keyup",this._bubbleElementEvent),this.element.addEventListener("mousedown",this._bubbleElementEvent),this.element.addEventListener("mouseenter",this._bubbleElementEvent),this.element.addEventListener("mouseleave",this._bubbleElementEvent),this.element.addEventListener("mousemove",this._bubbleElementEvent),this.element.addEventListener("mouseout",this._bubbleElementEvent),this.element.addEventListener("mouseover",this._bubbleElementEvent),this.element.addEventListener("mouseup",this._bubbleElementEvent)},$a.prototype._getSubbedHtmlString=function(e){if("string"==typeof e.htmlContent)return e.htmlContent.replace(/{color}/gi,e.color||"").replace(/{secondaryColor}/gi,e.secondaryColor||"").replace(/{text}/gi,e.text||"")},$a.prototype._getCollectionContainer=function(){var e=this.map.getCanvasContainer().querySelector("."+$a.collectionContainerClass);return e||((e=document.createElement("div")).classList.add($a.collectionContainerClass),this.map.getCanvasContainer().appendChild(e)),e},$a.prototype._setDraggable=function(e){e?this.element.addEventListener("dragstart",this._onEleDragStart):this.element.removeEventListener("dragstart",this._onEleDragStart)},$a.collectionContainerClass="marker-collection-container",$a.hiddenClass="hidden-accessible-element",$a.containerClass="marker-container",$a);function $a(e){var t=Ya.call(this)||this;return t._onDrag=function(){var e=t.marker.getLngLat().wrap();t.options.position=new En(e.lng,e.lat),t._invokeEvent("drag",{type:"drag",target:t})},t._onDragStart=function(){t._invokeEvent("dragstart",{type:"dragstart",target:t})},t._onDragEnd=function(){t._invokeEvent("dragend",{type:"dragend",target:t})},t._bubbleElementEvent=function(e){t._invokeEvent(e.type,{type:e.type,target:t})},t._onEleDragStart=function(e){e.preventDefault()},t.options=(new Ka).merge(ro(e,Ka._cloneCustomizer)),t._buildMarker(t.options),t}var Qa=function(e,t,r){(void 0===r||ue(e[t],r))&&(void 0!==r||t in e)||et(e,t,r)},es=function(e,t,r){for(var i=-1,n=Object(e),o=r(e),a=o.length;a--;){var s=o[++i];if(!1===t(n[s],s,n))break}return e},ts=function(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]},rs=function(e,t,r,i,n,o,a){var s=ts(e,r),l=ts(t,r),u=a.get(l);if(u)Qa(e,r,u);else{var c=o?o(s,l,r+"",e,t,a):void 0,p=void 0===c;if(p){var h=ct(l),d=!h&&ht(l),m=!h&&!d&&bt(l);c=l,h||d||m?c=ct(s)?s:function(e){return nt(e)&&Rt(e)}(s)?Ot(s):d?kt(l,!(p=!1)):m?mr(l,!(p=!1)):[]:qa(l)||ut(l)?ut(c=s)?c=function(e){return it(e,Mt(e))}(s):Pe(s)&&!Re(s)||(c=vr(l)):p=!1}p&&(a.set(l,c),n(c,l,i,o,a),a.delete(l)),Qa(e,r,c)}};function is(e){return e}var ns=function(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)},os=Math.max,as=function(e){return function(){return e}},ss=Qe?function(e,t){return Qe(e,"toString",{configurable:!0,enumerable:!1,value:as(t),writable:!0})}:is,ls=Date.now,us=function(e){var t=0,r=0;return function(){var i=ls(),n=16-(i-r);if(r=i,0<n){if(800<=++t)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}(ss),cs=function(e,t){return us(function(e,t,r){return t=os(void 0===t?e.length-1:t,0),function(){for(var i=arguments,n=-1,o=os(i.length-t,0),a=Array(o);++n<o;)a[n]=i[t+n];n=-1;for(var s=Array(t+1);++n<t;)s[n]=i[n];return s[t]=r(a),ns(e,this,s)}}(e,t,is),e+"")},ps=function(e){return cs((function(t,r){var i=-1,n=r.length,o=1<n?r[n-1]:void 0,a=2<n?r[2]:void 0;for(o=3<e.length&&"function"==typeof o?(n--,o):void 0,a&&function(e,t,r){if(!Pe(r))return!1;var i=typeof t;return!!("number"==i?Rt(r)&&mt(t,r.length):"string"==i&&t in r)&&ue(r[t],e)}(r[0],r[1],a)&&(o=n<3?void 0:o,n=1),t=Object(t);++i<n;){var s=r[i];s&&e(t,s,i)}return t}))}((function(e,t,r){!function e(t,r,i,n,o){t!==r&&es(r,(function(a,s){if(o=o||new $e,Pe(a))rs(t,r,s,i,e,n,o);else{var l=n?n(ts(t,s),a,s+"",t,r,o):void 0;void 0===l&&(l=a),Qa(t,s,l)}}),Mt)}(e,t,r)})),hs=(ds.parse=function(e){var t=(e=e.toLowerCase()).lastIndexOf("-");return-1!==t?{code:e,language:e.substring(0,t),region:e.substring(t+1)}:{code:e,language:e}},ds);function ds(){}var ms={localizationsPath:"locs/mapcontrol/2019-3-12",sensitiveUserRegions:["il","kr","pk","in","cn","ar","bh","eg","jo","sa","kw","om","qa","ma","ae"],locales:{defaultLanguage:{defaultRegion:{code:"NGT",strings:"en/resource.json"}},ar:{defaultRegion:{code:"ar",strings:"ar-sa/resource.json"}},bg:{defaultRegion:{code:"bg-BG",strings:"bg-bg/resource.json"}},cs:{defaultRegion:{code:"cs-CZ",strings:"cs-cz/resource.json"}},da:{defaultRegion:{code:"da-DK",strings:"da-dk/resource.json"}},de:{defaultRegion:{code:"de-DE",strings:"de-de/resource.json"}},el:{defaultRegion:{code:"el-GR",strings:"el-gr/resource.json"}},en:{defaultRegion:{code:"en",strings:"en/resource.json"},us:{code:"en-US",strings:"en/resource.json"}},es:{defaultRegion:{code:"es-ES",strings:"es-es/resource.json"},mx:{code:"es-MX",strings:"es-mx/resource.json"}},fi:{defaultRegion:{code:"fi-FI",strings:"fi-fi/resource.json"}},fr:{defaultRegion:{code:"fr-FR",strings:"fr-fr/resource.json"}},hu:{defaultRegion:{code:"hu-HU",strings:"hu-hu/resource.json"}},id:{defaultRegion:{code:"id-ID",strings:"id-id/resource.json"}},it:{defaultRegion:{code:"it-IT",strings:"it-it/resource.json"}},ko:{defaultRegion:{code:"ko-KR",strings:"ko-kr/resource.json"}},lt:{defaultRegion:{code:"lt-LT",strings:"lt-lt/resource.json"}},ms:{defaultRegion:{code:"ms-MY",strings:"ms-my/resource.json"}},nb:{defaultRegion:{code:"nb-NO",strings:"nb-no/resource.json"}},nl:{defaultRegion:{code:"nl-NL",strings:"nl-nl/resource.json"}},pl:{defaultRegion:{code:"pl-PL",strings:"pl-pl/resource.json"}},pt:{defaultRegion:{code:"pt-PT",strings:"pt-pt/resource.json"},br:{code:"pt-BR",strings:"pt-br/resource.json"}},ru:{defaultRegion:{code:"ru-RU",strings:"ru-ru/resource.json"}},sk:{defaultRegion:{code:"sk-SK",strings:"sk-sk/resource.json"}},sl:{defaultRegion:{code:"sl-SL",strings:"sl-sl/resource.json"}},sv:{defaultRegion:{code:"sv-SE",strings:"sv-se/resource.json"}},th:{defaultRegion:{code:"th-TH",strings:"th-th/resource.json"}},tr:{defaultRegion:{code:"tr-TR",strings:"tr-tr/resource.json"}},zh:{defaultRegion:{code:"zh-Hant",strings:"zh-tw/resource.json"}},"zh-hant":{defaultRegion:{code:"zh-Hant",strings:"zh-tw/resource.json"}}}},fs=function(){this.Unknown="Unknown",this.Accident="Accident",this.Fog="Fog",this.Danger="Danger",this.Rain="Rain",this.Ice="Ice",this.Jam="Jam",this.LaneClosed="Lane Closed",this.RoadClosed="Road Closed",this.RoadWorks="Road Works",this.Wind="Wind",this.Flood="Flood",this.Detour="Detour"},ys=(gs.getCode=function(e){var t=hs.parse(e);return-1===ms.sensitiveUserRegions.indexOf(t.region)?this.getLocaleData(t).code:e},gs.getStrings=function(e){var t=this.getLocaleData(e);return new w({domain:l,path:ms.localizationsPath+"/"+t.strings}).get().then((function(e){return e}),(function(){return new fs}))},gs.getLocaleData=function(e){if("string"==typeof e&&(e=hs.parse(e)),ms.locales[e.code])return ms.locales[e.code].defaultRegion;var t;if(ms.locales[e.language])t=ms.locales[e.language];else{if(-1!==e.language.indexOf("-"))return this.getLocaleData(e.language);t=ms.locales.defaultLanguage}return e.region&&t[e.region]?t[e.region]:t.defaultRegion},gs);function gs(){}var vs,_s=(bs.getEdgeOrIEVersion=function(){var e=window.navigator.userAgent,t=e.indexOf("MSIE ");if(0<t)return parseInt(e.substring(t+5,e.indexOf(".",t)),10);if(0<e.indexOf("Trident/")){var r=e.indexOf("rv:");return parseInt(e.substring(r+3,e.indexOf(".",r)),10)}var i=e.indexOf("Edge/");return 0<i?parseInt(e.substring(i+5,e.indexOf(".",i)),10):-1},bs.isEdgeOrIE=function(){return-1!==this.getEdgeOrIEVersion()},bs.isIE=function(){var e=this.getEdgeOrIEVersion();return-1!==e&&e<=11},bs);function bs(){}(vs=t.AuthenticationType||(t.AuthenticationType={})).subscriptionKey="subscriptionKey",vs.aad="aad",vs.anonymous="anonymous";var xs,ws,Ss=(d(Ts,xs=g),Ts.prototype.setSubscriptionKey=function(e){this.authType=t.AuthenticationType.subscriptionKey,this.subscriptionKey=e},Ts.prototype.setAadProperties=function(e,r,i,n,o){this.authType=t.AuthenticationType.aad,this.authContext=o||this.authContext,this.aadInstance=n||this.aadInstance,this.clientId=e,this.aadAppId=r,this.aadTenant=i},Ts.prototype.setTokenCallbackFunction=function(e){this.authType=t.AuthenticationType.anonymous,this.getToken=e},Ts.prototype.merge=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var i=xs.prototype.merge.apply(this,e);return i.authType===t.AuthenticationType.subscriptionKey?i.authContext=i.aadAppId=i.getToken=void 0:i.authType===t.AuthenticationType.aad?i.subscriptionKey=i.getToken=void 0:i.authType===t.AuthenticationType.anonymous&&(i.subscriptionKey=i.authContext=i.aadAppId=void 0),i},Ts);function Ts(){var e=null!==xs&&xs.apply(this,arguments)||this;return e.authType=void 0,e.subscriptionKey=void 0,e.clientId=void 0,e.aadAppId=void 0,e.aadTenant=void 0,e.aadInstance=void 0,e.getToken=void 0,e.authContext=void 0,e}var Cs="NGT",Es=yi(),Is=s,Ps=new Ss,Rs=!1,Ns=!1,As=!1,zs=!1,Ms=!1;function ks(){return Object.assign({},Ps)}function Os(){return Is}function Ls(){return Cs}function Ds(){return Es}function Bs(){return Ps.authType===t.AuthenticationType.subscriptionKey?Ps.subscriptionKey:void 0}function Fs(){return ws}function qs(e){return!_s.isIE()&&n.supported({failIfMajorPerformanceCaveat:e})}function Us(e){Ps=(new Ss).merge(Ps,e),Ms=!0}function js(e){Is=e,Ns=!0}function Vs(e){Cs=ys.getCode(e),As=!0}function Gs(e){Es=e,zs=!0}function Hs(e){Ps.setSubscriptionKey(e),Ms=!0}function Zs(e){ws=e,Rs=!0}function Ws(e,t){if(t=Math.abs(t||1),"string"==typeof e&&ol[e.toLowerCase()]){for(var r=ol[e.toLowerCase()],i=/calc\(([0-9.]+)[px]*\s*\*\s*\{scale\}\)/gi,n=r,o=i.exec(r);o;)n=n.replace(o[0],parseFloat(o[1])*t+""),o=i.exec(r);return n.replace("{scale}",t+"")}throw new Error("Invalid templateName.")}function Ks(){return Ms}function Xs(){return Ns}function Ys(){return As}function Js(){return zs}function $s(){return Rs}var Qs,el,tl,rl,il,nl,ol={marker:'<svg xmlns="http://www.w3.org/2000/svg" width="calc(27 * {scale})" height="calc(39 * {scale})" viewBox="-1 -1 26 38"><path d="M12.25.25a12.254 12.254 0 0 0-12 12.494c0 6.444 6.488 12.109 11.059 22.564.549 1.256 1.333 1.256 1.882 0C17.762 24.853 24.25 19.186 24.25 12.744A12.254 12.254 0 0 0 12.25.25Z" style="fill:{color};stroke:{secondaryColor};stroke-width:1"/><text x="12.5" y="17.5" style="font-size:14px;fill:#fff;text-anchor:middle">{text}</text></svg>',"marker-thick":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(28 * {scale})" height="calc(39 * {scale})" viewBox="-1 -1 27 38"><path d="M12.25.25a12.254 12.254 0 0 0-12 12.494c0 6.444 6.488 12.109 11.059 22.564.549 1.256 1.333 1.256 1.882 0C17.762 24.853 24.25 19.186 24.25 12.744A12.254 12.254 0 0 0 12.25.25Z" style="fill:{color};stroke:{secondaryColor};stroke-width:2"/><text x="12.5" y="18.5" style="font-size:14px;fill:#fff;text-anchor:middle">{text}</text></svg>',"marker-circle":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(28 * {scale})" height="calc(39 * {scale})" viewBox="-1 -1 27 38"><path d="M12.25.25a12.254 12.254 0 0 0-12 12.494c0 6.444 6.488 12.109 11.059 22.564.549 1.256 1.333 1.256 1.882 0C17.762 24.853 24.25 19.186 24.25 12.744A12.254 12.254 0 0 0 12.25.25Z" style="fill:{color};stroke:{secondaryColor};stroke-width:1"/><circle cx="12.5" cy="12.5" r="9" fill="{secondaryColor}"/><text x="12" y="17.5" style="font-size:14px;fill:#000;text-anchor:middle">{text}</text></svg>',pin:'<svg xmlns="http://www.w3.org/2000/svg" width="calc(24 * {scale})" height="calc(28 * {scale})" viewBox="0 0 24 28"><path d="m11.988 16.615a5.15 5.15 0 0 1-2.268-.525 4.909 4.909 0 0 1-2.805-4.442 5.019 5.019 0 0 1 5.072-4.936h.012a5.03 5.03 0 0 1 5.085 4.961 4.907 4.907 0 0 1-.549 2.224 5.114 5.114 0 0 1-4.548 2.718zm0-8.06a3.173 3.173 0 0 0-3.226 3.099 3.081 3.081 0 0 0 1.77 2.782 3.299 3.299 0 0 0 4.365-1.386 3.049 3.049 0 0 0 .342-1.381 3.184 3.184 0 0 0-3.239-3.114h-.012z" fill="{secondaryColor}"/><path d="m11.999.922a10.908 10.908 0 0 0-11.076 10.732 10.639 10.639 0 0 0 4.418 8.598l6.658 6.464 6.658-6.463a10.537 10.537 0 0 0 2.198-15.041 11.182 11.182 0 0 0-8.856-4.289zm1.873 14.341a4.221 4.221 0 0 1-5.589-1.789 3.945 3.945 0 0 1-.445-1.8 4.164 4.164 0 0 1 8.323-.037 4.028 4.028 0 0 1-2.289 3.626Z" fill="{color}"/><path d="m11.999 28-7.256-7.044a11.611 11.611 0 0 1-4.743-9.303 11.844 11.844 0 0 1 11.988-11.652.102 .102 0 0 1 .02 0 12.164 12.164 0 0 1 9.577 4.647 11.357 11.357 0 0 1 2.299 8.614 11.521 11.521 0 0 1-4.63 7.695zm-.01-26.157a9.997 9.997 0 0 0-10.143 9.812 9.769 9.769 0 0 0 4.04 7.853l.099.083 6.014 5.838 6.113-5.922a9.7 9.7 0 0 0 3.945-6.505 9.533 9.533 0 0 0-1.933-7.229 10.305 10.305 0 0 0-8.116-3.931h-.021zm.021 14.772a5.11 5.11 0 0 1-4.547-2.718 4.868 4.868 0 0 1 .932-5.743 5.118 5.118 0 0 1 3.58-1.46h.024a5.031 5.031 0 0 1 5.084 4.938 4.92 4.92 0 0 1-2.805 4.457h0a5.152 5.152 0 0 1-2.269.525zm-.011-8.079h-.015a3.277 3.277 0 0 0-2.295.933 3.029 3.029 0 0 0-.587 3.58 3.297 3.297 0 0 0 4.364 1.386h0a3.092 3.092 0 0 0 1.772-2.795 3.185 3.185 0 0 0-3.239-3.105z" fill="{secondaryColor}"/><text x="12" y="17" style="font-size:14px;fill:#000;text-anchor:middle">{text}</text></svg>',"pin-round":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(25 * {scale})" height="calc(25 * {scale})" viewBox="0 0 25 25"><g transform="translate(0 1)"><circle cx="12.25" cy="11.5833" r="11" fill="{color}"/><path d="m12.25 23.583a12 12 0 1 1 12-12 12 12 0 0 1-12 12zm0-22a10 10 0 1 0 10 10 10 10 0 0 0-10-10z" fill="{secondaryColor}"/><circle cx="12.25" cy="11.5833" r="4.2386" fill="{secondaryColor}"/></g><text x="12.5" y="17" style="font-size:14px;fill:#000;text-anchor:middle">{text}</text></svg>',"marker-flat":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(27 * {scale})" height="calc(42.8 * {scale})"  viewBox="0 0 1600 2570"><g fill="{color}"><path d="M691 2419c-409-575-641-1086-683-1504-10-106-10-136 5-224 31-188 105-330 241-458 129-124 270-190 453-214 69-9 113-10 182-1 373 46 655 326 703 698 40 308-120 801-424 1309-134 224-348 535-369 535-4 0-53-63-108-141z"/></g><g fill="rgba(0,0,0,0.15)" style="transform:scale(-1,1);transform-origin:center"><path d="M691 2419c-407-571-639-1083-682-1498-14-139-3-249 37-371 69-208 254-402 459-481 68-27 217-59 271-59h24v160 180 940 635c0 349-2 635-5 635-2 0-49-63-104-141z"/></g><circle cx="800" cy="800" r="600" fill="{secondaryColor}"/><text x="800" y="1100" style="font-size:800px;fill:#000;text-anchor:middle">{text}</text></svg>',"marker-arrow":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(25.47 * {scale})" height="calc(35.18 * {scale})" viewBox="0 0 4330 5980"><g fill="{color}"><path d="m2080 5969c-49-20-93-63-115-113-25-55-1928-5486-1953-5573-40-138 67-282 210-283 36 0 246 73 987 345 518 190 947 345 955 345 8 0 438-155 955-345 615-226 954-345 979-345 87 0 165 47 204 123 46 91 107-95-957 2942-537 1535-986 2805-997 2823-11 18-43 46-72 62-41 24-62 30-111 29-33 0-71-5-85-10z"/></g><g fill="{secondaryColor}"><path d="m2200 1600c-36 10-83 2-484-84-243-53-451-94-461-91-11 4-22 18-25 31-5 19 114 371 436 1292 244 697 448 1273 454 1281 19 24 50 30 71 12z"/><path d="m2200 1600c-36 10-83 2-484-84-243-53-451-94-461-91-11 4-22 18-25 31-5 19 114 371 436 1292 244 697 448 1273 454 1281 19 24 50 30 71 12z" style="transform:scale(-1,1);transform-origin:center"/></g><g fill="rgba(0,0,0,0.2)" ><path d="m2165 685c8 0 438-155 955-345 615-226 954-345 979-345 87 0 165 47 204 123 46 91 107-95-957 2942-537 1535-986 2805-997 2823-11 18-43 46-72 62-41 24-62 30-111 29z"/></g><text x="2165" y="3300" style="font-size:2500px;fill:#fff;text-anchor:middle">{text}</text></svg>',"marker-ball-pin":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(15.67 * {scale})" height="calc(33.33 * {scale})" viewBox="0 0 235 452"><g transform="translate(-135 10)"><path fill="{secondaryColor}" d="m256 442 0 0c-13 0-18-11-18-24l-6-323c0-13 11-24 24-24h0c13 0 24 11 24 24l-6 323c0 13-5 24-18 24z"/><circle style="fill:{color};stroke-width:10;stroke:{secondaryColor}" cx="256" cy="112" r="111"/><ellipse transform="matrix(0.834 0.5518 -0.5518 0.834 65.7916 -97.18)" fill="rgba(255,255,255,0.3)" cx="194.399" cy="60.749" rx="19.076" ry="32.428"/></g><text x="117.5" y="160" style="font-size:160px;fill:#fff;text-anchor:middle">{text}</text></svg>',"marker-square":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(26.67 * {scale})" height="calc(32.27 * {scale})" viewBox="0 0 2000 2420"><g transform="translate(100 100)" style="stroke:{secondaryColor};stroke-width:100;fill:{color}"><path d="M845 2152c-22-37-58-95-80-129-22-35-62-99-90-143l-50-80-312 0-313 0 0-900 0-900 900 0 900 0 0 900 0 900-313 0-313 0-34 58c-19 31-38 59-42 60-5 2-8 8-8 12 0 9-69 123-88 145-5 6-11 15-13 21-16 39-77 123-89 124-8 0-33-31-55-68z"/></g><text x="1000" y="1300" style="font-size:1000px;fill:#fff;text-anchor:middle">{text}</text></svg>',"marker-square-cluster":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(33.33 * {scale})" height="calc(38.8 * {scale})" viewBox="0 0 2500 2910"><g transform="translate(100 100)" style="stroke:{secondaryColor};stroke-width:100;fill:{color}"><path d="m866 2652c-17-31-37-68-46-82-9-14-32-54-51-90-19-36-50-92-70-125l-36-60-332-3-331-2 0-905 0-905 660 0 660 0 0-38c0-71 50-196 102-258 71-85 189-164 244-164 12 0 26-4 29-10 8-13 222-13 230 0 3 6 17 10 30 10 25 0 117 45 154 76 130 107 191 232 191 392 0 155-63 284-190 386-36 29-129 76-150 76-11 0-22 5-25 10-3 6-31 10-61 10l-54 0 0 660 0 660-332 2-332 3-29 50c-17 28-48 84-70 125-22 41-47 86-56 100-9 14-30 51-46 83-17 32-36 57-45 57-8 0-28-25-44-58z"/></g><text x="1650" y="900" style="font-size:1000px;fill:#fff">+</text><text x="1000" y="1800" style="font-size:1000px;fill:#fff;text-anchor:middle">{text}</text></svg>',"marker-square-rounded":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(26.8 * {scale})" height="calc(32.27 * {scale})" viewBox="0 0 2010 2410"><g transform="translate(100 100)" style="stroke:{secondaryColor};stroke-width:100;fill:{color}"><path d="M856 2155c-20-30-36-59-36-65 0-5-4-10-10-10-5 0-10-5-10-11 0-5-18-37-40-69-22-32-40-64-40-69 0-6-4-11-10-11-5 0-10-5-10-10 0-6-15-33-32-60l-33-50-127 0c-74 0-129-4-133-10-3-5-17-10-30-10-25 0-116-45-155-76-87-69-142-151-178-265-15-46-17-1075-2-1084 5-3 10-17 10-30 0-13 5-27 10-30 6-3 10-13 10-22 0-22 83-135 122-168 57-46 62-50 112-75l50-25 585 0 586 0 63 34c84 46 169 133 212 218l35 68 0 565 0 565-28 59c-32 69-100 157-139 180-15 9-33 22-40 29-23 22-99 57-123 57-13 0-27 5-30 10-4 6-60 10-135 10l-128 0-128 205c-84 136-133 205-144 205-10 0-33-24-54-55z"/></g><text x="1000" y="1300" style="font-size:1000px;fill:#fff;text-anchor:middle">{text}</text></svg>',"marker-square-rounded-cluster":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(33.33 * {scale})" height="calc(32.13 * {scale})" viewBox="0 0 2500 2900"><g transform="translate(100 100)" style="stroke:{secondaryColor};stroke-width:100;fill:{color}"><path d="m874 2669c-9-18-26-49-37-68-11-20-30-55-43-78-13-24-36-64-51-90-14-27-38-69-52-95l-26-48-142 0c-84 0-144-4-148-10-3-5-17-10-30-10-25 0-118-46-154-76-91-76-136-142-175-254-13-38-16-119-16-554 0-358 3-520 12-545 40-125 106-219 195-278 127-84 116-83 646-83l467 0 0-42c0-46 11-87 45-163 54-121 169-220 306-264 46-14 232-14 278 0 165 53 284 175 340 350 19 61 14 204-10 273-32 91-94 178-169 240-38 31-130 76-155 76-13 0-27 5-30 10-3 6-28 10-56 10l-49 0 0 462c0 446-1 464-21 522-32 91-94 178-169 240-38 31-130 76-155 76-13 0-27 5-30 10-4 6-65 10-149 10-138 0-143 1-154 23-12 23-62 114-112 202-16 28-44 79-63 115-42 77-67 88-93 39z"/></g><text x="1650" y="900" style="font-size:1000px;fill:#fff">+</text><text x="1000" y="1800" style="font-size:1000px;fill:#fff;text-anchor:middle">{text}</text></svg>',flag:'<svg xmlns="http://www.w3.org/2000/svg" width="calc(23.5 * {scale})" height="calc(40 * {scale})" viewBox="34 28 198 308"><path style="stroke:{secondaryColor};stroke-width:15;stroke-linecap:round;" d="M42 327l0 -291"/><path style="fill:{color};stroke:{secondaryColor};stroke-width:10;stroke-linejoin:round;" d="M49 50c70 30 104 28 178 2-21 42-21 74 0 116-72 25-101 25-178 0l0-118z"/><text x="130" y="165" style="font-size:100px;fill:#fff;text-anchor:middle">{text}</text></svg>',"flag-triangle":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(27 * {scale})" height="calc(35.33 * {scale})" viewBox="0 0 40.5 53"><g transform="translate(-31 -20)"><path fill="{secondaryColor}" d="M34.7,73.3V48.4l34.6-10.1c0.7-0.2,1.2-0.8,1.2-1.5s-0.4-1.4-1-1.7L33.7,20.5c-0.5-0.2-1.1-0.2-1.6,0.2 c-0.5,0.3-0.7,0.8-0.7,1.4v51.2H34.7z"/><polygon points="34.7,24.5 66,36.5 34.7,45 34.7,10" fill="{color}"/></g><text x="11" y="21" style="font-size:14px;fill:#fff;text-anchor:middle">{text}</text></svg>',"rounded-square":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(34 * {scale})" height="calc(34 * {scale})" viewBox="0 0 34 34"><g transform="translate(2 2)"><rect x="0" y="0" rx="8" ry="8" width="30" height="30" style="stroke:{secondaryColor};stroke-width:2;fill:{color}"/></g><text x="17" y="22" style="font-size:14px;fill:#fff;text-anchor:middle">{text}</text></svg>',"rounded-square-thick":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(38 * {scale})" height="calc(38 * {scale})" viewBox="0 0 38 38"><g transform="translate(4 4)"><rect x="0" y="0" rx="8" ry="8" width="30" height="30" style="stroke:{secondaryColor};stroke-width:4;fill:{color}"/></g><text x="19" y="24" style="font-size:14px;fill:#fff;text-anchor:middle">{text}</text></svg>',triangle:'<svg xmlns="http://www.w3.org/2000/svg" width="calc(36 * {scale})" height="calc(36 * {scale})" viewBox="0 0 36 36"><g transform="translate(2 2)"><polygon points="16,0 32,32 0,32 16,0" style="stroke:{secondaryColor};stroke-width:2;fill:{color}"/></g><text x="17.5" y="30" style="font-size:12px;fill:#fff;text-anchor:middle">{text}</text></svg>',"triangle-thick":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(40 * {scale})" height="calc(40 * {scale})" viewBox="0 0 40 40"><g transform="translate(4 4)"><polygon points="16,0 32,32 0,32 16,0" style="stroke:{secondaryColor};stroke-width:4;fill:{color}"/></g><text x="19.5" y="32" style="font-size:12px;fill:#fff;text-anchor:middle">{text}</text></svg>',hexagon:'<svg xmlns="http://www.w3.org/2000/svg" width="calc(35 * {scale})" height="calc(40 * {scale})" viewBox="0 0 35 40"><g transform="translate(2 2)"><path d="M31 9 15.5 0 0 9 0 27 15.5 36 31 27 31 9Z" style="stroke:{secondaryColor};stroke-width:2;fill:{color}"/></g><text x="17.5" y="25" style="font-size:14px;fill:#fff;text-anchor:middle">{text}</text></svg>',"hexagon-thick":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(39 * {scale})" height="calc(44 * {scale})" viewBox="0 0 39 44"><g transform="translate(4 4)"><path d="M31 9 15.5 0 0 9 0 27 15.5 36 31 27 31 9Z" style="stroke:{secondaryColor};stroke-width:4;fill:{color}"/></g><text x="19.5" y="27" style="font-size:14px;fill:#fff;text-anchor:middle">{text}</text></svg>',"hexagon-rounded":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(40 * {scale})" height="calc(40 * {scale})" viewBox="0 0 1100 1100"><g transform="translate(50 50)"><path style="stroke:{secondaryColor};stroke-width:50;fill:{color}" d="M881 210 561 25c-33-19-88-19-121 0L119 210c-33 19-61 67-61 105v370c0 39 27 86 61 105l321 185c33 19 88 19 122 0l321-185c33-19 61-67 61-105V315C942 276 915 229 881 210z"/></g><text x="550" y="700" style="font-size:400px;fill:#fff;text-anchor:middle">{text}</text></svg>',"hexagon-rounded-thick":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(40 * {scale})" height="calc(40 * {scale})" viewBox="0 0 1200 1200"><g transform="translate(100 100)"><path style="stroke:{secondaryColor};stroke-width:100;fill:{color}" d="M881 210 561 25c-33-19-88-19-121 0L119 210c-33 19-61 67-61 105v370c0 39 27 86 61 105l321 185c33 19 88 19 122 0l321-185c33-19 61-67 61-105V315C942 276 915 229 881 210z"/></g><text x="600" y="750" style="font-size:400px;fill:#fff;text-anchor:middle">{text}</text></svg>',"triangle-arrow-up":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(28 * {scale})" height="calc(28 * {scale})" viewBox="0 0 28 28"><g transform="translate(2 2)"><polygon points="12,0 0,24 12,17 24,24" stroke-width="2" stroke="{secondaryColor}" fill="{color}"/></g><text x="14" y="17" style="font-size:8px;fill:#fff;text-anchor:middle">{text}</text></svg>',"triangle-arrow-left":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(28 * {scale})" height="calc(28 * {scale})" viewBox="0 0 28 28"><g transform="translate(2 2)"><polygon points="24,12 0,0 7,12 0,24" stroke-width="2" stroke="{secondaryColor}" fill="{color}"/></g><text x="14" y="16.5" style="font-size:8px;fill:#fff;text-anchor:middle">{text}</text></svg>',"arrow-up":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(12.16 * {scale})" height="calc(30.1 * {scale})" viewBox="0 0 902 364"><g fill="{color}" transform="matrix(0,2.4,-2.4,0,897,-930)"><polygon points="902,222 233,222 233,364 0,182 233,0 233,141 902,141 902,222"/></g><text x="450" y="700" style="font-size:900px;fill:#000;text-anchor:middle">{text}</text></svg>',"arrow-up-thin":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(16 * {scale})" height="calc(33.33 * {scale})" viewBox="0 0 12 25"><g transform="translate(-136.91823 -751.91998)"><path fill="{color}" d="m148.271 760.71c-1.641-.547-3.186-1.47-4.633-2.769l0 18.07-1.675 0 0-18.07c-1.447 1.299-2.986 2.222-4.616 2.769l0-1.231c2.325-1.596 4.006-3.812 5.043-6.65l.838 0c1.037 2.838 2.718 5.055 5.043 6.65l0 1.231z"/></g><text x="6" y="20" style="font-size:10px;fill:#000;text-anchor:middle">{text}</text></svg>',car:'<svg xmlns="http://www.w3.org/2000/svg" width="calc(21.93 * {scale})" height="calc(40.9 * {scale})" viewBox="0 0 6580 12270"><g transform="translate(0 12270) rotate(-90)"><path fill="{secondaryColor}" d="M7045 6566c-42-13-105-44-105-51 0-2 23-105 50-228 28-123 50-230 50-236 0-8-241-11-907-11-855 0-1145 6-1513 30-85 6-189 13-230 15-41 3-133 10-205 15-286 21-430 32-705 50-953 63-1459 18-2335-205-304-77-746-209-799-238-131-72-221-408-285-1062-34-345-42-532-48-1130-16-1557 108-2532 336-2649 32-17 469-149 676-205 409-110 819-191 1205-238 116-14 224-18 540-18 395 1 494 5 1140 50 1124 79 1224 82 2496 78l641-3-53-237c-29-131-52-238-51-239 1-1 31-14 66-29 56-23 76-26 142-23 67 3 83 7 120 33 23 17 50 41 61 55 10 14 51 117 91 230l73 205 674 3 675 2 90-39c98-43 198-72 315-93 122-21 829-18 990 5 321 45 626 143 849 270 293 168 516 378 704 662 266 402 416 893 467 1527 15 174 8 882-9 998-6 41-18 127-27 190-69 502-253 969-523 1325-79 105-262 284-381 374-189 142-355 229-574 300-336 110-526 139-952 148-457 9-685-23-887-124l-47-24-678-6-678-6-64 179c-79 224-92 253-121 284-67 70-177 97-274 66zm-2752-5073c-23-2-64-2-90 0-26 2-7 3 42 3 50 0 71-1 48-3zm395 0c-21-2-55-2-75 0-21 2-4 4 37 4 41 0 58-2 38-4z"/><path fill="{color}" d="M7043 6498c-13-6-23-19-23-28 0-9 23-117 50-240 28-123 50-230 50-237 0-22-2126-13-2465 10-132 10-400 28-595 42-661 47-824 55-1160 62-435 7-656-8-1040-73-415-70-865-183-1447-365-168-53-272-556-325-1569-16-319-16-1311 0-1630 45-872 129-1366 257-1518 22-26 51-39 172-77 557-177 1122-310 1563-369 271-36 351-40 690-40 361 1 463 6 1165 54 1122 78 1288 83 2337 79 460-2 840-7 843-11 4-4-17-117-47-252l-55-245 39-16c76-30 180-8 224 47 10 13 54 124 98 246l79 222 709 0 709 0 47-24c74-37 219-83 322-101 122-22 606-32 802-16 374 29 658 102 933 238 124 62 271 155 361 230l61 51 6 100c19 278 103 497 247 643 88 89 173 136 278 152l70 11 41 131c116 369 159 673 168 1170 10 584-38 984-167 1397l-40 126-70 12c-193 33-348 175-441 405-56 139-89 302-89 445 0 43-3 47-58 91-290 235-644 384-1068 450-191 29-796 39-974 16-135-18-263-54-368-102l-75-35-701 0-701 0-79 223c-82 232-102 267-163 293-38 16-138 17-170 2zm-2023-820c332-15 1155-12 1835 6 308 8 563 12 566 8 4-4 10-21 13-38 7-30 6-31-92-77-518-244-1197-396-2112-474-295-25-1282-25-1579 0-231 20-473 46-479 51-6 7 49 110 93 171 160 226 416 335 855 365 142 10 539 5 900-12zm3304-263c525-111 899-887 934-1935 19-557-37-1023-172-1435-186-563-521-900-896-899-81 0-158 14-525 92-426 91-431 92-540 146-195 96-287 207-306 368-12 104-11 2985 1 3078 22 170 135 291 365 389 49 21 191 55 480 115 226 47 419 87 430 89 45 10 164 6 229-8zm-5570-485c112-43 197-156 216-291 12-83 13-2623 1-2706-23-158-125-273-270-304-44-9-100-1-542 75-272 47-514 91-539 98-266 68-487 424-594 958-56 280-70 548-40 800 56 484 207 878 414 1081 115 114 122 116 702 218 277 49 524 90 550 90 26 1 72-8 102-19zm2111-3440c1023-44 1884-213 2462-486l113-53-7-33c-3-18-8-35-10-37-2-3-236 1-521 7-993 24-1271 26-1708 11-541-18-1128-18-1249-1-377 56-588 181-734 437-32 55-41 79-32 84 12 8 246 32 491 51 356 28 815 36 1195 20z"/></g><text x="3250" y="8250" style="font-size:3000px;fill:#fff;text-anchor:middle">{text}</text></svg>',checker:'<svg xmlns="http://www.w3.org/2000/svg" width="calc(16 * {scale})" height="calc(16 * {scale})" viewBox="0 0 16 16"><pattern id="p" x="0" y="0" width="16" height="16" patternUnits="userSpaceOnUse"><rect fill="{color}" x="0" width="8" height="8" y="0"/><rect fill="{color}" x="8" width="8" height="8" y="8"/></pattern><rect x="0" y="0" width="16" height="16" fill="{secondaryColor}"/><rect x="0" y="0" width="16" height="16" fill="url(#p)"/></svg>',"checker-rotated":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(16 * {scale})" height="calc(16 * {scale})" viewBox="0 0 60 60"><rect width="60" height="60" fill="{secondaryColor}"/><rect width="42.42" height="42.42" transform="translate(30 0) rotate(45)" fill="{color}"/></svg>',"zig-zag":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(15 * {scale})" height="calc(15 * {scale})" viewBox="0 0 120 120"><rect x="0" y="0" width="120" height="120" fill="{secondaryColor}"/><polygon fill="{color}" points="120 120 60 120 90 90 120 60 120 0 120 0 60 60 0 0 0 60 30 90 60 120 120 120"/></svg>',"zig-zag-vertical":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(15 * {scale})" height="calc(15 * {scale})" viewBox="0 0 120 120"><rect x="0" y="0" width="120" height="120" fill="{secondaryColor}"/><polygon fill="{color}" points="120 0 120 60 90 30 60 0 0 0 0 0 60 60 0 120 60 120 90 90 120 60 120 0"/></svg>',"circles-spaced":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(20 * {scale})" height="calc(20 * {scale})" viewBox="0 0 20 20"><defs><pattern id="p" x="0" y="0" width="20" height="20" patternUnits="userSpaceOnUse"><circle cx="10" cy="10" r="2" stroke="none" fill="{color}"/></pattern></defs><rect x="0" y="0" width="20" height="20" fill="{secondaryColor}"/><rect x="0" y="0" width="100" height="100" fill="url(#p)"/></svg>',circles:'<svg xmlns="http://www.w3.org/2000/svg" width="calc(7 * {scale})" height="calc(7 * {scale})" viewBox="0 0 20 20"><defs><pattern id="p" x="0" y="0" width="20" height="20" patternUnits="userSpaceOnUse"><circle cx="10" cy="10" r="6" stroke="none" fill="{color}"/></pattern></defs><rect x="0" y="0" width="20" height="20" fill="{secondaryColor}"/><rect x="0" y="0" width="100" height="100" fill="url(#p)"/></svg>',"diagonal-lines-up":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(18 * {scale})" height="calc(18 * {scale})" viewBox="0 0 6 6"><rect x="0" y="0" width="6" height="6" fill="{secondaryColor}"/><g fill="{color}"><path d="M5 0h1L0 6V5zM6 5v1H5z"/></g></svg>',"diagonal-lines-down":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(18 * {scale})" height="calc(18 * {scale})" viewBox="0 0 6 6"><rect x="0" y="0" width="6" height="6" fill="{secondaryColor}"/><g transform="rotate(90 3 3)" fill="{color}"><path d="M5 0h1L0 6V5zM6 5v1H5z"/></g></svg>',"diagonal-stripes-up":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(20 * {scale})" height="calc(20 * {scale})" viewBox="0 0 40 40"><rect x="0" y="0" width="40" height="40" fill="{secondaryColor}"/><g fill="{color}"><path d="M0 40L40 0H20L0 20M40 40V20L20 40"/></g></svg>',"diagonal-stripes-down":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(20 * {scale})" height="calc(20 * {scale})" viewBox="0 0 40 40"><rect x="0" y="0" width="40" height="40" fill="{secondaryColor}"/><g transform="rotate(90 20 20)" fill="{color}"><path d="M0 40L40 0H20L0 20M40 40V20L20 40"/></g></svg>',"grid-lines":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(14 * {scale})" height="calc(14 * {scale})" viewBox="0 0 6 6"><rect x="0" y="0" width="6" height="6" fill="{secondaryColor}"/><g transform="rotate(45 3 3)" fill="{color}"><path d="M5 0h1L0 6V5zM6 5v1H5z"/></g><g fill="{color}" transform="rotate(-45 3 3)"><path d="M5 0h1L0 6V5zM6 5v1H5z"/></g></svg>',"rotated-grid-lines":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(18 * {scale})" height="calc(18 * {scale})" viewBox="0 0 6 6"><rect x="0" y="0" width="6" height="6" fill="{secondaryColor}"/><g transform="rotate(90 3 3)" fill="{color}"><path d="M5 0h1L0 6V5zM6 5v1H5z"/></g><g fill="{color}"><path d="M5 0h1L0 6V5zM6 5v1H5z"/></g></svg>',"rotated-grid-stripes":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(20 * {scale})" height="calc(20 * {scale})" viewBox="0 0 40 40"><rect x="0" y="0" width="40" height="40" fill="{secondaryColor}"/><g transform="rotate(90 20 20)" fill="{color}"><path d="M0 40L40 0H20L0 20M40 40V20L20 40"/></g><g fill="{color}"><path d="M0 40L40 0H20L0 20M40 40V20L20 40"/></g></svg>',"x-fill":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(40 * {scale})" height="calc(40 * {scale})" viewBox="0 0 40 40"><rect x="0" y="0" width="45.3" height="45.3" fill="{secondaryColor}"/><g fill="{color}"><path d="M0 38.59l2.83-2.83 1.41 1.41L1.41 40H0v-1.41zM0 1.4l2.83 2.83 1.41-1.41L1.41 0H0v1.41zM38.59 40l-2.83-2.83 1.41-1.41L40 38.59V40h-1.41zM40 1.41l-2.83 2.83-1.41-1.41L38.59 0H40v1.41zM20 18.6l2.83-2.83 1.41 1.41L21.41 20l2.83 2.83-1.41 1.41L20 21.41l-2.83 2.83-1.41-1.41L18.59 20l-2.83-2.83 1.41-1.41L20 18.59z"/></g></svg>',dots:'<svg xmlns="http://www.w3.org/2000/svg" width="calc(13 * {scale})" height="calc(13 * {scale})" viewBox="0 0 20 20"><rect x="0" y="0" width="20" height="20" fill="{secondaryColor}"/><g fill="{color}"><circle cx="3" cy="3" r="3"/><circle cx="13" cy="13" r="3"/></g></svg>'},al=(sl.getHighContrastMode=function(){return matchMedia("(-ms-high-contrast: white-on-black)").matches?"dark":matchMedia("(-ms-high-contrast: black-on-white)").matches?"light":matchMedia("(-ms-high-contrast: active)").matches?"dark":matchMedia("(inverted-colors: inverted)").matches?"invert":null},sl);function sl(){}(el=Qs=Qs||{})[el.LocalStorage=0]="LocalStorage",el[el.SessionStorage=1]="SessionStorage",(rl=tl=tl||{})[rl.Default=0]="Default",rl[rl.Required=1]="Required",rl[rl.Array=2]="Array",rl[rl.Hidden=4]="Hidden",(nl=il=il||{})[nl.AI=0]="AI",nl[nl.AI_AND_W3C=1]="AI_AND_W3C",nl[nl.W3C=2]="W3C";var ll=(ul.isNullOrUndefined=function(e){return null==e},ul.disableCookies=function(){ul._canUseCookies=!1},ul.newGuid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(hl,(function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))},ul);function ul(){}var cl,pl,hl=/[xy]/g,dl=(ml.prototype.addNotificationListener=function(e){this.listeners.push(e)},ml.prototype.removeNotificationListener=function(e){for(var t=this.listeners.indexOf(e);-1<t;)this.listeners.splice(t,1),t=this.listeners.indexOf(e)},ml.prototype.eventsSent=function(e){for(var t=this,r=function(r){i.listeners[r].eventsSent&&setTimeout((function(){return t.listeners[r].eventsSent(e)}),0)},i=this,n=0;n<this.listeners.length;++n)r(n)},ml.prototype.eventsDiscarded=function(e,t){for(var r=this,i=function(i){n.listeners[i].eventsDiscarded&&setTimeout((function(){return r.listeners[i].eventsDiscarded(e,t)}),0)},n=this,o=0;o<this.listeners.length;++o)i(o)},ml);function ml(){this.listeners=[]}(pl=cl=cl||{})[pl.CRITICAL=1]="CRITICAL",pl[pl.WARNING=2]="WARNING";var fl=(yl.sanitizeDiagnosticText=function(e){return'"'+e.replace(/\"/g,"")+'"'},yl.dataType="MessageData",yl.AiNonUserActionablePrefix="AI (Internal): ",yl.AiUserActionablePrefix="AI: ",yl);function yl(e,t,r,i){void 0===r&&(r=!1),this.messageId=e,this.message=(r?yl.AiUserActionablePrefix:yl.AiNonUserActionablePrefix)+e;var n=(t?" message:"+yl.sanitizeDiagnosticText(t):"")+(i?" props:"+yl.sanitizeDiagnosticText(JSON.stringify(i)):"");this.message+=n}var gl=(vl.prototype.throwInternal=function(e,t,r,i,n){void 0===n&&(n=!1);var o=new fl(t,r,n,i);if(this.enableDebugExceptions())throw o;if(void 0!==o&&o&&void 0!==o.message){if(n){var a=+o.messageId;(!this._messageLogged[a]||this.consoleLoggingLevel()>=cl.WARNING)&&(this.warnToConsole(o.message),this._messageLogged[a]=!0)}else this.consoleLoggingLevel()>=cl.WARNING&&this.warnToConsole(o.message);this.logInternalMessage(e,o)}},vl.prototype.warnToConsole=function(e){"undefined"!=typeof console&&console&&("function"==typeof console.warn?console.warn(e):"function"==typeof console.log&&console.log(e))},vl.prototype.resetInternalMessageCount=function(){this._messageCount=0,this._messageLogged={}},vl.prototype.logInternalMessage=function(e,t){if(!this._areInternalMessagesThrottled()){var r=!0,i=this.AIInternalMessagePrefix+t.messageId;if(this._messageLogged[i]?r=!1:this._messageLogged[i]=!0,r&&(e<=this.telemetryLoggingLevel()&&(this.queue.push(t),this._messageCount++),this._messageCount==this.maxInternalMessageLimit())){var n="Internal events throttle limit per PageView reached for this app.",o=new fl(23,n,!1);this.queue.push(o),this.warnToConsole(n)}}},vl.prototype._areInternalMessagesThrottled=function(){return this._messageCount>=this.maxInternalMessageLimit()},vl);function vl(e){this.AIInternalMessagePrefix="AITR_",this.enableDebugExceptions=function(){return!1},this.consoleLoggingLevel=function(){return 0},this.telemetryLoggingLevel=function(){return 1},this.maxInternalMessageLimit=function(){return 25},this.queue=[],this._messageCount=0,this._messageLogged={},ll.isNullOrUndefined(e)||(ll.isNullOrUndefined(e.loggingLevelConsole)||(this.consoleLoggingLevel=function(){return e.loggingLevelConsole}),ll.isNullOrUndefined(e.loggingLevelTelemetry)||(this.telemetryLoggingLevel=function(){return e.loggingLevelTelemetry}),ll.isNullOrUndefined(e.maxMessageLimit)||(this.maxInternalMessageLimit=function(){return e.maxMessageLimit}),ll.isNullOrUndefined(e.enableDebugExceptions)||(this.enableDebugExceptions=function(){return e.enableDebugExceptions}))}var _l=(bl.prototype.processTelemetry=function(e){this.channelQueue.forEach((function(t){0<t.length&&t[0].processTelemetry(e)}))},Object.defineProperty(bl.prototype,"ChannelControls",{get:function(){return this.channelQueue},enumerable:!0,configurable:!0}),bl.prototype.initialize=function(e,t,r){var i=this;if(e.isCookieUseDisabled&&ll.disableCookies(),this.channelQueue=new Array,e.channels){var n=void 0;e.channels.forEach((function(o){if(o&&0<o.length){o=o.sort((function(e,t){return e.priority-t.priority}));for(var a=1;a<o.length;a++)o[a-1].setNextPlugin(o[a]);if(o.forEach((function(i){i.priority<500&&(n=i.identifier),i.initialize(e,t,r)})),n)throw Error("Channel has invalid priority"+n);i.channelQueue.push(o)}}))}for(var o=new Array,a=0;a<r.length;a++){var s=r[a];500<s.priority&&o.push(s)}if(0<o.length){for(o=o.sort((function(e,t){return e.priority-t.priority})),a=1;a<o.length;a++)o[a-1].setNextPlugin(o[a]);o.forEach((function(i){return i.initialize(e,t,r)})),this.channelQueue.push(o)}},bl);function bl(){this.identifier="ChannelControllerPlugin",this.priority=500}var xl=(wl.prototype.initialize=function(e,t){var r=this;if(this._isInitialized)throw Error("Core should not be initialized more than once");if(!e||ll.isNullOrUndefined(e.instrumentationKey))throw Error("Please provide instrumentation key");this.config=e,this._notificationManager=new dl,this.config.extensions=ll.isNullOrUndefined(this.config.extensions)?[]:this.config.extensions,this.config.extensionConfig=ll.isNullOrUndefined(this.config.extensionConfig)?{}:this.config.extensionConfig,this.config.extensionConfig.NotificationManager=this._notificationManager,this.logger=new gl(e),(n=this._extensions).push.apply(n,t.concat(this.config.extensions)),this._extensions.forEach((function(e){var t=!0;if((ll.isNullOrUndefined(e)||ll.isNullOrUndefined(e.initialize))&&(t=!1),!t)throw Error("Extensions must provide callback to initialize")})),this._extensions.push(this._channelController),this._extensions=this._extensions.sort((function(e,t){var r=typeof e.processTelemetry,i=typeof t.processTelemetry;return"function"==r&&"function"==i?e.priority-t.priority:"function"==r&&"function"!=i?1:"function"!=r&&"function"==i?-1:void 0}));var i={};this._extensions.forEach((function(e){var t=e;t&&t.priority&&(ll.isNullOrUndefined(i[t.priority])?i[t.priority]=t.identifier:r.logger.warnToConsole("Two extensions have same priority"+i[t.priority]+", "+t.identifier))}));for(var n,o=-1,a=0;a<this._extensions.length-1;a++){var s=this._extensions[a];if(!s||"function"==typeof s.processTelemetry){if(s.priority===this._channelController.priority){o=a+1;break}this._extensions[a].setNextPlugin(this._extensions[a+1])}}if(this._channelController.initialize(this.config,this,this._extensions),this._extensions.forEach((function(e){e&&e.priority<r._channelController.priority&&e.initialize(r.config,r,r._extensions)})),o<this._extensions.length&&this._extensions.splice(o),0===this.getTransmissionControls().length)throw new Error("No channels available");this._isInitialized=!0},wl.prototype.getTransmissionControls=function(){return this._channelController.ChannelControls},wl.prototype.track=function(e){if(null===e)throw this._notifyInvalidEvent(e),Error("Invalid telemetry item");e.iKey||(e.iKey=this.config.instrumentationKey),e.time||(e.time=(new Date).toISOString()),ll.isNullOrUndefined(e.ver)&&(e.ver="4.0"),this._validateTelmetryItem(e),0==this._extensions.length&&this._channelController.processTelemetry(e);for(var t=0;t<this._extensions.length;){if(this._extensions[t].processTelemetry){this._extensions[t].processTelemetry(e);break}t++}},wl.prototype.addNotificationListener=function(e){this._notificationManager.addNotificationListener(e)},wl.prototype.removeNotificationListener=function(e){this._notificationManager.removeNotificationListener(e)},wl.prototype.pollInternalLogs=function(e){var t=this,r=this.config.diagnosticLogInterval;return 0<r||(r=1e4),setInterval((function(){var r=t.logger.queue;r.forEach((function(r){var i={name:e||"InternalMessageId: "+r.messageId,iKey:t.config.instrumentationKey,time:(new Date).toISOString(),baseType:fl.dataType,baseData:{message:r.message}};t.track(i)})),r.length=0}),r)},wl.prototype._validateTelmetryItem=function(e){if(ll.isNullOrUndefined(e.name))throw this._notifyInvalidEvent(e),Error("telemetry name required");if(ll.isNullOrUndefined(e.time))throw this._notifyInvalidEvent(e),Error("telemetry timestamp required");if(ll.isNullOrUndefined(e.iKey))throw this._notifyInvalidEvent(e),Error("telemetry instrumentationKey required")},wl.prototype._notifyInvalidEvent=function(e){this._notificationManager.eventsDiscarded([e],2)},wl);function wl(){this._isInitialized=!1,this._extensions=new Array,this._channelController=new _l}var Sl=(Tl.requestContextHeader="Request-Context",Tl.requestContextTargetKey="appId",Tl.requestContextAppIdFormat="appId=cid-v1:",Tl.requestIdHeader="Request-Id",Tl.traceParentHeader="traceparent",Tl.sdkContextHeader="Sdk-Context",Tl.sdkContextHeaderAppIdRequest="appId",Tl.requestContextHeaderLowerCase="request-context",Tl);function Tl(){}var Cl=(El.sanitizeKeyAndAddUniqueness=function(e,t,r){var i=t.length,n=El.sanitizeKey(e,t);if(n.length!==i){for(var o=0,a=n;void 0!==r[a];)o++,a=n.substring(0,El.MAX_NAME_LENGTH-3)+El.padNumber(o);n=a}return n},El.sanitizeKey=function(e,t){var r;return t&&(t=El.trim(t.toString())).length>El.MAX_NAME_LENGTH&&(r=t.substring(0,El.MAX_NAME_LENGTH),e.throwInternal(cl.WARNING,57,"name is too long.  It has been truncated to "+El.MAX_NAME_LENGTH+" characters.",{name:t},!0)),r||t},El.sanitizeString=function(e,t,r){var i;return void 0===r&&(r=El.MAX_STRING_LENGTH),t&&(r=r||El.MAX_STRING_LENGTH,(t=El.trim(t)).toString().length>r&&(i=t.toString().substring(0,r),e.throwInternal(cl.WARNING,61,"string value is too long. It has been truncated to "+r+" characters.",{value:t},!0))),i||t},El.sanitizeUrl=function(e,t){return El.sanitizeInput(e,t,El.MAX_URL_LENGTH,66)},El.sanitizeMessage=function(e,t){var r;return t&&t.length>El.MAX_MESSAGE_LENGTH&&(r=t.substring(0,El.MAX_MESSAGE_LENGTH),e.throwInternal(cl.WARNING,56,"message is too long, it has been truncated to "+El.MAX_MESSAGE_LENGTH+" characters.",{message:t},!0)),r||t},El.sanitizeException=function(e,t){var r;return t&&t.length>El.MAX_EXCEPTION_LENGTH&&(r=t.substring(0,El.MAX_EXCEPTION_LENGTH),e.throwInternal(cl.WARNING,52,"exception is too long, it has been truncated to "+El.MAX_EXCEPTION_LENGTH+" characters.",{exception:t},!0)),r||t},El.sanitizeProperties=function(e,t){if(t){var r={};for(var i in t){var n=t[i];if("object"==typeof n&&"undefined"!=typeof JSON)try{n=JSON.stringify(n)}catch(t){e.throwInternal(cl.WARNING,49,"custom property is not valid",{exception:t},!0)}n=El.sanitizeString(e,n,El.MAX_PROPERTY_LENGTH),r[i=El.sanitizeKeyAndAddUniqueness(e,i,r)]=n}t=r}return t},El.sanitizeMeasurements=function(e,t){if(t){var r={};for(var i in t){var n=t[i];r[i=El.sanitizeKeyAndAddUniqueness(e,i,r)]=n}t=r}return t},El.sanitizeId=function(e,t){return t?El.sanitizeInput(e,t,El.MAX_ID_LENGTH,69).toString():t},El.sanitizeInput=function(e,t,r,i){var n;return t&&(t=El.trim(t)).length>r&&(n=t.substring(0,r),e.throwInternal(cl.WARNING,i,"input is too long, it has been truncated to "+r+" characters.",{data:t},!0)),n||t},El.padNumber=function(e){var t="00"+e;return t.substr(t.length-3)},El.trim=function(e){return"string"!=typeof e?e:e.replace(/^\s+|\s+$/g,"")},El.MAX_NAME_LENGTH=150,El.MAX_ID_LENGTH=128,El.MAX_PROPERTY_LENGTH=8192,El.MAX_STRING_LENGTH=1024,El.MAX_URL_LENGTH=2048,El.MAX_MESSAGE_LENGTH=32768,El.MAX_EXCEPTION_LENGTH=32768,El);function El(){}var Il=(Pl.createDomEvent=function(e){var t=null;return"function"==typeof Event?t=new Event(e):(t=document.createEvent("Event")).initEvent(e,!0,!0),t},Pl.disableStorage=function(){Pl._canUseLocalStorage=!1,Pl._canUseSessionStorage=!1},Pl._getLocalStorageObject=function(){return Pl.canUseLocalStorage()?Pl._getVerifiedStorageObject(Qs.LocalStorage):null},Pl._getVerifiedStorageObject=function(e){var t,r,i=null;try{if("undefined"==typeof window)return null;r=new Date,(i=e===Qs.LocalStorage?window.localStorage:window.sessionStorage).setItem(r,r),t=i.getItem(r)!=r,i.removeItem(r),t&&(i=null)}catch(e){i=null}return i},Pl.isInternalApplicationInsightsEndpoint=function(e){return-1!==Pl._internalEndpoints.indexOf(e.toLowerCase())},Pl.canUseLocalStorage=function(){return void 0===Pl._canUseLocalStorage&&(Pl._canUseLocalStorage=!!Pl._getVerifiedStorageObject(Qs.LocalStorage)),Pl._canUseLocalStorage},Pl.getStorage=function(e,t){var r=Pl._getLocalStorageObject();if(null!==r)try{return r.getItem(t)}catch(t){Pl._canUseLocalStorage=!1,e.throwInternal(cl.WARNING,1,"Browser failed read of local storage. "+Pl.getExceptionName(t),{exception:Pl.dump(t)})}return null},Pl.setStorage=function(e,t,r){var i=Pl._getLocalStorageObject();if(null!==i)try{return i.setItem(t,r),!0}catch(t){Pl._canUseLocalStorage=!1,e.throwInternal(cl.WARNING,3,"Browser failed write to local storage. "+Pl.getExceptionName(t),{exception:Pl.dump(t)})}return!1},Pl.removeStorage=function(e,t){var r=Pl._getLocalStorageObject();if(null!==r)try{return r.removeItem(t),!0}catch(t){Pl._canUseLocalStorage=!1,e.throwInternal(cl.WARNING,5,"Browser failed removal of local storage item. "+Pl.getExceptionName(t),{exception:Pl.dump(t)})}return!1},Pl._getSessionStorageObject=function(){return Pl.canUseSessionStorage()?Pl._getVerifiedStorageObject(Qs.SessionStorage):null},Pl.canUseSessionStorage=function(){return void 0===Pl._canUseSessionStorage&&(Pl._canUseSessionStorage=!!Pl._getVerifiedStorageObject(Qs.SessionStorage)),Pl._canUseSessionStorage},Pl.getSessionStorageKeys=function(){var e=[];if(Pl.canUseSessionStorage())for(var t in window.sessionStorage)e.push(t);return e},Pl.getSessionStorage=function(e,t){var r=Pl._getSessionStorageObject();if(null!==r)try{return r.getItem(t)}catch(t){Pl._canUseSessionStorage=!1,e.throwInternal(cl.WARNING,2,"Browser failed read of session storage. "+Pl.getExceptionName(t),{exception:Pl.dump(t)})}return null},Pl.setSessionStorage=function(e,t,r){var i=Pl._getSessionStorageObject();if(null!==i)try{return i.setItem(t,r),!0}catch(t){Pl._canUseSessionStorage=!1,e.throwInternal(cl.WARNING,4,"Browser failed write to session storage. "+Pl.getExceptionName(t),{exception:Pl.dump(t)})}return!1},Pl.removeSessionStorage=function(e,t){var r=Pl._getSessionStorageObject();if(null!==r)try{return r.removeItem(t),!0}catch(t){Pl._canUseSessionStorage=!1,e.throwInternal(cl.WARNING,6,"Browser failed removal of session storage item. "+Pl.getExceptionName(t),{exception:Pl.dump(t)})}return!1},Pl.disableCookies=function(){ll.disableCookies()},Pl.canUseCookies=function(e){if(void 0===ll._canUseCookies){ll._canUseCookies=!1;try{ll._canUseCookies=void 0!==Pl.document.cookie}catch(t){e.throwInternal(cl.WARNING,68,"Cannot access document.cookie - "+Pl.getExceptionName(t),{exception:Pl.dump(t)})}}return ll._canUseCookies},Pl.setCookie=function(e,t,r,i){var n="",o="";i&&(n=";domain="+i),Pl.document.location&&"https:"===Pl.document.location.protocol&&(o=";secure"),Pl.canUseCookies(e)&&(Pl.document.cookie=t+"="+r+n+";path=/"+o)},Pl.stringToBoolOrDefault=function(e,t){return void 0===t&&(t=!1),null==e?t:"true"===e.toString().toLowerCase()},Pl.getCookie=function(e,t){if(Pl.canUseCookies(e)){var r="";if(t&&t.length)for(var i=t+"=",n=Pl.document.cookie.split(";"),o=0;o<n.length;o++){var a=n[o];if((a=Pl.trim(a))&&0===a.indexOf(i)){r=a.substring(i.length,n[o].length);break}}return r}},Pl.deleteCookie=function(e,t){Pl.canUseCookies(e)&&(Pl.document.cookie=t+"=;path=/;expires=Thu, 01 Jan 1970 00:00:01 GMT;")},Pl.trim=function(e){return"string"!=typeof e?e:e.replace(/^\s+|\s+$/g,"")},Pl.newId=function(){for(var e="",t=1073741824*Math.random();0<t;)e+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(t%64),t=Math.floor(t/64);return e},Pl.random32=function(){return 4294967296*Math.random()|0},Pl.generateW3CId=function(){for(var e,t=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],r="",i=0;i<4;i++)r+=t[15&(e=Pl.random32())]+t[e>>4&15]+t[e>>8&15]+t[e>>12&15]+t[e>>16&15]+t[e>>20&15]+t[e>>24&15]+t[e>>28&15];var n=t[8+4*Math.random()|0];return r.substr(0,8)+r.substr(9,4)+"4"+r.substr(13,3)+n+r.substr(16,3)+r.substr(19,12)},Pl.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)},Pl.isError=function(e){return"[object Error]"===Object.prototype.toString.call(e)},Pl.isDate=function(e){return"[object Date]"===Object.prototype.toString.call(e)},Pl.toISOStringForIE8=function(e){if(Pl.isDate(e)){if(Date.prototype.toISOString)return e.toISOString();var t=function(e){var t=String(e);return 1===t.length&&(t="0"+t),t};return e.getUTCFullYear()+"-"+t(e.getUTCMonth()+1)+"-"+t(e.getUTCDate())+"T"+t(e.getUTCHours())+":"+t(e.getUTCMinutes())+":"+t(e.getUTCSeconds())+"."+String((e.getUTCMilliseconds()/1e3).toFixed(3)).slice(2,5)+"Z"}},Pl.getIEVersion=function(e){void 0===e&&(e=null);var t=e?e.toLowerCase():navigator.userAgent.toLowerCase();return-1!=t.indexOf("msie")?parseInt(t.split("msie")[1]):null},Pl.msToTimeSpan=function(e){(isNaN(e)||e<0)&&(e=0);var t=""+(e=Math.round(e))%1e3,r=""+Math.floor(e/1e3)%60,i=""+Math.floor(e/6e4)%60,n=""+Math.floor(e/36e5)%24,o=Math.floor(e/864e5);return t=1===t.length?"00"+t:2===t.length?"0"+t:t,r=r.length<2?"0"+r:r,i=i.length<2?"0"+i:i,(0<o?o+".":"")+(n=n.length<2?"0"+n:n)+":"+i+":"+r+"."+t},Pl.isCrossOriginError=function(e,t,r,i,n){return("Script error."===e||"Script error"===e)&&!n},Pl.dump=function(e){var t=Object.prototype.toString.call(e),r=JSON.stringify(e);return"[object Error]"===t&&(r="{ stack: '"+e.stack+"', message: '"+e.message+"', name: '"+e.name+"'"),t+r},Pl.getExceptionName=function(e){return"[object Error]"===Object.prototype.toString.call(e)?e.name:""},Pl.addEventHandler=function(e,t){if("undefined"==typeof window||!window||"string"!=typeof e||"function"!=typeof t)return!1;var r="on"+e;if(window.addEventListener)window.addEventListener(e,t,!1);else{if(!window.attachEvent)return!1;window.attachEvent(r,t)}return!0},Pl.IsBeaconApiSupported=function(){return"sendBeacon"in navigator&&navigator.sendBeacon},Pl.getExtension=function(e,t){for(var r=null,i=0;!r&&i<e.length;)e[i]&&e[i].identifier===t&&(r=e[i]),i++;return r},Pl.document="undefined"!=typeof document?document:{},Pl._canUseLocalStorage=void 0,Pl._canUseSessionStorage=void 0,Pl._internalEndpoints=["https://dc.services.visualstudio.com/v2/track","https://breeze.aimon.applicationinsights.io/v2/track","https://dc-int.services.visualstudio.com/v2/track"],Pl.NotSpecified="not_specified",Pl);function Pl(){}var Rl=(Nl.parseUrl=function(e){return Nl.htmlAnchorElement||(Nl.htmlAnchorElement=Nl.document.createElement?Nl.document.createElement("a"):{host:Nl.parseHost(e)}),Nl.htmlAnchorElement.href=e,Nl.htmlAnchorElement},Nl.getAbsoluteUrl=function(e){var t,r=Nl.parseUrl(e);return r&&(t=r.href),t},Nl.getPathName=function(e){var t,r=Nl.parseUrl(e);return r&&(t=r.pathname),t},Nl.getCompleteUrl=function(e,t){return e?e.toUpperCase()+" "+t:t},Nl.parseHost=function(e){var t=e.match(/:\/\/(www[0-9]?\.)?(.[^/:]+)/i);return null!=t&&2<t.length&&"string"==typeof t[2]&&0<t[2].length?t[2]:null},Nl.document="undefined"!=typeof document?document:{},Nl);function Nl(){}var Al=(zl.canIncludeCorrelationHeader=function(e,t,r){if(e&&e.disableCorrelationHeaders)return!1;if(!t)return!1;var i=Rl.parseUrl(t).host.toLowerCase();if(!(e&&e.enableCorsCorrelation||i===r))return!1;var n,o=e&&e.correlationHeaderDomains;if(o&&(o.forEach((function(e){var t=new RegExp(e.toLowerCase().replace(/\./g,".").replace(/\*/g,".*"));n=n||t.test(i)})),!n))return!1;var a=e&&e.correlationHeaderExcludedDomains;if(!a||0==a.length)return!0;for(var s=0;s<a.length;s++)if(new RegExp(a[s].toLowerCase().replace(/\./g,".").replace(/\*/g,".*")).test(i))return!1;return!0},zl.getCorrelationContext=function(e){if(e){var t=zl.getCorrelationContextValue(e,Sl.requestContextTargetKey);if(t&&t!==zl.correlationIdPrefix)return t}},zl.getCorrelationContextValue=function(e,t){if(e)for(var r=e.split(","),i=0;i<r.length;++i){var n=r[i].split("=");if(2==n.length&&n[0]==t)return n[1]}},zl.correlationIdPrefix="cid-v1:",zl);function zl(){}var Ml=(kl.ParseDependencyPath=function(e,t,r,i){var n,o=i,a=i;if(t&&0<t.length){var s=Rl.parseUrl(t);if(n=s.host,!o)if(null!=s.pathname){var l=0===s.pathname.length?"/":s.pathname;"/"!==l.charAt(0)&&(l="/"+l),a=s.pathname,o=Cl.sanitizeString(e,r?r+" "+l:l)}else o=Cl.sanitizeString(e,t)}else o=n=i;return{target:n,name:o,data:a}},kl);function kl(){}var Ol=(Ll.Now="undefined"!=typeof window&&window.performance&&window.performance.now&&window.performance.timing?function(){return window.performance.now()+window.performance.timing.navigationStart}:function(){return(new Date).getTime()},Ll.GetDuration=function(e,t){var r=null;return 0===e||0===t||ll.isNullOrUndefined(e)||ll.isNullOrUndefined(t)||(r=t-e),r},Ll);function Ll(){}var Dl,Bl="Microsoft_ApplicationInsights_BypassAjaxInstrumentation",Fl="ProcessLegacy",ql="http.method",Ul=(d(jl,Dl=function(){}),jl);function jl(){return Dl.call(this)||this}var Vl,Gl=(d(Hl,Vl=function(){this.ver=1,this.sampleRate=100,this.tags={}}),Hl);function Hl(e,t,r){var i=Vl.call(this)||this;return i.name=Cl.sanitizeString(e,r)||Il.NotSpecified,i.data=t,i.time=Il.toISOStringForIE8(new Date),i.aiDataContract={time:tl.Required,iKey:tl.Required,name:tl.Required,sampleRate:function(){return 100==i.sampleRate?tl.Hidden:tl.Required},tags:tl.Required,data:tl.Required},i}function Zl(){}var Wl,Kl=(d(Xl,Wl=Zl),Xl);function Xl(){var e=Wl.call(this)||this;return e.ver=2,e.properties={},e.measurements={},e}var Yl,Jl=(d($l,Yl=Kl),$l.envelopeType="Microsoft.ApplicationInsights.{0}.Event",$l.dataType="EventData",$l);function $l(e,t,r,i){var n=Yl.call(this)||this;return n.aiDataContract={ver:tl.Required,name:tl.Required,properties:tl.Default,measurements:tl.Default},n.name=Cl.sanitizeString(e,t)||Il.NotSpecified,n.properties=Cl.sanitizeProperties(e,r),n.measurements=Cl.sanitizeMeasurements(e,i),n}var Ql,eu=(d(tu,Ql=Zl),tu);function tu(){var e=Ql.call(this)||this;return e.ver=2,e.exceptions=[],e.properties={},e.measurements={},e}var ru,iu=(d(nu,ru=eu),nu.CreateFromInterface=function(e,t){var r=t.exceptions&&t.exceptions.map((function(t){return au.CreateFromInterface(e,t)}));return new nu(e,m({},t,{exceptions:r}))},nu.prototype.toInterface=function(){var e=this.exceptions,t=this.properties,r=this.measurements,i=this.severityLevel,n=this.ver,o=this.problemGroup,a=this.id,s=this.isManual;return{ver:n,exceptions:e instanceof Array&&e.map((function(e){return e.toInterface()}))||void 0,severityLevel:i,properties:t,measurements:r,problemGroup:o,id:a,isManual:s}},nu.CreateSimpleException=function(e,t,r,i,n,o){return{exceptions:[{hasFullStack:!0,message:e,stack:n,typeName:t}]}},nu.envelopeType="Microsoft.ApplicationInsights.{0}.Exception",nu.dataType="ExceptionData",nu);function nu(e,t,r,i,n,o){var a=ru.call(this)||this;return a.aiDataContract={ver:tl.Required,exceptions:tl.Required,severityLevel:tl.Default,properties:tl.Default,measurements:tl.Default},t instanceof Error?(a.exceptions=[new au(e,t)],a.properties=Cl.sanitizeProperties(e,r),a.measurements=Cl.sanitizeMeasurements(e,i),n&&(a.severityLevel=n),o&&(a.id=o)):(a.exceptions=t.exceptions,a.properties=t.properties,a.measurements=t.measurements,t.severityLevel&&(a.severityLevel=t.severityLevel),t.id&&(a.id=t.id),t.problemGroup&&(a.problemGroup=t.problemGroup),ll.isNullOrUndefined(t.ver)||(a.ver=t.ver),ll.isNullOrUndefined(t.isManual)||(a.isManual=t.isManual)),a}var ou,au=(d(su,ou=function(){this.hasFullStack=!0,this.parsedStack=[]}),su.prototype.toInterface=function(){var e=this.parsedStack instanceof Array&&this.parsedStack.map((function(e){return e.toInterface()}));return{id:this.id,outerId:this.outerId,typeName:this.typeName,message:this.message,hasFullStack:this.hasFullStack,stack:this.stack,parsedStack:e||void 0}},su.CreateFromInterface=function(e,t){var r=t.parsedStack instanceof Array&&t.parsedStack.map((function(e){return uu.CreateFromInterface(e)}))||t.parsedStack;return new su(e,m({},t,{parsedStack:r}))},su.parseStack=function(e){var t=void 0;if("string"==typeof e){var r=e.split("\n");t=[];for(var i=0,n=0,o=0;o<=r.length;o++){var a=r[o];if(uu.regex.test(a)){var s=new uu(r[o],i++);n+=s.sizeInBytes,t.push(s)}}if(32768<n)for(var l=0,u=t.length-1,c=0,p=l,h=u;l<u;){if(32768<(c+=t[l].sizeInBytes+t[u].sizeInBytes)){var d=h-p+1;t.splice(p,d);break}p=l,h=u,l++,u--}}return t},su);function su(e,t){var r=ou.call(this)||this;if(r.aiDataContract={id:tl.Default,outerId:tl.Default,typeName:tl.Required,message:tl.Required,hasFullStack:tl.Default,stack:tl.Default,parsedStack:tl.Array},t instanceof Error){r.typeName=Cl.sanitizeString(e,t.name)||Il.NotSpecified,r.message=Cl.sanitizeMessage(e,t.message)||Il.NotSpecified;var i=t.stack;r.parsedStack=su.parseStack(i),r.stack=Cl.sanitizeException(e,i),r.hasFullStack=Il.isArray(r.parsedStack)&&0<r.parsedStack.length}else r.typeName=t.typeName,r.message=t.message,r.stack=t.stack,r.parsedStack=t.parsedStack,r.hasFullStack=t.hasFullStack;return r}var lu,uu=(d(cu,lu=function(){}),cu.CreateFromInterface=function(e){return new cu(e,null)},cu.prototype.toInterface=function(){return{level:this.level,method:this.method,assembly:this.assembly,fileName:this.fileName,line:this.line}},cu.regex=/^([\s]+at)?(.*?)(\@|\s\(|\s)([^\(\@\n]+):([0-9]+):([0-9]+)(\)?)$/,cu.baseSize=58,cu);function cu(e,t){var r=lu.call(this)||this;if(r.sizeInBytes=0,r.aiDataContract={level:tl.Required,method:tl.Required,assembly:tl.Default,fileName:tl.Default,line:tl.Default},"string"==typeof e){var i=e;r.level=t,r.method="<no_method>",r.assembly=Il.trim(i),r.fileName="",r.line=0;var n=i.match(cu.regex);n&&5<=n.length&&(r.method=Il.trim(n[2])||r.method,r.fileName=Il.trim(n[4]),r.line=parseInt(n[5])||0)}else r.level=e.level,r.method=e.method,r.assembly=e.assembly,r.fileName=e.fileName,r.line=e.line,r.sizeInBytes=0;return r.sizeInBytes+=r.method.length,r.sizeInBytes+=r.fileName.length,r.sizeInBytes+=r.assembly.length,r.sizeInBytes+=cu.baseSize,r.sizeInBytes+=r.level.toString().length,r.sizeInBytes+=r.line.toString().length,r}var pu,hu,du,mu=(d(fu,pu=Zl),fu);function fu(){var e=pu.call(this)||this;return e.ver=2,e.metrics=[],e.properties={},e}(du=hu=hu||{})[du.Measurement=0]="Measurement",du[du.Aggregation=1]="Aggregation";var yu,gu=(d(vu,yu=function(){this.kind=hu.Measurement}),vu);function vu(){var e=null!==yu&&yu.apply(this,arguments)||this;return e.aiDataContract={name:tl.Required,kind:tl.Default,value:tl.Required,count:tl.Default,min:tl.Default,max:tl.Default,stdDev:tl.Default},e}var _u,bu=(d(xu,_u=mu),xu.envelopeType="Microsoft.ApplicationInsights.{0}.Metric",xu.dataType="MetricData",xu);function xu(e,t,r,i,n,o,a){var s=_u.call(this)||this;s.aiDataContract={ver:tl.Required,metrics:tl.Required,properties:tl.Default};var l=new gu;return l.count=0<i?i:void 0,l.max=isNaN(o)||null===o?void 0:o,l.min=isNaN(n)||null===n?void 0:n,l.name=Cl.sanitizeString(e,t)||Il.NotSpecified,l.value=r,s.metrics=[l],s.properties=Cl.sanitizeProperties(e,a),s}var wu,Su=(d(Tu,wu=Kl),Tu);function Tu(){var e=wu.call(this)||this;return e.ver=2,e.properties={},e.measurements={},e}var Cu,Eu=(d(Iu,Cu=Su),Iu.envelopeType="Microsoft.ApplicationInsights.{0}.Pageview",Iu.dataType="PageviewData",Iu);function Iu(e,t,r,i,n,o,a){var s=Cu.call(this)||this;return s.aiDataContract={ver:tl.Required,name:tl.Default,url:tl.Default,duration:tl.Default,properties:tl.Default,measurements:tl.Default,id:tl.Default},s.id=Cl.sanitizeId(e,a),s.url=Cl.sanitizeUrl(e,r),s.name=Cl.sanitizeString(e,t)||Il.NotSpecified,isNaN(i)||(s.duration=Il.msToTimeSpan(i)),s.properties=Cl.sanitizeProperties(e,n),s.measurements=Cl.sanitizeMeasurements(e,o),s}var Pu,Ru=(d(Nu,Pu=Zl),Nu);function Nu(){var e=Pu.call(this)||this;return e.ver=2,e.success=!0,e.properties={},e.measurements={},e}var Au,zu=(d(Mu,Au=Ru),Mu.envelopeType="Microsoft.ApplicationInsights.{0}.RemoteDependency",Mu.dataType="RemoteDependencyData",Mu);function Mu(e,t,r,i,n,o,a,s,l,u,c,p){void 0===l&&(l="Ajax");var h=Au.call(this)||this;h.aiDataContract={id:tl.Required,ver:tl.Required,name:tl.Default,resultCode:tl.Default,duration:tl.Default,success:tl.Default,data:tl.Default,target:tl.Default,type:tl.Default,properties:tl.Default,measurements:tl.Default,kind:tl.Default,value:tl.Default,count:tl.Default,min:tl.Default,max:tl.Default,stdDev:tl.Default,dependencyKind:tl.Default,dependencySource:tl.Default,commandName:tl.Default,dependencyTypeName:tl.Default},h.id=t,h.duration=Il.msToTimeSpan(n),h.success=o,h.resultCode=a+"",h.type=Cl.sanitizeString(e,l);var d=Ml.ParseDependencyPath(e,r,s,i);return h.data=Cl.sanitizeUrl(e,i)||d.data,h.target=Cl.sanitizeString(e,d.target),u&&(h.target=h.target+" | "+u),h.name=Cl.sanitizeString(e,d.name),h.properties=Cl.sanitizeProperties(e,c),h.measurements=Cl.sanitizeMeasurements(e,p),h}var ku,Ou=(d(Lu,ku=Zl),Lu);function Lu(){var e=ku.call(this)||this;return e.ver=2,e.properties={},e}var Du,Bu=(d(Fu,Du=Ou),Fu.envelopeType="Microsoft.ApplicationInsights.{0}.Message",Fu.dataType="MessageData",Fu);function Fu(e,t,r,i){var n=Du.call(this)||this;return n.aiDataContract={ver:tl.Required,message:tl.Required,severityLevel:tl.Default,properties:tl.Default},t=t||Il.NotSpecified,n.message=Cl.sanitizeMessage(e,t),n.properties=Cl.sanitizeProperties(e,i),r&&(n.severityLevel=r),n}var qu,Uu=(d(ju,qu=Su),ju);function ju(){var e=qu.call(this)||this;return e.ver=2,e.properties={},e.measurements={},e}var Vu,Gu=(d(Hu,Vu=Uu),Hu.envelopeType="Microsoft.ApplicationInsights.{0}.PageviewPerformance",Hu.dataType="PageviewPerformanceData",Hu);function Hu(e,t,r,i,n,o,a){var s=Vu.call(this)||this;return s.aiDataContract={ver:tl.Required,name:tl.Default,url:tl.Default,duration:tl.Default,perfTotal:tl.Default,networkConnect:tl.Default,sentRequest:tl.Default,receivedResponse:tl.Default,domProcessing:tl.Default,properties:tl.Default,measurements:tl.Default},s.url=Cl.sanitizeUrl(e,r),s.name=Cl.sanitizeString(e,t)||Il.NotSpecified,s.properties=Cl.sanitizeProperties(e,n),s.measurements=Cl.sanitizeMeasurements(e,o),a&&(s.domProcessing=a.domProcessing,s.duration=a.duration,s.networkConnect=a.networkConnect,s.perfTotal=a.perfTotal,s.receivedResponse=a.receivedResponse,s.sentRequest=a.sentRequest),s}var Zu,Wu,Ku,Xu=(d(Yu,Zu=Ul),Yu);function Yu(e,t){var r=Zu.call(this)||this;return r.aiDataContract={baseType:tl.Required,baseData:tl.Required},r.baseType=e,r.baseData=t,r}(Ku=Wu=Wu||{})[Ku.Verbose=0]="Verbose",Ku[Ku.Information=1]="Information",Ku[Ku.Warning=2]="Warning",Ku[Ku.Error=3]="Error",Ku[Ku.Critical=4]="Critical";var Ju=($u.getConfig=function(e,t,r,i){var n;return void 0===i&&(i=!1),n=r&&e.extensionConfig&&e.extensionConfig[r]&&!ll.isNullOrUndefined(e.extensionConfig[r][t])?e.extensionConfig[r][t]:e[t],ll.isNullOrUndefined(n)?i:n},$u);function $u(){}var Qu=function(){this.applicationVersion="ai.application.ver",this.applicationBuild="ai.application.build",this.applicationTypeId="ai.application.typeId",this.applicationId="ai.application.applicationId",this.applicationLayer="ai.application.layer",this.deviceId="ai.device.id",this.deviceIp="ai.device.ip",this.deviceLanguage="ai.device.language",this.deviceLocale="ai.device.locale",this.deviceModel="ai.device.model",this.deviceFriendlyName="ai.device.friendlyName",this.deviceNetwork="ai.device.network",this.deviceNetworkName="ai.device.networkName",this.deviceOEMName="ai.device.oemName",this.deviceOS="ai.device.os",this.deviceOSVersion="ai.device.osVersion",this.deviceRoleInstance="ai.device.roleInstance",this.deviceRoleName="ai.device.roleName",this.deviceScreenResolution="ai.device.screenResolution",this.deviceType="ai.device.type",this.deviceMachineName="ai.device.machineName",this.deviceVMName="ai.device.vmName",this.deviceBrowser="ai.device.browser",this.deviceBrowserVersion="ai.device.browserVersion",this.locationIp="ai.location.ip",this.locationCountry="ai.location.country",this.locationProvince="ai.location.province",this.locationCity="ai.location.city",this.operationId="ai.operation.id",this.operationName="ai.operation.name",this.operationParentId="ai.operation.parentId",this.operationRootId="ai.operation.rootId",this.operationSyntheticSource="ai.operation.syntheticSource",this.operationCorrelationVector="ai.operation.correlationVector",this.sessionId="ai.session.id",this.sessionIsFirst="ai.session.isFirst",this.sessionIsNew="ai.session.isNew",this.userAccountAcquisitionDate="ai.user.accountAcquisitionDate",this.userAccountId="ai.user.accountId",this.userAgent="ai.user.userAgent",this.userId="ai.user.id",this.userStoreRegion="ai.user.storeRegion",this.userAuthUserId="ai.user.authUserId",this.userAnonymousUserAcquisitionDate="ai.user.anonUserAcquisitionDate",this.userAuthenticatedUserAcquisitionDate="ai.user.authUserAcquisitionDate",this.cloudName="ai.cloud.name",this.cloudRole="ai.cloud.role",this.cloudRoleVer="ai.cloud.roleVer",this.cloudRoleInstance="ai.cloud.roleInstance",this.cloudEnvironment="ai.cloud.environment",this.cloudLocation="ai.cloud.location",this.cloudDeploymentUnit="ai.cloud.deploymentUnit",this.internalNodeName="ai.internal.nodeName",this.internalSdkVersion="ai.internal.sdkVersion",this.internalAgentVersion="ai.internal.agentVersion"},ec=(tc.create=function(e,t,r,i,n,o){if(r=Cl.sanitizeString(i,r)||Il.NotSpecified,ll.isNullOrUndefined(e)||ll.isNullOrUndefined(t)||ll.isNullOrUndefined(r))throw Error("Input doesn't contain all required fields");var a={name:r,time:(new Date).toISOString(),iKey:"",ext:o||{},tags:[],data:{},baseType:t,baseData:e};if(!ll.isNullOrUndefined(n))for(var s in n)n.hasOwnProperty(s)&&(a.data[s]=n[s]);return a},tc);function tc(){}var rc=(ic.UserExt="user",ic.DeviceExt="device",ic.TraceExt="trace",ic.WebExt="web",ic.AppExt="app",ic.OSExt="os",ic.SessionExt="ses",ic.SDKExt="sdk",ic);function ic(){}var nc=new Qu,oc="AppInsightsPropertiesPlugin",ac="AppInsightsChannelPlugin",sc=(lc.prototype.trackPageView=function(e,t){var r=this,i=e.name;!ll.isNullOrUndefined(i)&&"string"==typeof i||(e.name=window.document&&window.document.title||"");var n=e.uri;if(!ll.isNullOrUndefined(n)&&"string"==typeof n||(e.uri=window.location&&window.location.href||""),!this._pageViewPerformanceManager.isPerformanceTimingSupported())return this.appInsights.sendPageViewInternal(e,t),this._channel().forEach((function(e){e.forEach((function(e){return e.flush(!0)}))})),void this._logger.throwInternal(cl.WARNING,25,"trackPageView: navigation timing API used for calculation of page duration is not supported in this browser. This page view will be collected without duration and timing info.");var o=!1,a=void 0,s=this._pageViewPerformanceManager.getPerformanceTiming().navigationStart;a=Ol.GetDuration(s,+new Date),this._pageViewPerformanceManager.shouldCollectDuration(a)||(a=void 0);var l=void 0;ll.isNullOrUndefined(t)||ll.isNullOrUndefined(t.duration)||(l=t.duration),!this.overridePageViewDuration&&isNaN(l)||(isNaN(l)&&((t=t||{}).duration=a),this.appInsights.sendPageViewInternal(e,t),this._channel().forEach((function(e){e.forEach((function(e){return e.flush(!0)}))})),o=!0),t=t||{};var u=setInterval((function(){try{if(r._pageViewPerformanceManager.isPerformanceTimingDataReady()){clearInterval(u);var l={name:i,uri:n};r._pageViewPerformanceManager.populatePageViewPerformanceEvent(l),l.isValid||o?(o||(t.duration=l.durationMs,r.appInsights.sendPageViewInternal(e,t)),r.pageViewPerformanceSent||(r.appInsights.sendPageViewPerformanceInternal(l,t),r.pageViewPerformanceSent=!0),r._channel().forEach((function(e){e.forEach((function(e){return e.flush(!0)}))}))):(t.duration=a,r.appInsights.sendPageViewInternal(e,t),r._channel().forEach((function(e){e.forEach((function(e){return e.flush(!0)}))})))}else 6e4<Ol.GetDuration(s,+new Date)&&(clearInterval(u),o||(t.duration=6e4,r.appInsights.sendPageViewInternal(e,t),r._channel().forEach((function(e){e.forEach((function(e){return e.flush(!0)}))}))))}catch(l){r._logger.throwInternal(cl.CRITICAL,38,"trackPageView failed on page load calculation: "+Il.getExceptionName(l),{exception:Il.dump(l)})}}),100)},lc);function lc(e,t,r,i){this.pageViewPerformanceSent=!1,this.overridePageViewDuration=!1,this.overridePageViewDuration=t,this.appInsights=e,this._pageViewPerformanceManager=i,r&&(this._channel=function(){return r.getTransmissionControls()},this._logger=r.logger)}var uc=(cc.prototype.trackPreviousPageVisit=function(e,t){try{var r=this.restartPageVisitTimer(e,t);r&&this.pageVisitTimeTrackingHandler(r.pageName,r.pageUrl,r.pageVisitTime)}catch(e){this._logger.warnToConsole("Auto track page visit time failed, metric will not be collected: "+Il.dump(e))}},cc.prototype.restartPageVisitTimer=function(e,t){try{var r=this.stopPageVisitTimer();return this.startPageVisitTimer(e,t),r}catch(e){return this._logger.warnToConsole("Call to restart failed: "+Il.dump(e)),null}},cc.prototype.startPageVisitTimer=function(e,t){try{if(Il.canUseSessionStorage()){if(null!=Il.getSessionStorage(this._logger,this.prevPageVisitDataKeyName))throw new Error("Cannot call startPageVisit consecutively without first calling stopPageVisit");var r=new pc(e,t),i=JSON.stringify(r);Il.setSessionStorage(this._logger,this.prevPageVisitDataKeyName,i)}}catch(e){this._logger.warnToConsole("Call to start failed: "+Il.dump(e))}},cc.prototype.stopPageVisitTimer=function(){try{if(Il.canUseSessionStorage()){var e=Date.now(),t=Il.getSessionStorage(this._logger,this.prevPageVisitDataKeyName);if(t){var r=JSON.parse(t);return r.pageVisitTime=e-r.pageVisitStartTime,Il.removeSessionStorage(this._logger,this.prevPageVisitDataKeyName),r}return null}return null}catch(e){return this._logger.warnToConsole("Stop page visit timer failed: "+Il.dump(e)),null}},cc);function cc(e,t){this.prevPageVisitDataKeyName="prevPageVisitData",this.pageVisitTimeTrackingHandler=t,this._logger=e}var pc=function(e,t){this.pageVisitStartTime=Date.now(),this.pageName=e,this.pageUrl=t},hc=(dc.prototype.populatePageViewPerformanceEvent=function(e){e.isValid=!1;var t=this.getPerformanceTiming();if(t){var r=Ol.GetDuration(t.navigationStart,t.loadEventEnd),i=Ol.GetDuration(t.navigationStart,t.connectEnd),n=Ol.GetDuration(t.requestStart,t.responseStart),o=Ol.GetDuration(t.responseStart,t.responseEnd),a=Ol.GetDuration(t.responseEnd,t.loadEventEnd);0==r?this._logger.throwInternal(cl.WARNING,10,"error calculating page view performance.",{total:r,network:i,request:n,response:o,dom:a}):this.shouldCollectDuration(r,i,n,o,a)?r<Math.floor(i)+Math.floor(n)+Math.floor(o)+Math.floor(a)?this._logger.throwInternal(cl.WARNING,8,"client performance math error.",{total:r,network:i,request:n,response:o,dom:a}):(e.durationMs=r,e.perfTotal=e.duration=Il.msToTimeSpan(r),e.networkConnect=Il.msToTimeSpan(i),e.sentRequest=Il.msToTimeSpan(n),e.receivedResponse=Il.msToTimeSpan(o),e.domProcessing=Il.msToTimeSpan(a),e.isValid=!0):this._logger.throwInternal(cl.WARNING,45,"Invalid page load duration value. Browser perf data won't be sent.",{total:r,network:i,request:n,response:o,dom:a})}},dc.prototype.getPerformanceTiming=function(){return this.isPerformanceTimingSupported()?window.performance.timing:null},dc.prototype.isPerformanceTimingSupported=function(){return"undefined"!=typeof window&&window.performance&&window.performance.timing},dc.prototype.isPerformanceTimingDataReady=function(){var e=window.performance.timing;return 0<e.domainLookupStart&&0<e.navigationStart&&0<e.responseStart&&0<e.requestStart&&0<e.loadEventEnd&&0<e.responseEnd&&0<e.connectEnd&&0<e.domLoading},dc.prototype.shouldCollectDuration=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=["googlebot","adsbot-google","apis-google","mediapartners-google"],i=navigator.userAgent,n=!1;if(i)for(var o=0;o<r.length;o++)n=n||-1!==i.toLowerCase().indexOf(r[o]);if(n)return!1;for(var a=0;a<e.length;a++)if(e[a]>=this.MAX_DURATION_ALLOWED)return!1;return!0},dc);function dc(e){this.MAX_DURATION_ALLOWED=36e5,e&&(this._logger=e.logger)}var mc="duration",fc=(yc.getDefaultConfig=function(e){return(e=e||{}).sessionRenewalMs=18e5,e.sessionExpirationMs=864e5,e.disableExceptionTracking=Il.stringToBoolOrDefault(e.disableExceptionTracking),e.autoTrackPageVisitTime=Il.stringToBoolOrDefault(e.autoTrackPageVisitTime),e.overridePageViewDuration=Il.stringToBoolOrDefault(e.overridePageViewDuration),(isNaN(e.samplingPercentage)||e.samplingPercentage<=0||100<=e.samplingPercentage)&&(e.samplingPercentage=100),e.isCookieUseDisabled=Il.stringToBoolOrDefault(e.isCookieUseDisabled),e.isStorageUseDisabled=Il.stringToBoolOrDefault(e.isStorageUseDisabled),e.isBrowserLinkTrackingEnabled=Il.stringToBoolOrDefault(e.isBrowserLinkTrackingEnabled),e.enableAutoRouteTracking=Il.stringToBoolOrDefault(e.enableAutoRouteTracking),e.namePrefix=e.namePrefix||"",e},yc.prototype.processTelemetry=function(e){for(var t=!1,r=this._telemetryInitializers.length,i=0;i<r;++i){var n=this._telemetryInitializers[i];if(n)try{if(!1===n.apply(null,[e])){t=!0;break}}catch(e){this._logger.throwInternal(cl.CRITICAL,64,"One of telemetry initializers failed, telemetry item will not be sent: "+Il.getExceptionName(e),{exception:Il.dump(e)},!0)}}t||ll.isNullOrUndefined(this._nextPlugin)||this._nextPlugin.processTelemetry(e)},yc.prototype.setNextPlugin=function(e){this._nextPlugin=e},yc.prototype.trackEvent=function(e,t){try{var r=ec.create(e,Jl.dataType,Jl.envelopeType,this._logger,t);this.core.track(r)}catch(e){this._logger.throwInternal(cl.WARNING,39,"trackTrace failed, trace will not be collected: "+Il.getExceptionName(e),{exception:Il.dump(e)})}},yc.prototype.startTrackEvent=function(e){try{this._eventTracking.start(e)}catch(e){this._logger.throwInternal(cl.CRITICAL,29,"startTrackEvent failed, event will not be collected: "+Il.getExceptionName(e),{exception:Il.dump(e)})}},yc.prototype.stopTrackEvent=function(e,t,r){try{this._eventTracking.stop(e,void 0,t)}catch(e){this._logger.throwInternal(cl.CRITICAL,30,"stopTrackEvent failed, event will not be collected: "+Il.getExceptionName(e),{exception:Il.dump(e)})}},yc.prototype.trackTrace=function(e,t){try{var r=ec.create(e,Bu.dataType,Bu.envelopeType,this._logger,t);this.core.track(r)}catch(e){this._logger.throwInternal(cl.WARNING,39,"trackTrace failed, trace will not be collected: "+Il.getExceptionName(e),{exception:Il.dump(e)})}},yc.prototype.trackMetric=function(e,t){try{var r=ec.create(e,bu.dataType,bu.envelopeType,this._logger,t);this.core.track(r)}catch(e){this._logger.throwInternal(cl.CRITICAL,36,"trackMetric failed, metric will not be collected: "+Il.getExceptionName(e),{exception:Il.dump(e)})}},yc.prototype.trackPageView=function(e,t){try{var r=e||{};this._pageViewManager.trackPageView(r,m({},r.properties,r.measurements,t)),this.config.autoTrackPageVisitTime&&this._pageVisitTimeManager.trackPreviousPageVisit(r.name,r.uri)}catch(e){this._logger.throwInternal(cl.CRITICAL,37,"trackPageView failed, page view will not be collected: "+Il.getExceptionName(e),{exception:Il.dump(e)})}},yc.prototype.sendPageViewInternal=function(e,t,r){"undefined"!=typeof document&&(e.refUri=void 0===e.refUri?document.referrer:e.refUri);var i=ec.create(e,Eu.dataType,Eu.envelopeType,this._logger,t,r);this.core.track(i),this._trackAjaxAttempts=0},yc.prototype.sendPageViewPerformanceInternal=function(e,t,r){var i=ec.create(e,Gu.dataType,Gu.envelopeType,this._logger,t,r);this.core.track(i)},yc.prototype.trackPageViewPerformance=function(e,t){try{this._pageViewPerformanceManager.populatePageViewPerformanceEvent(e),this.sendPageViewPerformanceInternal(e,t)}catch(e){this._logger.throwInternal(cl.CRITICAL,37,"trackPageViewPerformance failed, page view will not be collected: "+Il.getExceptionName(e),{exception:Il.dump(e)})}},yc.prototype.startTrackPage=function(e){try{"string"!=typeof e&&(e=window.document&&window.document.title||""),this._pageTracking.start(e)}catch(e){this._logger.throwInternal(cl.CRITICAL,31,"startTrackPage failed, page view may not be collected: "+Il.getExceptionName(e),{exception:Il.dump(e)})}},yc.prototype.stopTrackPage=function(e,t,r,i){try{"string"!=typeof e&&(e=window.document&&window.document.title||""),"string"!=typeof t&&(t=window.location&&window.location.href||""),this._pageTracking.stop(e,t,r,i),this.config.autoTrackPageVisitTime&&this._pageVisitTimeManager.trackPreviousPageVisit(e,t)}catch(e){this._logger.throwInternal(cl.CRITICAL,32,"stopTrackPage failed, page view will not be collected: "+Il.getExceptionName(e),{exception:Il.dump(e)})}},yc.prototype.sendExceptionInternal=function(e,t,r){var i=new iu(this._logger,e.exception||new Error(Il.NotSpecified),e.properties,e.measurements,e.severityLevel,e.id).toInterface(),n=ec.create(i,iu.dataType,iu.envelopeType,this._logger,t,r);this.core.track(n)},yc.prototype.trackException=function(e,t){try{this.sendExceptionInternal(e,t)}catch(e){this._logger.throwInternal(cl.CRITICAL,35,"trackException failed, exception will not be collected: "+Il.getExceptionName(e),{exception:Il.dump(e)})}},yc.prototype._onerror=function(e){try{var t={url:e&&e.url||document.URL,lineNumber:e.lineNumber,columnNumber:e.columnNumber,message:e.message};if(Il.isCrossOriginError(e.message,e.url,e.lineNumber,e.columnNumber,e.error))this._sendCORSException(t.url);else{if(!Il.isError(e.error)){var r="window.onerror@"+t.url+":"+e.lineNumber+":"+(e.columnNumber||0);e.error=new Error(e.message),e.error.stack=r}this.trackException({exception:e.error,severityLevel:Wu.Error},t)}}catch(t){var i=e.error?e.error.name+", "+e.error.message:"null";this._logger.throwInternal(cl.CRITICAL,11,"_onError threw exception while logging error, error will not be collected: "+Il.getExceptionName(t),{exception:Il.dump(t),errorString:i})}},yc.prototype.addTelemetryInitializer=function(e){this._telemetryInitializers.push(e)},yc.prototype._initialize=function(e,t,r){var i=this;if(!this._isInitialized){if(ll.isNullOrUndefined(t))throw Error("Error initializing");this.core=t,this._logger=t.logger,this._globalconfig={instrumentationKey:e.instrumentationKey,endpointUrl:e.endpointUrl||"https://dc.services.visualstudio.com/v2/track"},this.config=e.extensionConfig&&e.extensionConfig[this.identifier]?e.extensionConfig[this.identifier]:{};var n=yc.getDefaultConfig();if(void 0!==n){for(var o in n)this.config[o]=Ju.getConfig(e,o,this.identifier,n[o]);if(this._globalconfig)for(var o in n)void 0===this._globalconfig[o]&&(this._globalconfig[o]=n[o])}this.config.isCookieUseDisabled&&Il.disableCookies(),this.config.isStorageUseDisabled&&Il.disableStorage();var a={instrumentationKey:function(){return e.instrumentationKey},accountId:function(){return i.config.accountId||e.accountId},sessionRenewalMs:function(){return i.config.sessionRenewalMs||e.sessionRenewalMs},sessionExpirationMs:function(){return i.config.sessionExpirationMs||e.sessionExpirationMs},sampleRate:function(){return i.config.samplingPercentage||e.samplingPercentage},cookieDomain:function(){return i.config.cookieDomain||e.cookieDomain},sdkExtension:function(){return i.config.sdkExtension||e.sdkExtension},isBrowserLinkTrackingEnabled:function(){return i.config.isBrowserLinkTrackingEnabled||e.isBrowserLinkTrackingEnabled},appId:function(){return i.config.appId||e.appId}};this._pageViewPerformanceManager=new hc(this.core),this._pageViewManager=new sc(this,this.config.overridePageViewDuration,this.core,this._pageViewPerformanceManager),this._pageVisitTimeManager=new uc(this._logger,(function(e,t,r){return i.trackPageVisitTime(e,t,r)})),this._telemetryInitializers=[],this._addDefaultTelemetryInitializers(a),this._eventTracking=new gc(this._logger,"trackEvent"),this._eventTracking.action=function(e,t,r,n){(n=n||{})[mc]=r.toString(),i.trackEvent({name:e,properties:n})},this._pageTracking=new gc(this._logger,"trackPageView"),this._pageTracking.action=function(e,t,r,n,o){ll.isNullOrUndefined(n)&&(n={}),n[mc]=r.toString();var a={name:e,uri:t,properties:n,measurements:o};i.sendPageViewInternal(a)};var s,l,u=this;if(!1===this.config.disableExceptionTracking&&!this.config.autoExceptionInstrumented){var c=window.onerror;window.onerror=function(e,t,r,i,n){var o=c&&c(e,t,r,i,n);return!0!==o&&u._onerror({message:e,url:t,lineNumber:r,columnNumber:i,error:n}),o},this.config.autoExceptionInstrumented=!0}if(!0===this.config.enableAutoRouteTracking&&"object"==typeof history&&"function"==typeof history.pushState&&"function"==typeof history.replaceState&&"object"==typeof window&&"undefined"!=typeof Event){var p=this;r.forEach((function(e){e.identifier===oc&&(i._properties=e)})),history.pushState=(l=history.pushState,function(){var e=l.apply(this,arguments);return window.dispatchEvent(Il.createDomEvent(p.config.namePrefix+"pushState")),window.dispatchEvent(Il.createDomEvent(p.config.namePrefix+"locationchange")),e}),history.replaceState=(s=history.replaceState,function(){var e=s.apply(this,arguments);return window.dispatchEvent(Il.createDomEvent(p.config.namePrefix+"replaceState")),window.dispatchEvent(Il.createDomEvent(p.config.namePrefix+"locationchange")),e}),window.addEventListener(p.config.namePrefix+"popstate",(function(){window.dispatchEvent(Il.createDomEvent(p.config.namePrefix+"locationchange"))})),window.addEventListener(p.config.namePrefix+"locationchange",(function(){p._properties&&p._properties.context&&p._properties.context.telemetryTrace&&(p._properties.context.telemetryTrace.traceID=Il.generateW3CId(),p._properties.context.telemetryTrace.name=window.location&&window.location.pathname||"_unknown_"),i._currUri&&(i._prevUri=i._currUri),i._currUri=window.location&&window.location.href||"",setTimeout(function(e){p.trackPageView({refUri:e,properties:{duration:0}})}.bind(i,i._prevUri),p.autoRoutePVDelay)}))}this._isInitialized=!0}},yc.prototype.trackPageVisitTime=function(e,t,r){var i={PageName:e,PageUrl:t};this.trackMetric({name:"PageVisitTime",average:r,max:r,min:r,sampleCount:1},i)},yc.prototype._addDefaultTelemetryInitializers=function(e){if(!e.isBrowserLinkTrackingEnabled()){var t=["/browserLinkSignalR/","/__browserLink/"];this._addTelemetryInitializer((function(e){if(e.baseType===zu.dataType){var r=e.baseData;if(r)for(var i=0;i<t.length;i++)if(r.target&&0<=r.target.indexOf(t[i]))return!1}return!0}))}},yc.prototype._addTelemetryInitializer=function(e){this._telemetryInitializers.push(e)},yc.prototype._sendCORSException=function(e){var t={message:"Script error: The browser's same-origin policy prevents us from getting the details of this exception. Consider using the 'crossorigin' attribute.",url:e,lineNumber:0,columnNumber:0,error:void 0},r=ec.create(t,iu.dataType,iu.envelopeType,this._logger,{url:e});this.core.track(r)},yc.Version="2.2.2",yc);function yc(){this.identifier="ApplicationInsightsAnalytics",this.priority=180,this.autoRoutePVDelay=500,this._isInitialized=!1,this._trackAjaxAttempts=0,this._prevUri="object"==typeof window&&window.location&&window.location.href||"",this.initialize=this._initialize.bind(this)}var gc=(vc.prototype.start=function(e){void 0!==this._events[e]&&this._logger.throwInternal(cl.WARNING,62,"start was called more than once for this event without calling stop.",{name:this._name,key:e},!0),this._events[e]=+new Date},vc.prototype.stop=function(e,t,r,i){var n=this._events[e];if(isNaN(n))this._logger.throwInternal(cl.WARNING,63,"stop was called without a corresponding start.",{name:this._name,key:e},!0);else{var o=+new Date,a=Ol.GetDuration(n,o);this.action(e,t,a,r,i)}delete this._events[e],this._events[e]=void 0},vc);function vc(e,t){this._name=t,this._events={},this._logger=e}var _c=(bc.prototype.enqueue=function(e){this._buffer.push(e)},bc.prototype.count=function(){return this._buffer.length},bc.prototype.clear=function(){this._buffer.length=0},bc.prototype.getItems=function(){return this._buffer.slice(0)},bc.prototype.batchPayloads=function(e){return e&&0<e.length?this._config.emitLineDelimitedJson()?e.join("\n"):"["+e.join(",")+"]":null},bc.prototype.markAsSent=function(e){this.clear()},bc.prototype.clearSent=function(e){},bc);function bc(e){this._config=e,this._buffer=[]}var xc=(wc.prototype.enqueue=function(e){this._buffer.length>=wc.MAX_BUFFER_SIZE?this._bufferFullMessageSent||(this._logger.throwInternal(cl.WARNING,67,"Maximum buffer size reached: "+this._buffer.length,!0),this._bufferFullMessageSent=!0):(this._buffer.push(e),this.setBuffer(wc.BUFFER_KEY,this._buffer))},wc.prototype.count=function(){return this._buffer.length},wc.prototype.clear=function(){this._buffer.length=0,this.setBuffer(wc.BUFFER_KEY,[]),this.setBuffer(wc.SENT_BUFFER_KEY,[]),this._bufferFullMessageSent=!1},wc.prototype.getItems=function(){return this._buffer.slice(0)},wc.prototype.batchPayloads=function(e){return e&&0<e.length?this._config.emitLineDelimitedJson()?e.join("\n"):"["+e.join(",")+"]":null},wc.prototype.markAsSent=function(e){this._buffer=this.removePayloadsFromBuffer(e,this._buffer),this.setBuffer(wc.BUFFER_KEY,this._buffer);var t=this.getBuffer(wc.SENT_BUFFER_KEY);t instanceof Array&&e instanceof Array&&((t=t.concat(e)).length>wc.MAX_BUFFER_SIZE&&(this._logger.throwInternal(cl.CRITICAL,67,"Sent buffer reached its maximum size: "+t.length,!0),t.length=wc.MAX_BUFFER_SIZE),this.setBuffer(wc.SENT_BUFFER_KEY,t))},wc.prototype.clearSent=function(e){var t=this.getBuffer(wc.SENT_BUFFER_KEY);t=this.removePayloadsFromBuffer(e,t),this.setBuffer(wc.SENT_BUFFER_KEY,t)},wc.prototype.removePayloadsFromBuffer=function(e,t){var r=[];for(var i in t){var n=!1;for(var o in e)if(e[o]===t[i]){n=!0;break}n||r.push(t[i])}return r},wc.prototype.getBuffer=function(e){var t=e;try{t=this._config.namePrefix&&this._config.namePrefix()?this._config.namePrefix()+"_"+t:t;var r=Il.getSessionStorage(this._logger,t);if(r){var i=JSON.parse(r);if(i)return i}}catch(e){this._logger.throwInternal(cl.CRITICAL,42," storage key: "+t+", "+Il.getExceptionName(e),{exception:Il.dump(e)})}return[]},wc.prototype.setBuffer=function(e,t){var r=e;try{r=this._config.namePrefix&&this._config.namePrefix()?this._config.namePrefix()+"_"+r:r;var i=JSON.stringify(t);Il.setSessionStorage(this._logger,r,i)}catch(e){Il.setSessionStorage(this._logger,r,JSON.stringify([])),this._logger.throwInternal(cl.WARNING,41," storage key: "+r+", "+Il.getExceptionName(e)+". Buffer cleared",{exception:Il.dump(e)})}},wc.BUFFER_KEY="AI_buffer",wc.SENT_BUFFER_KEY="AI_sentBuffer",wc.MAX_BUFFER_SIZE=2e3,wc);function wc(e,t){this._bufferFullMessageSent=!1,this._logger=e,this._config=t;var r=this.getBuffer(wc.BUFFER_KEY),i=this.getBuffer(wc.SENT_BUFFER_KEY);this._buffer=r.concat(i),this._buffer.length>wc.MAX_BUFFER_SIZE&&(this._buffer.length=wc.MAX_BUFFER_SIZE),this.setBuffer(wc.SENT_BUFFER_KEY,[]),this.setBuffer(wc.BUFFER_KEY,this._buffer)}var Sc=(Tc.extractProperties=function(e){var t=null;for(var r in e)if(e.hasOwnProperty(r)){var i=e[r];"number"!=typeof i&&((t=t||{})[r]=i)}return t},Tc.extractPropsAndMeasurements=function(e,t,r){if(!ll.isNullOrUndefined(e))for(var i in e)if(e.hasOwnProperty(i)){var n=e[i];"number"==typeof n?r[i]=n:t[i]="string"==typeof n?n:JSON.stringify(n)}},Tc.createEnvelope=function(e,t,r,i){var n=new Gl(e,i,t);n.iKey=r.iKey;var o=r.iKey.replace(/-/g,"");return n.name=n.name.replace("{0}",o),Tc.extractPartAExtensions(r,n),r.tags||(r.tags=[]),n},Tc.extractPartAExtensions=function(e,t){if(t.tags||(t.tags={}),e.ext||(e.ext={}),e.tags||(e.tags=[]),e.ext.user){e.ext.user.authId&&(t.tags[nc.userAuthUserId]=e.ext.user.authId);var r=e.ext.user.id||e.ext.user.localId;r&&(t.tags[nc.userId]=r)}if(e.ext.app&&e.ext.app.sesId&&(t.tags[nc.sessionId]=e.ext.app.sesId),e.ext.device&&((e.ext.device.id||e.ext.device.localId)&&(t.tags[nc.deviceId]=e.ext.device.id||e.ext.device.localId),e.ext.device.deviceClass&&(t.tags[nc.deviceType]=e.ext.device.deviceClass),e.ext.device.ip&&(t.tags[nc.deviceIp]=e.ext.device.ip)),e.ext.web){var i=e.ext.web;i.browserLang&&(t.tags[nc.deviceLanguage]=i.browserLang),i.browserVer&&(t.tags[nc.deviceBrowserVersion]=i.browserVer),i.browser&&(t.tags[nc.deviceBrowser]=i.browser),t.data=t.data||{},t.data.baseData=t.data.baseData||{},t.data.baseData.properties=t.data.baseData.properties||{},i.domain&&(t.data.baseData.properties.domain=i.domain),i.isManual&&(t.data.baseData.properties.isManual=i.isManual.toString()),i.screenRes&&(t.data.baseData.properties.screenRes=i.screenRes),i.userConsent&&(t.data.baseData.properties.userConsent=i.userConsent.toString())}e.ext.device&&e.ext.device.model&&(t.tags[nc.deviceModel]=e.ext.device.model),e.ext.os&&e.ext.os.name&&(t.tags[nc.deviceOS]=e.ext.os.name),e.ext.device&&e.ext.device.deviceType&&(t.tags[nc.deviceType]=e.ext.device.deviceType),e.ext.trace&&(e.ext.trace.parentID&&(t.tags[nc.operationParentId]=e.ext.trace.parentID),e.ext.trace.name&&(t.tags[nc.operationName]=e.ext.trace.name),e.ext.trace.traceID&&(t.tags[nc.operationId]=e.ext.trace.traceID));for(var n={},o=function(t){var r=e.tags[t];Object.keys(r).forEach((function(e){n[e]=r[e]})),e.tags.splice(t,1)},a=e.tags.length-1;0<=a;a--)o(a);for(var s in e.tags)n[s]=e.tags[s];t.tags=m({},t.tags,n),t.tags[nc.internalSdkVersion]||(t.tags[nc.internalSdkVersion]="javascript:"+Tc.Version)},Tc.Version="2.2.2",Tc);function Tc(){}var Cc,Ec=(d(Ic,Cc=Sc),Ic.prototype.Create=function(e,t){this._logger=e,ll.isNullOrUndefined(t.baseData)&&this._logger.throwInternal(cl.CRITICAL,46,"telemetryItem.baseData cannot be null.");var r=t.baseData.measurements||{},i=t.baseData.properties||{};Sc.extractPropsAndMeasurements(t.data,i,r);var n=t.baseData;if(ll.isNullOrUndefined(n))return e.warnToConsole("Invalid input for dependency data"),null;var o=n.id,a=n.target,s=n.name,l=n.duration,u=n.success,c=n.responseCode,p=n.type,h=n.correlationContext,d=n.properties&&n.properties[ql]?n.properties[ql]:"GET",m=new zu(e,o,a,s,l,u,c,d,p,h,i,r),f=new Xu(zu.dataType,m);return Sc.createEnvelope(e,zu.envelopeType,t,f)},Ic.DependencyEnvelopeCreator=new Ic,Ic);function Ic(){return null!==Cc&&Cc.apply(this,arguments)||this}var Pc,Rc=(d(Nc,Pc=Sc),Nc.prototype.Create=function(e,t){this._logger=e,ll.isNullOrUndefined(t.baseData)&&this._logger.throwInternal(cl.CRITICAL,46,"telemetryItem.baseData cannot be null.");var r={},i={};t.baseType!==Jl.dataType&&(r.baseTypeSource=t.baseType),t.baseType===Jl.dataType?(r=t.baseData.properties||{},i=t.baseData.measurements||{}):t.baseData&&Sc.extractPropsAndMeasurements(t.baseData,r,i),Sc.extractPropsAndMeasurements(t.data,r,i);var n=t.baseData.name,o=new Jl(e,n,r,i),a=new Xu(Jl.dataType,o);return Sc.createEnvelope(e,Jl.envelopeType,t,a)},Nc.EventEnvelopeCreator=new Nc,Nc);function Nc(){return null!==Pc&&Pc.apply(this,arguments)||this}var Ac,zc=(d(Mc,Ac=Sc),Mc.prototype.Create=function(e,t){this._logger=e,ll.isNullOrUndefined(t.baseData)&&this._logger.throwInternal(cl.CRITICAL,46,"telemetryItem.baseData cannot be null.");var r=t.baseData,i=iu.CreateFromInterface(e,r),n=new Xu(iu.dataType,i);return Sc.createEnvelope(e,iu.envelopeType,t,n)},Mc.ExceptionEnvelopeCreator=new Mc,Mc);function Mc(){return null!==Ac&&Ac.apply(this,arguments)||this}var kc,Oc=(d(Lc,kc=Sc),Lc.prototype.Create=function(e,t){this._logger=e,ll.isNullOrUndefined(t.baseData)&&this._logger.throwInternal(cl.CRITICAL,46,"telemetryItem.baseData cannot be null.");var r=t.baseData.properties||{},i=Sc.extractProperties(t.data);i=m({},r,i);var n=t.baseData.name,o=t.baseData.average,a=t.baseData.sampleCount,s=t.baseData.min,l=t.baseData.max,u=new bu(e,n,o,a,s,l,i),c=new Xu(bu.dataType,u);return Sc.createEnvelope(e,bu.envelopeType,t,c)},Lc.MetricEnvelopeCreator=new Lc,Lc);function Lc(){return null!==kc&&kc.apply(this,arguments)||this}var Dc,Bc=(d(Fc,Dc=Sc),Fc.prototype.Create=function(e,t){this._logger=e,ll.isNullOrUndefined(t.baseData)&&this._logger.throwInternal(cl.CRITICAL,46,"telemetryItem.baseData cannot be null.");var r=void 0;ll.isNullOrUndefined(t.baseData)||ll.isNullOrUndefined(t.baseData.properties)||ll.isNullOrUndefined(t.baseData.properties.duration)?ll.isNullOrUndefined(t.data)||ll.isNullOrUndefined(t.data.duration)||(r=t.data.duration,delete t.data.duration):(r=t.baseData.properties.duration,delete t.baseData.properties.duration);var i,n=t.baseData;t.ext&&t.ext.trace&&t.ext.trace.traceID&&(i=t.ext.trace.traceID);var o=n.id||i,a=n.name,s=n.uri,l=n.properties||{},u=n.measurements||{};if(ll.isNullOrUndefined(n.refUri)||(l.refUri=n.refUri),ll.isNullOrUndefined(n.pageType)||(l.pageType=n.pageType),ll.isNullOrUndefined(n.isLoggedIn)||(l.isLoggedIn=n.isLoggedIn.toString()),!ll.isNullOrUndefined(n.properties)){var c=n.properties;for(var p in c)c.hasOwnProperty(p)&&(l[p]=c[p])}Sc.extractPropsAndMeasurements(t.data,l,u);var h=new Eu(e,a,s,r,l,u,o),d=new Xu(Eu.dataType,h);return Sc.createEnvelope(e,Eu.envelopeType,t,d)},Fc.PageViewEnvelopeCreator=new Fc,Fc);function Fc(){return null!==Dc&&Dc.apply(this,arguments)||this}var qc,Uc=(d(jc,qc=Sc),jc.prototype.Create=function(e,t){this._logger=e,ll.isNullOrUndefined(t.baseData)&&this._logger.throwInternal(cl.CRITICAL,46,"telemetryItem.baseData cannot be null.");var r=t.baseData,i=r.name,n=r.uri||r.url,o=r.properties||{},a=r.measurements||{};Sc.extractPropsAndMeasurements(t.data,o,a);var s=new Gu(e,i,n,void 0,o,a,r),l=new Xu(Gu.dataType,s);return Sc.createEnvelope(e,Gu.envelopeType,t,l)},jc.PageViewPerformanceEnvelopeCreator=new jc,jc);function jc(){return null!==qc&&qc.apply(this,arguments)||this}var Vc,Gc=(d(Hc,Vc=Sc),Hc.prototype.Create=function(e,t){this._logger=e,ll.isNullOrUndefined(t.baseData)&&this._logger.throwInternal(cl.CRITICAL,46,"telemetryItem.baseData cannot be null.");var r=t.baseData.message,i=t.baseData.severityLevel,n=Sc.extractProperties(t.data),o=m({},n,t.baseData.properties),a=new Bu(e,r,i,o),s=new Xu(Bu.dataType,a);return Sc.createEnvelope(e,Bu.envelopeType,t,s)},Hc.TraceEnvelopeCreator=new Hc,Hc);function Hc(){return null!==Vc&&Vc.apply(this,arguments)||this}var Zc=(Wc.prototype.serialize=function(e){var t=this._serializeObject(e,"root");return JSON.stringify(t)},Wc.prototype._serializeObject=function(e,t){var r="__aiCircularRefCheck",i={};if(!e)return this._logger.throwInternal(cl.CRITICAL,48,"cannot serialize object because it is null or undefined",{name:t},!0),i;if(e[r])return this._logger.throwInternal(cl.WARNING,50,"Circular reference detected while serializing object",{name:t},!0),i;if(!e.aiDataContract){if("measurements"===t)i=this._serializeStringMap(e,"number",t);else if("properties"===t)i=this._serializeStringMap(e,"string",t);else if("tags"===t)i=this._serializeStringMap(e,"string",t);else if(Il.isArray(e))i=this._serializeArray(e,t);else{this._logger.throwInternal(cl.WARNING,49,"Attempting to serialize an object which does not implement ISerializable",{name:t},!0);try{JSON.stringify(e),i=e}catch(e){this._logger.throwInternal(cl.CRITICAL,48,e&&"function"==typeof e.toString?e.toString():"Error serializing object",null,!0)}}return i}for(var n in e[r]=!0,e.aiDataContract){var o,a=e.aiDataContract[n],s="function"==typeof a?a()&tl.Required:a&tl.Required,l="function"==typeof a?a()&tl.Hidden:a&tl.Hidden,u=a&tl.Array,c=void 0!==e[n],p="object"==typeof e[n]&&null!==e[n];!s||c||u?l||void 0!==(o=p?u?this._serializeArray(e[n],n):this._serializeObject(e[n],n):e[n])&&(i[n]=o):this._logger.throwInternal(cl.CRITICAL,24,"Missing required field specification. The field is required but not present on source",{field:n,name:t})}return delete e[r],i},Wc.prototype._serializeArray=function(e,t){var r=void 0;if(e)if(Il.isArray(e)){r=[];for(var i=0;i<e.length;i++){var n=e[i],o=this._serializeObject(n,t+"["+i+"]");r.push(o)}}else this._logger.throwInternal(cl.CRITICAL,54,"This field was specified as an array in the contract but the item is not an array.\r\n",{name:t},!0);return r},Wc.prototype._serializeStringMap=function(e,t,r){var i=void 0;if(e)for(var n in i={},e){var o=e[n];if("string"===t)void 0===o?i[n]="undefined":null===o?i[n]="null":o.toString?i[n]=o.toString():i[n]="invalid field: toString() is not defined.";else if("number"===t)if(void 0===o)i[n]="undefined";else if(null===o)i[n]="null";else{var a=parseFloat(o);isNaN(a)?i[n]="NaN":i[n]=a}else i[n]="invalid field: "+r+" is of unknown type.",this._logger.throwInternal(cl.CRITICAL,i[n],null,!0)}return i},Wc);function Wc(e){this._logger=e}function Kc(){this._onlineStatus=!0;try{"undefined"==typeof window?this.isListening=!1:window&&window.addEventListener?(window.addEventListener("online",this._setOnline.bind(this),!1),window.addEventListener("offline",this._setOffline.bind(this),!1),this.isListening=!0):document&&document.body?(document.body.ononline=this._setOnline.bind(this),document.body.onoffline=this._setOffline.bind(this),this.isListening=!0):document?(document.ononline=this._setOnline.bind(this),document.onoffline=this._setOffline.bind(this),this.isListening=!0):this.isListening=!1}catch(e){this.isListening=!1}}var Xc=(Kc.prototype._setOnline=function(){this._onlineStatus=!0},Kc.prototype._setOffline=function(){this._onlineStatus=!1},Kc.prototype.isOnline=function(){return this.isListening?this._onlineStatus:!(navigator&&!ll.isNullOrUndefined(navigator.onLine))||navigator.onLine},Kc.prototype.isOffline=function(){return!this.isOnline()},Kc.Offline=new Kc,Kc).Offline,Yc=(Jc.prototype.getHashCodeScore=function(e){return this.getHashCode(e)/Jc.INT_MAX_VALUE*100},Jc.prototype.getHashCode=function(e){if(""==e)return 0;for(;e.length<Jc.MIN_INPUT_LENGTH;)e=e.concat(e);for(var t=5381,r=0;r<e.length;++r)t=(t<<5)+t+e.charCodeAt(r),t&=t;return Math.abs(t)},Jc.INT_MAX_VALUE=2147483647,Jc.MIN_INPUT_LENGTH=8,Jc);function Jc(){}var $c=(Qc.prototype.getSamplingScore=function(e){return e.tags&&e.tags[this.keys.userId]?this.hashCodeGeneragor.getHashCodeScore(e.tags[this.keys.userId]):e.ext&&e.ext.user&&e.ext.user.id?this.hashCodeGeneragor.getHashCodeScore(e.ext.user.id):e.tags&&e.tags[this.keys.operationId]?this.hashCodeGeneragor.getHashCodeScore(e.tags[this.keys.operationId]):e.ext&&e.ext.telemetryTrace&&e.ext.telemetryTrace.traceID?this.hashCodeGeneragor.getHashCodeScore(e.ext.telemetryTrace.traceID):100*Math.random()},Qc);function Qc(){this.hashCodeGeneragor=new Yc,this.keys=new Qu}var ep=(tp.prototype.isSampledIn=function(e){var t=this.sampleRate;return null==t||100<=t||e.baseType===bu.dataType||this.samplingScoreGenerator.getSamplingScore(e)<t},tp);function tp(e,t){this.INT_MAX_VALUE=2147483647,ll.isNullOrUndefined(t)?this._logger=new gl:this._logger=t,(100<e||e<0)&&(this._logger.throwInternal(cl.WARNING,58,"Sampling rate is out of range (0..100). Sampling will be disabled, you may be sending too much data which may affect your AI service level.",{samplingRate:e},!0),this.sampleRate=100),this.sampleRate=e,this.samplingScoreGenerator=new $c}var rp=(ip.prototype.pause=function(){throw new Error("Method not implemented.")},ip.prototype.resume=function(){throw new Error("Method not implemented.")},ip.prototype.flush=function(){try{this.triggerSend()}catch(e){this._logger.throwInternal(cl.CRITICAL,22,"flush failed, telemetry will not be collected: "+Il.getExceptionName(e),{exception:Il.dump(e)})}},ip.prototype.onunloadFlush=function(){if(!1!==this._config.onunloadDisableBeacon()&&!1!==this._config.isBeaconApiDisabled()||!Il.IsBeaconApiSupported())this.flush();else try{this.triggerSend(!0,this._beaconSender)}catch(e){this._logger.throwInternal(cl.CRITICAL,20,"failed to flush with beacon sender on page unload, telemetry will not be collected: "+Il.getExceptionName(e),{exception:Il.dump(e)})}},ip.prototype.teardown=function(){throw new Error("Method not implemented.")},ip.prototype.initialize=function(e,t,r){var i=this;this._logger=t.logger,this._serializer=new Zc(t.logger),this._consecutiveErrors=0,this._retryAt=null,this._lastSend=0,this._sender=null;var n=ip._getDefaultAppInsightsChannelConfig();function o(t){a._config[t]=function(){return Ju.getConfig(e,t,i.identifier,n[t]())}}this._config=ip._getEmptyAppInsightsChannelConfig();var a=this;for(var s in n)o(s);this._buffer=this._config.enableSessionStorageBuffer&&Il.canUseSessionStorage()?new xc(this._logger,this._config):new _c(this._config),this._sample=new ep(this._config.samplingPercentage(),this._logger),!this._config.isBeaconApiDisabled()&&Il.IsBeaconApiSupported()?this._sender=this._beaconSender:"undefined"!=typeof XMLHttpRequest&&("withCredentials"in new XMLHttpRequest?(this._sender=this._xhrSender,this._XMLHttpRequestSupported=!0):"undefined"!=typeof XDomainRequest&&(this._sender=this._xdrSender))},ip.prototype.processTelemetry=function(e){var t=this;try{if(this._config.disableTelemetry())return;if(!e)return void this._logger.throwInternal(cl.CRITICAL,7,"Cannot send empty telemetry");if(e.baseData&&!e.baseType)return void this._logger.throwInternal(cl.CRITICAL,70,"Cannot send telemetry without baseData and baseType");if(e.baseType||(e.baseType="EventData"),!this._sender)return void this._logger.throwInternal(cl.CRITICAL,28,"Sender was not initialized");if(!this._isSampledIn(e))return void this._logger.throwInternal(cl.WARNING,33,"Telemetry item was sampled out and not sent",{SampleRate:this._sample.sampleRate});e.tags=e.tags||{},e.tags.sampleRate=this._sample.sampleRate;var r=ip.constructEnvelope(e,this._config.instrumentationKey(),this._logger);if(!r)return void this._logger.throwInternal(cl.CRITICAL,47,"Unable to create an AppInsights envelope");var i=!1;if(e.tags&&e.tags[Fl]&&(e.tags[Fl].forEach((function(e){try{e&&!1===e(r)&&(i=!0,t._logger.warnToConsole("Telemetry processor check returns false"))}catch(e){t._logger.throwInternal(cl.CRITICAL,64,"One of telemetry initializers failed, telemetry item will not be sent: "+Il.getExceptionName(e),{exception:Il.dump(e)},!0)}})),delete e.tags[Fl]),i)return;var n=this._serializer.serialize(r),o=this._buffer.getItems(),a=this._buffer.batchPayloads(o);a&&a.length+n.length>this._config.maxBatchSizeInBytes()&&this.triggerSend(),this._buffer.enqueue(n),this._setupTimer()}catch(e){this._logger.throwInternal(cl.WARNING,12,"Failed adding telemetry to the sender's buffer, some telemetry will be lost: "+Il.getExceptionName(e),{exception:Il.dump(e)})}ll.isNullOrUndefined(this._nextPlugin)||this._nextPlugin.processTelemetry(e)},ip.prototype.setNextPlugin=function(e){this._nextPlugin=e},ip.prototype._xhrReadyStateChange=function(e,t,r){if(4===e.readyState){var i=null;this._appId||(i=this._parseResponse(e.responseText||e.response))&&i.appId&&(this._appId=i.appId),(e.status<200||300<=e.status)&&0!==e.status?!this._config.isRetryDisabled()&&this._isRetriable(e.status)?(this._resendPayload(t),this._logger.throwInternal(cl.WARNING,40,". Response code "+e.status+". Will retry to send "+t.length+" items.")):this._onError(t,this._formatErrorMessageXhr(e)):Xc.isOffline()?this._config.isRetryDisabled()||(this._resendPayload(t,10),this._logger.throwInternal(cl.WARNING,40,". Offline - Response Code: "+e.status+". Offline status: "+Xc.isOffline()+". Will retry to send "+t.length+" items.")):206===e.status?(i=i||this._parseResponse(e.responseText||e.response))&&!this._config.isRetryDisabled()?this._onPartialSuccess(t,i):this._onError(t,this._formatErrorMessageXhr(e)):(this._consecutiveErrors=0,this._onSuccess(t,r))}},ip.prototype.triggerSend=function(e,t){void 0===e&&(e=!0);try{if(this._config.disableTelemetry())this._buffer.clear();else{if(0<this._buffer.count()){var r=this._buffer.getItems();t?t.call(this,r,e):this._sender(r,e)}this._lastSend=+new Date}clearTimeout(this._timeoutHandle),this._timeoutHandle=null,this._retryAt=null}catch(e){(!Il.getIEVersion()||9<Il.getIEVersion())&&this._logger.throwInternal(cl.CRITICAL,40,"Telemetry transmission failed, some telemetry will be lost: "+Il.getExceptionName(e),{exception:Il.dump(e)})}},ip.prototype._onError=function(e,t,r){this._logger.throwInternal(cl.WARNING,26,"Failed to send telemetry.",{message:t}),this._buffer.clearSent(e)},ip.prototype._onPartialSuccess=function(e,t){for(var r=[],i=[],n=0,o=t.errors.reverse();n<o.length;n++){var a=o[n],s=e.splice(a.index,1)[0];this._isRetriable(a.statusCode)?i.push(s):r.push(s)}0<e.length&&this._onSuccess(e,t.itemsAccepted),0<r.length&&this._onError(r,this._formatErrorMessageXhr(null,["partial success",t.itemsAccepted,"of",t.itemsReceived].join(" "))),0<i.length&&(this._resendPayload(i),this._logger.throwInternal(cl.WARNING,40,"Partial success. Delivered: "+e.length+", Failed: "+r.length+". Will retry to send "+i.length+" our of "+t.itemsReceived+" items"))},ip.prototype._onSuccess=function(e,t){this._buffer.clearSent(e)},ip.prototype._xdrOnLoad=function(e,t){if(!e||e.responseText+""!="200"&&""!==e.responseText){var r=this._parseResponse(e.responseText);r&&r.itemsReceived&&r.itemsReceived>r.itemsAccepted&&!this._config.isRetryDisabled()?this._onPartialSuccess(t,r):this._onError(t,this._formatErrorMessageXdr(e))}else this._consecutiveErrors=0,this._onSuccess(t,0)},ip.constructEnvelope=function(e,t,r){var i;switch((i=t===e.iKey||ll.isNullOrUndefined(t)?e:m({},e,{iKey:t})).baseType){case Jl.dataType:return Rc.EventEnvelopeCreator.Create(r,i);case Bu.dataType:return Gc.TraceEnvelopeCreator.Create(r,i);case Eu.dataType:return Bc.PageViewEnvelopeCreator.Create(r,i);case Gu.dataType:return Uc.PageViewPerformanceEnvelopeCreator.Create(r,i);case iu.dataType:return zc.ExceptionEnvelopeCreator.Create(r,i);case bu.dataType:return Oc.MetricEnvelopeCreator.Create(r,i);case zu.dataType:return Ec.DependencyEnvelopeCreator.Create(r,i);default:return Rc.EventEnvelopeCreator.Create(r,i)}},ip._getDefaultAppInsightsChannelConfig=function(){return{endpointUrl:function(){return"https://dc.services.visualstudio.com/v2/track"},emitLineDelimitedJson:function(){return!1},maxBatchInterval:function(){return 15e3},maxBatchSizeInBytes:function(){return 102400},disableTelemetry:function(){return!1},enableSessionStorageBuffer:function(){return!0},isRetryDisabled:function(){return!1},isBeaconApiDisabled:function(){return!0},onunloadDisableBeacon:function(){return!1},instrumentationKey:function(){},namePrefix:function(){},samplingPercentage:function(){return 100}}},ip._getEmptyAppInsightsChannelConfig=function(){return{endpointUrl:void 0,emitLineDelimitedJson:void 0,maxBatchInterval:void 0,maxBatchSizeInBytes:void 0,disableTelemetry:void 0,enableSessionStorageBuffer:void 0,isRetryDisabled:void 0,isBeaconApiDisabled:void 0,onunloadDisableBeacon:void 0,instrumentationKey:void 0,namePrefix:void 0,samplingPercentage:void 0}},ip.prototype._isSampledIn=function(e){return this._sample.isSampledIn(e)},ip.prototype._beaconSender=function(e,t){var r=this._config.endpointUrl(),i=this._buffer.batchPayloads(e),n=new Blob([i],{type:"text/plain;charset=UTF-8"});navigator.sendBeacon(r,n)?(this._buffer.markAsSent(e),this._onSuccess(e,e.length)):(this._xhrSender(e,!0),this._logger.throwInternal(cl.WARNING,40,". Failed to send telemetry with Beacon API, retried with xhrSender."))},ip.prototype._xhrSender=function(e,t){var r=this,i=new XMLHttpRequest;i[Bl]=!0,i.open("POST",this._config.endpointUrl(),t),i.setRequestHeader("Content-type","application/json"),Il.isInternalApplicationInsightsEndpoint(this._config.endpointUrl())&&i.setRequestHeader(Sl.sdkContextHeader,Sl.sdkContextHeaderAppIdRequest),i.onreadystatechange=function(){return r._xhrReadyStateChange(i,e,e.length)},i.onerror=function(t){return r._onError(e,r._formatErrorMessageXhr(i),t)};var n=this._buffer.batchPayloads(e);i.send(n),this._buffer.markAsSent(e)},ip.prototype._parseResponse=function(e){try{if(e&&""!==e){var t=JSON.parse(e);if(t&&t.itemsReceived&&t.itemsReceived>=t.itemsAccepted&&t.itemsReceived-t.itemsAccepted==t.errors.length)return t}}catch(t){this._logger.throwInternal(cl.CRITICAL,43,"Cannot parse the response. "+Il.getExceptionName(t),{response:e})}return null},ip.prototype._resendPayload=function(e,t){if(void 0===t&&(t=1),e&&0!==e.length){this._buffer.clearSent(e),this._consecutiveErrors++;for(var r=0,i=e;r<i.length;r++){var n=i[r];this._buffer.enqueue(n)}this._setRetryTime(t),this._setupTimer()}},ip.prototype._setRetryTime=function(e){var t;if(this._consecutiveErrors<=1)t=10;else{var r=(Math.pow(2,this._consecutiveErrors)-1)/2,i=Math.floor(Math.random()*r*10)+1;i*=e,t=Math.max(Math.min(i,3600),10)}var n=Date.now()+1e3*t;this._retryAt=n},ip.prototype._setupTimer=function(){var e=this;if(!this._timeoutHandle){var t=this._retryAt?Math.max(0,this._retryAt-Date.now()):0,r=Math.max(this._config.maxBatchInterval(),t);this._timeoutHandle=setTimeout((function(){e.triggerSend()}),r)}},ip.prototype._isRetriable=function(e){return 408==e||429==e||500==e||503==e},ip.prototype._formatErrorMessageXhr=function(e,t){return e?"XMLHttpRequest,Status:"+e.status+",Response:"+e.responseText||!1:t},ip.prototype._xdrSender=function(e,t){var r=this,i=new XDomainRequest;i.onload=function(){return r._xdrOnLoad(i,e)},i.onerror=function(t){return r._onError(e,r._formatErrorMessageXdr(i),t)};var n=window.location&&window.location.protocol;if(0!==this._config.endpointUrl().lastIndexOf(n,0))return this._logger.throwInternal(cl.WARNING,40,". Cannot send XDomain request. The endpoint URL protocol doesn't match the hosting page protocol."),void this._buffer.clear();var o=this._config.endpointUrl().replace(/^(https?:)/,"");i.open("POST",o);var a=this._buffer.batchPayloads(e);i.send(a),this._buffer.markAsSent(e)},ip.prototype._formatErrorMessageXdr=function(e,t){return e?"XDomainRequest,Response:"+e.responseText||!1:t},ip);function ip(){this.priority=1001,this.identifier=ac,this._XMLHttpRequestSupported=!1}var np=function(){},op=(ap.prototype.update=function(){this.automaticSession.id||this.initializeAutomaticSession();var e=Ol.Now(),t=e-this.automaticSession.acquisitionDate>this.config.sessionExpirationMs(),r=e-this.automaticSession.renewalDate>this.config.sessionRenewalMs();t||r?this.renew():(!this.cookieUpdatedTimestamp||e-this.cookieUpdatedTimestamp>ap.cookieUpdateInterval)&&(this.automaticSession.renewalDate=e,this.setCookie(this.automaticSession.id,this.automaticSession.acquisitionDate,this.automaticSession.renewalDate))},ap.prototype.backup=function(){this.setStorage(this.automaticSession.id,this.automaticSession.acquisitionDate,this.automaticSession.renewalDate)},ap.prototype.initializeAutomaticSession=function(){var e=Il.getCookie(this._logger,this._storageNamePrefix());if(e&&"function"==typeof e.split)this.initializeAutomaticSessionWithData(e);else{var t=Il.getStorage(this._logger,this._storageNamePrefix());t&&this.initializeAutomaticSessionWithData(t)}this.automaticSession.id||this.renew()},ap.prototype.initializeAutomaticSessionWithData=function(e){var t=e.split("|");0<t.length&&(this.automaticSession.id=t[0]);try{if(1<t.length){var r=+t[1];this.automaticSession.acquisitionDate=+new Date(r),this.automaticSession.acquisitionDate=0<this.automaticSession.acquisitionDate?this.automaticSession.acquisitionDate:0}if(2<t.length){var i=+t[2];this.automaticSession.renewalDate=+new Date(i),this.automaticSession.renewalDate=0<this.automaticSession.renewalDate?this.automaticSession.renewalDate:0}}catch(e){this._logger.throwInternal(cl.CRITICAL,9,"Error parsing ai_session cookie, session will be reset: "+Il.getExceptionName(e),{exception:Il.dump(e)})}0==this.automaticSession.renewalDate&&this._logger.throwInternal(cl.WARNING,27,"AI session renewal date is 0, session will be reset.")},ap.prototype.renew=function(){var e=Ol.Now();this.automaticSession.id=Il.newId(),this.automaticSession.acquisitionDate=e,this.automaticSession.renewalDate=e,this.setCookie(this.automaticSession.id,this.automaticSession.acquisitionDate,this.automaticSession.renewalDate),Il.canUseLocalStorage()||this._logger.throwInternal(cl.WARNING,0,"Browser does not support local storage. Session durations will be inaccurate.")},ap.prototype.setCookie=function(e,t,r){var i=t+this.config.sessionExpirationMs(),n=r+this.config.sessionRenewalMs(),o=new Date,a=[e,t,r];i<n?o.setTime(i):o.setTime(n);var s=this.config.cookieDomain?this.config.cookieDomain():null;Il.setCookie(this._logger,this._storageNamePrefix(),a.join("|")+";expires="+o.toUTCString(),s),this.cookieUpdatedTimestamp=Ol.Now()},ap.prototype.setStorage=function(e,t,r){Il.setStorage(this._logger,this._storageNamePrefix(),[e,t,r].join("|"))},ap.acquisitionSpan=864e5,ap.renewalSpan=18e5,ap.cookieUpdateInterval=6e4,ap.cookieNameConst="ai_session",ap);function ap(e,t){var r=this;ll.isNullOrUndefined(t)?this._logger=new gl:this._logger=t,"function"!=typeof(e=e||{}).sessionExpirationMs&&(e.sessionExpirationMs=function(){return ap.acquisitionSpan}),"function"!=typeof e.sessionRenewalMs&&(e.sessionRenewalMs=function(){return ap.renewalSpan}),this.config=e,this._storageNamePrefix=function(){return r.config.namePrefix&&r.config.namePrefix()?ap.cookieNameConst+r.config.namePrefix():ap.cookieNameConst},this.automaticSession=new np}var sp=function(){},lp=function(){this.id="browser",this.deviceClass="Browser"},up=function(e){this.sdkVersion=(e.sdkExtension&&e.sdkExtension()?e.sdkExtension()+"_":"")+"javascript:2.2.2"},cp=(pp.prototype.setAuthenticatedUserContext=function(e,t,r){if(void 0===r&&(r=!1),!this.validateUserInput(e)||t&&!this.validateUserInput(t))this._logger.throwInternal(cl.WARNING,60,"Setting auth user context failed. User auth/account id should be of type string, and not contain commas, semi-colons, equal signs, spaces, or vertical-bars.",!0);else{this.authenticatedId=e;var i=this.authenticatedId;t&&(this.accountId=t,i=[this.authenticatedId,this.accountId].join(pp.cookieSeparator)),r&&Il.setCookie(this._logger,pp.authUserCookieName,encodeURI(i),this.config.cookieDomain())}},pp.prototype.clearAuthenticatedUserContext=function(){this.authenticatedId=null,this.accountId=null,Il.deleteCookie(this._logger,pp.authUserCookieName)},pp.prototype.validateUserInput=function(e){return!("string"!=typeof e||!e||e.match(/,|;|=| |\|/))},pp.cookieSeparator="|",pp.userCookieName="ai_user",pp.authUserCookieName="ai_authUser",pp);function pp(e,t){this._logger=t;var r=Il.getCookie(this._logger,pp.userCookieName);if(r){var i=r.split(pp.cookieSeparator);0<i.length&&(this.id=i[0])}if(this.config=e,!this.id){this.id=Il.newId();var n=new Date,o=Il.toISOStringForIE8(n);this.accountAcquisitionDate=o,n.setTime(n.getTime()+31536e6);var a=[this.id,o],s=this.config.cookieDomain?this.config.cookieDomain():void 0;Il.setCookie(this._logger,pp.userCookieName,a.join(pp.cookieSeparator)+";expires="+n.toUTCString(),s);var l=e.namePrefix&&e.namePrefix()?e.namePrefix()+"ai_session":"ai_session";Il.removeStorage(this._logger,l)}this.accountId=e.accountId?e.accountId():void 0;var u=Il.getCookie(this._logger,pp.authUserCookieName);if(u){var c=(u=decodeURI(u)).split(pp.cookieSeparator);c[0]&&(this.authenticatedId=c[0]),1<c.length&&c[1]&&(this.accountId=c[1])}}var hp=function(){},dp=function(e,t,r){this.traceID=e||Il.generateW3CId(),this.parentID=t,this.name=r,window&&window.location&&window.location.pathname&&(this.name=window.location.pathname)},mp=(fp.prototype.applySessionContext=function(e){var t=this.session||this.sessionManager.automaticSession;t&&"string"==typeof t.id&&(e.ext.app.sesId=t.id),this.session&&("string"==typeof this.session.id?e.ext.app.sesId=this.session.id:e.ext.app.sesId=this.sessionManager.automaticSession.id)},fp.prototype.applyOperatingSystemContxt=function(e){this.os&&this.os.name&&(e.ext.os=this.os)},fp.prototype.applyApplicationContext=function(e){this.application&&("string"==typeof this.application.ver&&(e.tags[nc.applicationVersion]=this.application.ver),"string"==typeof this.application.build&&(e.tags[nc.applicationBuild]=this.application.build))},fp.prototype.applyDeviceContext=function(e){this.device&&("string"==typeof this.device.id&&(e.ext.device.localId=this.device.id),"string"==typeof this.device.ip&&(e.ext.device.ip=this.device.ip),"string"==typeof this.device.model&&(e.ext.device.model=this.device.model),"string"==typeof this.device.deviceClass&&(e.ext.device.deviceClass=this.device.deviceClass))},fp.prototype.applyInternalContext=function(e){this.internal&&("string"==typeof this.internal.agentVersion&&(e.tags[nc.internalAgentVersion]=this.internal.agentVersion),"string"==typeof this.internal.sdkVersion&&(e.tags[nc.internalSdkVersion]=this.internal.sdkVersion))},fp.prototype.applyLocationContext=function(e){this.location&&"string"==typeof this.location.ip&&(e.tags[nc.locationIp]=this.location.ip)},fp.prototype.applyOperationContext=function(e){if(this.telemetryTrace){var t=e.ext.trace||{traceID:void 0,parentID:void 0};"string"==typeof this.telemetryTrace.traceID&&(t.traceID=this.telemetryTrace.traceID),"string"==typeof this.telemetryTrace.name&&(t.name=this.telemetryTrace.name),"string"==typeof this.telemetryTrace.parentID&&(t.parentID=this.telemetryTrace.parentID),e.ext.trace=t}},fp.prototype.applyWebContext=function(e){this.web&&(e.ext.web=e.ext.web||{},e.ext.web=this.web)},fp.prototype.applyUserContext=function(e){this.user&&(e.tags||(e.tags=[]),"string"==typeof this.user.accountId&&(e.tags[nc.userAccountId]=this.user.accountId),"string"==typeof this.user.id&&(e.ext.user.id=this.user.id),"string"==typeof this.user.authenticatedId&&(e.ext.user.authId=this.user.authenticatedId))},fp.prototype.cleanUp=function(e){e.ext[rc.DeviceExt]&&0===Object.keys(e.ext[rc.DeviceExt]).length&&delete e.ext[rc.DeviceExt],e.ext[rc.UserExt]&&0===Object.keys(e.ext[rc.UserExt]).length&&delete e.ext[rc.UserExt],e.ext[rc.WebExt]&&0===Object.keys(e.ext[rc.WebExt]).length&&delete e.ext[rc.WebExt],e.ext[rc.OSExt]&&0===Object.keys(e.ext[rc.OSExt]).length&&delete e.ext[rc.OSExt],e.ext[rc.AppExt]&&0===Object.keys(e.ext[rc.AppExt]).length&&delete e.ext[rc.AppExt],e.ext[rc.TraceExt]&&0===Object.keys(e.ext[rc.TraceExt]).length&&delete e.ext[rc.TraceExt]},fp);function fp(e,t){"undefined"!=typeof window&&(this.sessionManager=new op(t,e),this.application=new sp,this.device=new lp,this.internal=new up(t),this.location=new hp,this.user=new cp(t,e),this.telemetryTrace=new dp,this.session=new np),this.appId=function(){return null}}var yp=(gp.getDefaultConfig=function(){return{instrumentationKey:function(){},accountId:function(){return null},sessionRenewalMs:function(){return 18e5},samplingPercentage:function(){return 100},sessionExpirationMs:function(){return 864e5},cookieDomain:function(){return null},sdkExtension:function(){return null},isBrowserLinkTrackingEnabled:function(){return!1},appId:function(){return null},namePrefix:function(){}}},gp.prototype.initialize=function(e,t,r){var i=this,n=gp.getDefaultConfig();function o(t){a._extensionConfig[t]=function(){return Ju.getConfig(e,t,i.identifier,n[t]())}}this._extensionConfig=this._extensionConfig||gp.getDefaultConfig();var a=this;for(var s in n)o(s);this._logger=t.logger,this.context=new mp(t.logger,this._extensionConfig),this._breezeChannel=Il.getExtension(r,ac),this.context.appId=function(){return i._breezeChannel?i._breezeChannel._appId:null}},gp.prototype.processTelemetry=function(e){ll.isNullOrUndefined(e)||(e.name===Eu.envelopeType&&this._logger.resetInternalMessageCount(),this.context.session&&"string"!=typeof this.context.session.id&&this.context.sessionManager.update(),this._processTelemetryInternal(e),ll.isNullOrUndefined(this._nextPlugin)||this._nextPlugin.processTelemetry(e))},gp.prototype.setNextPlugin=function(e){this._nextPlugin=e},gp.prototype._processTelemetryInternal=function(e){e.tags||(e.tags=[]),e.ext||(e.ext={}),e.ext[rc.DeviceExt]=e.ext[rc.DeviceExt]||{},e.ext[rc.WebExt]=e.ext[rc.WebExt]||{},e.ext[rc.UserExt]=e.ext[rc.UserExt]||{},e.ext[rc.OSExt]=e.ext[rc.OSExt]||{},e.ext[rc.AppExt]=e.ext[rc.AppExt]||{},e.ext[rc.TraceExt]=e.ext[rc.TraceExt]||{},this.context.applySessionContext(e),this.context.applyApplicationContext(e),this.context.applyDeviceContext(e),this.context.applyOperationContext(e),this.context.applyUserContext(e),this.context.applyOperatingSystemContxt(e),this.context.applyWebContext(e),this.context.applyLocationContext(e),this.context.applyInternalContext(e),this.context.cleanUp(e)},gp);function gp(){this.priority=110,this.identifier=oc}var vp=function(){this.openDone=!1,this.setRequestHeaderDone=!1,this.sendDone=!1,this.abortDone=!1,this.onreadystatechangeCallbackAttached=!1},_p=(bp.prototype.getAbsoluteUrl=function(){return this.requestUrl?Rl.getAbsoluteUrl(this.requestUrl):null},bp.prototype.getPathName=function(){return this.requestUrl?Cl.sanitizeUrl(this._logger,Rl.getCompleteUrl(this.method,this.requestUrl)):null},bp);function bp(e,t,r){this.completed=!1,this.requestHeadersSize=null,this.requestHeaders=null,this.ttfb=null,this.responseReceivingDuration=null,this.callbackDuration=null,this.ajaxTotalDuration=null,this.aborted=null,this.pageUrl=null,this.requestUrl=null,this.requestSize=0,this.method=null,this.status=null,this.requestSentTime=null,this.responseStartedTime=null,this.responseFinishedTime=null,this.callbackFinishedTime=null,this.endTime=null,this.originalOnreadystatechage=null,this.xhrMonitoringState=new vp,this.clientFailure=0,this.CalculateMetrics=function(){this.ajaxTotalDuration=Math.round(1e3*Ol.GetDuration(this.requestSentTime,this.responseFinishedTime))/1e3},this.traceID=e,this.spanID=t,this._logger=r}var xp=(wp.AttachEvent=function(e,t,r){var i=!1;return ll.isNullOrUndefined(e)||(ll.isNullOrUndefined(e.attachEvent)?ll.isNullOrUndefined(e.addEventListener)||(e.addEventListener(t,r,!1),i=!0):(e.attachEvent("on"+t,r),i=!0)),i},wp.DetachEvent=function(e,t,r){ll.isNullOrUndefined(e)||(ll.isNullOrUndefined(e.detachEvent)?ll.isNullOrUndefined(e.removeEventListener)||e.removeEventListener(t,r,!1):e.detachEvent("on"+t,r))},wp);function wp(){}var Sp=(Tp.isValidTraceId=function(e){return e.match(/^[0-9a-f]{32}$/)&&"00000000000000000000000000000000"!==e},Tp.isValidSpanId=function(e){return e.match(/^[0-9a-f]{16}$/)&&"0000000000000000"!==e},Tp.prototype.toString=function(){return this.version+"-"+this.traceId+"-"+this.spanId+"-"+this.traceFlag},Tp.DEFAULT_TRACE_FLAG="00",Tp.DEFAULT_VERSION="00",Tp);function Tp(e,t){this.traceFlag=Tp.DEFAULT_TRACE_FLAG,this.version=Tp.DEFAULT_VERSION,e&&Tp.isValidTraceId(e)?this.traceId=e:this.traceId=Il.generateW3CId(),t&&Tp.isValidSpanId(t)?this.spanId=t:this.spanId=Il.generateW3CId().substr(0,16)}var Cp=(Ep.prototype.isMonitoredInstance=function(e,t,r,i){var n=!1,o=!0,a=!1;return void 0!==r?(a=this._fetchInitialized,n="object"==typeof r&&!0===r[Bl]||!!i&&!0===i[Bl]):void 0!==e&&(a=this.initialized,n=!0===e[Bl],o=!0===t||!ll.isNullOrUndefined(e.ajaxData)),a&&o&&!n},Ep.prototype.supportsAjaxMonitoring=function(){var e=!0;(ll.isNullOrUndefined(XMLHttpRequest)||ll.isNullOrUndefined(XMLHttpRequest.prototype)||ll.isNullOrUndefined(XMLHttpRequest.prototype.open)||ll.isNullOrUndefined(XMLHttpRequest.prototype.send)||ll.isNullOrUndefined(XMLHttpRequest.prototype.abort))&&(e=!1);try{" a ".trim()}catch(t){e=!1}return e},Ep.prototype.instrumentOpen=function(){var e=XMLHttpRequest.prototype.open,t=this;XMLHttpRequest.prototype.open=function(r,i,n){try{!t.isMonitoredInstance(this,!0)||this.ajaxData&&this.ajaxData.xhrMonitoringState.openDone||t.openHandler(this,r,i,n)}catch(r){t._core.logger.throwInternal(cl.CRITICAL,15,"Failed to monitor XMLHttpRequest.open, monitoring data for this ajax call may be incorrect.",{ajaxDiagnosticsMessage:Ep.getFailedAjaxDiagnosticsMessage(this),exception:Il.dump(r)})}return e.apply(this,arguments)}},Ep.prototype.openHandler=function(e,t,r,i){var n=this._context&&this._context.telemetryTrace&&this._context.telemetryTrace.traceID||Il.generateW3CId(),o=Il.generateW3CId().substr(0,16),a=new _p(n,o,this._core.logger);a.method=t,a.requestUrl=r,a.xhrMonitoringState.openDone=!0,a.requestHeaders={},e.ajaxData=a,this.attachToOnReadyStateChange(e)},Ep.getFailedAjaxDiagnosticsMessage=function(e){var t="";try{ll.isNullOrUndefined(e)||ll.isNullOrUndefined(e.ajaxData)||ll.isNullOrUndefined(e.ajaxData.requestUrl)||(t+="(url: '"+e.ajaxData.requestUrl+"')")}catch(e){}return t},Ep.prototype.instrumentSend=function(){var e=XMLHttpRequest.prototype.send,t=this;XMLHttpRequest.prototype.send=function(r){try{t.isMonitoredInstance(this)&&!this.ajaxData.xhrMonitoringState.sendDone&&t.sendHandler(this,r)}catch(r){t._core.logger.throwInternal(cl.CRITICAL,17,"Failed to monitor XMLHttpRequest, monitoring data for this ajax call may be incorrect.",{ajaxDiagnosticsMessage:Ep.getFailedAjaxDiagnosticsMessage(this),exception:Il.dump(r)})}return e.apply(this,arguments)}},Ep.prototype.sendHandler=function(e,t){e.ajaxData.requestSentTime=Ol.Now(),(e=this.includeCorrelationHeaders(e.ajaxData,void 0,void 0,e)).ajaxData.xhrMonitoringState.sendDone=!0},Ep.prototype.instrumentAbort=function(){var e=XMLHttpRequest.prototype.abort,t=this;XMLHttpRequest.prototype.abort=function(){try{t.isMonitoredInstance(this)&&!this.ajaxData.xhrMonitoringState.abortDone&&(this.ajaxData.aborted=1,this.ajaxData.xhrMonitoringState.abortDone=!0)}catch(e){t._core.logger.throwInternal(cl.CRITICAL,13,"Failed to monitor XMLHttpRequest.abort, monitoring data for this ajax call may be incorrect.",{ajaxDiagnosticsMessage:Ep.getFailedAjaxDiagnosticsMessage(this),exception:Il.dump(e)})}return e.apply(this,arguments)}},Ep.prototype.instrumentSetRequestHeader=function(){if(this._config.enableRequestHeaderTracking){var e=XMLHttpRequest.prototype.setRequestHeader,t=this;XMLHttpRequest.prototype.setRequestHeader=function(r,i){try{t.isMonitoredInstance(this)&&(this.ajaxData.requestHeaders[r]=i)}catch(r){t._core.logger.throwInternal(cl.CRITICAL,71,"Failed to monitor XMLHttpRequest.setRequestHeader, monitoring data for this ajax call may be incorrect.",{ajaxDiagnosticsMessage:Ep.getFailedAjaxDiagnosticsMessage(this),exception:Il.dump(r)})}return e.apply(this,arguments)}}},Ep.prototype.attachToOnReadyStateChange=function(e){var t=this;e.ajaxData.xhrMonitoringState.onreadystatechangeCallbackAttached=xp.AttachEvent(e,"readystatechange",(function(){try{t.isMonitoredInstance(e)&&4===e.readyState&&t.onAjaxComplete(e)}catch(i){var r=Il.dump(i);r&&-1!=r.toLowerCase().indexOf("c00c023f")||t._core.logger.throwInternal(cl.CRITICAL,16,"Failed to monitor XMLHttpRequest 'readystatechange' event handler, monitoring data for this ajax call may be incorrect.",{ajaxDiagnosticsMessage:Ep.getFailedAjaxDiagnosticsMessage(e),exception:Il.dump(i)})}}))},Ep.prototype.onAjaxComplete=function(e){if(e.ajaxData.responseFinishedTime=Ol.Now(),e.ajaxData.status=e.status,e.ajaxData.CalculateMetrics(),e.ajaxData.ajaxTotalDuration<0)this._core.logger.throwInternal(cl.WARNING,14,"Failed to calculate the duration of the ajax call, monitoring data for this ajax call won't be sent.",{ajaxDiagnosticsMessage:Ep.getFailedAjaxDiagnosticsMessage(e),requestSentTime:e.ajaxData.requestSentTime,responseFinishedTime:e.ajaxData.responseFinishedTime});else{var t={id:"|"+e.ajaxData.traceID+"."+e.ajaxData.spanID,target:e.ajaxData.getAbsoluteUrl(),name:e.ajaxData.getPathName(),type:"Ajax",duration:e.ajaxData.ajaxTotalDuration,success:200<=+e.ajaxData.status&&+e.ajaxData.status<400,responseCode:+e.ajaxData.status,method:e.ajaxData.method},r=this.getAjaxCorrelationContext(e);if(r&&(t.correlationContext=r),this._config.enableRequestHeaderTracking&&0<Object.keys(e.ajaxData.requestHeaders).length&&(t.properties=t.properties||{},t.properties.requestHeaders={},t.properties.requestHeaders=e.ajaxData.requestHeaders),this._config.enableResponseHeaderTracking){var i=e.getAllResponseHeaders();if(i){var n=i.trim().split(/[\r\n]+/),o={};n.forEach((function(e){var t=e.split(": "),r=t.shift(),i=t.join(": ");o[r]=i})),0<Object.keys(o).length&&(t.properties=t.properties||{},t.properties.responseHeaders={},t.properties.responseHeaders=o)}}this.trackDependencyDataInternal(t),e.ajaxData=null}},Ep.prototype.getAjaxCorrelationContext=function(e){try{var t=e.getAllResponseHeaders();if(null!==t&&-1!==t.toLowerCase().indexOf(Sl.requestContextHeaderLowerCase)){var r=e.getResponseHeader(Sl.requestContextHeader);return Al.getCorrelationContext(r)}}catch(t){this._core.logger.throwInternal(cl.WARNING,18,"Failed to get Request-Context correlation header as it may be not included in the response or not accessible.",{ajaxDiagnosticsMessage:Ep.getFailedAjaxDiagnosticsMessage(e),exception:Il.dump(t)})}},Ep.prototype.trackDependencyDataInternal=function(e,t,r){if(-1===this._config.maxAjaxCallsPerView||this._trackAjaxAttempts<this._config.maxAjaxCallsPerView){var i=ec.create(e,zu.dataType,zu.envelopeType,this._core.logger,t,r);this._core.track(i)}else this._trackAjaxAttempts===this._config.maxAjaxCallsPerView&&this._core.logger.throwInternal(cl.CRITICAL,55,"Maximum ajax per page view limit reached, ajax monitoring is paused until the next trackPageView(). In order to increase the limit set the maxAjaxCallsPerView configuration parameter.",!0);++this._trackAjaxAttempts},Ep.prototype.trackDependencyData=function(e,t){this.trackDependencyDataInternal(e,t)},Ep.prototype.processTelemetry=function(e){this._nextPlugin&&this._nextPlugin.processTelemetry&&this._nextPlugin.processTelemetry(e)},Ep.prototype.setNextPlugin=function(e){e&&(this._nextPlugin=e)},Ep.prototype.instrumentFetch=function(){if(this.supportsFetch()&&!this._fetchInitialized){var e=window.fetch,t=this;window.fetch=function(r,i){var n;if(t.isFetchInstrumented(r)&&t.isMonitoredInstance(void 0,void 0,r,i))try{n=t.createFetchRecord(r,i),i=t.includeCorrelationHeaders(n,r,i)}catch(i){t._core.logger.throwInternal(cl.CRITICAL,15,"Failed to monitor Window.fetch, monitoring data for this fetch call may be incorrect.",{ajaxDiagnosticsMessage:this.getFailedFetchDiagnosticsMessage(r),exception:Il.dump(i)})}return e(r,i).then((function(e){return t.onFetchComplete(e,n),e})).catch((function(e){throw t.onFetchFailed(r,n,e),e}))},this._fetchInitialized=!0}},Ep.prototype.isFetchInstrumented=function(e){return this._fetchInitialized&&!0!==e[Bl]},Ep.prototype.supportsFetch=function(){var e=!0;return(!window||ll.isNullOrUndefined(window.Request)||ll.isNullOrUndefined(window.Request.prototype)||ll.isNullOrUndefined(window.fetch))&&(e=!1),e},Ep.prototype.createFetchRecord=function(e,t){var r=this._context&&this._context.telemetryTrace&&this._context.telemetryTrace.traceID||Il.generateW3CId(),i=Il.generateW3CId().substr(0,16),n=new _p(r,i,this._core.logger);return n.requestSentTime=Ol.Now(),e instanceof Request?n.requestUrl=e?e.url:"":n.requestUrl=e,t&&t.method?n.method=t.method:e&&e instanceof Request?n.method=e.method:n.method="GET",t&&t.headers&&this._config.enableRequestHeaderTracking?n.requestHeaders=t.headers:n.requestHeaders={},n},Ep.prototype.includeCorrelationHeaders=function(e,t,r,i){if(t){if(Al.canIncludeCorrelationHeader(this._config,e.getAbsoluteUrl(),this.currentWindowHost)){if((r=r||{}).headers=new Headers(r.headers||t instanceof Request&&t.headers||{}),this._isUsingAIHeaders){var n="|"+e.traceID+"."+e.spanID;r.headers.set(Sl.requestIdHeader,n),this._config.enableRequestHeaderTracking&&(e.requestHeaders[Sl.requestIdHeader]=n)}var o=this._config.appId||this._context.appId();if(o&&(r.headers.set(Sl.requestContextHeader,Sl.requestContextAppIdFormat+o),this._config.enableRequestHeaderTracking&&(e.requestHeaders[Sl.requestContextHeader]=Sl.requestContextAppIdFormat+o)),this._isUsingW3CHeaders){var a=new Sp(e.traceID,e.spanID);r.headers.set(Sl.traceParentHeader,a.toString()),this._config.enableRequestHeaderTracking&&(e.requestHeaders[Sl.traceParentHeader]=a.toString())}return r}return r}if(i){if(this.currentWindowHost&&Al.canIncludeCorrelationHeader(this._config,i.ajaxData.getAbsoluteUrl(),this.currentWindowHost)){this._isUsingAIHeaders&&(n="|"+i.ajaxData.traceID+"."+i.ajaxData.spanID,i.setRequestHeader(Sl.requestIdHeader,n),this._config.enableRequestHeaderTracking&&(i.ajaxData.requestHeaders[Sl.requestIdHeader]=n));var s=this._config.appId||this._context.appId();s&&(i.setRequestHeader(Sl.requestContextHeader,Sl.requestContextAppIdFormat+s),this._config.enableRequestHeaderTracking&&(i.ajaxData.requestHeaders[Sl.requestContextHeader]=Sl.requestContextAppIdFormat+s)),this._isUsingW3CHeaders&&(a=new Sp(i.ajaxData.traceID,i.ajaxData.spanID),i.setRequestHeader(Sl.traceParentHeader,a.toString()),this._config.enableRequestHeaderTracking&&(i.ajaxData.requestHeaders[Sl.traceParentHeader]=a.toString()))}return i}},Ep.prototype.getFailedFetchDiagnosticsMessage=function(e){var t="";try{ll.isNullOrUndefined(e)||(t+="string"==typeof e?"(url: '"+e+"')":"(url: '"+e.url+"')")}catch(e){this._core.logger.throwInternal(cl.CRITICAL,15,"Failed to grab failed fetch diagnostics message",{exception:Il.dump(e)})}return t},Ep.prototype.onFetchComplete=function(e,t){if(t)try{if(t.responseFinishedTime=Ol.Now(),t.CalculateMetrics(),t.ajaxTotalDuration<0)this._core.logger.throwInternal(cl.WARNING,14,"Failed to calculate the duration of the fetch call, monitoring data for this fetch call won't be sent.",{fetchDiagnosticsMessage:this.getFailedFetchDiagnosticsMessage(e),requestSentTime:t.requestSentTime,responseFinishedTime:t.responseFinishedTime});else{var r={id:"|"+t.traceID+"."+t.spanID,target:t.getAbsoluteUrl(),name:t.getPathName(),type:"Fetch",duration:t.ajaxTotalDuration,success:200<=e.status&&e.status<400,responseCode:e.status,properties:{HttpMethod:t.method}},i=this.getFetchCorrelationContext(e);if(i&&(r.correlationContext=i),this._config.enableRequestHeaderTracking&&0<Object.keys(t.requestHeaders).length&&(r.properties=r.properties||{},r.properties.requestHeaders=t.requestHeaders),this._config.enableResponseHeaderTracking){var n={};e.headers.forEach((function(e,t){n[t]=e})),0<Object.keys(n).length&&(r.properties=r.properties||{},r.properties.responseHeaders=n)}this.trackDependencyDataInternal(r)}}catch(t){this._core.logger.throwInternal(cl.WARNING,18,"Failed to calculate the duration of the fetch call, monitoring data for this fetch call won't be sent.",{fetchDiagnosticsMessage:this.getFailedFetchDiagnosticsMessage(e),exception:Il.dump(t)})}},Ep.prototype.onFetchFailed=function(e,t,r){if(t)try{if(t.responseFinishedTime=Ol.Now(),t.CalculateMetrics(),t.ajaxTotalDuration<0)this._core.logger.throwInternal(cl.WARNING,14,"Failed to calculate the duration of the failed fetch call, monitoring data for this fetch call won't be sent.",{fetchDiagnosticsMessage:this.getFailedFetchDiagnosticsMessage(e),requestSentTime:t.requestSentTime,responseFinishedTime:t.responseFinishedTime});else{var i={id:"|"+t.traceID+"."+t.spanID,target:t.getAbsoluteUrl(),name:t.getPathName(),type:"Fetch",duration:t.ajaxTotalDuration,success:!1,responseCode:0,properties:{HttpMethod:t.method}};this.trackDependencyDataInternal(i,{error:r.message})}}catch(t){this._core.logger.throwInternal(cl.WARNING,18,"Failed to calculate the duration of the failed fetch call, monitoring data for this fetch call won't be sent.",{fetchDiagnosticsMessage:this.getFailedFetchDiagnosticsMessage(e),exception:Il.dump(t)})}},Ep.prototype.getFetchCorrelationContext=function(e){try{var t=e.headers.get(Sl.requestContextHeader);return Al.getCorrelationContext(t)}catch(t){this._core.logger.throwInternal(cl.WARNING,18,"Failed to get Request-Context correlation header as it may be not included in the response or not accessible.",{fetchDiagnosticsMessage:this.getFailedFetchDiagnosticsMessage(e),exception:Il.dump(t)})}},Ep.prototype.instrumentXhr=function(){this.supportsAjaxMonitoring()&&!this.initialized&&(this.instrumentOpen(),this.instrumentSend(),this.instrumentAbort(),this.instrumentSetRequestHeader(),this.initialized=!0)},Ep.getDefaultConfig=function(){return{maxAjaxCallsPerView:500,disableAjaxTracking:!1,disableFetchTracking:!0,disableCorrelationHeaders:!1,distributedTracingMode:il.AI,correlationHeaderExcludedDomains:["*.blob.core.windows.net","*.blob.core.chinacloudapi.cn","*.blob.core.cloudapi.de","*.blob.core.usgovcloudapi.net"],correlationHeaderDomains:void 0,appId:void 0,enableCorsCorrelation:!1,enableRequestHeaderTracking:!1,enableResponseHeaderTracking:!1}},Ep.getEmptyConfig=function(){return{maxAjaxCallsPerView:void 0,disableAjaxTracking:void 0,disableFetchTracking:void 0,disableCorrelationHeaders:void 0,distributedTracingMode:void 0,correlationHeaderExcludedDomains:void 0,appId:void 0,enableCorsCorrelation:void 0,correlationHeaderDomains:void 0,enableRequestHeaderTracking:void 0,enableResponseHeaderTracking:void 0}},Ep.prototype.initialize=function(e,t,r){if(!this.initialized&&!this._fetchInitialized){this._core=t;var i=Ep.getDefaultConfig();for(var n in this._config=Ep.getEmptyConfig(),i)this._config[n]=Ju.getConfig(e,n,Ep.identifier,i[n]);if(this._isUsingAIHeaders=this._config.distributedTracingMode===il.AI||this._config.distributedTracingMode===il.AI_AND_W3C,this._isUsingW3CHeaders=this._config.distributedTracingMode===il.AI_AND_W3C||this._config.distributedTracingMode===il.W3C,!1===this._config.disableAjaxTracking&&this.instrumentXhr(),!1===this._config.disableFetchTracking&&this.instrumentFetch(),0<r.length&&r){for(var o=void 0,a=0;!o&&a<r.length;)r[a]&&r[a].identifier===oc&&(o=r[a]),a++;o&&(this._context=o.context)}}},Ep.identifier="AjaxDependencyPlugin",Ep);function Ep(){this._trackAjaxAttempts=0,this.identifier=Ep.identifier,this.priority=120,this.currentWindowHost=window&&window.location&&window.location.host&&window.location.host.toLowerCase(),this.initialized=!1,this._fetchInitialized=!1}var Ip=(Pp.prototype.trackEvent=function(e,t){this.appInsights.trackEvent(e,t)},Pp.prototype.trackPageView=function(e){var t=e||{};this.appInsights.trackPageView(t)},Pp.prototype.trackPageViewPerformance=function(e){var t=e||{};this.appInsights.trackPageViewPerformance(t)},Pp.prototype.trackException=function(e){!e.exception&&e.error&&(e.exception=e.error),this.appInsights.trackException(e)},Pp.prototype._onerror=function(e){this.appInsights._onerror(e)},Pp.prototype.trackTrace=function(e,t){this.appInsights.trackTrace(e,t)},Pp.prototype.trackMetric=function(e,t){this.appInsights.trackMetric(e,t)},Pp.prototype.startTrackPage=function(e){this.appInsights.startTrackPage(e)},Pp.prototype.stopTrackPage=function(e,t,r,i){this.appInsights.stopTrackPage(e,t,r,i)},Pp.prototype.startTrackEvent=function(e){this.appInsights.startTrackEvent(e)},Pp.prototype.stopTrackEvent=function(e,t,r){this.appInsights.stopTrackEvent(e,t,r)},Pp.prototype.addTelemetryInitializer=function(e){return this.appInsights.addTelemetryInitializer(e)},Pp.prototype.setAuthenticatedUserContext=function(e,t,r){void 0===r&&(r=!1),this.properties.context.user.setAuthenticatedUserContext(e,t,r)},Pp.prototype.clearAuthenticatedUserContext=function(){this.properties.context.user.clearAuthenticatedUserContext()},Pp.prototype.trackDependencyData=function(e){this.dependencies.trackDependencyData(e)},Pp.prototype.flush=function(e){void 0===e&&(e=!0),this.core.getTransmissionControls().forEach((function(t){t.forEach((function(t){t.flush(e)}))}))},Pp.prototype.onunloadFlush=function(e){void 0===e&&(e=!0),this.core.getTransmissionControls().forEach((function(t){t.forEach((function(t){t.onunloadFlush?t.onunloadFlush():t.flush(e)}))}))},Pp.prototype.loadAppInsights=function(e){if(void 0===e&&(e=!1),e&&this.config.extensions&&0<this.config.extensions.length)throw new Error("Extensions not allowed in legacy mode");var t=[],r=new rp;return t.push(r),t.push(this.properties),t.push(this.dependencies),t.push(this.appInsights),this.core.initialize(this.config,t),this.emptyQueue(),this.pollInternalLogs(),this.addHousekeepingBeforeUnload(this),this.context=this.properties.context,this},Pp.prototype.updateSnippetDefinitions=function(e){for(var t in this)"string"==typeof t&&(e[t]=this[t])},Pp.prototype.emptyQueue=function(){try{if(Il.isArray(this.snippet.queue)){for(var e=this.snippet.queue.length,t=0;t<e;t++)(0,this.snippet.queue[t])();this.snippet.queue=void 0,delete this.snippet.queue}}catch(e){e&&"function"==typeof e.toString&&e.toString()}},Pp.prototype.pollInternalLogs=function(){this.core.pollInternalLogs()},Pp.prototype.addHousekeepingBeforeUnload=function(e){!e.appInsights.config.disableFlushOnBeforeUnload&&"onbeforeunload"in window&&(Il.addEventHandler("beforeunload",(function(){e.onunloadFlush(!1);var t=e.appInsights.core._extensions[oc];t&&t.context&&t.context._sessionManager&&t.context._sessionManager.backup()}))||e.appInsights.core.logger.throwInternal(cl.CRITICAL,19,"Could not add handler for beforeunload"))},Pp.prototype.getSKUDefaults=function(){this.config.diagnosticLogInterval=this.config.diagnosticLogInterval&&0<this.config.diagnosticLogInterval?this.config.diagnosticLogInterval:1e4},Pp);function Pp(e){e.queue=e.queue||[],e.version=e.version||2;var t=e.config||{};t&&!t.instrumentationKey&&(t=e,fc.Version="2.2.2"),this.appInsights=new fc,this.properties=new yp,this.dependencies=new Cp,this.core=new xl,this.snippet=e,this.config=t,this.getSKUDefaults()}var Rp=(Np.prototype.trackEvent=function(e,t){!this.options.disableTelemetry&&this.appInsights&&this.appInsights.trackEvent(e,t)},Np.prototype.setAuthenticatedUserContext=function(e,t){!this.options.disableTelemetry&&this.appInsights&&this.appInsights.setAuthenticatedUserContext(e,t)},Np.prototype.trackException=function(e){!this.options.disableTelemetry&&this.appInsights&&this.appInsights.trackException(e)},Np.prototype.flush=function(e){!this.options.disableTelemetry&&this.appInsights&&this.appInsights.flush(e)},Np);function Np(e){this.options=e,!this.options.disableTelemetry&&(this.appInsights=new Ip({config:{instrumentationKey:u,disableExceptionTracking:!0,disableAjaxTracking:!0,isCookieUseDisabled:!0,maxBatchInterval:5e3}}),this.appInsights.loadAppInsights(),this.appInsights.addTelemetryInitializer((function(e){e.tags[nc.applicationVersion]=E.getFullVersion()})))}var Ap=(zp.prototype.onAdd=function(e){return this.container=document.createElement("div"),this.container.className="azure-map-logo",this.container},zp.prototype.onRemove=function(){this.container.remove()},zp);function zp(){}var Mp,kp=(d(Op,Mp=g),Op);function Op(){var e=null!==Mp&&Mp.apply(this,arguments)||this;return e.copyrightMessage=void 0,e.showFeedbackLink=!0,e}var Lp,Dp=(d(Bp,Lp=X),Bp.prototype.onAdd=function(e){return this.container=this.buildContainer(e,t.ControlStyle.auto),this.container.className="map-copyright",this.copyrightDiv=this.buildCopyrightDiv(),this.container.appendChild(this.copyrightDiv),this.options.showFeedbackLink&&(this.feedbackLink=this.buildFeedbackLink(),this.container.appendChild(this.feedbackLink)),this.container},Bp.prototype.onRemove=function(){Lp.prototype.onRemove.call(this),delete this.container},Bp.prototype.setOptions=function(e){var t=(new kp).merge(this.options,e);t.copyrightMessage!==this.options.copyrightMessage&&(this.copyrightDiv.innerText=t.copyrightMessage),!t.showFeedbackLink&&this.feedbackLink?(this.feedbackLink.remove(),delete this.feedbackLink):t.showFeedbackLink&&!this.feedbackLink&&(this.feedbackLink=this.buildFeedbackLink(),this.container.appendChild(this.feedbackLink)),this.options=t},Bp.prototype.buildCopyrightDiv=function(){var e=document.createElement("div");return e.innerText=this.options.copyrightMessage||"",e},Bp.prototype.buildFeedbackLink=function(){var e=document.createElement("a");return e.textContent="Improve this map",e.href="https://feedback.azuremaps.com",e.target="_blank",e.rel="noopener",e},Bp);function Bp(e){var t=Lp.call(this)||this;return t.options=(new kp).merge(e),t}var Fp=(qp.throwOnError=function(e,t){var r=e instanceof Ud?e._getMap():e,i=function(e){throw r.off("error",i),e.error};r.on("error",i);var n=t();return r.off("error",i),n},qp.tryCatch=function(e,t,r,i){try{return this.throwOnError(e,t)}catch(e){return r(e)}finally{"function"==typeof i&&i()}},qp.tryFinally=function(e,t,r){try{return this.throwOnError(e,t)}finally{r()}},qp);function qp(){}var Up=(jp.prototype.request=function(e){var t={domain:this.map.getServiceOptions().domain,path:"search/address/reverse/json",queryParams:m({"api-version":"1.0",language:e.style.language,limit:1,query:ln(e.position[1])+","+un(e.position[0])},e.style.view&&{view:e.style.view})};return new w(this.map.authentication.signRequest(t)).get()},jp);function jp(e){this.map=e}var Vp=(Gp.prototype.cache=function(e,t,r,i){var n=e+"_"+r[0]+"_"+r[1]+"_"+i;this._labelIdx[t.labelType]||(this._labelIdx[t.labelType]=[],this._labelCache[t.labelType]=[]),-1===this._labelIdx[t.labelType].indexOf(n)&&(this._labelCache[t.labelType].push({name:e,radius:t.radius,minZoom:t.minZoom,maxZoom:t.maxZoom||24,position:r}),this._labelIdx[t.labelType].push(n))},Gp.prototype.getNearestLabel=function(e,t,r){var i=null,n=this._labelCache[e];if(n)for(var o=1/0,a=0,s=n.length;a<s;a++)if(r>=n[a].minZoom&&r<=n[a].maxZoom){var l=tn(n[a].position,t);l<=n[a].radius&&l<=o&&(o=l,i=n[a])}return i},Gp.prototype._preloadCache=function(e){if(!this._preloadedCache.has(e)){this._preloadedCache.add(e);var t={source:["Ocean label","Ocean name"],labelType:"water",minZoom:0,radius:395e4,polygonSources:["Ocean","Ocean or sea"]},r=e,i=r.indexOf("-");switch(-1!==i&&(r=r.substr(0,i)),r){case"fr":this.cache("Océan Pacifique",t,[-170,32],e),this.cache("Océan Pacifique",t,[-138,-27],e),this.cache("Océan Atlantique",t,[-40,32],e),this.cache("Océan Atlantique",t,[-17,-29],e);break;case"es":this.cache("Océan Pacifique",t,[-170,32],e),this.cache("Océan Pacifique",t,[-138,-27],e),this.cache("Océano Atlántico",t,[-40,32],e),this.cache("Océano Atlántico",t,[-17,-29],e);break;case"pt":this.cache("Oceano Pacífico",t,[-170,32],e),this.cache("Oceano Pacífico",t,[-138,-27],e),this.cache("Oceano Atlântico",t,[-40,32],e),this.cache("Oceano Atlântico",t,[-17,-29],e);break;case"ja":this.cache("太平洋",t,[-170,32],e),this.cache("太平洋",t,[-138,-27],e);break;case"en":this.cache("Pacific Ocean",t,[-170,32],e),this.cache("Pacific Ocean",t,[-138,-27],e),this.cache("Atlantic Ocean",t,[-40,32],e),this.cache("Atlantic Ocean",t,[-17,-29],e),this.cache("Indian Ocean",t,[77,-26],e)}}},Gp);function Gp(){this._labelCache={},this._labelIdx={},this._preloadedCache=new Set}var Hp=(Zp.prototype.dispose=function(){this._disposed=!0,this._map._getMap().off("move",this._onMove),this._map._getMap().off("moveend",this._onMoveEnd),this._map._getMap().off("styledata",this._onStyleData),this._map._getMap().off("rotate",this._onRotate),this._map.getCanvas().removeEventListener("mousedown",this._onPointerDown),this._map.getCanvas().removeEventListener("touchstart",this._onPointerDown),this._map.getMapContainer().removeEventListener("keydown",this._shortcutListener)},Zp.prototype._getEventPos=function(e){if("touches"in e){var t=e.touches[0],r=e.target.getBoundingClientRect();return[t.pageX-r.left,t.pageY-r.top]}return[e.offsetX,e.offsetY]},Zp.prototype._checkThresholds=function(e,t){return this._checkZoomThreshold(e.zoom,t.zoom)||this._checkPitchThreshold(e.pitch,t.pitch)||this._checkLocThreshold(e.center,t.center)||this._checkHeadingThreshold(e.bearing,t.bearing)},Zp.prototype._checkZoomThreshold=function(e,t){return this._round(e)!==this._round(t)},Zp.prototype._checkPitchThreshold=function(e,t){return Math.abs(e-t)>=this._pitchThreshold},Zp.prototype._checkLocThreshold=function(e,t){var r=this._map.positionsToPixels([t,e]),i=r[0],n=r[1];return bi.getDistance(i,n)>=this._moveThreshold},Zp.prototype._checkHeadingThreshold=function(e,t){e<0&&(e+=360),t<0&&(t+=360);var r=Math.abs(e-t);return 180<r&&(r=360-r),r>=this._headingThreshold},Zp.prototype._getLocDesc=function(e,t,r){return f(this,void 0,void 0,(function(){var i,n,o,a,s,l,u,c,p,h=this;return y(this,(function(d){switch(d.label){case 0:return"blank"===r?[3,3]:this._map._getMap().loaded()?[3,2]:[4,new Promise((function(e){return h._map._getMap().once("idle",e)}))];case 1:d.sent(),d.label=2;case 2:for(i={},n=this._map.positionsToPixels([e.center])[0],Fp.tryCatch(this._map,(function(){o=h._map._getMap().queryRenderedFeatures(n,{layers:h._polygonStyleLayer,filter:["==",["geometry-type"],"Polygon"]})}),(function(){})),a=null,o&&0<o.length&&(a=o[0]),s=null,l=0,u=this._lableConfig.length;l<u;l++)c=this._lableConfig[l],e.zoom>=c.minZoom?c.polygonSources?a&&-1!==c.polygonSources.indexOf(a.layer["source-layer"])?(s=c.labelType,this._getClosestLabel(c,e,t,i,!1)):this._getClosestLabel(c,e,t,i,!0):this._getClosestLabel(c,e,t,i,!1):this._getClosestLabel(c,e,t,i,!0);return 8<=e.zoom&&this._processRoads(i,e,t),this._labelCache.forEach((function(t){i[t]||(p=null,("water"!==t&&"majorPoi"!==t||t===s)&&(p=Zp._labelCache.getNearestLabel(t,e.center,e.zoom)),p&&(i[t]=p.name))})),[2,this._processLocInfo(e,s,i,!0,this._restFallback)];case 3:return[2,this._processLocInfo(e,null,null,!1,!1)]}}))}))},Zp.prototype._getHeadingDesc=function(e){var t=e.bearing;switch(t<0&&(t+=360),t=this._round(t,this._headingThreshold)){case 0:case 360:return"north";case 45:return"north east";case 90:return"east";case 135:return"south east";case 180:return"south";case 225:return"south west";case 270:return"west";case 315:return"north west";default:return t+" degrees"}},Zp.prototype._getClosestLabel=function(e,t,r,i,n){for(var o=e.radius,a=0,s=e.source.length;a<s;a++){var l={sourceLayer:e.source[a]},u=this._map._getMap().querySourceFeatures(this._baseVectorTileSourceId,l),c=null,p=1/0,h=this._labelCache.has(e.labelType);if(!n||n&&h)for(var d=0,m=u.length;d<m;d++){var f="Point"===u[d].geometry.type?u[d]:Tn(t.center,u[d].geometry);if(!n){var y="Point"===u[d].geometry.type?tn(t.center,f.geometry.coordinates):f.properties.distance;y<p&&(p=y,c=u[d])}h&&Zp._labelCache.cache(u[d].properties.name,e,f.geometry.coordinates,r)}if(!n){var g=e.labelType+"Dis";c&&p<=o&&("number"!=typeof i[g]||p<=i[g])&&(i[e.labelType]=c.properties.name,i[g]=p)}}},Zp.prototype._processRoads=function(e,t,r,i){var n=this._map._getMap().queryRenderedFeatures(i,{filter:["==",["geometry-type"],"LineString"]});if(n){for(var o=void 0,a=void 0,s=void 0,l=void 0,u=0,c=n.length;u<c;u++)if(this._roadLayers.has(n[u].layer["source-layer"])&&n[u].properties.name&&""!==n[u].properties.name){var p=Tn(t.center,n[u]);(!s||p.properties.distance<s.properties.distance)&&(o&&n[u].properties.name===o.properties.name?s=p:o&&n[u].properties.name===o.properties.name?(!l||p.properties.distance<l.properties.distance)&&(l=p,a=n[u]):(l=s,a=o,s=p,o=n[u]))}if(o&&(e.country||(e.country=o.properties.country_code,e.countryDis=0,Zp._labelCache.cache(e.country,{source:["Country name"],labelType:"country",radius:5e3,minZoom:0},s.geometry.coordinates,r)),e.state||(e.state=o.properties.country_subdivision,e.stateDis=0,Zp._labelCache.cache(e.state,{source:["State name"],labelType:"state",radius:5e3,minZoom:4},s.geometry.coordinates,r)),15<=t.zoom)){var h=this._map.positionsToPixels([t.center,s.geometry.coordinates]),d=bi.getDistance(h[0],h[1]);if((d<this._roadPixelRadius||s.properties.distance<this._minRoadDistance)&&(e.road=o.properties.name),a){var m=this._map.positionsToPixels([l.geometry.coordinates]);((d=bi.getDistance(h[0],m[0]))<this._minIntersectionPixelDistance||l.properties.distance<this._minRoadDistance)&&(e.secondRoad=a.properties.name,e.secondRoadDis=l.properties.distance)}}}},Zp.prototype._getActionDesc=function(e){if(this._lastCam){var t=[];if(this._checkLocThreshold(e.center,this._lastCam.center)){var r=["panned"],i=Math.round(nn(this._lastCam.center,e.center));0===i||360===i?r.push("north"):i<90?r.push("north east"):90===i?r.push("east"):i<180?r.push("south east"):180===i?r.push("south"):i<270?r.push("south west"):270===i?r.push("west"):i<360&&r.push("north west");var n=tn(this._lastCam.center,e.center,Ei.meters);r.push(1e3<n?$i(n/1e3,2)+" kilometers":$i(n,2)+" meters"),t.push(r.join(" "))}if(this._checkZoomThreshold(e.zoom,this._lastCam.zoom)){(r=["zoomed"]).push(this._lastCam.zoom<e.zoom?"in":"out");var o=Math.abs(this._lastCam.zoom-e.zoom);1<=o&&(o=Math.ceil(o),r.push(1<o?o+" levels":o+" level")),this._getCanonicalZoom(this._lastCam.zoom)!==this._getCanonicalZoom(e.zoom)&&r.push("to "+this._getCanonicalZoom(e.zoom)+" level"),t.push(r.join(" "))}if(this._checkPitchThreshold(e.pitch,this._lastCam.pitch)){var a=this._round(e.pitch,this._pitchThreshold);if(t.push("pitched to "+a+" degrees"),60===e.pitch||0===e.pitch){var s=60===e.pitch?"maximum":"minimum";t.push("reached "+s+" of "+e.pitch+" degrees")}}return this._checkHeadingThreshold(this._lastCam.bearing,e.bearing)&&t.push("rotated to "+this._getHeadingDesc(e)),t.join(" and ")||null}return null},Zp.prototype._getCanonicalZoom=function(e){return(e=this._round(e))<2?"world":e<5?"country":e<11?"state province":e<15?"city":"street"},Zp.prototype._processLocInfo=function(e,t,r,i,n){var o=this;return new Promise((function(a,s){var l=[];if(i){var u=[];if(r&&(t&&("water"===t&&r.water?u.push(r.water):"majorPoi"===t&&r.majorPoi&&u.push(r.majorPoi)),0===u.length&&(r.majorPoi&&8<=e.zoom?u.push(r.majorPoi):(r.poi&&14<=e.zoom?u.push(r.poi):r.road&&15<=e.zoom&&(r.secondRoad?u.push(r.road+" & "+r.secondRoad):u.push(r.road)),r.neighbourhood&&12<=e.zoom&&u.push(r.neighbourhood),r.city&&6<=e.zoom&&u.push(r.city)),r.state&&4<=e.zoom&&u.push(r.state),0===u.length?r.water?u.push(r.water):r.country&&u.push(r.country):1===u.length&&r.state&&4<=e.zoom&&r.country&&u.push(r.country))),0<u.length)l.push("<p>Location: ",u.join(", "),".</p>");else if(n&&"water"!==t)return void o._reverseGeocodeDescription(e).then((function(e){a(e)}),(function(){s("<p>Location: unknown</p>")}))}o._returnDetailedDescriptions&&(l.push("<p>Zoom: ",$i(e.zoom,2),".</p>"),l.push("<p>Latitude: ",$i(e.center[1],5),".</p>"),l.push("<p>Longitude: ",$i(e.center[0],5),".</p>")),a(l.join(""))}))},Zp.prototype._reverseGeocodeDescription=function(e){var t=this;return new Promise((function(r){var i=t._map.getStyle();t._reverseSearch.request({position:e.center,style:i}).then((function(n){var o={};if(n&&n.addresses&&0<n.addresses.length&&n.addresses[0].address){var a=n.addresses[0].address;a.country&&(o.country=a.country,Zp._labelCache.cache(o.country,{source:["Country name"],labelType:"country",radius:5e3,minZoom:0},e.center,i.language)),a.countrySubdivision&&(o.state=a.countrySubdivision,Zp._labelCache.cache(o.state,{source:["State name"],labelType:"state",radius:5e3,minZoom:4},e.center,i.language)),a.municipality&&(o.city=a.municipality,Zp._labelCache.cache(o.state,{source:["Small city"],labelType:"city",radius:1e3,minZoom:10},e.center,i.language)),a.streetNameAndNumber?o.road=a.streetNameAndNumber:a.street&&(o.road=a.street)}t._processLocInfo(e,null,o,!0,!1).then((function(e){r(e)}))}),(function(i){t._processLocInfo(e,null,null,!0,!1).then((function(e){r(e)}))})).catch((function(i){t._processLocInfo(e,null,null,!0,!1).then((function(e){r(e)}))}))}))},Zp.prototype._round=function(e,t){return void 0===t&&(t=1),Math.round(e/t)*t},Zp);function Zp(e,t){var r=this;this._restFallback=!0,this._disposed=!1,this._lastHeadingTime=0,this._actionQueue=[],this._pointerUpdateDelay=3e3,this._camUpdateDelay=1e3,this._headUpdateLimit=1e3,this._controlEventDelay=500,this._moveThreshold=25,this._headingThreshold=5,this._pitchThreshold=5,this._roadPixelRadius=120,this._minRoadDistance=25,this._minIntersectionPixelDistance=50,this._baseVectorTileSourceId="vectorTiles",this._lableConfig=[{source:["Ocean label","Ocean name"],labelType:"water",minZoom:0,radius:395e4,polygonSources:["Ocean","Ocean or sea"]},{source:["Sea label"],labelType:"water",minZoom:3,radius:1e6,polygonSources:["Sea","Ocean or sea"]},{source:["Country name"],labelType:"country",minZoom:0,maxZoom:5,radius:3e5},{source:["State name","State name short"],labelType:"state",minZoom:4,maxZoom:7,radius:3e5},{source:["Capital city","Large city"],labelType:"city",minZoom:8,radius:4e4},{source:["Medium city"],labelType:"city",minZoom:8,radius:3e4},{source:["Small city"],labelType:"city",minZoom:8,radius:2e4},{source:["Island label"],labelType:"city",minZoom:8,radius:1e4},{source:["Town"],labelType:"city",minZoom:10,radius:1e4},{source:["Village"],labelType:"neighbourhood",minZoom:12,radius:6e3},{source:["Amusement area label"],labelType:"poi",minZoom:14,radius:2e3,polygonSources:["Amusement park"]},{source:["Hospital label"],labelType:"poi",minZoom:14,radius:1e3,polygonSources:["Hospital"]},{source:["Shopping centre label"],labelType:"poi",minZoom:14,radius:1e3,polygonSources:["Shopping"]},{source:["Stadium label"],labelType:"poi",minZoom:14,radius:1e3,polygonSources:["Stadium"]},{source:["University/School label"],labelType:"poi",minZoom:14,radius:1e3,polygonSources:["University"]},{source:["Zoo label"],labelType:"poi",minZoom:14,radius:1e3,polygonSources:["Zoo"]},{source:["Airport Label","Airport name","Airport POI"],labelType:"majorPoi",minZoom:11,radius:3e3,polygonSources:["Airport","Runway"]},{source:["National park label"],labelType:"majorPoi",minZoom:7,radius:15e3,polygonSources:["National or state park","National park","Forest"]},{source:["Reservation label"],labelType:"majorPoi",minZoom:7,radius:15e3,polygonSources:["Reservation"]}],this._polygonStyleLayer=["National or state park","National park","Reservation","Airport","Runway","Stadium","University","Zoo","Shopping","Hospital","Amusement park","Ocean","Sea","Ocean or sea"],this._labelCache=new Set(["city","state","country","water","majorPoi"]),this._roadLayers=new Set(["Connecting road","Connecting road tunnel","International road","International road tunnel","Local road","Local road tunnel","Major local road","Major local road tunnel","Major road","Major road tunnel","Minor local road","Minor local road tunnel","Motorway","Motorway tunnel","Secondary road","Secondary road tunnel","Toll connecting road","Toll connecting road tunnel","Toll international road","Toll international road tunnel","Toll local road","Toll local road tunnel","Toll major local road","Toll major local road tunnel","Toll major road","Toll major road tunnel","Toll minor local road","Toll minor local road tunnel","Toll motorway","Toll motorway tunnel","Toll secondary road","Toll secondary road tunnel"]),this._returnDetailedDescriptions=!1,this._shortcutListener=function(e){return f(r,void 0,void 0,(function(){var t,r,i,n,o;return y(this,(function(a){switch(a.label){case 0:return e.altKey&&e.ctrlKey&&68===e.keyCode?(this._returnDetailedDescriptions=!this._returnDetailedDescriptions,t=this._map.getCamera(),r=this._map.getStyle(),i=r.language.toLowerCase(),n=r.style.toLowerCase(),[4,this._getLocDesc(t,i,n)]):[3,2];case 1:o=a.sent(),this._descCallback(o),a.label=2;case 2:return[2]}}))}))},this._onRotate=function(){r._rotateTimeout||(Date.now()-r._lastHeadingTime>=r._headUpdateLimit?r._rotateTimeout=setTimeout(r._updateHeading,te.RotationDuration+25):r._rotateTimeout=setTimeout(r._updateHeading,r._headUpdateLimit-(Date.now()-r._lastHeadingTime)))},this._onMove=function(){r._moveTimeout&&(clearTimeout(r._moveTimeout),delete r._moveTimeout),r._controlTimeout&&(clearTimeout(r._controlTimeout),delete r._controlTimeout)},this._onMoveEnd=function(e){e.fromControl?r._controlTimeout=setTimeout(r._updateCam,r._controlEventDelay):r._updateCam()},this._onStyleData=function(){setTimeout(r._updateStyle)},this._onPointerDown=function(e){r._lastPointerPos=r._getEventPos(e),r._pointerTimeout=setTimeout((function(){return f(r,void 0,void 0,(function(){var e,t,r,i,n;return y(this,(function(o){switch(o.label){case 0:return e=this._map.getStyle(),t=e.language.toLowerCase(),r=e.style.toLowerCase(),(i=this._map.getCamera()).center=this._map.pixelsToPositions([this._lastPointerPos])[0],[4,this._getLocDesc(i,t,r)];case 1:return n=o.sent(),this._descCallback(n),this._onPointerUp(),[2]}}))}))}),r._pointerUpdateDelay),r._map.getCanvas().addEventListener("mousemove",r._onPointerMove),r._map.getCanvas().addEventListener("touchmove",r._onPointerMove),r._map.getCanvas().addEventListener("mouseup",r._onPointerUp),r._map.getCanvas().addEventListener("touchend",r._onPointerUp)},this._onPointerMove=function(e){var t=r._getEventPos(e),i=r._lastPointerPos[0]-t[0],n=r._lastPointerPos[1]-t[1];Math.sqrt(i*i+n*n)>r._moveThreshold&&r._onPointerUp()},this._onPointerUp=function(){clearTimeout(r._pointerTimeout),delete r._pointerTimeout,r._map.getCanvas().removeEventListener("mousemove",r._onPointerMove),r._map.getCanvas().removeEventListener("touchmove",r._onPointerMove),r._map.getCanvas().removeEventListener("mouseup",r._onPointerUp),r._map.getCanvas().removeEventListener("touchend",r._onPointerUp)},this._updateHeading=function(){var e=r._map.getCamera();if(!r._lastHead||r._checkHeadingThreshold(e.bearing,r._lastHead)){var t=r._getHeadingDesc(e);r._lastHead=e.bearing,r._descCallback("<p>Map heading "+t+".</p>"),r._lastHeadingTime=Date.now()}delete r._rotateTimeout},this._updateStyle=function(){return f(r,void 0,void 0,(function(){var e,t,r,i,n;return y(this,(function(o){switch(o.label){case 0:return e=this._map.getCamera(),t=this._map.getStyle(),r=t.language.toLowerCase(),i=t.style.toLowerCase(),this._lastLang===r?[3,2]:(Zp._labelCache._preloadCache(r),[4,this._getLocDesc(e,r,i)]);case 1:return n=o.sent(),[3,4];case 2:return this._lastStyle===i||"blank"!==this._lastStyle?[3,4]:[4,this._getLocDesc(e,r,i)];case 3:n=o.sent(),o.label=4;case 4:return this._lastLang=r,this._lastStyle=i,n&&this._descCallback(n),[2]}}))}))},this._updateCam=function(e){void 0===e&&(e=!1);var t=r._map.getCamera();if(!r._lastCam||0<r._actionQueue.length||r._checkThresholds(t,r._lastCam)){var i=r._map.getStyle(),n=i.language.toLowerCase(),o=i.style.toLowerCase(),a=r._getActionDesc(t);a&&r._actionQueue.push(a),r._lastCam=t,r._moveTimeout&&(clearTimeout(r._moveTimeout),delete r._moveTimeout),r._moveTimeout=setTimeout((function(){return f(r,void 0,void 0,(function(){var e;return y(this,(function(r){switch(r.label){case 0:return clearTimeout(this._rotateTimeout),delete this._rotateTimeout,[4,this._getLocDesc(t,n,o)];case 1:return e=r.sent(),0<this._actionQueue.length?(this._descCallback("<p>Map "+this._actionQueue.join(", then ")+".</p>"+e),this._actionQueue=[]):this._descCallback(e),[2]}}))}))}),e?0:r._camUpdateDelay)}},this._map=e,this._descCallback=t,this._reverseSearch=new Up(e),Zp._labelCache||(Zp._labelCache=new Vp),this._lastLang=this._map.getStyle().language.toLowerCase(),Zp._labelCache._preloadCache(this._lastLang),this._map.events.addOnce("load",(function(){r._disposed||(r._updateCam(!0),r._map._getMap().on("move",r._onMove),r._map._getMap().on("moveend",r._onMoveEnd),r._map._getMap().on("styledata",r._onStyleData),r._map._getMap().on("rotate",r._onRotate),r._map.getCanvas().addEventListener("mousedown",r._onPointerDown),r._map.getCanvas().addEventListener("touchstart",r._onPointerDown))})),this._map.getMapContainer().addEventListener("keydown",this._shortcutListener)}var Wp,Kp=function(e){var t=this;this.addToMap=function(){t.initializeMapLiveStateInfo(),t.initializeMapStyleInfo(),t.createMapKeyBindingInfo(),t.map.getMapContainer().setAttribute("role","application"),t.map.getMapContainer().setAttribute("aria-label","Map Application"),t.map.getCanvas().setAttribute("aria-label","Interactive Map"),t.map.getCanvas().setAttribute("aria-describedby","atlas-map-state atlas-map-style atlas-map-shortcuts"),t.map.getCanvas().setAttribute("alt","Interactive Map")},this.removeFromMap=function(){null!=t.mapViewDesc&&t.mapViewDesc.dispose(),delete t.mapViewDesc,null!=t.atlasMapKeyBindings&&t.map.getCanvasContainer().removeChild(t.atlasMapKeyBindings),delete t.atlasMapKeyBindings,null!=t.atlasMapLiveStateInfo&&t.map.getCanvasContainer().removeChild(t.atlasMapLiveStateInfo),delete t.atlasMapLiveStateInfo,null!=t.atlasMapStyleInfo&&t.map.getCanvasContainer().removeChild(t.atlasMapStyleInfo),delete t.atlasMapStyleInfo,t.map.getMapContainer().removeAttribute("role"),t.map.getMapContainer().removeAttribute("aria-label"),t.map.getCanvas().removeAttribute("aria-label"),t.map.getCanvas().removeAttribute("aria-describedby"),t.map.getCanvas().removeAttribute("alt"),t.map.events.remove("styledata",t.updateMapStyle)},this.createMapKeyBindingInfo=function(){t.atlasMapKeyBindings=document.createElement("div"),t.atlasMapKeyBindings.setAttribute("tabindex","-1"),t.atlasMapKeyBindings.setAttribute("aria-hidden","true"),t.atlasMapKeyBindings.id="atlas-map-shortcuts",t.atlasMapKeyBindings.classList.add("hidden-accessible-element"),t.atlasMapKeyBindings.innerHTML=["Map shortcuts:","Zoom out: hyphen.","Zoom in: plus.","Pan right 100 pixels: right arrow.","Pan left 100 pixels: left arrow.","Pan up 100 pixels: up arrow.","Pan down 100 pixels: down arrow.","Rotate 15 degrees clockwise: shift + right arrow.","Rotate 15 degrees counter clockwise: shift + left arrow.","Increase pitch 10 degrees: shift + up arrow.","Decrease pitch 10 degrees: shift + down arrow.","Toggle verbose map state: control + alt + D.","Jump focus to the map: Escape."].join("\n"),t.map.getCanvasContainer().appendChild(t.atlasMapKeyBindings),t.atlasMapKeyBindings.setAttribute("aria-live","polite")},this.initializeMapLiveStateInfo=function(){t.mapViewDesc=new Hp(t.map,t.updateMapState),t.atlasMapLiveStateInfo=document.createElement("div"),t.atlasMapLiveStateInfo.setAttribute("tabindex","-1"),t.atlasMapLiveStateInfo.setAttribute("aria-hidden","true"),t.atlasMapLiveStateInfo.id="atlas-map-state",t.atlasMapLiveStateInfo.classList.add("hidden-accessible-element"),t.map.getCanvasContainer().appendChild(t.atlasMapLiveStateInfo),t.atlasMapLiveStateInfo.setAttribute("aria-live","polite")},this.initializeMapStyleInfo=function(){t.atlasMapStyleInfo=document.createElement("div"),t.atlasMapStyleInfo.setAttribute("tabindex","-1"),t.atlasMapStyleInfo.setAttribute("aria-hidden","true"),t.atlasMapStyleInfo.id="atlas-map-style",t.atlasMapStyleInfo.classList.add("hidden-accessible-element"),t.updateMapStyle(),t.map.events.add("styledata",t.updateMapStyle),t.map.getCanvasContainer().appendChild(t.atlasMapStyleInfo),t.atlasMapStyleInfo.setAttribute("aria-live","polite")},this.updateMapStyle=function(){t.atlasMapStyleInfo.innerHTML="<p>Map style: "+t.map.getStyle().style+".</p>"},this.updateMapState=function(e){t.atlasMapLiveStateInfo.innerHTML=e},this.map=e},Xp=function(e){var t=this;this.callCounter=0,this.listenerEnabled=!1,this.flowComponent=void 0,this.flowPath=void 0,this.addToMap=function(){if(!t.map._isReady())throw new Error("Traffic flow could not be added to the map because the map is not ready. Please use a ready event listener to guarantee the map is ready before enabling traffic flow.");t.listenerEnabled||(t.map.events.add("styledata",t.addToMap),t.listenerEnabled=!0);var e=t.map.getStyle(),r=t.map.getTraffic(),i=t.map.styles.getFlowPath(e,r);if(i&&t.flowPath!==i){t.callCounter++;var n=t.callCounter;t.map.styles.getFlowComponent(e,r).then((function(e){if(t.callCounter===n){t.flowComponent&&(t.map.layers.remove(t.flowComponent.layer),t.map.sources.remove(t.flowComponent.sources),delete t.flowComponent);var r=t.map.layers.getLayers(),o=r.findIndex((function(e){return"transit"===e.getId()})),a=-1!==o?r[o+1]:void 0;t.map.sources.add(e.sources),t.map.layers.add(e.layer,a),t.flowComponent=e,t.flowPath=i}}))}},this.removeFromMap=function(){t.callCounter++,t.listenerEnabled&&(t.map.events.remove("styledata",t.addToMap),t.listenerEnabled=!1),t.flowPath&&delete t.flowPath,t.flowComponent&&(t.map.layers.remove(t.flowComponent.layer),t.map.sources.remove(t.flowComponent.sources),delete t.flowComponent)},this.map=e},Yp=(d(Jp,Wp=g),Jp);function Jp(){var e=null!==Wp&&Wp.apply(this,arguments)||this;return e.version="1.0",e.bbox=void 0,e.zoom=void 0,e.params={},e}var $p=(Qp.prototype.request=function(e){var t,r=(new Yp).merge(e),i=this.map.getServiceOptions().domain;t=qn.getWest(r.bbox)<-180&&180<qn.getEast(r.bbox)?qn.getSouth(r.bbox)+",-180,"+qn.getNorth(r.bbox)+",180":qn.getSouth(r.bbox)+","+un(qn.getWest(r.bbox))+","+qn.getNorth(r.bbox)+","+un(qn.getEast(r.bbox));var n={domain:i,path:"traffic/incident/detail/json",queryParams:m({"api-version":r.version,projection:"EPSG4326",style:"s3",boundingbox:t,boundingzoom:r.zoom,trafficmodelid:-1},r.params)};return new w(this.map.authentication.signRequest(n)).get()},Qp);function Qp(e){this.map=e}var eh,th,rh,ih=(d(nh,eh=gi),nh.getIncidentTypeName=function(e,t){switch(e){case 0:return t.Unknown;case 1:return t.Accident;case 2:return t.Fog;case 3:return t.Danger;case 4:return t.Rain;case 5:return t.Ice;case 6:return t.Jam;case 7:return t.LaneClosed;case 8:return t.RoadClosed;case 9:return t.RoadWorks;case 10:return t.Wind;case 11:return t.Flood;case 12:return t.Detour;default:return t.Unknown}},nh.getIncidentTypeIconName=function(e){switch(e){case 0:return"unknown";case 1:return"accident";case 2:return"fog";case 3:return"danger";case 4:return"rain";case 5:return"ice";case 6:return"jam";case 7:return"lane-closed";case 8:return"road-closed";case 9:return"road-work";case 10:return"wind";case 11:return"flood";case 12:return"detour";default:return"unknown"}},nh.getSeverityColorName=function(e){switch(e){case 0:return"grey";case 1:return"yellow";case 2:return"orange";case 3:return"red";case 4:default:return"grey"}},nh.getSeverityColorHexCode=function(e){switch(e){case 0:return"#B5B6B7";case 1:return"#F4C951";case 2:return"#F4873F";case 3:return"#F04F4E";case 4:default:return"#B5B6B7"}},nh);function nh(e,t){var r=new wi(new En(e.op.x,e.op.y)),i={icon:nh.getSeverityColorName(e.ty)+"-"+nh.getIncidentTypeIconName(e.ic),incidentType:nh.getIncidentTypeName(e.ic,t),description:e.d,length:e.l,delay:e.dl,from:e.f,color:nh.getSeverityColorHexCode(e.ty),to:e.t,id:e.id};return eh.call(this,r,i)||this}(rh=th=th||{}).DELAY="delay",rh.LENGTH="length",rh.FROM="from",rh.TO="to";var oh=(ah.build=function(e,t){void 0===t&&(t="en-US");var r=document.createElement("div");r.classList.add("incident-popup-title"),r.classList.add("font-segoeui-b"),r.setAttribute("tabindex","0"),r.innerText=e.properties.incidentType,r.setAttribute("aria-label","Incident Type "+e.properties.incidentType);var i=document.createElement("div");i.classList.add("incident-popup-subtitle"),i.classList.add("font-segoeui-b"),i.setAttribute("aria-label","Incident Description "+e.properties.description),i.setAttribute("tabindex","0"),i.innerText=e.properties.description;var n=document.createElement("div");n.classList.add("incident-popup-header"),n.style.backgroundColor=e.properties.color,n.appendChild(r),n.appendChild(i);var o=document.createElement("div");if(o.classList.add("incident-popup-body"),e.properties.delay){var a=Math.floor(e.properties.delay/60)+" min",s=this.createInfoSection(a,th.DELAY);o.appendChild(s)}if(e.properties.length){var l=new Intl.NumberFormat([t,"en-US"],{maximumFractionDigits:2}),u=void 0;if("en-US"===t){var c=Qi(e.properties.length,"meters","miles");u=l.format(c)+" miles"}else{var p=Qi(e.properties.length,"meters","kilometers");u=l.format(p)+" km"}var h=this.createInfoSection(u,th.LENGTH);o.appendChild(h)}if(e.properties.from){var d=this.createInfoSection(e.properties.from,th.FROM);o.appendChild(d)}if(e.properties.to){var m=this.createInfoSection(e.properties.to,th.TO);o.appendChild(m)}var f=document.createElement("div");return f.classList.add("incident-popup-content"),f.appendChild(n),f.appendChild(o),new Ha({content:f,position:e.geometry.coordinates})},ah.createInfoSection=function(e,t){var r=document.createElement("div");r.classList.add("incident-popup-info");var i=document.createElement("div");i.classList.add("icon"),i.classList.add(t);var n=document.createElement("span");return n.classList.add("message"),n.classList.add("font-segoeui"),n.setAttribute("aria-label","Incident "+t+" "+e),n.setAttribute("tabindex","0"),n.innerText=e,r.appendChild(i),r.appendChild(n),r},ah);function ah(){}var sh,lh=function(e){var t=this;this.incidentLayerName="incidents",this.popups=new Nr,this.addToMap=function(){t.map.addPins([],{name:t.incidentLayerName,cluster:!1}),t.map.addEventListener("mouseenter",t.incidentLayerName,t.cursorToPointer),t.map.addEventListener("mouseleave",t.incidentLayerName,t.cursorToDefault),t.map.addEventListener("click",t.incidentLayerName,t.openIncidentPopup),t.map.events.add("moveend",t.updateIncidents),t.map.events.add("styledata",t.updateLanguage),t.updateIncidents()},this.removeFromMap=function(){t.map.removeLayers([t.incidentLayerName]),t.map.removeEventListener("click",t.incidentLayerName,t.openIncidentPopup),t.map.removeEventListener("mouseenter",t.incidentLayerName,t.cursorToPointer),t.map.removeEventListener("mouseleave",t.incidentLayerName,t.cursorToDefault),t.map.events.remove("moveend",t.updateIncidents),t.map.events.remove("styledata",t.updateLanguage),t.cleanUpPopups()},this.updateIncidents=function(){var e=Math.ceil(t.map.getCamera().zoom),r=t.map.getCamera().bounds;t.incidentLanguage=t.map.getStyle().language;var i=t.map._getLocalizedStrings(),n=t.incidentService.request({bbox:r,zoom:e,params:{expandCluster:!0,originalPosition:!0,language:t.incidentLanguage}});Promise.all([n,i]).then((function(e){var i=e[0],n=e[1];if(t.map.getTraffic().incidents){var o=[];t.cleanUpPopups();for(var a=0,s=i.tm.poi||[];a<s.length;a++)for(var l=s[a],u=function(e){if(qn.containsPosition(r,[e.op.x,e.op.y])){var i=new ih(e,n);o.push(i);var a=oh.build(i,t.incidentLanguage);t.popups.set(i.properties.id,a),t.map.events.add("open",a,(function(){t.openPopupId=i.properties.id,t.popups.forEach((function(e,r){t.openPopupId!==r&&e.close()}))})),t.map.events.add("close",a,(function(){t.openPopupId===i.properties.id&&delete t.openPopupId})),t.openPopupId===i.properties.id?t.popups.get(i.properties.id).open(t.map):t.popups.get(i.properties.id).attach(t.map)}},c=0,p=l.cpoi||[l];c<p.length;c++)u(p[c]);t.map.addPins(o,{overwrite:!0,name:t.incidentLayerName})}}))},this.cursorToPointer=function(e){t.map.getCanvas().style.cursor="pointer"},this.cursorToDefault=function(e){t.map.getCanvas().style.cursor=""},this.openIncidentPopup=function(e){var r=e.features[0].properties.id;t.popups.has(r)&&t.popups.get(r).open(t.map)},this.cleanUpPopups=function(){t.popups.forEach((function(e){e.remove()})),t.popups.clear()},this.updateLanguage=function(){t.map.getStyle().language!==t.incidentLanguage&&t.updateIncidents()},this.map=e,this.incidentService=new $p(this.map)},uh=(d(ch,sh=g),ch);function ch(){var e=null!==sh&&sh.apply(this,arguments)||this;return e.interactive=!0,e.scrollZoomInteraction=!0,e.boxZoomInteraction=!0,e.dragRotateInteraction=!0,e.dragPanInteraction=!0,e.keyboardInteraction=!0,e.dblClickZoomInteraction=!0,e.touchInteraction=!0,e.wheelZoomRate=1/450,e}var ph=(hh.prototype.enable=function(){this.map.getMapContainer().addEventListener("keydown",this._onKeyDown)},hh.prototype.disable=function(){this.map.getMapContainer().removeEventListener("keydown",this._onKeyDown)},hh);function hh(e){var t=this;this._onKeyDown=function(e){27===e.keyCode&&t.map.getCanvas().focus()},this.map=e}var dh=(mh.prototype.enable=function(){this.map._getMap().on("touchstart",this._onTouchStart),this.map._getMap().on("touchmove",this._onTouchMove),this.map._getMap().on("touchend",this._onTouchEnd),this.map._getMap().on("touchcancel",this._onTouchCancel)},mh.prototype.disable=function(){this.map._getMap().off("touchstart",this._onTouchStart),this.map._getMap().off("touchmove",this._onTouchMove),this.map._getMap().off("touchend",this._onTouchEnd),this.map._getMap().off("touchcancel",this._onTouchCancel)},mh);function mh(e){var t=this;this.minDiffX=70,this.maxDiffY=100,this.minDiff=30,this.delay=160,this._onTouchStart=function(e){if(2===e.points.length){var r=e.points[0].y-e.points[1].y,i=e.points[0].x-e.points[1].x;Math.abs(i)>=t.minDiffX&&Math.abs(r)<=t.maxDiffY&&(e.originalEvent.preventDefault(),t.map._getMap().touchZoomRotate.disable(),t.map._getMap().dragPan.disable(),t.dpPoint=e.point,t.dpPitch=t.map._getMap().getPitch(),t.startTiming=Date.now(),t.startDistance=Math.hypot(i,r),t.startEventData=e)}},this._onTouchMove=function(e){if(void 0!==t.dpPoint&&void 0!==t.dpPitch){e.preventDefault(),e.originalEvent.preventDefault();var r=e.points[0].y-e.points[1].y,i=e.points[0].x-e.points[1].x,n=Math.hypot(i,r);if(Math.abs(n-t.startDistance)>=t.minDiff)return t.dpPoint&&(t.map._getMap().touchZoomRotate.enable(),t.map._getMap().dragPan.enable(),t.map._getMap().touchZoomRotate.onStart(Date.now()-t.startTiming>=t.delay?e.originalEvent:t.startEventData.originalEvent)),void(t.dpPoint=void 0);if(Date.now()-t.startTiming>=t.delay){var o=.5*(t.dpPoint.y-e.point.y);t.map._getMap().setPitch(t.dpPitch+o)}}},this._onTouchEnd=function(){t.dpPoint&&(t.map._getMap().touchZoomRotate.enable(),t.map._getMap().dragPan.enable()),t.dpPoint=void 0},this._onTouchCancel=function(){t.dpPoint&&(t.map._getMap().touchZoomRotate.enable(),t.map._getMap().dragPan.enable()),t.dpPoint=void 0},this.map=e}var fh=(yh.prototype.enable=function(){this.map.getCanvasContainer().addEventListener("gesturestart",this._onGestureStart),this.map.getCanvasContainer().addEventListener("gesturechange",this._onGestureChange),this.map.getCanvasContainer().addEventListener("touchstart",this._onTouchStart),this.map.getCanvasContainer().addEventListener("touchend",this._onTouchEnd)},yh.prototype.disable=function(){this.map.getCanvasContainer().removeEventListener("gesturestart",this._onGestureStart),this.map.getCanvasContainer().removeEventListener("gesturechange",this._onGestureChange),this.map.getCanvasContainer().removeEventListener("touchstart",this._onTouchStart),this.map.getCanvasContainer().removeEventListener("touchend",this._onTouchEnd)},yh);function yh(e){var t=this;this._onGestureStart=function(e){t.hasTouch||(e.preventDefault(),t.initZoom=t.map.getCamera().zoom)},this._onGestureChange=function(e){t.hasTouch||(e.preventDefault(),t.map.setCamera({zoom:t.initZoom+e.scale-1}))},this._onTouchStart=function(e){t.hasTouch=!0},this._onTouchEnd=function(e){0===e.touches.length&&(t.hasTouch=!1)},this.map=e}var gh=(vh.prototype.addToMap=function(){this.added||(this.added=!0,this._setInteractions(this.options))},vh.prototype.removeFromMap=function(){this.added&&(this.added=!1,this._setInteractions({interactive:!1}))},vh.prototype.setOptions=function(e){this.options=(new uh).merge(this.options,e),this.added&&this._setInteractions(this.options)},vh.prototype.getOptions=function(){return Object.assign({},this.options)},vh.prototype._setInteractions=function(e){e.interactive?(e.boxZoomInteraction?this.map._getMap().boxZoom.enable():this.map._getMap().boxZoom.disable(),e.dblClickZoomInteraction?this.map._getMap().doubleClickZoom.enable():this.map._getMap().doubleClickZoom.disable(),e.dragPanInteraction?this.map._getMap().dragPan.enable():this.map._getMap().dragPan.disable(),e.dragRotateInteraction?this.map._getMap().dragRotate.enable():this.map._getMap().dragRotate.disable(),e.keyboardInteraction?(this.map._getMap().keyboard.enable(),this.focusShortcut.enable()):(this.map._getMap().keyboard.disable(),this.focusShortcut.disable()),e.scrollZoomInteraction?(this.map._getMap().scrollZoom.enable(),this.map._getMap().scrollZoom.setWheelZoomRate(e.wheelZoomRate)):this.map._getMap().scrollZoom.disable(),e.touchInteraction?(this.map._getMap().touchZoomRotate.enable(),this.mobilePitch.enable()):(this.map._getMap().touchZoomRotate.disable(),this.mobilePitch.disable()),this.pinchZoom.enable()):(this.map._getMap().boxZoom.disable(),this.map._getMap().doubleClickZoom.disable(),this.map._getMap().dragPan.disable(),this.map._getMap().dragRotate.disable(),this.map._getMap().keyboard.disable(),this.focusShortcut.disable(),this.map._getMap().scrollZoom.disable(),this.map._getMap().touchZoomRotate.disable(),this.mobilePitch.disable(),this.pinchZoom.disable())},vh);function vh(e,t){this.added=!1,this.map=e,this.mobilePitch=new dh(e),this.focusShortcut=new ph(e),this.pinchZoom=new fh(e),this.options=(new uh).merge(t)}var _h=i((function(e){var t=(t=function(e){if(this.REQUEST_TYPE={LOGIN:"LOGIN",RENEW_TOKEN:"RENEW_TOKEN",UNKNOWN:"UNKNOWN"},this.RESPONSE_TYPE={ID_TOKEN_TOKEN:"id_token token",TOKEN:"token"},this.CONSTANTS={ACCESS_TOKEN:"access_token",EXPIRES_IN:"expires_in",ID_TOKEN:"id_token",ERROR_DESCRIPTION:"error_description",SESSION_STATE:"session_state",ERROR:"error",STORAGE:{TOKEN_KEYS:"adal.token.keys",ACCESS_TOKEN_KEY:"adal.access.token.key",EXPIRATION_KEY:"adal.expiration.key",STATE_LOGIN:"adal.state.login",STATE_RENEW:"adal.state.renew",NONCE_IDTOKEN:"adal.nonce.idtoken",SESSION_STATE:"adal.session.state",USERNAME:"adal.username",IDTOKEN:"adal.idtoken",ERROR:"adal.error",ERROR_DESCRIPTION:"adal.error.description",LOGIN_REQUEST:"adal.login.request",LOGIN_ERROR:"adal.login.error",RENEW_STATUS:"adal.token.renew.status",ANGULAR_LOGIN_REQUEST:"adal.angular.login.request"},RESOURCE_DELIMETER:"|",CACHE_DELIMETER:"||",LOADFRAME_TIMEOUT:6e3,TOKEN_RENEW_STATUS_CANCELED:"Canceled",TOKEN_RENEW_STATUS_COMPLETED:"Completed",TOKEN_RENEW_STATUS_IN_PROGRESS:"In Progress",LOGGING_LEVEL:{ERROR:0,WARN:1,INFO:2,VERBOSE:3},LEVEL_STRING_MAP:{0:"ERROR:",1:"WARNING:",2:"INFO:",3:"VERBOSE:"},POPUP_WIDTH:483,POPUP_HEIGHT:600},t.prototype._singletonInstance)return t.prototype._singletonInstance;if((t.prototype._singletonInstance=this).instance="https://login.microsoftonline.com/",this.config={},this.callback=null,this.popUp=!1,this.isAngular=!1,this._user=null,this._activeRenewals={},this._loginInProgress=!1,this._acquireTokenInProgress=!1,this._renewStates=[],this._callBackMappedToRenewStates={},this._callBacksMappedToRenewStates={},this._openedWindows=[],this._requestType=this.REQUEST_TYPE.LOGIN,window._adalInstance=this,e.displayCall&&"function"!=typeof e.displayCall)throw new Error("displayCall is not a function");if(!e.clientId)throw new Error("clientId is required");this.config=this._cloneConfig(e),void 0===this.config.navigateToLoginRequestUrl&&(this.config.navigateToLoginRequestUrl=!0),this.config.popUp&&(this.popUp=!0),this.config.callback&&"function"==typeof this.config.callback&&(this.callback=this.config.callback),this.config.instance&&(this.instance=this.config.instance),this.config.loginResource||(this.config.loginResource=this.config.clientId),this.config.redirectUri||(this.config.redirectUri=window.location.href.split("?")[0].split("#")[0]),this.config.postLogoutRedirectUri||(this.config.postLogoutRedirectUri=window.location.href.split("?")[0].split("#")[0]),this.config.anonymousEndpoints||(this.config.anonymousEndpoints=[]),this.config.isAngular&&(this.isAngular=this.config.isAngular),this.config.loadFrameTimeout&&(this.CONSTANTS.LOADFRAME_TIMEOUT=this.config.loadFrameTimeout)},"undefined"!=typeof window&&(window.Logging={piiLoggingEnabled:!1,level:0,log:function(e){}}),t.prototype.login=function(){if(this._loginInProgress)this.info("Login in progress");else{this._loginInProgress=!0;var e=this._guid();this.config.state=e,this._idTokenNonce=this._guid();var t=this._getItem(this.CONSTANTS.STORAGE.ANGULAR_LOGIN_REQUEST);t&&""!==t?this._saveItem(this.CONSTANTS.STORAGE.ANGULAR_LOGIN_REQUEST,""):t=window.location.href,this.verbose("Expected state: "+e+" startPage:"+t),this._saveItem(this.CONSTANTS.STORAGE.LOGIN_REQUEST,t),this._saveItem(this.CONSTANTS.STORAGE.LOGIN_ERROR,""),this._saveItem(this.CONSTANTS.STORAGE.STATE_LOGIN,e,!0),this._saveItem(this.CONSTANTS.STORAGE.NONCE_IDTOKEN,this._idTokenNonce,!0),this._saveItem(this.CONSTANTS.STORAGE.ERROR,""),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,"");var r=this._getNavigateUrl("id_token",null)+"&nonce="+encodeURIComponent(this._idTokenNonce);this.config.displayCall?this.config.displayCall(r):this.popUp?(this._saveItem(this.CONSTANTS.STORAGE.STATE_LOGIN,""),this._renewStates.push(e),this.registerCallback(e,this.config.clientId,this.callback),this._loginPopup(r)):this.promptUser(r)}},t.prototype._openPopup=function(e,t,r,i){try{var n=window.screenLeft?window.screenLeft:window.screenX,o=window.screenTop?window.screenTop:window.screenY,a=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,s=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,l=a/2-r/2+n,u=s/2-i/2+o,c=window.open(e,t,"width="+r+", height="+i+", top="+u+", left="+l);return c.focus&&c.focus(),c}catch(e){return this.warn("Error opening popup, "+e.message),this._loginInProgress=!1,this._acquireTokenInProgress=!1,null}},t.prototype._handlePopupError=function(e,t,r,i,n){this.warn(i),this._saveItem(this.CONSTANTS.STORAGE.ERROR,r),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,i),this._saveItem(this.CONSTANTS.STORAGE.LOGIN_ERROR,n),t&&this._activeRenewals[t]&&(this._activeRenewals[t]=null),this._loginInProgress=!1,this._acquireTokenInProgress=!1,e&&e(i,null,r)},t.prototype._loginPopup=function(e,t,r){var i=this._openPopup(e,"login",this.CONSTANTS.POPUP_WIDTH,this.CONSTANTS.POPUP_HEIGHT),n=r||this.callback;if(null!=i){if(this._openedWindows.push(i),-1!=this.config.redirectUri.indexOf("#"))var o=this.config.redirectUri.split("#")[0];else o=this.config.redirectUri;var a=this,s=window.setInterval((function(){if(!i||i.closed||void 0===i.closed){var e="Popup Window closed",r="Popup Window closed by UI action/ Popup Window handle destroyed due to cross zone navigation in IE/Edge";return a.isAngular&&a._broadcast("adal:popUpClosed",r+a.CONSTANTS.RESOURCE_DELIMETER+e),a._handlePopupError(n,t,e,r,r),void window.clearInterval(s)}try{var l=i.location;if(-1!=encodeURI(l.href).indexOf(encodeURI(o)))return a.isAngular?a._broadcast("adal:popUpHashChanged",l.hash):a.handleWindowCallback(l.hash),window.clearInterval(s),a._loginInProgress=!1,a._acquireTokenInProgress=!1,a.info("Closing popup window"),a._openedWindows=[],void i.close()}catch(e){}}),1)}else{var l="Popup Window is null. This can happen if you are using IE";this._handlePopupError(n,t,"Error opening popup",l,l)}},t.prototype._broadcast=function(e,t){function r(e,t){t=t||{bubbles:!1,cancelable:!1,detail:void 0};var r=document.createEvent("CustomEvent");return r.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),r}"function"!=typeof window.CustomEvent&&(r.prototype=window.Event.prototype,window.CustomEvent=r);var i=new CustomEvent(e,{detail:t});window.dispatchEvent(i)},t.prototype.loginInProgress=function(){return this._loginInProgress},t.prototype._hasResource=function(e){var t=this._getItem(this.CONSTANTS.STORAGE.TOKEN_KEYS);return t&&!this._isEmpty(t)&&-1<t.indexOf(e+this.CONSTANTS.RESOURCE_DELIMETER)},t.prototype.getCachedToken=function(e){if(!this._hasResource(e))return null;var t=this._getItem(this.CONSTANTS.STORAGE.ACCESS_TOKEN_KEY+e),r=this._getItem(this.CONSTANTS.STORAGE.EXPIRATION_KEY+e),i=this.config.expireOffsetSeconds||300;return r&&r>this._now()+i?t:(this._saveItem(this.CONSTANTS.STORAGE.ACCESS_TOKEN_KEY+e,""),this._saveItem(this.CONSTANTS.STORAGE.EXPIRATION_KEY+e,0),null)},t.prototype.getCachedUser=function(){if(this._user)return this._user;var e=this._getItem(this.CONSTANTS.STORAGE.IDTOKEN);return this._user=this._createUser(e),this._user},t.prototype.registerCallback=function(e,t,r){this._activeRenewals[t]=e,this._callBacksMappedToRenewStates[e]||(this._callBacksMappedToRenewStates[e]=[]);var i=this;this._callBacksMappedToRenewStates[e].push(r),this._callBackMappedToRenewStates[e]||(this._callBackMappedToRenewStates[e]=function(r,n,o,a){i._activeRenewals[t]=null;for(var s=0;s<i._callBacksMappedToRenewStates[e].length;++s)try{i._callBacksMappedToRenewStates[e][s](r,n,o,a)}catch(o){i.warn(o)}i._callBacksMappedToRenewStates[e]=null,i._callBackMappedToRenewStates[e]=null})},t.prototype._renewToken=function(e,t,r){this.info("renewToken is called for resource:"+e);var i=this._addAdalFrame("adalRenewFrame"+e),n=this._guid()+"|"+e;this.config.state=n,this._renewStates.push(n),this.verbose("Renew token Expected state: "+n),r=r||"token";var o=this._urlRemoveQueryStringParameter(this._getNavigateUrl(r,e),"prompt");r===this.RESPONSE_TYPE.ID_TOKEN_TOKEN&&(this._idTokenNonce=this._guid(),this._saveItem(this.CONSTANTS.STORAGE.NONCE_IDTOKEN,this._idTokenNonce,!0),o+="&nonce="+encodeURIComponent(this._idTokenNonce)),o+="&prompt=none",o=this._addHintParameters(o),this.registerCallback(n,e,t),this.verbosePii("Navigate to:"+o),i.src="about:blank",this._loadFrameTimeout(o,"adalRenewFrame"+e,e)},t.prototype._renewIdToken=function(e,t){this.info("renewIdToken is called");var r=this._addAdalFrame("adalIdTokenFrame"),i=this._guid()+"|"+this.config.clientId;this._idTokenNonce=this._guid(),this._saveItem(this.CONSTANTS.STORAGE.NONCE_IDTOKEN,this._idTokenNonce,!0),this.config.state=i,this._renewStates.push(i),this.verbose("Renew Idtoken Expected state: "+i);var n=null==t?null:this.config.clientId,o=(t=t||"id_token",this._urlRemoveQueryStringParameter(this._getNavigateUrl(t,n),"prompt"));o+="&prompt=none",o=this._addHintParameters(o),o+="&nonce="+encodeURIComponent(this._idTokenNonce),this.registerCallback(i,this.config.clientId,e),this.verbosePii("Navigate to:"+o),r.src="about:blank",this._loadFrameTimeout(o,"adalIdTokenFrame",this.config.clientId)},t.prototype._urlContainsQueryStringParameter=function(e,t){return new RegExp("[\\?&]"+e+"=").test(t)},t.prototype._urlRemoveQueryStringParameter=function(e,t){var r=new RegExp("(\\&"+t+"=)[^&]+");return e=e.replace(r,""),r=new RegExp("("+t+"=)[^&]+&"),e=e.replace(r,""),r=new RegExp("("+t+"=)[^&]+"),e.replace(r,"")},t.prototype._loadFrameTimeout=function(e,t,r){this.verbose("Set loading state to pending for: "+r),this._saveItem(this.CONSTANTS.STORAGE.RENEW_STATUS+r,this.CONSTANTS.TOKEN_RENEW_STATUS_IN_PROGRESS),this._loadFrame(e,t);var i=this;setTimeout((function(){if(i._getItem(i.CONSTANTS.STORAGE.RENEW_STATUS+r)===i.CONSTANTS.TOKEN_RENEW_STATUS_IN_PROGRESS){i.verbose("Loading frame has timed out after: "+i.CONSTANTS.LOADFRAME_TIMEOUT/1e3+" seconds for resource "+r);var e=i._activeRenewals[r];e&&i._callBackMappedToRenewStates[e]&&i._callBackMappedToRenewStates[e]("Token renewal operation failed due to timeout",null,"Token Renewal Failed"),i._saveItem(i.CONSTANTS.STORAGE.RENEW_STATUS+r,i.CONSTANTS.TOKEN_RENEW_STATUS_CANCELED)}}),i.CONSTANTS.LOADFRAME_TIMEOUT)},t.prototype._loadFrame=function(e,t){var r=this;r.info("LoadFrame: "+t);var i=t;setTimeout((function(){var t=r._addAdalFrame(i);""!==t.src&&"about:blank"!==t.src||(t.src=e,r._loadFrame(e,i))}),500)},t.prototype.acquireToken=function(e,t){if(this._isEmpty(e))return this.warn("resource is required"),void t("resource is required",null,"resource is required");var r=this.getCachedToken(e);return r?(this.info("Token is already in cache for resource:"+e),void t(null,r,null)):this._user||this.config.extraQueryParameter&&-1!==this.config.extraQueryParameter.indexOf("login_hint")?void(this._activeRenewals[e]?this.registerCallback(this._activeRenewals[e],e,t):(this._requestType=this.REQUEST_TYPE.RENEW_TOKEN,e===this.config.clientId?this._user?(this.verbose("renewing idtoken"),this._renewIdToken(t)):(this.verbose("renewing idtoken and access_token"),this._renewIdToken(t,this.RESPONSE_TYPE.ID_TOKEN_TOKEN)):this._user?(this.verbose("renewing access_token"),this._renewToken(e,t)):(this.verbose("renewing idtoken and access_token"),this._renewToken(e,t,this.RESPONSE_TYPE.ID_TOKEN_TOKEN)))):(this.warn("User login is required"),void t("User login is required",null,"login required"))},t.prototype.acquireTokenPopup=function(e,t,r,i){if(this._isEmpty(e))return this.warn("resource is required"),void i("resource is required",null,"resource is required");if(!this._user)return this.warn("User login is required"),void i("User login is required",null,"login required");if(this._acquireTokenInProgress)return this.warn("Acquire token interactive is already in progress"),void i("Acquire token interactive is already in progress",null,"Acquire token interactive is already in progress");var n=this._guid()+"|"+e;this.config.state=n,this._renewStates.push(n),this._requestType=this.REQUEST_TYPE.RENEW_TOKEN,this.verbose("Renew token Expected state: "+n);var o=this._urlRemoveQueryStringParameter(this._getNavigateUrl("token",e),"prompt");if(o+="&prompt=select_account",t&&(o+=t),r&&-1===o.indexOf("&claims"))o+="&claims="+encodeURIComponent(r);else if(r&&-1!==o.indexOf("&claims"))throw new Error("Claims cannot be passed as an extraQueryParameter");o=this._addHintParameters(o),this._acquireTokenInProgress=!0,this.info("acquireToken interactive is called for the resource "+e),this.registerCallback(n,e,i),this._loginPopup(o,e,i)},t.prototype.acquireTokenRedirect=function(e,t,r){if(this._isEmpty(e))return this.warn("resource is required"),void i("resource is required",null,"resource is required");var i=this.callback;if(!this._user)return this.warn("User login is required"),void i("User login is required",null,"login required");if(this._acquireTokenInProgress)return this.warn("Acquire token interactive is already in progress"),void i("Acquire token interactive is already in progress",null,"Acquire token interactive is already in progress");var n=this._guid()+"|"+e;this.config.state=n,this.verbose("Renew token Expected state: "+n);var o=this._urlRemoveQueryStringParameter(this._getNavigateUrl("token",e),"prompt");if(o+="&prompt=select_account",t&&(o+=t),r&&-1===o.indexOf("&claims"))o+="&claims="+encodeURIComponent(r);else if(r&&-1!==o.indexOf("&claims"))throw new Error("Claims cannot be passed as an extraQueryParameter");o=this._addHintParameters(o),this._acquireTokenInProgress=!0,this.info("acquireToken interactive is called for the resource "+e),this._saveItem(this.CONSTANTS.STORAGE.LOGIN_REQUEST,window.location.href),this._saveItem(this.CONSTANTS.STORAGE.STATE_RENEW,n,!0),this.promptUser(o)},t.prototype.promptUser=function(e){e?(this.infoPii("Navigate to:"+e),window.location.replace(e)):this.info("Navigate url is empty")},t.prototype.clearCache=function(){this._saveItem(this.CONSTANTS.STORAGE.LOGIN_REQUEST,""),this._saveItem(this.CONSTANTS.STORAGE.ANGULAR_LOGIN_REQUEST,""),this._saveItem(this.CONSTANTS.STORAGE.SESSION_STATE,""),this._saveItem(this.CONSTANTS.STORAGE.STATE_LOGIN,""),this._saveItem(this.CONSTANTS.STORAGE.STATE_RENEW,""),this._renewStates=[],this._saveItem(this.CONSTANTS.STORAGE.NONCE_IDTOKEN,""),this._saveItem(this.CONSTANTS.STORAGE.IDTOKEN,""),this._saveItem(this.CONSTANTS.STORAGE.ERROR,""),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,""),this._saveItem(this.CONSTANTS.STORAGE.LOGIN_ERROR,""),this._saveItem(this.CONSTANTS.STORAGE.LOGIN_ERROR,"");var e=this._getItem(this.CONSTANTS.STORAGE.TOKEN_KEYS);if(!this._isEmpty(e)){e=e.split(this.CONSTANTS.RESOURCE_DELIMETER);for(var t=0;t<e.length&&""!==e[t];t++)this._saveItem(this.CONSTANTS.STORAGE.ACCESS_TOKEN_KEY+e[t],""),this._saveItem(this.CONSTANTS.STORAGE.EXPIRATION_KEY+e[t],0)}this._saveItem(this.CONSTANTS.STORAGE.TOKEN_KEYS,"")},t.prototype.clearCacheForResource=function(e){this._saveItem(this.CONSTANTS.STORAGE.STATE_RENEW,""),this._saveItem(this.CONSTANTS.STORAGE.ERROR,""),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,""),this._hasResource(e)&&(this._saveItem(this.CONSTANTS.STORAGE.ACCESS_TOKEN_KEY+e,""),this._saveItem(this.CONSTANTS.STORAGE.EXPIRATION_KEY+e,0))},t.prototype.logOut=function(){var e;if(this.clearCache(),this._user=null,this.config.logOutUri)e=this.config.logOutUri;else{var t="common",r="";this.config.tenant&&(t=this.config.tenant),this.config.postLogoutRedirectUri&&(r="post_logout_redirect_uri="+encodeURIComponent(this.config.postLogoutRedirectUri)),e=this.instance+t+"/oauth2/logout?"+r}this.infoPii("Logout navigate to: "+e),this.promptUser(e)},t.prototype._isEmpty=function(e){return void 0===e||!e||0===e.length},t.prototype.getUser=function(e){if("function"!=typeof e)throw new Error("callback is not a function");if(this._user)e(null,this._user);else{var t=this._getItem(this.CONSTANTS.STORAGE.IDTOKEN);this._isEmpty(t)?(this.warn("User information is not available"),e("User information is not available",null)):(this.info("User exists in cache: "),this._user=this._createUser(t),e(null,this._user))}},t.prototype._addHintParameters=function(e){if(this._user&&this._user.profile)if(this._user.profile.sid&&-1!==e.indexOf("&prompt=none"))this._urlContainsQueryStringParameter("sid",e)||(e+="&sid="+encodeURIComponent(this._user.profile.sid));else if(this._user.profile.upn&&(this._urlContainsQueryStringParameter("login_hint",e)||(e+="&login_hint="+encodeURIComponent(this._user.profile.upn)),!this._urlContainsQueryStringParameter("domain_hint",e)&&-1<this._user.profile.upn.indexOf("@"))){var t=this._user.profile.upn.split("@");e+="&domain_hint="+encodeURIComponent(t[t.length-1])}return e},t.prototype._createUser=function(e){var t=null,r=this._extractIdToken(e);return r&&r.hasOwnProperty("aud")&&(r.aud.toLowerCase()===this.config.clientId.toLowerCase()?(t={userName:"",profile:r},r.hasOwnProperty("upn")?t.userName=r.upn:r.hasOwnProperty("email")&&(t.userName=r.email)):this.warn("IdToken has invalid aud field")),t},t.prototype._getHash=function(e){return-1<e.indexOf("#/")?e=e.substring(e.indexOf("#/")+2):-1<e.indexOf("#")&&(e=e.substring(1)),e},t.prototype.isCallback=function(e){e=this._getHash(e);var t=this._deserialize(e);return t.hasOwnProperty(this.CONSTANTS.ERROR_DESCRIPTION)||t.hasOwnProperty(this.CONSTANTS.ACCESS_TOKEN)||t.hasOwnProperty(this.CONSTANTS.ID_TOKEN)},t.prototype.getLoginError=function(){return this._getItem(this.CONSTANTS.STORAGE.LOGIN_ERROR)},t.prototype.getRequestInfo=function(e){e=this._getHash(e);var t=this._deserialize(e),r={valid:!1,parameters:{},stateMatch:!1,stateResponse:"",requestType:this.REQUEST_TYPE.UNKNOWN};if(t&&((r.parameters=t).hasOwnProperty(this.CONSTANTS.ERROR_DESCRIPTION)||t.hasOwnProperty(this.CONSTANTS.ACCESS_TOKEN)||t.hasOwnProperty(this.CONSTANTS.ID_TOKEN))){var i;if(r.valid=!0,!t.hasOwnProperty("state"))return this.warn("No state returned"),r;if(this.verbose("State: "+t.state),i=t.state,r.stateResponse=i,this._matchState(r))return r;if(!r.stateMatch&&window.parent){r.requestType=this._requestType;for(var n=this._renewStates,o=0;o<n.length;o++)if(n[o]===r.stateResponse){r.stateMatch=!0;break}}}return r},t.prototype._matchNonce=function(e){var t=this._getItem(this.CONSTANTS.STORAGE.NONCE_IDTOKEN);if(t){t=t.split(this.CONSTANTS.CACHE_DELIMETER);for(var r=0;r<t.length;r++)if(t[r]===e.profile.nonce)return!0}return!1},t.prototype._matchState=function(e){var t=this._getItem(this.CONSTANTS.STORAGE.STATE_LOGIN);if(t){t=t.split(this.CONSTANTS.CACHE_DELIMETER);for(var r=0;r<t.length;r++)if(t[r]===e.stateResponse)return e.requestType=this.REQUEST_TYPE.LOGIN,e.stateMatch=!0}var i=this._getItem(this.CONSTANTS.STORAGE.STATE_RENEW);if(i)for(i=i.split(this.CONSTANTS.CACHE_DELIMETER),r=0;r<i.length;r++)if(i[r]===e.stateResponse)return e.requestType=this.REQUEST_TYPE.RENEW_TOKEN,e.stateMatch=!0;return!1},t.prototype._getResourceFromState=function(e){if(e){var t=e.indexOf("|");if(-1<t&&t+1<e.length)return e.substring(t+1)}return""},t.prototype.saveTokenFromHash=function(e){this.info("State status:"+e.stateMatch+"; Request type:"+e.requestType),this._saveItem(this.CONSTANTS.STORAGE.ERROR,""),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,"");var t,r=this._getResourceFromState(e.stateResponse);e.parameters.hasOwnProperty(this.CONSTANTS.ERROR_DESCRIPTION)?(this.infoPii("Error :"+e.parameters.error+"; Error description:"+e.parameters[this.CONSTANTS.ERROR_DESCRIPTION]),this._saveItem(this.CONSTANTS.STORAGE.ERROR,e.parameters.error),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,e.parameters[this.CONSTANTS.ERROR_DESCRIPTION]),e.requestType===this.REQUEST_TYPE.LOGIN&&(this._loginInProgress=!1,this._saveItem(this.CONSTANTS.STORAGE.LOGIN_ERROR,e.parameters.error_description))):e.stateMatch?(this.info("State is right"),e.parameters.hasOwnProperty(this.CONSTANTS.SESSION_STATE)&&this._saveItem(this.CONSTANTS.STORAGE.SESSION_STATE,e.parameters[this.CONSTANTS.SESSION_STATE]),e.parameters.hasOwnProperty(this.CONSTANTS.ACCESS_TOKEN)&&(this.info("Fragment has access token"),this._hasResource(r)||(t=this._getItem(this.CONSTANTS.STORAGE.TOKEN_KEYS)||"",this._saveItem(this.CONSTANTS.STORAGE.TOKEN_KEYS,t+r+this.CONSTANTS.RESOURCE_DELIMETER)),this._saveItem(this.CONSTANTS.STORAGE.ACCESS_TOKEN_KEY+r,e.parameters[this.CONSTANTS.ACCESS_TOKEN]),this._saveItem(this.CONSTANTS.STORAGE.EXPIRATION_KEY+r,this._expiresIn(e.parameters[this.CONSTANTS.EXPIRES_IN]))),e.parameters.hasOwnProperty(this.CONSTANTS.ID_TOKEN)&&(this.info("Fragment has id token"),this._loginInProgress=!1,this._user=this._createUser(e.parameters[this.CONSTANTS.ID_TOKEN]),this._user&&this._user.profile?this._matchNonce(this._user)?(this._saveItem(this.CONSTANTS.STORAGE.IDTOKEN,e.parameters[this.CONSTANTS.ID_TOKEN]),r=this.config.loginResource?this.config.loginResource:this.config.clientId,this._hasResource(r)||(t=this._getItem(this.CONSTANTS.STORAGE.TOKEN_KEYS)||"",this._saveItem(this.CONSTANTS.STORAGE.TOKEN_KEYS,t+r+this.CONSTANTS.RESOURCE_DELIMETER)),this._saveItem(this.CONSTANTS.STORAGE.ACCESS_TOKEN_KEY+r,e.parameters[this.CONSTANTS.ID_TOKEN]),this._saveItem(this.CONSTANTS.STORAGE.EXPIRATION_KEY+r,this._user.profile.exp)):(this._saveItem(this.CONSTANTS.STORAGE.LOGIN_ERROR,"Nonce received: "+this._user.profile.nonce+" is not same as requested: "+this._getItem(this.CONSTANTS.STORAGE.NONCE_IDTOKEN)),this._user=null):(e.parameters.error="invalid id_token",e.parameters.error_description="Invalid id_token. id_token: "+e.parameters[this.CONSTANTS.ID_TOKEN],this._saveItem(this.CONSTANTS.STORAGE.ERROR,"invalid id_token"),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,"Invalid id_token. id_token: "+e.parameters[this.CONSTANTS.ID_TOKEN])))):(e.parameters.error="Invalid_state",e.parameters.error_description="Invalid_state. state: "+e.stateResponse,this._saveItem(this.CONSTANTS.STORAGE.ERROR,"Invalid_state"),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,"Invalid_state. state: "+e.stateResponse)),this._saveItem(this.CONSTANTS.STORAGE.RENEW_STATUS+r,this.CONSTANTS.TOKEN_RENEW_STATUS_COMPLETED)},t.prototype.getResourceForEndpoint=function(e){if(this.config&&this.config.anonymousEndpoints)for(var t=0;t<this.config.anonymousEndpoints.length;t++)if(-1<e.indexOf(this.config.anonymousEndpoints[t]))return null;if(this.config&&this.config.endpoints)for(var r in this.config.endpoints)if(-1<e.indexOf(r))return this.config.endpoints[r];return(-1<e.indexOf("http://")||-1<e.indexOf("https://"))&&this._getHostFromUri(e)!==this._getHostFromUri(this.config.redirectUri)?null:this.config.loginResource},t.prototype._getHostFromUri=function(e){var t=String(e).replace(/^(https?:)\/\//,"");return t.split("/")[0]},t.prototype.handleWindowCallback=function(e){if(null==e&&(e=window.location.hash),this.isCallback(e)){var t=null,r=!1;0<this._openedWindows.length&&this._openedWindows[this._openedWindows.length-1].opener&&this._openedWindows[this._openedWindows.length-1].opener._adalInstance?(t=this._openedWindows[this._openedWindows.length-1].opener._adalInstance,r=!0):window.parent&&window.parent._adalInstance&&(t=window.parent._adalInstance);var i,n,o=t.getRequestInfo(e),a=null;n=r||window.parent!==window?t._callBackMappedToRenewStates[o.stateResponse]:t.callback,t.info("Returned from redirect url"),t.saveTokenFromHash(o),o.requestType===this.REQUEST_TYPE.RENEW_TOKEN&&window.parent?(window.parent!==window?t.verbose("Window is in iframe, acquiring token silently"):t.verbose("acquiring token interactive in progress"),i=o.parameters[t.CONSTANTS.ACCESS_TOKEN]||o.parameters[t.CONSTANTS.ID_TOKEN],a=t.CONSTANTS.ACCESS_TOKEN):o.requestType===this.REQUEST_TYPE.LOGIN&&(i=o.parameters[t.CONSTANTS.ID_TOKEN],a=t.CONSTANTS.ID_TOKEN);var s=o.parameters[t.CONSTANTS.ERROR_DESCRIPTION],l=o.parameters[t.CONSTANTS.ERROR];try{n&&n(s,i,l,a)}catch(e){t.error("Error occurred in user defined callback function: "+e)}window.parent!==window||r||(t.config.navigateToLoginRequestUrl?window.location.href=t._getItem(t.CONSTANTS.STORAGE.LOGIN_REQUEST):window.location.hash="")}},t.prototype._getNavigateUrl=function(e,t){var r="common";this.config.tenant&&(r=this.config.tenant);var i=this.instance+r+"/oauth2/authorize"+this._serialize(e,this.config,t)+this._addLibMetadata();return this.info("Navigate url:"+i),i},t.prototype._extractIdToken=function(e){var t=this._decodeJwt(e);if(!t)return null;try{var r=t.JWSPayload,i=this._base64DecodeStringUrlSafe(r);return i?JSON.parse(i):(this.info("The returned id_token could not be base64 url safe decoded."),null)}catch(e){this.error("The returned id_token could not be decoded",e)}return null},t.prototype._base64DecodeStringUrlSafe=function(e){return e=e.replace(/-/g,"+").replace(/_/g,"/"),window.atob?decodeURIComponent(escape(window.atob(e))):decodeURIComponent(escape(this._decode(e)))},t.prototype._decode=function(e){var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",r=(e=String(e).replace(/=+$/,"")).length;if(r%4==1)throw new Error("The token to be decoded is not correctly encoded.");for(var i,n,o,a,s,l,u,c,p="",h=0;h<r;h+=4){if(i=t.indexOf(e.charAt(h)),n=t.indexOf(e.charAt(h+1)),o=t.indexOf(e.charAt(h+2)),a=t.indexOf(e.charAt(h+3)),h+2===r-1){l=(s=i<<18|n<<12|o<<6)>>16&255,u=s>>8&255,p+=String.fromCharCode(l,u);break}if(h+1===r-1){l=(s=i<<18|n<<12)>>16&255,p+=String.fromCharCode(l);break}l=(s=i<<18|n<<12|o<<6|a)>>16&255,u=s>>8&255,c=255&s,p+=String.fromCharCode(l,u,c)}return p},t.prototype._decodeJwt=function(e){if(this._isEmpty(e))return null;var t=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(e);return!t||t.length<4?(this.warn("The returned id_token is not parseable."),null):{header:t[1],JWSPayload:t[2],JWSSig:t[3]}},t.prototype._convertUrlSafeToRegularBase64EncodedString=function(e){return e.replace("-","+").replace("_","/")},t.prototype._serialize=function(e,t,r){var i=[];if(null!==t){i.push("?response_type="+e),i.push("client_id="+encodeURIComponent(t.clientId)),r&&i.push("resource="+encodeURIComponent(r)),i.push("redirect_uri="+encodeURIComponent(t.redirectUri)),i.push("state="+encodeURIComponent(t.state)),t.hasOwnProperty("slice")&&i.push("slice="+encodeURIComponent(t.slice)),t.hasOwnProperty("extraQueryParameter")&&i.push(t.extraQueryParameter);var n=t.correlationId?t.correlationId:this._guid();i.push("client-request-id="+encodeURIComponent(n))}return i.join("&")},t.prototype._deserialize=function(e){function t(e){return decodeURIComponent(e.replace(i," "))}var r,i=/\+/g,n=/([^&=]+)=([^&]*)/g,o={};for(r=n.exec(e);r;)o[t(r[1])]=t(r[2]),r=n.exec(e);return o},t.prototype._decimalToHex=function(e){for(var t=e.toString(16);t.length<2;)t="0"+t;return t},t.prototype._guid=function(){var e=window.crypto||window.msCrypto;if(e&&e.getRandomValues){var t=new Uint8Array(16);return e.getRandomValues(t),t[6]|=64,t[6]&=79,t[8]|=128,t[8]&=191,this._decimalToHex(t[0])+this._decimalToHex(t[1])+this._decimalToHex(t[2])+this._decimalToHex(t[3])+"-"+this._decimalToHex(t[4])+this._decimalToHex(t[5])+"-"+this._decimalToHex(t[6])+this._decimalToHex(t[7])+"-"+this._decimalToHex(t[8])+this._decimalToHex(t[9])+"-"+this._decimalToHex(t[10])+this._decimalToHex(t[11])+this._decimalToHex(t[12])+this._decimalToHex(t[13])+this._decimalToHex(t[14])+this._decimalToHex(t[15])}for(var r="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx",i="0123456789abcdef",n=0,o="",a=0;a<36;a++)"-"!==r[a]&&"4"!==r[a]&&(n=16*Math.random()|0),"x"===r[a]?o+=i[n]:"y"===r[a]?(n&=3,o+=i[n|=8]):o+=r[a];return o},t.prototype._expiresIn=function(e){return e=e||3599,this._now()+parseInt(e,10)},t.prototype._now=function(){return Math.round((new Date).getTime()/1e3)},t.prototype._addAdalFrame=function(e){if(void 0!==e){this.info("Add adal frame to document:"+e);var t=document.getElementById(e);if(!t){if(document.createElement&&document.documentElement&&(window.opera||-1===window.navigator.userAgent.indexOf("MSIE 5.0"))){var r=document.createElement("iframe");r.setAttribute("id",e),r.setAttribute("aria-hidden","true"),r.style.visibility="hidden",r.style.position="absolute",r.style.width=r.style.height=r.borderWidth="0px",t=document.getElementsByTagName("body")[0].appendChild(r)}else document.body&&document.body.insertAdjacentHTML&&document.body.insertAdjacentHTML("beforeEnd",'<iframe name="'+e+'" id="'+e+'" style="display:none"></iframe>');window.frames&&window.frames[e]&&(t=window.frames[e])}return t}},t.prototype._saveItem=function(e,t,r){if(this.config&&this.config.cacheLocation&&"localStorage"===this.config.cacheLocation){if(!this._supportsLocalStorage())return this.info("Local storage is not supported"),!1;if(r){var i=this._getItem(e)||"";localStorage.setItem(e,i+t+this.CONSTANTS.CACHE_DELIMETER)}else localStorage.setItem(e,t);return!0}return this._supportsSessionStorage()?(sessionStorage.setItem(e,t),!0):(this.info("Session storage is not supported"),!1)},t.prototype._getItem=function(e){return this.config&&this.config.cacheLocation&&"localStorage"===this.config.cacheLocation?this._supportsLocalStorage()?localStorage.getItem(e):(this.info("Local storage is not supported"),null):this._supportsSessionStorage()?sessionStorage.getItem(e):(this.info("Session storage is not supported"),null)},t.prototype._supportsLocalStorage=function(){try{return!!window.localStorage&&(window.localStorage.setItem("storageTest","A"),"A"==window.localStorage.getItem("storageTest")&&(window.localStorage.removeItem("storageTest"),!window.localStorage.getItem("storageTest")))}catch(e){return!1}},t.prototype._supportsSessionStorage=function(){try{return!!window.sessionStorage&&(window.sessionStorage.setItem("storageTest","A"),"A"==window.sessionStorage.getItem("storageTest")&&(window.sessionStorage.removeItem("storageTest"),!window.sessionStorage.getItem("storageTest")))}catch(e){return!1}},t.prototype._cloneConfig=function(e){if(null===e||"object"!=typeof e)return e;var t={};for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);return t},t.prototype._addLibMetadata=function(){return"&x-client-SKU=Js&x-client-Ver="+this._libVersion()},t.prototype.log=function(e,t,r,i){if(e<=Logging.level){if(!Logging.piiLoggingEnabled&&i)return;var n=(new Date).toUTCString(),o="";o=this.config.correlationId?n+":"+this.config.correlationId+"-"+this._libVersion()+"-"+this.CONSTANTS.LEVEL_STRING_MAP[e]+" "+t:n+":"+this._libVersion()+"-"+this.CONSTANTS.LEVEL_STRING_MAP[e]+" "+t,r&&(o+="\nstack:\n"+r.stack),Logging.log(o)}},t.prototype.error=function(e,t){this.log(this.CONSTANTS.LOGGING_LEVEL.ERROR,e,t)},t.prototype.warn=function(e){this.log(this.CONSTANTS.LOGGING_LEVEL.WARN,e,null)},t.prototype.info=function(e){this.log(this.CONSTANTS.LOGGING_LEVEL.INFO,e,null)},t.prototype.verbose=function(e){this.log(this.CONSTANTS.LOGGING_LEVEL.VERBOSE,e,null)},t.prototype.errorPii=function(e,t){this.log(this.CONSTANTS.LOGGING_LEVEL.ERROR,e,t,!0)},t.prototype.warnPii=function(e){this.log(this.CONSTANTS.LOGGING_LEVEL.WARN,e,null,!0)},t.prototype.infoPii=function(e){this.log(this.CONSTANTS.LOGGING_LEVEL.INFO,e,null,!0)},t.prototype.verbosePii=function(e){this.log(this.CONSTANTS.LOGGING_LEVEL.VERBOSE,e,null,!0)},t.prototype._libVersion=function(){return"1.0.17"},e.exports&&(e.exports=t,e.exports.inject=function(e){return new t(e)}),t)}));function bh(e){this.message=e}_h.inject,(bh.prototype=new Error).name="InvalidCharacterError";var xh="undefined"!=typeof window&&window.atob&&window.atob.bind(window)||function(e){var t=String(e).replace(/=+$/,"");if(t.length%4==1)throw new bh("'atob' failed: The string to be decoded is not correctly encoded.");for(var r,i,n=0,o=0,a="";i=t.charAt(o++);~i&&(r=n%4?64*r+i:i,n++%4)&&(a+=String.fromCharCode(255&r>>(-2*n&6))))i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(i);return a};function wh(e){this.message=e}function Sh(e,t){if("string"!=typeof e)throw new wh("Invalid token specified");var r=!0===(t=t||{}).header?0:1;try{return JSON.parse(function(e){var t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw"Illegal base64url string!"}try{return decodeURIComponent(xh(t).replace(/(.)/g,(function(e,t){var r=t.charCodeAt(0).toString(16).toUpperCase();return r.length<2&&(r="0"+r),"%"+r})))}catch(e){return xh(t)}}(e.split(".")[r]))}catch(e){throw new wh("Invalid token specified: "+e.message)}}(wh.prototype=new Error).name="InvalidTokenError",Sh.InvalidTokenError=wh;var Th=(Ch.prototype.initialize=function(){var e=this;return this.initPromise||(this.initPromise=new Promise((function(r,i){if(e.options.authType===t.AuthenticationType.subscriptionKey)r();else if(e.options.authType===t.AuthenticationType.aad){if(e.options.authContext=e.options.authContext||Ch.getDefaultAuthContext(e.options),e.options.authContext.handleWindowCallback(),e.options.authContext.getLoginError())return void i(new Error("Error logging in the AAD users: "+e.options.authContext.getLoginError()));if(e.options.authContext.isCallback(window.location.hash))return void e.map.dispose();setTimeout((function(){return e._loginAndAcquire(r,i)}))}else e.options.authType===t.AuthenticationType.anonymous?r(e._triggerTokenFetch()):i(new Error("An invalid authentication type was specified."))}))),this.initPromise},Ch.getDefaultAuthContext=function(e){if(!e.aadAppId)throw new Error("No AAD app ID was specified.");if(!e.aadTenant)throw new Error("No AAD tenant was specified.");return this.defaultAuthContext||(this.defaultAuthContext=new _h({instance:e.aadInstance||"https://login.microsoftonline.com/",tenant:e.aadTenant,clientId:e.aadAppId,cacheLocation:this.constants.preferredCacheLocation})),this.defaultAuthContext},Ch.prototype._loginAndAcquire=function(e,t){function r(){i.options.authContext.acquireToken(p,(function(r){if(r)t(new Error(r));else{var n={map:i.map,type:Ch.constants.events.tokenAcquired};i.map.events.invoke(Ch.constants.events.tokenAcquired,n),e()}}))}var i=this,n=this.options.authContext.getCachedToken(this.options.aadAppId),o=this.options.authContext.getCachedUser();if(n&&o)r();else{this.options.authContext.loginInProgress()||this.options.authContext.login();var a=setInterval((function(){i.options.authContext.loginInProgress()||(clearInterval(a),i.options.authContext.getCachedToken(i.options.aadAppId)?r():t(new Error(i.options.authContext.getLoginError()||"The AAD authentication context is not logged-in for the specified app ID: "+i.options.aadAppId)))}),25)}},Ch.prototype.getAuthType=function(){return this.options.authType},Ch.prototype.getClientId=function(){return this.options.clientId},Ch.prototype.getToken=function(){var e=this;if(this.options.authType===t.AuthenticationType.aad){var r=this.options.authContext.getCachedToken(p);return r||(this.options.authContext.getCachedUser()||this.options.authContext.login(),this.options.authContext.acquireToken(p,(function(t,i){if(!t){r=i;var n={map:e.map,type:Ch.constants.events.tokenAcquired};e.map.events.invoke(Ch.constants.events.tokenAcquired,n)}}))),r}if(this.options.authType===t.AuthenticationType.anonymous){var i=this._getItem(Ch.constants.storage.accessTokenKey);if(i){var n=this._getTokenExpiry(i);if(n<300&&0<n)this._triggerTokenFetch();else if(n<=0)throw this._saveItem(Ch.constants.storage.accessTokenKey,""),new Error(Ch.constants.errors.tokenExpired)}else this._triggerTokenFetch();return i}if(this.options.authType===t.AuthenticationType.subscriptionKey)return this.options.subscriptionKey},Ch.prototype._getTokenExpiry=function(e){var t=Sh(e).exp,r=this._getCurrentTime();return 0<t-r?t-r:-1},Ch.prototype._storeAccessToken=function(e){this._saveItem(Ch.constants.storage.accessTokenKey,e);var t={map:this.map,type:Ch.constants.events.tokenAcquired};this.map.events.invoke(Ch.constants.events.tokenAcquired,t)},Ch.prototype._saveItem=function(e,t){return this._supportsLocalStorage()?(localStorage.setItem(e,t),!0):!!this._supportsSessionStorage()&&(sessionStorage.setItem(e,t),!0)},Ch.prototype._getItem=function(e){return this._supportsLocalStorage()?localStorage.getItem(e):this._supportsSessionStorage()?sessionStorage.getItem(e):null},Ch.prototype._supportsLocalStorage=function(){try{return!!window.localStorage&&(window.localStorage.setItem(Ch.constants.storage.testStorageKey,"A"),"A"===window.localStorage.getItem(Ch.constants.storage.testStorageKey)&&(window.localStorage.removeItem(Ch.constants.storage.testStorageKey),!window.localStorage.getItem(Ch.constants.storage.testStorageKey)))}catch(e){return!1}},Ch.prototype._supportsSessionStorage=function(){try{return!!window.sessionStorage&&(window.sessionStorage.setItem(Ch.constants.storage.testStorageKey,"A"),"A"===window.sessionStorage.getItem(Ch.constants.storage.testStorageKey)&&(window.sessionStorage.removeItem(Ch.constants.storage.testStorageKey),!window.sessionStorage.getItem(Ch.constants.storage.testStorageKey)))}catch(e){return!1}},Ch.prototype._getCurrentTime=function(){return Math.round((new Date).getTime()/1e3)},Ch.prototype.signRequest=function(e){e.headers=e.headers||{},e.headers["Session-Id"]=this.sessionId,e.headers["Ms-Am-Request-Origin"]="MapControl",e.headers["Map-Agent"]="MapControl/2.0.31 (Web)";var r=this.getToken();switch(this.options.authType){case t.AuthenticationType.aad:case t.AuthenticationType.anonymous:e.headers["x-ms-client-id"]=this.options.clientId,e.headers.Authorization="Bearer "+r;break;case t.AuthenticationType.subscriptionKey:if("url"in e)-1!==e.url.indexOf("?")?e.url+="&subscription-key="+r:e.url+="?&subscription-key="+r;else{if(!("domain"in e))throw new Error("Could not determine if the provided object was UrlOptions or RequestParameters");e.queryParams=e.queryParams||{},e.queryParams["subscription-key"]=r}break;default:throw new Error("An invalid authentication type was specified")}return e},Ch.constants={preferredCacheLocation:"localStorage",storage:{accessTokenKey:"access.token.key",testStorageKey:"testStorage"},events:{tokenAcquired:"tokenacquired"},tokenExpiresIn:3599,tokenRefreshClockSkew:300,errors:{tokenExpired:"Token Expired, Try again"}},Ch);function Ch(e){var t=this;this._triggerTokenFetch=function(){return new Promise((function(e,r){t.options.getToken((function(i){try{var n=t._getTokenExpiry(i)-Ch.constants.tokenRefreshClockSkew;t._storeAccessToken(i),clearTimeout(t.tokenTimeOutHandle),t.tokenTimeOutHandle=setTimeout(t._triggerTokenFetch,1e3*n),e()}catch(i){r(new Error("Invalid token returned by getToken function"))}}),(function(e){r(e)}),t.map)}))};var r=e.getServiceOptions();this.options=r.authOptions,this.sessionId=r.sessionId,this.map=e}var Eh=(Ih.prototype.add=function(e,t){if(Array.isArray(e))for(var r=0,i=e;r<i.length;r++){var n=i[r];this._add(n,t)}else this._add(e,t)},Ih.prototype.getControls=function(){return Array.from(this.controls)},Ih.prototype.remove=function(e){if(Array.isArray(e))for(var t=0,r=e;t<r.length;t++){var i=r[t];this._remove(i)}else this._remove(e)},Ih.prototype._add=function(e,t){this.controls.add(e);var r=(new R).merge(t),i=e.onAdd(this.map,t),n=this.controlContainer.getElementsByClassName(r.position);if(!(0<n.length))throw new Error("Control position "+r.position+" does not exist.");n.item(0).appendChild(i)},Ih.prototype._remove=function(e){e.onRemove(),this.controls.delete(e)},Ih);function Ih(e){for(var r in this.map=e,this.controlContainer=document.createElement("div"),this.controlContainer.classList.add("atlas-control-container"),t.ControlPosition)if(t.ControlPosition.hasOwnProperty(r)){var i=document.createElement("div");i.classList.add(t.ControlPosition[r]),i.classList.add("subcontrol-container"),this.controlContainer.appendChild(i)}this.map.getMapContainer().appendChild(this.controlContainer),this.controls=new Set}var Ph=(Rh.prototype.addCallback=function(e,t,r,i,n){var o,a,s=this;if(i)o=function(e){var t=e.lngLat?new En(e.lngLat.lng,e.lngLat.lat):void 0,i=e.point?[e.point.x,e.point.y]:void 0,n=e.features?e.features.map((function(e){return new gi(e.geometry,e.properties,e.id)})):[],o={type:e.type,originalEvent:e.originalEvent,position:t,coordinate:i,features:n};r(o)};else switch(e){case"data":case"sourcedata":case"styledata":o=function(i){var o=m(m({dataType:i.dataType},"source"===i.dataType&&m(m(m({isSourceLoaded:i.isSourceLoaded},i.sourceDataType&&{sourceDataType:i.sourceDataType}),{source:s.map.sources.getById(i.sourceId)}),i.tile&&{tile:{id:{x:i.tile.tileID.canonical.x,y:i.tile.tileID.canonical.y,z:i.tile.tileID.canonical.z},size:i.tile.tileSize,state:i.tile.state}})),{map:s.map,type:i.type});n&&s.map.events._removeListener(e,t,r),r(o)};break;case"error":o=function(i){var o={error:i.error,map:s.map,type:i.type};n&&s.map.events._removeListener(e,t,r),r(o)};break;case"touchstart":case"touchend":case"touchmove":case"touchcancel":o=function(i){if(i.originalEvent){if(i.originalEvent===a)return;a=i.originalEvent}var o=i.point?new bi(i.point.x,i.point.y):void 0,l=i.points?i.points.map((function(e){return new bi(e.x,e.y)})):[],u=i.lngLat?new En(i.lngLat.lng,i.lngLat.lat):void 0,c=i.lngLats?i.lngLats.map((function(e){return new En(e.lng,e.lat)})):[],p=u?s.map.layers.getRenderedShapes(new wi(u),t?[t]:void 0):[],h={map:s.map,originalEvent:i.originalEvent,pixel:o,pixels:l,position:u,positions:c,shapes:p,layerId:t||void 0,preventDefault:function(){return i.preventDefault()},type:i.type};n&&s.map.events._removeListener(e,t,r),r(h)};break;case"mousedown":case"mouseup":case"mouseover":case"mousemove":case"click":case"dblclick":case"mouseout":case"mouseenter":case"mouseleave":case"contextmenu":o=function(i){if(i.originalEvent){if(i.originalEvent===a)return;a=i.originalEvent}var o=i.lngLat?new En(i.lngLat.lng,i.lngLat.lat):void 0,l=i.point?new bi(i.point.x,i.point.y):void 0,u=o?s.map.layers.getRenderedShapes(new wi(o),t?[t]:void 0):[],c={map:s.map,originalEvent:i.originalEvent,position:o,pixel:l,preventDefault:function(){return i.preventDefault()},shapes:u,layerId:t||void 0,type:i.type};n&&s.map.events._removeListener(e,t,r),r(c)};break;case"styleimagemissing":o=function(i){n&&s.map.events._removeListener(e,t,r),r(i.id)};break;case"wheel":o=function(i){if(i.originalEvent){if(i.originalEvent===a)return;a=i.originalEvent}var o={map:s.map,originalEvent:i.originalEvent,preventDefault:function(){return i.preventDefault()},type:i.type};n&&s.map.events._removeListener(e,t,r),r(o)};break;case"resize":o=function(i){var o={map:s.map,type:i.type};for(var a in i)"type"!==a&&"target"!==a&&(o[a]=i[a]);n&&s.map.events._removeListener(e,t,r),r(o)};break;default:o=function(i){var o={map:s.map,type:i.type};i.originalEvent&&(o.originalEvent=i.originalEvent),n&&s.map.events._removeListener(e,t,r),r(o)}}this.callbacks.has(t)||this.callbacks.set(t,new Nr),this.callbacks.get(t).has(e)||this.callbacks.get(t).set(e,new Nr),this.callbacks.get(t).get(e).set(r,[o,n])},Rh.prototype.removeCallback=function(e,t,r){this.callbacks.has(t)&&this.callbacks.get(t).has(e)&&this.callbacks.get(t).get(e).has(r)&&this.callbacks.get(t).get(e).delete(r)},Rh.prototype.getModifiedCallback=function(e,t,r){if(this.callbacks.has(t)&&this.callbacks.get(t).has(e)&&this.callbacks.get(t).get(e).has(r))return this.callbacks.get(t).get(e).get(r)[0]},Rh.prototype.getLayerCallbacks=function(e){if(this.callbacks.has(e))return this.callbacks.get(e)},Rh.prototype.getEventCallbacks=function(e,t){if(this.callbacks.has(t)){var r=this.callbacks.get(t);if(r.has(e))return r.get(e)}},Rh);function Rh(e){this.callbacks=new Nr,this.map=e}var Nh=(Ah.prototype.add=function(e,t,r){if("function"==typeof t)this._addGlobalListener(e,t,!1,!1);else for(var i=0,n=t=Array.isArray(t)?t:[t];i<n.length;i++){var o=n[i];o instanceof bo&&bo._isMBoxEvent(e)?this._addLayerListener(e,o,r,!1,!1):o._addEventListener(e,r,!1)}},Ah.prototype.addOnce=function(e,t,r){"function"==typeof t?this._addGlobalListener(e,t,!1,!0):t instanceof bo&&bo._isMBoxEvent(e)?this._addLayerListener(e,t,r,!1,!0):t._addEventListener(e,r,!0)},Ah.prototype._addLegacy=function(e,t,r){"function"==typeof t?this._addGlobalListener(e,t,!0,!1):this._addLayerListener(e,t,r,!0,!1)},Ah.prototype._addLayerListener=function(e,t,r,i,n){var o=t instanceof bo?t.getId():t,a=this.map.layers.getLayerById(o),s=this.mapCallbackHandler.getModifiedCallback(e,o,r);if(s&&a)for(var l=0,u=a._getLayerIds();l<u.length;l++){var c=u[l];this.map._getMap().off(e,c,s)}if(this.mapCallbackHandler.addCallback(e,o,r,i,n),a){s=this.mapCallbackHandler.getModifiedCallback(e,o,r);for(var p=0,h=a._getLayerIds();p<h.length;p++)c=h[p],this.map._getMap().on(e,c,s)}},Ah.prototype._addGlobalListener=function(e,t,r,i){var n=this.mapCallbackHandler.getModifiedCallback(e,"",t);if(n&&this.map._getMap().off(e,n),this.mapCallbackHandler.addCallback(e,"",t,r,i),n=this.mapCallbackHandler.getModifiedCallback(e,"",t),"load"===e&&this.map._isLoaded()){var o={type:"load",map:this.map};setTimeout((function(){return n(o)}))}else if("ready"===e){if(this.map._isReady()){var a={type:"ready",map:this.map};setTimeout((function(){return n(a)}))}}else this.map._getMap().on(e,n)},Ah.prototype.invoke=function(e,t,r){if(void 0===r)this._invokeListeners(e,"",t);else if(t instanceof bo&&bo._isMBoxEvent(e))this._invokeListeners(e,t.getId(),r);else{if(!(t instanceof Nn))throw new Error("The invoke target is invalid.");t._invokeEvent(e,r)}},Ah.prototype._invokeListeners=function(e,t,r){var i=this,n=this.mapCallbackHandler.getEventCallbacks(e,t);n?n.forEach((function(n,o){n[0],n[1]&&i._removeListener(e,t,o),o(r)})):"error"===e&&console.error("error"in r?r.error:r)},Ah.prototype.remove=function(e,t,r){if("function"==typeof t)this._removeListener(e,"",t);else for(var i=0,n=t=Array.isArray(t)?t:[t];i<n.length;i++){var o=n[i];o instanceof bo&&bo._isMBoxEvent(e)?this._removeListener(e,o,r):o._removeEventListener(e,r)}},Ah.prototype._removeLegacy=function(e,t,r){"function"==typeof t?this._removeListener(e,"",t):this._removeListener(e,t,r)},Ah.prototype._removeListener=function(e,t,r){var i=t instanceof bo?t.getId():t,n=this.mapCallbackHandler.getModifiedCallback(e,i,r);if(n)if(i){var o=this.map.layers.getLayerById(i);if(o)for(var a=0,s=o._getLayerIds();a<s.length;a++){var l=s[a];this.map._getMap().off(e,l,n)}}else this.map._getMap().off(e,n);this.mapCallbackHandler.removeCallback(e,i,r)},Ah.prototype._enableLayerEvents=function(e){var t=this,r=this.mapCallbackHandler.getLayerCallbacks(e.getId());r&&r.forEach((function(r,i){r.forEach((function(r){for(var n=r[0],o=0,a=e._getLayerIds();o<a.length;o++){var s=a[o];t.map._getMap().on(i,s,n)}}))}))},Ah.prototype._disableLayerEvents=function(e){var t=this,r=this.mapCallbackHandler.getLayerCallbacks(e.getId());r&&r.forEach((function(r,i){r.forEach((function(r){for(var n=r[0],o=0,a=e._getLayerIds();o<a.length;o++){var s=a[o];t.map._getMap().off(i,s,n)}}))}))},Ah);function Ah(e){this.map=e,this.mapCallbackHandler=new Ph(this.map)}var zh=(Mh.prototype.add=function(e,t){if(Array.isArray(e))for(var r=0,i=e;r<i.length;r++){var n=i[r];this._addMarker(n,t)}else this._addMarker(e,t)},Mh.prototype._addMarker=function(e,t){e._addToMap(this.map,t),this.markers.add(e)},Mh.prototype.getMarkers=function(){return Array.from(this.markers)},Mh.prototype.remove=function(e){if(Array.isArray(e))for(var t=0,r=e;t<r.length;t++){var i=r[t];this._removeMarker(i)}else this._removeMarker(e)},Mh.prototype._removeMarker=function(e){var t=this;e instanceof Ja?(e._removeFromMap(),this.markers.delete(e)):this.markers.forEach((function(r){r._getId()===e&&(r._removeFromMap(),t.markers.delete(r))}))},Mh.prototype.clear=function(){var e=this;this.markers.forEach((function(t){t._removeFromMap(),e.markers.delete(t)}))},Mh);function Mh(e){this.markers=new Set,this.map=e}var kh=(Oh.prototype.add=function(e,t){var r=this;return new Promise((function(i,n){if(r.userImages.has(e))i();else if(t instanceof HTMLImageElement||t instanceof ImageData)r.map._getMap().addImage(e,t),r.userImages.set(e,t),i();else if("string"==typeof t){var o,a;a=/<svg/i.test(t)&&!/^data:/i.test(t)?"data:image/svg+xml;base64,"+window.btoa(t):t;var s=!1;r.map._sendRequest(a,"Image").then((function(e){if(!s)return e.blob()})).then((function(t){if(!s){clearTimeout(o);var a=new Image;a.onload=function(){r.map._getMap().addImage(e,a),r.userImages.set(e,a),i()},a.onerror=a.onabort=function(){n("Failed to load image into HTML element.")},a.src=URL.createObjectURL(t)}})).catch((function(){s||(clearTimeout(o),n("Failed to load image into HTML element."))})),o=setTimeout((function(){s=!0,n("Failed to load image within specified timeout: "+r.imageLoadTimeout+" ms.")}),r.imageLoadTimeout)}}))},Oh.prototype.clear=function(){var e=this;this.userImages.forEach((function(t,r){e.map._getMap().removeImage(r)})),this.userImages.clear()},Oh.prototype.getImageIds=function(){var e=[];return this.userImages.forEach((function(t,r){e.push(r)})),e},Oh.prototype.createFromTemplate=function(e,t,r,i,n){r=r||"#1A73AA",i=i||"#fff";var o=Ws(t,n);return o=o.replace(/{color}/g,r).replace(/{secondaryColor}/g,i).replace(/{text}/g,""),this.add(e,o)},Oh.prototype.hasImage=function(e){return this.userImages.has(e)},Oh.prototype.remove=function(e){this.map._getMap().removeImage(e),this.userImages.delete(e)},Oh.prototype._restoreImages=function(){var e=this;this.userImages.forEach((function(t,r){e.map._getMap().hasImage(r)||e.map._getMap().addImage(r,t)}))},Oh);function Oh(e){this.userImages=new Nr,this.imageLoadTimeout=5e3,this.map=e}var Lh=(Dh.prototype.add=function(e,t,r){void 0===r&&(r=!0);var i=t instanceof bo?t.getId():t;if(Array.isArray(e))for(var n=0,o=e;n<o.length;n++){var a=o[n];this._addLayer(a,i,r)}else this._addLayer(e,i,r)},Dh.prototype._addLayer=function(e,t,r){if(t!==e.getId()&&this.layersById.has(t))if(this.layersById.has(e.getId())){var i=this.layers.findIndex((function(t){return t.getId()===e.getId()})),n=this.layers[i];r&&(this._removeMapboxLayers(n),this._addMapboxLayers(e,t)),this.map.events._disableLayerEvents(n),this.map.events._enableLayerEvents(e),this.layersById.set(e.getId(),e),this.layers.splice(i,1);var o=this.layers.findIndex((function(e){return e.getId()===t}));this.layers.splice(o,0,e),n.onRemove(),e.onAdd(this.map)}else r&&this._addMapboxLayers(e,t),o=this.layers.findIndex((function(e){return e.getId()===t})),this.layers.splice(o,0,e),this.layersById.set(e.getId(),e),this.map.events._enableLayerEvents(e),e.onAdd(this.map);else this.layersById.has(e.getId())?(i=this.layers.findIndex((function(t){return t.getId()===e.getId()})),n=this.layers[i],r&&(this._removeMapboxLayers(n),this._addMapboxLayers(e,i+1)),this.map.events._disableLayerEvents(n),this.map.events._enableLayerEvents(e),this.layersById.set(e.getId(),e),this.layers[i]=e,n.onRemove()):(r&&this._addMapboxLayers(e),this.layersById.set(e.getId(),e),this.layers.push(e),this.map.events._enableLayerEvents(e)),e.onAdd(this.map)},Dh.prototype._addMapboxLayers=function(e,t){if(!this.map._isReady())throw new Error("The layer '"+e.getId()+"' could not be added to the map because the map is not ready. Please use a ready event listener to guarantee the map is ready before adding a layer to it.");if(!(e instanceof Ra)||e.getOptions().tileUrl){e instanceof Go&&this.map._getMap().addSource(e._getSourceId(),e._buildSource());for(var r=this._getMapboxBefore(t),i=0,n=e._buildLayers();i<n.length;i++){var o=n[i];this.map._getMap().addLayer(o,r)}}},Dh.prototype._removeMapboxLayers=function(e){for(var t=0,r=e._getLayerIds();t<r.length;t++){var i=r[t];this.map._getMap().getLayer(i)&&this.map._getMap().removeLayer(i)}e instanceof Go&&this.map._getMap().getSource(e._getSourceId())&&this.map._getMap().removeSource(e._getSourceId())},Dh.prototype._getMapboxBefore=function(e){if("string"==typeof e){var t=this.layersById.get(e);if(!t)return;for(var r=0,i=t._getLayerIds();r<i.length;r++){var n=i[r];if(this.map._getMap().getLayer(n))return n}e=this.layers.findIndex((function(t){return t.getId()===e}))+1}for(var o=e;o<this.layers.length;o++)for(var a=0,s=this.layers[o]._getLayerIds();a<s.length;a++)if(n=s[a],this.map._getMap().getLayer(n))return n},Dh.prototype.clear=function(){for(var e=this.layers.length-1;0<=e;e--){var t=this.layers[e];this._removeMapboxLayers(t),this.map.events._disableLayerEvents(t),this.layersById.delete(t.getId()),this.layers.splice(e,1),t.onRemove()}},Dh.prototype.getLayerById=function(e){return this.layersById.get(e)},Dh.prototype.getLayers=function(){return this.layers.slice(0)},Dh.prototype._getSourceIds=function(){for(var e=new Set,t=0,r=this.layers;t<r.length;t++)r[t]._getSourceIds().forEach((function(t){return e.add(t)}));return e},Dh.prototype.move=function(e,t){var r=e instanceof bo?e.getId():e,i=t instanceof bo?t.getId():t;if(!this.layersById.has(r))throw new Error("The layer '"+r+"' has not been added to the map and cannot be moved.");var n=this.layers.findIndex((function(e){return e.getId()===r}));if(this._moveMapboxLayers(this.layers[n],i),e=this.layers[n],this.layers.splice(n,1),this.layersById.has(i)){var o=this.layers.findIndex((function(e){return e.getId()===i}));this.layers.splice(o,0,e)}else this.layers.push(e)},Dh.prototype._moveMapboxLayers=function(e,t){for(var r=this._getMapboxBefore(t),i=0,n=e._getLayerIds();i<n.length;i++){var o=n[i];this.map._getMap().moveLayer(o,r)}},Dh.prototype.getRenderedShapes=function(e,t,r){var i,n,o=this;if(e=e||[-180,-85.0511,180,85.0511],Array.isArray(e)?4===e.length||6===e.length?i=this.map.positionsToPixels([qn.getSouthWest(e),qn.getNorthEast(e)]):2!==e.length&&3!==e.length||(i=this.map.positionsToPixels([e])[0]):i=this.map.positionsToPixels([e.coordinates])[0],t){n=[];for(var a=0,s=t=Array.isArray(t)?t:[t];a<s.length;a++){var l=s[a],u=l instanceof bo?l.getId():l;if(!this.layersById.has(u))throw new Error("The layer '"+u+"' has not been added to the map and its rendered features cannot be retrieved.");n.push.apply(n,this.layersById.get(u)._getLayerIds().filter((function(e){return!!o.map._getMap().getLayer(e)})))}}var c=this.map._getMap().queryRenderedFeatures(i,{layers:n,filter:r});return this.map.sources._mapFeaturesToShapes(c)},Dh.prototype.remove=function(e,t){if(void 0===t&&(t=!0),Array.isArray(e))for(var r=0,i=e;r<i.length;r++){var n=i[r];this._removeLayer(n,t)}else this._removeLayer(e,t)},Dh.prototype._removeLayer=function(e,t){var r=e instanceof bo?e.getId():e;if(!this.layersById.has(r))throw new Error("The layer '"+r+"' has not been added to the map and cannot be removed.");var i=this.layers.findIndex((function(e){return e.getId()===r})),n=this.layers[i];t&&this._removeMapboxLayers(n),this.layersById.delete(r),this.layers.splice(i,1),this.map.events._disableLayerEvents(n),n.onRemove()},Dh);function Dh(e){this.layersById=new Nr,this.layers=[],this.map=e}var Bh=(Fh.prototype.add=function(e){for(var t=0,r=e=Array.isArray(e)?e:[e];t<r.length;t++){var i=r[t];this.popups.has(i)||(this.popups.add(i),i.attach(this.map))}},Fh.prototype.clear=function(){var e=this;this.popups.forEach((function(t){e.popups.delete(t),t.remove()}))},Fh.prototype.remove=function(e){for(var t=0,r=e=Array.isArray(e)?e:[e];t<r.length;t++){var i=r[t];this.popups.has(i)&&(this.popups.delete(i),i.remove())}},Fh.prototype.getPopups=function(){return Array.from(this.popups)},Fh.prototype._getCollectionDiv=function(){var e=this.map.getMapContainer().querySelector("."+Fh.Css.collection);return e||((e=document.createElement("div")).classList.add(Fh.Css.collection),e.setAttribute("aria-label","Map Information"),this.map.getMapContainer().appendChild(e)),e},Fh.prototype._addDraggedPopup=function(e){0===this.draggedPopups.size&&(this.map.getMapContainer().addEventListener("mousemove",this._onDrag),this.map.getMapContainer().addEventListener("touchmove",this._onDrag),this.map.getMapContainer().addEventListener("mouseup",this._onUp),this.map.getMapContainer().addEventListener("touchend",this._onUp)),this.draggedPopups.add(e)},Fh.Css={collection:"popup-collection-container"},Fh);function Fh(e){var t=this;this._onDrag=function(e){var r,i;"mousemove"===e.type?(r=(e=e).clientX,i=e.clientY):"touchmove"===e.type&&(r=(e=e).touches[0].clientX,i=e.touches[0].clientY),t.draggedPopups.forEach((function(e){e._dragToPixel([r,i])}))},this._onUp=function(){t.map.getMapContainer().removeEventListener("mousemove",t._onDrag),t.map.getMapContainer().removeEventListener("touchmove",t._onDrag),t.map.getMapContainer().removeEventListener("mouseup",t._onUp),t.map.getMapContainer().removeEventListener("touchend",t._onUp),t.draggedPopups.forEach((function(e){t.draggedPopups.delete(e),e._onUp()}))},this.map=e,this.popups=new Set,this.draggedPopups=new Set}var qh=(Uh.prototype.add=function(e,t){if(void 0===t&&(t=!0),Array.isArray(e))for(var r=0,i=e;r<i.length;r++){var n=i[r];this._addSource(n,t)}else this._addSource(e,t)},Uh.prototype.getRenderedShapes=function(e,t,r){var i="string"==typeof e?e:e.getId(),n=this.map._getMap().querySourceFeatures(i,{sourceLayer:r,filter:t});return this.map.sources._mapFeaturesToShapes(n,!0,this.sources.get(i))},Uh.prototype._buildSources=function(){var e={};return this.sources.forEach((function(t){e[t.getId()]=t._buildSource()})),e},Uh.prototype.clear=function(){var e=this;this.sources.forEach((function(t){e.remove(t)}))},Uh.prototype.getById=function(e){return this.sources.get(e)},Uh.prototype.getSources=function(){return Array.from(this.sources.values())},Uh.prototype.isSourceLoaded=function(e){var t=e instanceof ao?e.getId():e;return this.map._getMap().isSourceLoaded(t)},Uh.prototype.remove=function(e,t){if(void 0===t&&(t=!0),Array.isArray(e))for(var r=0,i=e;r<i.length;r++){var n=i[r];this._removeSource(n,t)}else this._removeSource(e,t)},Uh.prototype._removeSource=function(e,t){var r=e instanceof ao?e.getId():e;if(this.sources.has(r)){if(this.map._getMap().getSource(r)&&t&&this.map._getMap().removeSource(r),this.map._getMap().getSource(r)&&t)throw new Error("One or more layers have a dependency on the source '"+r+"'");return this.sources.get(r)._setMap(null),void this.sources.delete(r)}throw new Error("'"+r+"' is not added to the map")},Uh.prototype._addSource=function(e,t){if(this.sources.has(e.getId())){if(t)throw new Error("'"+e.getId()+"' is already added to the map");this.sources.get(e.getId())._setMap(null),this.sources.delete(e.getId())}if(t){if(!this.map._isReady())throw new Error("The source '"+e.getId()+"' could not be added to the map because the map is not ready. Please use a ready event listener to guarantee the map is ready before adding a source to it.");this.map._getMap().addSource(e.getId(),e._buildSource())}this.sources.set(e.getId(),e),e._setMap(this.map)},Uh.prototype._mapFeaturesToShapes=function(e,t,r){for(var i=[],n=0,o=e;n<o.length;n++){var a=o[n];if((r||"string"==typeof a.source)&&"string"==typeof a.properties[Dn._shapeIdPropName]){var s=r||this.sources.get(a.source);if(s instanceof uo){var l=s.getShapeById(a.properties[Dn._shapeIdPropName]);if(l instanceof Dn){i.push(l);continue}}}t||i.push(a)}return i},Uh);function Uh(e){this.map=e,this.sources=new Nr}var jh,Vh=(d(Gh,jh=g),Gh);function Gh(){var e=null!==jh&&jh.apply(this,arguments)||this;return e.duration=1e3,e.type="jump",e}var Hh,Zh=(d(Wh,Hh=g),Wh);function Wh(){var e=null!==Hh&&Hh.apply(this,arguments)||this;return e.bottom=0,e.left=0,e.right=0,e.top=0,e}var Kh,Xh=(d(Yh,Kh=g),Yh.prototype.merge=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var r=0,i=e;r<i.length;r++){var n=i[r];n&&"number"==typeof n.padding&&(n.padding={top:n.padding,bottom:n.padding,left:n.padding,right:n.padding})}return Kh.prototype.merge.apply(this,e)},Yh);function Yh(){var e=null!==Kh&&Kh.apply(this,arguments)||this;return e.bounds=[-180,-89,180,90],e.maxBounds=void 0,e.maxZoom=20,e.offset=new bi(0,0),e.padding=new Zh,e}var Jh,$h=(d(Qh,Jh=g),Qh);function Qh(){var e=null!==Jh&&Jh.apply(this,arguments)||this;return e.zoom=1,e.center=new En(0,0),e.centerOffset=new bi(0,0),e.bearing=0,e.pitch=0,e.minZoom=1,e.maxZoom=20,e.maxBounds=void 0,e}var ed,td=(d(rd,ed=g),rd);function rd(){var e=null!==ed&&ed.apply(this,arguments)||this;return e.name=void 0,e.before=void 0,e.minZoom=1,e.maxZoom=20,e.overwrite=!1,e.defer=!1,e.opacity=1,e}var id,nd=(d(od,id=td),od);function od(){var e=null!==id&&id.apply(this,arguments)||this;return e.color="rgba(0,0,0,.5)",e.outlineColor="#000",e.radius=1,e.outlineWidth=5,e.name="default-circles",e}var ad,sd=(d(ld,ad=td),ld);function ld(){var e=null!==ad&&ad.apply(this,arguments)||this;return e.cap="butt",e.join="miter",e.name="default-linestrings",e.color="#000",e.width=1,e}var ud,cd=(d(pd,ud=td),pd);function pd(){var e=null!==ud&&ud.apply(this,arguments)||this;return e.iconSize=1,e.fontSize=14,e.fontColor="#000",e.textFont="SegoeUi-Regular",e.cluster=!0,e.clusterIcon=void 0,e.textOffset=[0,0],e.name="default-pins",e.icon="pin-darkblue",e.title="",e}var hd,dd=(d(md,hd=td),md);function md(){var e=null!==hd&&hd.apply(this,arguments)||this;return e.color="rgba(0,0,0,.5)",e.outlineColor="#000",e.name="default-polygons",e}var fd,yd=(d(gd,fd=td),gd);function gd(){var e=null!==fd&&fd.apply(this,arguments)||this;return e.name="default-raster",e}var vd,_d=(d(bd,vd=g),bd);function bd(){var e=null!==vd&&vd.apply(this,arguments)||this;return e.anchor="map",e.color="#FFFFFF",e.intensity=.5,e.position=[1.15,210,30],e}var xd,wd=(d(Sd,xd=g),Sd.prototype.merge=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var r=0,i=e;r<i.length;r++){var n=i[r];n&&(n.hasOwnProperty("view")?n.userRegion=n.view:n.hasOwnProperty("userRegion")&&(n.view=n.userRegion),"string"==typeof n.language&&(n.language=ys.getCode(n.language)))}return xd.prototype.merge.apply(this,e)},Sd);function Sd(){var e=null!==xd&&xd.apply(this,arguments)||this;return e.autoResize=!0,e.language=Ls(),e.light=new _d,e.preserveDrawingBuffer=!1,e.renderWorldCopies=!0,e.showBuildingModels=!1,e.showFeedbackLink=!0,e.showLogo=!0,e.showTileBoundaries=!1,e.style="road",e.view=Fs(),e.userRegion=e.view,e}var Td,Cd=(d(Ed,Td=g),Ed);function Ed(){var e=null!==Td&&Td.apply(this,arguments)||this;return e.flow="none",e.incidents=!1,e}var Id,Pd=(d(Rd,Id=g),Rd.prototype.merge=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];for(var i=0,n=e;i<n.length;i++){var o=n[i];o&&(o.authOptions?"string"==typeof o.authOptions.subscriptionKey&&(o.subscriptionKey=o["subscription-key"]=o.authOptions.subscriptionKey):"string"==typeof o.subscriptionKey?(o["subscription-key"]=o.subscriptionKey,o.authOptions={authType:t.AuthenticationType.subscriptionKey,subscriptionKey:o.subscriptionKey}):"string"==typeof o["subscription-key"]&&(o.subscriptionKey=o["subscription-key"],o.authOptions={authType:t.AuthenticationType.subscriptionKey,subscriptionKey:o["subscription-key"]}),"string"==typeof o.sessionId?o["session-id"]=o.sessionId:"string"==typeof o["session-id"]&&(o.sessionId=o["session-id"]),"boolean"==typeof o.disableTelemetry?o["disable-telemetry"]=o.disableTelemetry:"boolean"==typeof o["disable-telemetry"]&&(o.disableTelemetry=o["disable-telemetry"]),"boolean"==typeof o.enableAccessibility?o["enable-accessibility"]=o.enableAccessibility:"boolean"==typeof o["enable-accessibility"]&&(o.enableAccessibility=o["enable-accessibility"]))}var a=Id.prototype.merge.apply(this,e);return a.authOptions.authType!==t.AuthenticationType.subscriptionKey&&(a["subscription-key"]=a.subscriptionKey=void 0),a},Rd._cloneCustomizer=function(e){if("object"==typeof e)return Object.assign({},e)},Rd);function Rd(){var e=null!==Id&&Id.apply(this,arguments)||this;return e.authOptions=ks(),e.disableTelemetry=!1,e["disable-telemetry"]=e.disableTelemetry,e.domain=Os(),e.enableAccessibility=!0,e["enable-accessibility"]=e.enableAccessibility,e.refreshExpiredTiles=!0,e.subscriptionKey=Bs(),e["subscription-key"]=e.subscriptionKey,e.sessionId=Ds(),e["session-id"]=e.sessionId,e.transformRequest=void 0,e}var Nd=function(){this.version=8,this.sprite="",this.glyphs="",this.light={},this.sources={},this.layers=[]},Ad=(zd.prototype.build=function(e){var t=new Nd;if(null!=this.glyphs&&(t.glyphs=this.glyphs),null!=this.sprite&&(t.sprite=this.sprite),null!=e.light&&Object.assign(t.light,e.light),null!=this.map.sources&&(t.sources=this.map.sources._buildSources()),null!=this.map.layers)for(var r=0,i=this.map.layers.getLayers();r<i.length;r++){var n=i[r];t.layers=t.layers.concat(n._buildLayers()),n instanceof Go&&(t.sources[n._getSourceId()]=n._buildSource())}return t},zd.prototype.setGlyphs=function(e){this.glyphs=e},zd.prototype.setSprite=function(e){this.sprite=e},zd);function zd(e){this.sprite="",this.glyphs="{fontstack}/{range}",this.map=e}var Md,kd=(d(Od,Md=bo),Od.prototype._buildLayers=function(){return this.layers},Od.prototype._getLayerIds=function(){return this.layers.map((function(e){return e.id}))},Od.prototype._getSourceIds=function(){for(var e=new Set,t=0,r=this.layers;t<r.length;t++){var i=r[t];"string"==typeof i.source?e.add(i.source):i.source&&e.add(i.id)}return e},Od);function Od(e,t){var r=Md.call(this,t)||this;return r.layers=e,r}var Ld,Dd=(d(Bd,Ld=ao),Bd.prototype._buildSource=function(){return this.source},Bd.prototype._modifySource=function(e,t){var r=e.tiles.map((function(e){return"string"==typeof e?e:new w({domain:c,path:e.path,queryParams:m(m({},t),e.queryParams)}).toString()}));return e.tiles=r,e},Bd);function Bd(e,t,r){var i=Ld.call(this,e)||this;return i.source=i._modifySource(t,r),i}var Fd=(qd.prototype.initialize=function(){var e=this;return this.initPromise||(this.initPromise=this.request(l,"styles/definitions/2019-10-16.json").then((function(t){e.definitions=t})).catch((function(e){throw new Error("Failed to retrieve the style definitions: "+e)}))),this.initPromise},qd.prototype.getStyleComponents=function(e){return f(this,void 0,void 0,(function(){var t,r,i,n=this;return y(this,(function(o){return t=new Set,r=this.lookUp(e),i=r.layerGroups.map((function(r){return f(n,void 0,void 0,(function(){var i,n,o,a,s,l,u;return y(this,(function(c){switch(c.label){case 0:return i=r.layerPath,n=r.name,o={language:e.language},e.view&&(o.view=encodeURIComponent(e.view)),[4,this.buildComponent(n,i,o,t)];case 1:for(a=c.sent(),s=0,l=a.layer.layers;s<l.length;s++)"fill-extrusion"===(u=l[s]).type&&(u.layout=u.layout||{},u.layout.visibility=e.showBuildingModels?"visible":"none");return[2,a]}}))}))})),[2,Promise.all(i)]}))}))},qd.prototype.getFlowComponent=function(e,t){return f(this,void 0,void 0,(function(){var r;return y(this,(function(i){return r=this.getFlowPath(e,t),[2,this.buildComponent("flow",r)]}))}))},qd.prototype.getCopyrightCaption=function(e){var t=this.lookUp(e).copyright.join(" ");return e.showLogo||(t+=" ©2019 Microsoft"),t},qd.prototype.getSprite=function(e){var t=this.lookUp(e);return new w({domain:this.definitions.domain,path:t.spritePath}).toString()},qd.prototype.getGlyphs=function(e){var t=this.lookUp(e);return new w({domain:this.definitions.domain,path:t.glyphsPath}).toString()},qd.prototype.getFlowPath=function(e,t){return this.lookUp(e).flowPaths[t.flow]},qd.prototype.getTheme=function(e){return this.lookUp(e).theme.toLowerCase()||"light"},qd.prototype.getDef=function(){return this.definitions},qd.prototype.lookUp=function(e){for(var t,r=e.style||this.definitions.defaultStyle,i=0,n=this.definitions.styles;i<n.length;i++){var o=n[i];if(o.name===r)return o;o.name===this.definitions.defaultStyle&&(t=o)}return t},qd.prototype.request=function(e,t){return f(this,void 0,void 0,(function(){return y(this,(function(r){return[2,new w({domain:e,path:t}).get()]}))}))},qd.prototype.buildComponent=function(e,t,r,i){return f(this,void 0,void 0,(function(){return y(this,(function(n){return[2,this.request(this.definitions.domain,t).then((function(t){for(var n=new kd(t.layers,e),o=[],a=0,s=t.sources;a<s.length;a++){var l=s[a],u=l.name;if(i){if(i.has(u))continue;i.add(u)}o.push(new Dd(u,l,r))}return{layer:n,sources:o}}))]}))}))},qd);function qd(){}var Ud=(jd.prototype.getCanvas=function(){return this.map.getCanvas()},jd.prototype.getCanvasContainer=function(){return this.map.getCanvasContainer()},jd.prototype.getMapContainer=function(){return this.map.getContainer()},jd.prototype.getServiceOptions=function(){return ro(this.serviceOptions,Pd._cloneCustomizer)},jd.prototype.setServiceOptions=function(e){this.serviceOptions=(new Pd).merge(this.serviceOptions,e),this.serviceOptions["enable-accessibility"]?this.accessibleMapDelegate.addToMap():this.accessibleMapDelegate.removeFromMap()},jd.prototype.setCamera=function(e,t){var r,i;if(void 0===t&&(t=!1),"padding"in e||"offset"in e||"bounds"in e){var n=(new Xh).merge({maxZoom:this.getCamera().maxZoom},e),o=this._generateSafeBounds(n.bounds);if(!(r=this.map.cameraForBounds(o,{padding:n.padding,offset:n.offset,maxZoom:n.maxZoom})))throw new Error("The map cannot be fit to the current canvas with the given CameraBoundsOptions.");this.map.setMaxZoom(n.maxZoom),i=this._generateSafeBounds(n.maxBounds)}else{var a=(new $h).merge(this.getCamera(),e);if(a.centerOffset&&2<=a.centerOffset.length){var s=a.centerOffset,l=hn([a.center],a.zoom);l[0][0]+=s[0],l[0][1]+=s[1],a.center=pn(l,a.zoom)[0]}r={center:a.center,zoom:a.zoom,bearing:a.bearing,pitch:a.pitch,around:void 0},this.map.setMinZoom(a.minZoom),this.map.setMaxZoom(a.maxZoom),i=this._generateSafeBounds(a.maxBounds)}i?this.map.setMaxBounds(i):this.map.setMaxBounds(null);var u=(new Vh).merge(e),c={duration:u.duration,easing:function(e){return e},offset:[0,0],animate:!0},p={fromControl:t};"jump"===u.type?this.map.jumpTo(r,p):"ease"===u.type?this.map.easeTo(m(m({},r),c),p):"fly"===u.type&&this.map.flyTo(m(m({},r),c),p)},jd.prototype.setCameraBounds=function(e){this.setCamera(e)},jd.prototype.getCamera=function(){var e=this.map.getBounds().getSouthWest().toArray(),t=this.map.getBounds().getNorthEast().toArray();return{zoom:this.map.getZoom(),center:this.map.getCenter().toArray(),bearing:this.map.getBearing(),pitch:this.map.getPitch(),bounds:new qn(e,t),minZoom:this.map.getMinZoom(),maxZoom:this.map.getMaxZoom()}},jd.prototype.setStyle=function(e){delete e.preserveDrawingBuffer;var r=(new wd).merge(this.styleOptions,e);r.autoResize!==this.styleOptions.autoResize&&this._setAutoResize(r.autoResize),r.language!==this.styleOptions.language&&(this.localizedStringsPromise=ys.getStrings(r.language)),r.renderWorldCopies!==this.styleOptions.renderWorldCopies&&this.map.setRenderWorldCopies(r.renderWorldCopies),r.showFeedbackLink!==this.styleOptions.showFeedbackLink&&this.copyrightControl.setOptions({showFeedbackLink:r.showFeedbackLink}),r.showLogo&&!this.logoControl?(this.logoControl=new Ap,this.controls.add(this.logoControl,{position:t.ControlPosition.NonFixed})):!r.showLogo&&this.logoControl&&(this.controls.remove(this.logoControl),delete this.logoControl),r.showTileBoundaries!==this.styleOptions.showTileBoundaries&&(this.map.showTileBoundaries=r.showTileBoundaries),this._setStyleComponents(r),this.styleOptions=r},jd.prototype.getStyle=function(){return Rr(this.styleOptions)},jd.prototype.addIcon=function(e,t){this.imageSprite.add(e,t)},jd.prototype.addPins=function(e,t){var r,i=(new cd).merge(t),n=this.layers.getLayerById(i.name),o=!1;if(n||(o=!0,n=new Sa(i.name+"-source",i.name,{source:i.name+"-source",minZoom:i.minZoom,maxZoom:i.maxZoom,iconOptions:{anchor:"center",size:i.iconSize,image:["case",["has","icon"],["get","icon"],i.icon],ignorePlacement:!i.cluster,opacity:i.opacity},textOptions:{anchor:"center",textField:["case",["has","point_count"],["to-string",["get","point_count"]],["has","title"],["to-string",["get","title"]],i.title],font:["case",["has","point_count"],["literal",["StandardFontCondensed-Bold"]],["literal",[i.textFont]]],size:["case",["has","point_count"],20,i.fontSize],ignorePlacement:!i.cluster,opacity:i.opacity,offset:["case",["has","point_count"],["literal",[.5,-.45]],["literal",[i.textOffset[0]/16,i.textOffset[1]/16]]],color:i.fontColor}})),!(n instanceof Sa))throw new Error("A layer with name '"+i.name+"' already exists but it is not a SymbolLayer.A SymbolLayer should be used for rendering pins.");var a=n.getSource();"string"==typeof a?(r=a,a=this.sources.getById(r)):r=a.getId();var s=!1;if(a||(s=!0,a=new uo(r,{cluster:i.cluster})),!(a instanceof uo))throw new Error("The source with name '"+r+"' already exists but it is not a DataSource.New data can only be added to a DataSource.");s&&this.sources.add(a),o&&this.layers.add(n,i.before);var l=new jn(e);i.defer?(i.overwrite&&a._clearNoUpdate(),a._addNoUpdate(l)):i.overwrite?a.setShapes(l):a.add(l)},jd.prototype.addCircles=function(e,t){var r,i=(new nd).merge(t),n=this.layers.getLayerById(i.name),o=!1;if(n||(o=!0,n=new Ro(i.name+"-source",i.name,{source:i.name+"-source",minZoom:i.minZoom,maxZoom:i.maxZoom,opacity:i.opacity,radius:["case",["has","radius"],["get","radius"],i.radius],color:["case",["has","color"],["get","color"],i.color],strokeColor:["case",["has","outlineColor"],["get","outlineColor"],i.outlineColor],strokeWidth:["case",["has","outlineWidth"],["get","outlineWidth"],i.outlineWidth]})),!(n instanceof Ro))throw new Error("A layer with name '"+i.name+"' already exists but it is not a BubbleLayer.A BubbleLayer should be used for rendering circles.");var a=n.getSource();"string"==typeof a?(r=a,a=this.sources.getById(r)):r=a.getId();var s=!1;if(a||(s=!0,a=new uo(r)),!(a instanceof uo))throw new Error("The source with name '"+r+"' already exists but it is not a DataSource.New data can only be added to a DataSource.");s&&this.sources.add(a),o&&this.layers.add(n,i.before);var l=new jn(e);i.defer?(i.overwrite&&a._clearNoUpdate(),a._addNoUpdate(l)):i.overwrite?a.setShapes(l):a.add(l)},jd.prototype.addLinestrings=function(e,t){var r,i=(new sd).merge(t),n=this.layers.getLayerById(i.name),o=!1;if(n||(o=!0,n=new Qo(i.name+"-source",i.name,{source:i.name+"-source",minZoom:i.minZoom,maxZoom:i.maxZoom,lineCap:i.cap,lineJoin:i.join,strokeOpacity:i.opacity,strokeColor:["case",["has","color"],["get","color"],i.color],strokeWidth:["case",["has","width"],["get","width"],i.width]})),!(n instanceof Qo))throw new Error("A layer with name '"+i.name+"' already exists but it is not a LineLayer.A LineLayer should be used for rendering linestrings.");var a=n.getSource();"string"==typeof a?(r=a,a=this.sources.getById(r)):r=a.getId();var s=!1;if(a||(s=!0,a=new uo(r)),!(a instanceof uo))throw new Error("The source with name '"+r+"' already exists but it is not a DataSource.New data can only be added to a DataSource.");s&&this.sources.add(a),o&&this.layers.add(n,i.before);var l=new jn(e);i.defer?(i.overwrite&&a._clearNoUpdate(),a._addNoUpdate(l)):i.overwrite?a.setShapes(l):a.add(l)},jd.prototype.addPolygons=function(e,t){var r,i=(new dd).merge(t),n=this.layers.getLayerById(i.name),o=!1;if(n||(o=!0,n=new pa(i.name+"-source",i.name,{source:i.name+"-source",minZoom:i.minZoom,maxZoom:i.maxZoom,fillOpacity:i.opacity,fillColor:["case",["has","color"],["get","color"],i.color]})),!(n instanceof pa))throw new Error("A layer with name '"+i.name+"' already exists but it is not a PolygonLayer.A PolygonLayer should be used for rendering linestrings.");var a=n.getSource();"string"==typeof a?(r=a,a=this.sources.getById(r)):r=a.getId();var s=!1;if(a||(s=!0,a=new uo(r)),!(a instanceof uo))throw new Error("The source with name '"+r+"' already exists but it is not a DataSource.New data can only be added to a DataSource.");s&&this.sources.add(a),o&&this.layers.add(n,i.before);var l=new jn(e);i.defer?(i.overwrite&&a._clearNoUpdate(),a._addNoUpdate(l)):i.overwrite?a.setShapes(l):a.add(l)},jd.prototype.addRaster=function(e,t){var r,i=(new yd).merge(t),n=this.layers.getLayerById(i.name),o=!1;if(n||(o=!0,n=new Ra({maxZoom:i.maxZoom,minZoom:i.minZoom,opacity:i.opacity,tileSize:256,tileUrl:"{subdomain}"},i.name)),!(n instanceof Ra))throw new Error("A layer with name '"+i.name+"' already exists but it is not a TileLayer.A TileLayer should be used for rendering raster images.");if("{subdomain}"!==n.getOptions().tileUrl)throw new Error("A TileLayer with name '"+i.name+"' already exists but was configured for a single tile url [default for new TileLayer(...)].");(r=!i.overwrite&&n.getOptions().subdomains||[]).push.apply(r,e),n._setOptionsNoUpdate({subdomains:r}),i.defer?o&&this.layers.add(n,i.before,!1):this.layers.add(n,i.before)},jd.prototype.getLayers=function(){return this.layers.getLayers().map((function(e){return e.getId()}))},jd.prototype.removeLayers=function(e){for(var t=0,r=e;t<r.length;t++){var i=r[t];if(this.layers.getLayerById(i)){this.layers.remove(i);var n=i+"-source";this.sources.getById(n)&&this.sources.remove(n)}}},jd.prototype.addHtml=function(e,t){e.id||(e.id="marker_"+yi());var r=new Ja({htmlContent:e});return this.markers.add(r,t),e.id},jd.prototype.removeHtml=function(e){this.markers.remove(e)},jd.prototype.addEventListener=function(e,t,r){this.events._addLegacy(e,t,r)},jd.prototype.removeEventListener=function(e,t,r){this.events._removeLegacy(e,t,r)},jd.prototype.setUserInteraction=function(e){this.userInteractionDelegate.setOptions(e)},jd.prototype.getUserInteraction=function(){return this.userInteractionDelegate.getOptions()},jd.prototype.addControl=function(e,t){this.controls.add(e,t)},jd.prototype.removeControl=function(e){this.controls.remove(e)},jd.prototype.setTraffic=function(e){var t=this.trafficOptions.incidents,r=this.trafficOptions.flow;if(this.trafficOptions=(new Cd).merge(this.trafficOptions,e),this.trafficOptions.incidents?t||this.incidentDelegate.addToMap():this.incidentDelegate.removeFromMap(),this.trafficOptions.flow&&"none"!==this.trafficOptions.flow)try{this.flowDelegate.addToMap()}catch(e){throw this.trafficOptions.flow=r,e}else this.flowDelegate.removeFromMap()},jd.prototype.getTraffic=function(){return Rr(this.trafficOptions)},jd.prototype.remove=function(){this.dispose()},jd.prototype.clear=function(){this.popups.clear(),this.layers.clear(),this.sources.clear(),this.markers.clear()},jd.prototype.dispose=function(){for(this.clear(),this.map.remove(),this.removed=!0;this.getMapContainer().firstChild;){var e=this.getMapContainer().firstChild;this.getMapContainer().removeChild(e)}},jd.prototype.resize=function(e,t,r){if("number"!=typeof e&&"string"!=typeof e||"number"!=typeof t&&"string"!=typeof t)r=e;else{var i=e;this.getMapContainer().style.height="number"==typeof i?i+"px":i,this.getMapContainer().style.width="number"==typeof t?t+"px":t}var n=this.getMapContainer().style.overflow;this.getMapContainer().style.overflow="hidden",this.map.resize(r),this.getMapContainer().style.overflow=n},jd.prototype.pixelsToPositions=function(e){for(var t=[],r=0,i=e;r<i.length;r++){var n=i[r],o=this.map.unproject(n);t.push(new En(o.lng,o.lat))}return t},jd.prototype.positionsToPixels=function(e){for(var t=[],r=0,i=e;r<i.length;r++){var n=i[r],o=this.map.project(n);t.push(new bi(o.x,o.y))}return t},jd.prototype.areTilesLoaded=function(){return this.map.areTilesLoaded()},jd.prototype.stop=function(){this.map.stop()},jd.prototype._getMap=function(){return this.map},jd.prototype._rebuildStyle=function(){this.map.setStyle(this.styleBuilder.build(this.styleOptions)),this.imageSprite._restoreImages()},jd.prototype._isLoaded=function(){return this.loaded},jd.prototype._isReady=function(){return this.ready},jd.prototype._getLocalizedStrings=function(){return this.localizedStringsPromise},jd.prototype._sendRequest=function(e,t,r){var i;return"function"==typeof this.serviceOptions.transformRequest&&(i=this.serviceOptions.transformRequest(e,t)),i?fetch(i.url||e,{credentials:i.credentials,headers:m(m({},r),i.headers),method:"GET",mode:"cors"}):fetch(e,{headers:r,method:"GET",mode:"cors"})},jd.prototype._setAutoResize=function(e){e?window.addEventListener("resize",this._windowResizeCallback):window.removeEventListener("resize",this._windowResizeCallback)},jd.prototype._setStyleComponents=function(e){var t=this;this.styles.getStyleComponents(e).then((function(r){if(!t.removed){t.copyrightControl.setOptions({copyrightMessage:t.styles.getCopyrightCaption(e)}),t.styleBuilder.setGlyphs(t.styles.getGlyphs(e)),t.styleBuilder.setSprite(t.styles.getSprite(e));for(var i=new Set,n=new Set,o=0,a=r;o<a.length;o++){var s=a[o];i.add(s.layer.getId());for(var l=0,u=s.sources;l<u.length;l++){var c=u[l];n.add(c.getId())}}t.styleLayerIds.forEach((function(e){i.has(e)||(t.layers.getLayerById(e)&&t.layers.remove(e,!1),t.styleLayerIds.delete(e))}));for(var p=function(e){var i=r[e].layer;if(t.styleLayerIds.add(i.getId()),t.layers.getLayerById(i.getId()))t.layers.add(i,void 0,!1);else if(0===e)t.layers.add(i,t.layers.getLayers()[0],!1);else{var n=r[e-1].layer,o=t.layers.getLayers(),a=o.findIndex((function(e){return e.getId()===n.getId()}));t.layers.add(i,o[a+1],!1)}},h=0;h<r.length;h++)p(h);var d=t.layers._getSourceIds();t.styleSourceIds.forEach((function(e){d.has(e)||n.has(e)||(t.sources.getById(e)&&t.sources.remove(e,!1),t.styleSourceIds.delete(e))}));for(var m=0,f=r;m<f.length;m++){s=f[m],t.sources.add(s.sources,!1);for(var y=0,g=s.sources;y<g.length;y++)c=g[y],t.styleSourceIds.add(c.getId())}t._rebuildStyle()}}))},jd.prototype._updateGlobalDefaults=function(e){e&&(e.authOptions&&!Ks()&&Us(e.authOptions),e.domain&&!Xs()&&js(e.domain),!e.subscriptionKey&&!e["subscription-key"]||Ks()||Hs(e.subscriptionKey||e["subscription-key"]),!e.sessionId&&!e["session-id"]||Js()||Gs(e.sessionId||e["session-id"]),e.language&&!Ys()&&Vs(e.language),!e.userRegion&&!e.view||$s()||Zs(e.userRegion||e.view))},jd.prototype._generateSafeBounds=function(e){if(e){var t=qn.getSouth(e),r=qn.getWest(e),i=qn.getNorth(e),n=qn.getEast(e);if(isNaN(t)||isNaN(r)||isNaN(i)||isNaN(n))throw new Error("The bounds specified are invalid: ["+e+"]");for(;n<r;)n+=360;return new qn([r,t,n,i])}return e},jd.prototype._detectHighContrast=function(){var e,t;switch(al.getHighContrastMode()){case"invert":e=jd.Css.hcLight,t="high_contrast_dark";break;case"light":e=jd.Css.hcLight,t="grayscale_light";break;case"dark":e=jd.Css.hcDark,t="high_contrast_dark"}e&&this.map.getContainer().classList.add(e),t&&"road"===this.styleOptions.style&&(this.styleOptions.style=t)},jd.Css={canvasContainer:"atlas-map-canvas-container",canvas:"atlas-map-canvas",container:"atlas-map",hcDark:"high-contrast-dark",hcLight:"high-contrast-light"},jd);function jd(e,r){var i=this;this.styleLayerIds=new Set,this.styleSourceIds=new Set,this.removed=!1,this.loaded=!1,this.ready=!1,this._windowResizeCallback=function(){return i.resize()};var o=!0;this._updateGlobalDefaults(r),this.serviceOptions=(new Pd).merge(r),this.styleOptions=(new wd).merge(r),this.trafficOptions=new Cd,this.styles=new Fd,this.insights=new Rp(this.serviceOptions),this.serviceOptions.authOptions.subscriptionKey&&(this.serviceOptions.authOptions.subscriptionKey=encodeURIComponent(this.serviceOptions.authOptions.subscriptionKey));var a,s={attributionControl:!1,container:e,preserveDrawingBuffer:this.styleOptions.preserveDrawingBuffer,refreshExpiredTiles:this.serviceOptions.refreshExpiredTiles,renderWorldCopies:this.styleOptions.renderWorldCopies,trackResize:!1,transformRequest:function(e,t){var r={url:e};if("Tile"===t&&e.includes(c)){if(i.insights&&i.insights.trackEvent({name:"TileLoad"}),w.protoRegEx.test(i.serviceOptions.domain)){var n=e.indexOf(c);r.url=i.serviceOptions.domain+e.substring(n+c.length)}else r.url=e.replace(c,i.serviceOptions.domain);i.authentication.signRequest(r)}return i.serviceOptions.transformRequest&&ps(r,i.serviceOptions.transformRequest(r.url,t)),r}};a=this.serviceOptions.authOptions.clientId?this.serviceOptions.authOptions.clientId:this.serviceOptions.authOptions.subscriptionKey?this.serviceOptions.authOptions.subscriptionKey.replace(/.(?=.{3,}$)/g,"*"):"invalid-setting",this.insights&&this.insights.setAuthenticatedUserContext(this.serviceOptions.sessionId,a);try{var l=new n.Map(s);this.map=l,this.authentication=new Th(this),this.controls=new Eh(this),this.events=new Nh(this),this.imageSprite=new kh(this),this.layers=new Lh(this),this.markers=new zh(this),this.sources=new qh(this),this.popups=new Bh(this),this.styleBuilder=new Ad(this),this.map.getContainer().classList.add(jd.Css.container),this.map.getCanvasContainer().classList.add(jd.Css.canvasContainer),this.map.getCanvas().classList.add(jd.Css.canvas),this._detectHighContrast(),this.copyrightControl=new Dp({showFeedbackLink:this.styleOptions.showFeedbackLink}),this.controls.add(this.copyrightControl,{position:t.ControlPosition.NonFixed}),this.styleOptions.showLogo&&(this.logoControl=new Ap,this.controls.add(this.logoControl,{position:t.ControlPosition.NonFixed}));var u=this.authentication.initialize();if(this.removed)return;var p=function(){i.loaded=!0,i.map.off("load",p)};this.map.on("load",p);var h=function(){i.ready=!0,i.map.off("styledata",h);var e={map:i,type:"ready"};i.events.invoke("ready",e)};this.map.on("styledata",h),this._setAutoResize(this.styleOptions.autoResize),this.map.showTileBoundaries=this.styleOptions.showTileBoundaries,this.localizedStringsPromise=ys.getStrings(this.styleOptions.language);var d=this.styles.initialize();Promise.all([u,d]).then((function(){if(!i.removed){if(!i.authentication.getToken())throw new Error("AuthenticationManager finished initializing, but no token is available");i.serviceOptions["enable-accessibility"]&&i.accessibleMapDelegate.addToMap(),i._setStyleComponents(i.styleOptions)}})).catch((function(e){var t=e instanceof Error?e:new Error(e);i.insights&&i.insights.trackException({error:t});var r={map:i,type:"error",error:t};i.events.invoke("error",r)})),this.setCamera(m(m({},r),{type:"jump",duration:0})),this.incidentDelegate=new lh(this),this.flowDelegate=new Xp(this),this.accessibleMapDelegate=new Kp(this),this.userInteractionDelegate=new gh(this,r),this.userInteractionDelegate.addToMap()}catch(e){throw o=!1,this.insights&&this.insights.trackException({error:e instanceof Error?e:new Error(e)}),e}finally{this.insights&&(this.insights.trackEvent({name:"MapLoad"},{success:o,supported:qs(!1),supportedWithPerformance:qs(!0)}),this.insights.flush())}}var Vd=(Gd.applyTemplate=function(e,t){var r=this,i=document.createElement("div");if(i.classList.add(Gd.Css.template),e){"boolean"!=typeof(t=t||{}).singleDescription&&(t.singleDescription=!0),t.sandboxContent="boolean"!=typeof t.sandboxContent||t.sandboxContent,t.title&&"string"==typeof t.content&&(t.content.includes("{title}")||t.content.includes("{name}"))||(e.title?t.title="{title}":e.name&&(t.title="{name}")),"boolean"!=typeof t.detectHyperlinks&&(t.detectHyperlinks=!0),"boolean"!=typeof t.parsePropertyPaths&&(t.parsePropertyPaths=!0),t.textColor&&(i.style.color=t.textColor),t.fillColor&&(i.style.backgroundColor=t.fillColor),t.title&&((a=this._applyStringTemplate(e,t.title,t)).innerText=a.textContent||a.innerText||"",this._appendChild(i,a,Gd.Css.title));var n=document.createElement("div");if(n.classList.add(Gd.Css.content),Array.isArray(t.content))0<t.content.length&&t.content[0].propertyPath?this._appendChild(n,this._generateContent(e,t.content,t),Gd.Css.item):t.content.forEach((function(i){r._appendChild(n,r._generateContent(e,i,t),Gd.Css.item)}));else{var o=0;e.description&&Object.keys(e).forEach((function(t){r._ignoreProperty(t,e[t])||o++}));var a=void 0;1===o||t.singleDescription&&e.description||2===o&&e.Snippet?(a=document.createElement("div")).innerHTML=e.description:a=this._generateContent(e,t.content,t),this._appendChild(n,a,Gd.Css.item)}""!==n.innerHTML&&(t.sandboxContent?i.appendChild(Gd._createSandboxedIframe(n,t)):i.appendChild(n))}return i},Gd._createSandboxedIframe=function(e,t){var r=document.createElement("iframe");r.sandbox.add("allow-popups");var i,n=e.innerHTML,o=!1,a=100,s=550,l=10;document.body.scrollWidth<=340&&(s=300,a=50);var u=n.split(/<(tr|div|br|li|h[0-9]|p>)/);i=Math.max.apply(Math,u.map((function(e){return e.replace(/<[a-zA-Z0-9\s=\/]+>/g,"").length})))-1;var c=Math.ceil(3.5*i);if(c<s&&(s=c,a=i),n.includes("<img")||n.includes("<video"))o=!0,r.width="550px";else{var p=-1<n.indexOf(Gd.Css.table)?25:20;l+=Math.max(.5*u.length*p,Math.ceil(n.replace(/<[a-zA-Z0-9\s=\/]+>/g,"").length/a)*p)}r.width=s+"px",r.height=o||280<l?"280px":l+"px";var h=t.textColor?"color:"+t.textColor+";":"",d=t.fillColor?"background-color:"+t.fillColor+";":"",m='<html><head><title></title><meta charset="utf-8" /><meta http-equiv="x-ua-compatible" content="IE=Edge" /><link rel="stylesheet" href="'+Gd._cssUrl+'" type="text/css"/><style>html, body{margin:0;padding:0;'+h+d+'}</style></head><body><div class="'+Gd.Css.template+'" style="padding:0;width:'+(s-20)+'px">'+n+"</div></body></html>";return void 0===r.srcdoc?r.src="data:text/html;charset=utf-8,"+encodeURI(m):r.srcdoc=m,r},Gd._appendChild=function(e,t,r){t&&(r&&(t.className=(t.className?t.className+" ":"")+r),e.appendChild(t))},Gd._generateContent=function(e,t,r){if(t)return Array.isArray(t)?this._generatePropertyInfoTable(e,t,r):this._applyStringTemplate(e,t,r);var i=this._generateDynamicTableHtml(e,null,r);if(i){var n=document.createElement("div");return n.innerHTML=i,n}return null},Gd._applyStringTemplate=function(e,t,r){if(t){for(var i=t,n=this._placeholderRx.exec(t);n;){if(2<=n.length){var o=this._getPropertyValue(e,n[1],r);i=i.replace(n[0],o)}n=this._placeholderRx.exec(t)}if(i){(i=i.trim()).includes("<")&&(i=i.replace(/[\r\n]+/g,"<br/>"));var a=document.createElement("div");return a.innerHTML=i,a}}return null},Gd._getPropertyValue=function(e,t,r,i){var n=r.parsePropertyPaths?t.split("/"):[t],o=n.length;if(0<o&&e){var a=n[0],s=e[a];if(r.detectHyperlinks&&"link"===t&&(!i||i.hyperlinkFormat)){var l=[];if(Array.isArray(s)?s.forEach((function(e){e.href?l.push(e):"string"==typeof e&&l.push({href:e})})):s.href&&l.push(s),0<l.length){var u,c;i&&i.hyperlinkFormat?u=i.hyperlinkFormat:r&&r.hyperlinkFormat&&(u=r.hyperlinkFormat),c=u&&u.target?u.target:"_blank";var p=[];return l.forEach((function(e){e.title||u&&u.label||!e.rel||p.push(e.rel," - "),p.push('<a href="',e.href,'" target="',c,'">'),e.title?p.push(e.title):u&&u.label?p.push(u.label):p.push(e.href),p.push("</a>","<br/>")})),p.pop(),p.join("")}}if(null!=s){var h=void 0;for(h=1;h<o&&(s=s[n[h]],a=n[h],null!=s);h++);if(h===o&&null!=s){var d=void 0;if((d=void 0!==s.value?s.value:s)instanceof Date)return i&&i.dateFormat?d.toLocaleString(void 0,i.dateFormat):r.dateFormat?d.toLocaleString(void 0,r.dateFormat):d.toISOString();if("object"==typeof d)return(v=this._generateDynamicTableHtml(d,n.slice(1),r))||"";if("number"==typeof d){if(i){if(i.dateFormat)return new Date(d).toLocaleString(void 0,i.dateFormat);if(i.numberFormat)return d.toLocaleString(void 0,i.numberFormat)}else if(/(timestamp|date)/gi.test(a))return new Date(d).toISOString();return d.toLocaleString(void 0,r.numberFormat)}if("string"==typeof d&&""!==d&&!/[\n\r<>\s]/g.test(d)&&(r.detectHyperlinks||i&&i.hyperlinkFormat)){d=d.trim();var m=this._isUrlRx.test(d)||i&&i.hyperlinkFormat,f=this._isImageUrlRx.test(d)&&(m||d.startsWith("data:image")),y=this._emailRx.test(d);if(m||f||y){var g=void 0;i&&i.hyperlinkFormat?g=i.hyperlinkFormat:r&&r.hyperlinkFormat&&(g=r.hyperlinkFormat);var v=void 0;v=g&&g.target?' target="'+g.target+'"':' target="_blank"';var _=""+(g&&g.label?g.label:d);g&&g.scheme?d=g.scheme+d:y&&(d="mailto:"+d);var b=g&&g.label?' alt="'+g.label+'"':"";return(g&&g.isImage||f)&&(_='<img src="'+d+'" style="max-width:100%"'+b+'"/>'),'<a href="'+d+'"'+v+">"+_+"</a>"}}return d.toString()}}}return""},Gd._generatePropertyInfoTable=function(e,t,r){if(e&&t&&0<t.length){var i=[],n=this;i.push('<table class="'+n.Css.table+'">'),t.forEach((function(t){var o=n._getPropertyValue(e,t.propertyPath,r,t);if(t.hideLabel)i.push('<tr><td colspan="2">',o,"</td></tr>");else{var a=t.label||t.propertyPath.split("/")[0];i.push("<tr><th>",a,"</th><td>",o,"</td></tr>")}})),i.push("</table>");var o=document.createElement("div");return o.innerHTML=i.join(""),o}return null},Gd._generateDynamicTableHtml=function(e,t,r){var i=this;if(e){var n=[],o=this;n.push('<table class="'+o.Css.table+'">');var a=t&&0<t.length?t.join("/")+"/":"",s=0;return Object.keys(e).forEach((function(t){i._ignoreProperty(t,e[t])||(n.push("<tr><th>",t,"</th><td>",o._getPropertyValue(e,a+t,r),"</td></tr>"),s++)})),0===s?null:(n.push("</table>"),n.join(""))}return null},Gd._ignoreProperty=function(e,t){switch(e){case"title":case"name":case"base":case"popupTemplate":case"anchor":case"icon":case"image":case"imageUrl":case"rotation":case"color":case"size":case"offset":case"strokeColor":case"strokeWidth":case"strokeOpacity":case"subType":case"fillColor":case"fillOpacity":case"visibility":case"visible":return!0;default:if(0===e.indexOf("_")||null==t||""===t)return!0}return!1},Gd._placeholderRx=/\{([a-zA-Z0-9_\/\s]+)\}/gi,Gd._isUrlRx=/^(http|https|ftp|tel|mailto):\/\//i,Gd._isImageUrlRx=/(^data:image|.png$|.jpg$|.jpeg$|.gif$|.bmp$|.svg|.tif|.tiff$)/i,Gd._emailRx=/^[^\.\s@:](?:[^\s@:]*[^\s@:\.])?@[^\.\s@]+(?:\.[^\.\s@]+)*$/,Gd._cssUrl=new w({domain:l,path:"sdk/javascript/mapcontrol/"+E.getEndpointVersion()+"/atlas.min.css"}).toString(),Gd.Css={template:"azure-maps-control-popup-template",title:"azure-maps-control-popup-template-title",content:"azure-maps-control-popup-template-content",item:"azure-maps-control-popup-template-content-item",table:"azure-maps-control-popup-template-table"},Gd);function Gd(){this.detectHyperlinks=!0,this.parsePropertyPaths=!0}o(new w({domain:l,path:"sdk/javascript/mapcontrol/"+E.getEndpointVersion()+"/mapbox-gl-rtl-text.min.js"}).toString(),(function(e){e&&console.warn(e)}),!0),t.HtmlMarker=Ja,t.Map=Ud,t.Pixel=bi,t.Popup=Ha,t.PopupTemplate=Vd,t.Shape=Dn,t._getAssetDomain=function(){return s},t._getDomain=function(){return Os()},t._hasSetAuthenticationOptions=Ks,t._hasSetDomain=Xs,t._hasSetLanguage=Ys,t._hasSetSessionId=Js,t._hasSetView=$s,t.addImageTemplate=function(e,t,r){!r&&ol[e.toLowerCase()]||(ol[e.toLowerCase()]=t)},t.control=Jr,t.data=to,t.getAllImageTemplateNames=function(){return Object.keys(ol)},t.getAuthenticationOptions=ks,t.getDomain=Os,t.getImageTemplate=Ws,t.getLanguage=Ls,t.getSessionId=Ds,t.getSubscriptionKey=Bs,t.getUserRegion=function(){return ws},t.getVersion=function(){return E.getFullVersion()},t.getView=Fs,t.internal=zn,t.isSupported=qs,t.layer=Aa,t.math=Ln,t.setAuthenticationOptions=Us,t.setDomain=js,t.setLanguage=Vs,t.setSessionId=Gs,t.setSubscriptionKey=Hs,t.setUserRegion=Zs,t.setView=function(e){ws=e,Rs=!0},t.source=_o,Object.defineProperty(t,"__esModule",{value:!0})}(t)}).call(this,r(2))},function(e,t,r){(function(e,r){!function(t){"use strict";function i(e){return e.toLowerCase()}var n=(o.prototype.set=function(e,t){this._headersMap[i(e)]={name:e,value:t.toString()}},o.prototype.get=function(e){var t=this._headersMap[i(e)];return t?t.value:void 0},o.prototype.contains=function(e){return!!this._headersMap[i(e)]},o.prototype.remove=function(e){var t=this.contains(e);return delete this._headersMap[i(e)],t},o.prototype.rawHeaders=function(){var e={};for(var t in this._headersMap){var r=this._headersMap[t];e[r.name.toLowerCase()]=r.value}return e},o.prototype.headersArray=function(){var e=[];for(var t in this._headersMap)e.push(this._headersMap[t]);return e},o.prototype.headerNames=function(){for(var e=[],t=this.headersArray(),r=0;r<t.length;++r)e.push(t[r].name);return e},o.prototype.headerValues=function(){for(var e=[],t=this.headersArray(),r=0;r<t.length;++r)e.push(t[r].value);return e},o.prototype.toJson=function(){return this.rawHeaders()},o.prototype.toString=function(){return JSON.stringify(this.toJson())},o.prototype.clone=function(){return new o(this.rawHeaders())},o);function o(e){if(this._headersMap={},e)for(var t in e)this.set(t,e[t])}function a(e){for(var t="",r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return btoa(t)}function s(e){for(var t=atob(e),r=new Uint8Array(t.length),i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r}for(var l,u=(function(e){var t="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(t){var r=new Uint8Array(16);e.exports=function(){return t(r),r}}else{var i=new Array(16);e.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),i[t]=e>>>((3&t)<<3)&255;return i}}}(l={exports:{}}),l.exports),c=[],p=0;p<256;++p)c[p]=(p+256).toString(16).substr(1);var h=function(e,t){var r=t||0,i=c;return[i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]]].join("")},d={msRestVersion:"1.8.13",HTTP:"http:",HTTPS:"https:",HTTP_PROXY:"HTTP_PROXY",HTTPS_PROXY:"HTTPS_PROXY",HttpConstants:{HttpVerbs:{PUT:"PUT",GET:"GET",DELETE:"DELETE",POST:"POST",MERGE:"MERGE",HEAD:"HEAD",PATCH:"PATCH"},StatusCodes:{TooManyRequests:429}},HeaderConstants:{AUTHORIZATION:"authorization",AUTHORIZATION_SCHEME:"Bearer",RETRY_AFTER:"Retry-After",USER_AGENT:"User-Agent"}};function m(e){var t={};return t.body=e.bodyAsText,t.headers=e.headers,t.status=e.status,t}function f(e){var t=e.clone();return t.headers&&t.headers.remove("authorization"),t}function y(){return function(e,t,r){var i=t&&r||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var n=(e=e||{}).random||(e.rng||u)();if(n[6]=15&n[6]|64,n[8]=63&n[8]|128,t)for(var o=0;o<16;++o)t[i+o]=n[o];return t||h(n)}()}function g(e,t){return new Promise((function(r){return setTimeout((function(){return r(t)}),e)}))}void 0!==e&&e.version&&e.versions&&e.versions.node;var v=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function _(e,t,r){return e&&t?e.split(t).join(r||""):e}var b=(x.prototype.validateConstraints=function(e,t,r){function i(e,i){throw new Error('"'+r+'" with value "'+t+'" should satisfy the constraint "'+e+'": '+i+".")}if(e.constraints&&null!=t){var n=e.constraints,o=n.ExclusiveMaximum,a=n.ExclusiveMinimum,s=n.InclusiveMaximum,l=n.InclusiveMinimum,u=n.MaxItems,c=n.MaxLength,p=n.MinItems,h=n.MinLength,d=n.MultipleOf,m=n.Pattern,f=n.UniqueItems;null!=o&&o<=t&&i("ExclusiveMaximum",o),null!=a&&t<=a&&i("ExclusiveMinimum",a),null!=s&&s<t&&i("InclusiveMaximum",s),null!=l&&t<l&&i("InclusiveMinimum",l),null!=u&&t.length>u&&i("MaxItems",u),null!=c&&t.length>c&&i("MaxLength",c),null!=p&&t.length<p&&i("MinItems",p),null!=h&&t.length<h&&i("MinLength",h),null!=d&&t%d!=0&&i("MultipleOf",d),m&&null===t.match(m)&&i("Pattern",m),f&&t.some((function(e,t,r){return r.indexOf(e)!==t}))&&i("UniqueItems",f)}},x.prototype.serialize=function(e,t,r){var i={},n=e.type.name;r=r||e.serializedName,null!==n.match(/^Sequence$/gi)&&(i=[]),null!=t||null==e.defaultValue&&!e.isConstant||(t=e.defaultValue);var o=e.required,s=e.nullable;if(o&&s&&void 0===t)throw new Error(r+" cannot be undefined.");if(o&&!s&&null==t)throw new Error(r+" cannot be null or undefined.");if(!o&&!1===s&&null===t)throw new Error(r+" cannot be null.");return null==t?i=t:(this.validateConstraints(e,t,r),null!==n.match(/^any$/gi)?i=t:null!==n.match(/^(Number|String|Boolean|Object|Stream|Uuid)$/gi)?i=function(e,t,r){if(null!=r)if(null!==e.match(/^Number$/gi)){if("number"!=typeof r)throw new Error(t+" with value "+r+" must be of type number.")}else if(null!==e.match(/^String$/gi)){if("string"!=typeof r.valueOf())throw new Error(t+' with value "'+r+'" must be of type string.')}else if(null!==e.match(/^Uuid$/gi)){if("string"!=typeof r.valueOf()||!function(e){return new RegExp("^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$","ig").test(e)}(r))throw new Error(t+' with value "'+r+'" must be of type string and a valid uuid.')}else if(null!==e.match(/^Boolean$/gi)){if("boolean"!=typeof r)throw new Error(t+" with value "+r+" must be of type boolean.")}else if(null!==e.match(/^Stream$/gi)){var i=typeof r;if(!("string"==i||"function"==i||r instanceof ArrayBuffer||ArrayBuffer.isView(r)||"function"==typeof Blob&&r instanceof Blob))throw new Error(t+" must be a string, Blob, ArrayBuffer, ArrayBufferView, or a function returning NodeJS.ReadableStream.")}return r}(n,r,t):null!==n.match(/^Enum$/gi)?i=function(e,t,r){if(!t)throw new Error("Please provide a set of allowedValues to validate "+e+" as an Enum Type.");if(t.some((function(e){return"string"==typeof e.valueOf()?e.toLowerCase()===r.toLowerCase():e===r})))return r;throw new Error(r+" is not a valid value for "+e+". The valid values are: "+JSON.stringify(t)+".")}(r,e.type.allowedValues,t):null!==n.match(/^(Date|DateTime|TimeSpan|DateTimeRfc1123|UnixTime)$/gi)?i=function(e,t,r){if(null!=t)if(null!==e.match(/^Date$/gi)){if(!(t instanceof Date||"string"==typeof t.valueOf()&&!isNaN(Date.parse(t))))throw new Error(r+" must be an instanceof Date or a string in ISO8601 format.");t=t instanceof Date?t.toISOString().substring(0,10):new Date(t).toISOString().substring(0,10)}else if(null!==e.match(/^DateTime$/gi)){if(!(t instanceof Date||"string"==typeof t.valueOf()&&!isNaN(Date.parse(t))))throw new Error(r+" must be an instanceof Date or a string in ISO8601 format.");t=t instanceof Date?t.toISOString():new Date(t).toISOString()}else if(null!==e.match(/^DateTimeRfc1123$/gi)){if(!(t instanceof Date||"string"==typeof t.valueOf()&&!isNaN(Date.parse(t))))throw new Error(r+" must be an instanceof Date or a string in RFC-1123 format.");t=t instanceof Date?t.toUTCString():new Date(t).toUTCString()}else if(null!==e.match(/^UnixTime$/gi)){if(!(t instanceof Date||"string"==typeof t.valueOf()&&!isNaN(Date.parse(t))))throw new Error(r+" must be an instanceof Date or a string in RFC-1123/ISO8601 format for it to be serialized in UnixTime/Epoch format.");t=function(e){if(e)return"string"==typeof e.valueOf()&&(e=new Date(e)),Math.floor(e.getTime()/1e3)}(t)}else if(null!==e.match(/^TimeSpan$/gi)){if(!function(e){return v.test(e)}(t))throw new Error(r+' must be a string in ISO 8601 format. Instead was "'+t+'".');t=t}return t}(n,t,r):null!==n.match(/^ByteArray$/gi)?i=function(e,t){if(null!=t){if(!(t instanceof Uint8Array))throw new Error(e+" must be of type Uint8Array.");t=a(t)}return t}(r,t):null!==n.match(/^Base64Url$/gi)?i=function(e,t){if(null!=t){if(!(t instanceof Uint8Array))throw new Error(e+" must be of type Uint8Array.");t=function(e){if(e){if(e instanceof Uint8Array)return function(e,t){for(var r=e.length;0<=r-1&&"="===e[r-1];)--r;return e.substr(0,r)}(a(e)).replace(/\+/g,"-").replace(/\//g,"_");throw new Error("Please provide an input of type Uint8Array for converting to Base64Url.")}}(t)}return t}(r,t):null!==n.match(/^Sequence$/gi)?i=function(e,t,r,i){if(!Array.isArray(r))throw new Error(i+" must be of type Array.");var n=t.type.element;if(!n||"object"!=typeof n)throw new Error('element" metadata for an Array must be defined in the mapper and it must of type "object" in '+i+".");for(var o=[],a=0;a<r.length;a++)o[a]=e.serialize(n,r[a],i);return o}(this,e,t,r):null!==n.match(/^Dictionary$/gi)?i=function(e,t,r,i){if("object"!=typeof r)throw new Error(i+" must be of type object.");var n=t.type.value;if(!n||"object"!=typeof n)throw new Error('"value" metadata for a Dictionary must be defined in the mapper and it must of type "object" in '+i+".");for(var o={},a=0,s=Object.keys(r);a<s.length;a++){var l=s[a];o[l]=e.serialize(n,r[l],i+"."+l)}return o}(this,e,t,r):null!==n.match(/^Composite$/gi)&&(i=function(e,t,r,i){var n;if(C(e,t)&&(t=T(e,t,r,"clientName")),null==r)return r;for(var o={},a=S(e,t,i),s=0,l=Object.keys(a);s<l.length;s++){var u=l[s],c=a[u];if(!c.readOnly){var p=void 0,h=o;if(e.isXML)p=c.xmlIsWrapped?c.xmlName:c.xmlElementName||c.xmlName;else{var d=w(c.serializedName);p=d.pop();for(var m=0,f=d;m<f.length;m++){var y=f[m];null==h[y]&&null!=r[u]&&(h[y]={}),h=h[y]}}if(null!=h){var g=""!==c.serializedName?i+"."+c.serializedName:i,v=r[u],_=C(e,t);_&&_.clientName===u&&null==v&&(v=t.serializedName);var b=e.serialize(c,v,g);void 0!==b&&null!=p&&(c.xmlIsAttribute?(h.$=h.$||{},h.$[p]=b):c.xmlIsWrapped?h[p]=((n={})[c.xmlElementName]=b,n):h[p]=b)}}}var x=t.type.additionalProperties;if(x){var E=Object.keys(a),I=function(t){E.every((function(e){return e!==t}))&&(o[t]=e.serialize(x,r[t],i+'["'+t+'"]'))};for(var P in r)I(P)}return o}(this,e,t,r))),i},x.prototype.deserialize=function(e,t,r){if(null==t)return this.isXML&&"Sequence"===e.type.name&&!e.xmlIsWrapped&&(t=[]),t;var i,n=e.type.name;return r=r||e.serializedName,null!==n.match(/^Composite$/gi)?i=function(e,t,r,i){C(e,t)&&(t=T(e,t,r,"serializedName"));for(var n=S(e,t,i),o={},a=[],s=0,l=Object.keys(n);s<l.length;s++){var u=l[s],c=n[u],p=w(n[u].serializedName);a.push(p[0]);var h=c.serializedName,d=c.xmlName,m=c.xmlElementName,f=i;""!==h&&void 0!==h&&(f=i+"."+h);var y=c.headerCollectionPrefix;if(y){for(var g={},v=0,_=Object.keys(r);v<_.length;v++){var b=_[v];b.startsWith(y)&&(g[b.substring(y.length)]=e.deserialize(c.type.value,r[b],f)),a.push(b)}o[u]=g}else if(e.isXML)if(c.xmlIsAttribute&&r.$)o[u]=e.deserialize(c,r.$[d],f);else{var x=r[m||d||h];c.xmlIsWrapped&&void 0===(x=(x=r[d])&&x[m])&&(x=[]),o[u]=e.deserialize(c,x,f)}else{for(var E=void 0,I=r,P=0,R=p;P<R.length;P++){var N=R[P];if(!I)break;I=I[N]}E=I;var A=t.type.polymorphicDiscriminator;A&&c.serializedName===A.serializedName&&null==E&&(E=t.serializedName);var z=void 0;Array.isArray(r[u])&&""===n[u].serializedName?(E=r[u],o=e.deserialize(c,E,f)):void 0!==E&&(z=e.deserialize(c,E,f),o[u]=z)}}var M=t.type.additionalProperties;if(M){var k=function(e){for(var t in n)if(w(n[t].serializedName)[0]===e)return!1;return!0};for(var O in r)k(O)&&(o[O]=e.deserialize(M,r[O],i+'["'+O+'"]'))}else if(r)for(var L=0,D=Object.keys(r);L<D.length;L++)void 0!==o[u=D[L]]||a.includes(u)||["$","_"].includes(u)||(o[u]=r[u]);return o}(this,e,t,r):(this.isXML&&null!=t.$&&null!=t._&&(t=t._),null!==n.match(/^Number$/gi)?(i=parseFloat(t),isNaN(i)&&(i=t)):null!==n.match(/^Boolean$/gi)?i="true"===t||"false"!==t&&t:null!==n.match(/^(String|Enum|Object|Stream|Uuid|TimeSpan|any)$/gi)?i=t:null!==n.match(/^(Date|DateTime|DateTimeRfc1123)$/gi)?i=new Date(t):null!==n.match(/^UnixTime$/gi)?i=function(e){return e?new Date(1e3*e):void 0}(t):null!==n.match(/^ByteArray$/gi)?i=s(t):null!==n.match(/^Base64Url$/gi)?i=function(e){if(e){if(e&&"string"!=typeof e.valueOf())throw new Error("Please provide an input of type string for converting to Uint8Array");return s(e=e.replace(/\-/g,"+").replace(/\_/g,"/"))}}(t):null!==n.match(/^Sequence$/gi)?i=function(e,t,r,i){var n=t.type.element;if(!n||"object"!=typeof n)throw new Error('element" metadata for an Array must be defined in the mapper and it must of type "object" in '+i);if(r){Array.isArray(r)||(r=[r]);for(var o=[],a=0;a<r.length;a++)o[a]=e.deserialize(n,r[a],i+"["+a+"]");return o}return r}(this,e,t,r):null!==n.match(/^Dictionary$/gi)&&(i=function(e,t,r,i){var n=t.type.value;if(!n||"object"!=typeof n)throw new Error('"value" metadata for a Dictionary must be defined in the mapper and it must of type "object" in '+i);if(r){for(var o={},a=0,s=Object.keys(r);a<s.length;a++){var l=s[a];o[l]=e.deserialize(n,r[l],i)}return o}return r}(this,e,t,r))),e.isConstant&&(i=e.defaultValue),i},x);function x(e,t){void 0===e&&(e={}),this.modelMappers=e,this.isXML=t}function w(e){var t=[],r="";if(e)for(var i=0,n=e.split(".");i<n.length;i++){var o=n[i];"\\"===o.charAt(o.length-1)?r+=o.substr(0,o.length-1)+".":(r+=o,t.push(r),r="")}return t}function S(e,t,r){var i=t.type.modelProperties;if(!i){var n=t.type.className;if(!n)throw new Error('Class name for model "'+r+'" is not provided in the mapper "'+JSON.stringify(t,void 0,2)+'".');var o=e.modelMappers[n];if(!o)throw new Error('mapper() cannot be null or undefined for model "'+n+'".');if(!(i=o.type.modelProperties))throw new Error('modelProperties cannot be null or undefined in the mapper "'+JSON.stringify(o)+'" of type "'+n+'" for object "'+r+'".')}return i}function T(e,t,r,i){var n=C(e,t);if(n){var o=n[i];if(null!=o){var a=r[o];if(null!=a){var s=t.type.uberParent||t.type.className,l=a===s?a:s+"."+a,u=e.modelMappers.discriminators[l];u&&(t=u)}}}return t}function C(e,t){return t.type.polymorphicDiscriminator||E(e,t.type.uberParent)||E(e,t.type.className)}function E(e,t){return t&&e.modelMappers[t]&&e.modelMappers[t].type.polymorphicDiscriminator}var I=function(e){for(var t={},r=0,i=["Base64Url","Boolean","ByteArray","Composite","Date","DateTime","DateTimeRfc1123","Dictionary","Enum","Number","Object","Sequence","String","Stream","TimeSpan","UnixTime"];r<i.length;r++){var n=i[r];t[n]=n}return t}(),P=(R.prototype.validateRequestProperties=function(){if(!this.method)throw new Error("WebResource.method is required.");if(!this.url)throw new Error("WebResource.url is required.")},R.prototype.prepare=function(e){if(!e)throw new Error("options object is required");if(null==e.method||"string"!=typeof e.method.valueOf())throw new Error("options.method must be a string.");if(e.url&&e.pathTemplate)throw new Error("options.url and options.pathTemplate are mutually exclusive. Please provide exactly one of them.");if(!(null!=e.pathTemplate&&"string"==typeof e.pathTemplate.valueOf()||null!=e.url&&"string"==typeof e.url.valueOf()))throw new Error("Please provide exactly one of options.pathTemplate or options.url.");if(e.url){if("string"!=typeof e.url)throw new Error('options.url must be of type "string".');this.url=e.url}if(e.method){var t=["GET","PUT","HEAD","DELETE","OPTIONS","POST","PATCH","TRACE"];if(-1===t.indexOf(e.method.toUpperCase()))throw new Error('The provided method "'+e.method+'" is invalid. Supported HTTP methods are: '+JSON.stringify(t))}if(this.method=e.method.toUpperCase(),e.pathTemplate){var r=e.pathTemplate,i=e.pathParameters;if("string"!=typeof r)throw new Error('options.pathTemplate must be of type "string".');e.baseUrl||(e.baseUrl="https://management.azure.com");var n=e.baseUrl,o=n+(n.endsWith("/")?"":"/")+(r.startsWith("/")?r.slice(1):r),a=o.match(/({\w*\s*\w*})/gi);if(a&&a.length){if(!i)throw new Error("pathTemplate: "+r+" has been provided. Hence, options.pathParameters must also be provided.");a.forEach((function(e){var t=e.slice(1,-1),n=i[t];if(null==n||"string"!=typeof n&&"object"!=typeof n)throw new Error("pathTemplate: "+r+" contains the path parameter "+t+" however, it is not present in "+i+" - "+JSON.stringify(i,void 0,2)+'.The value of the path parameter can either be a "string" of the form { '+t+': "some sample value" } or it can be an "object" of the form { "'+t+'": { value: "some sample value", skipUrlEncoding: true } }.');if("string"==typeof n.valueOf()&&(o=o.replace(e,encodeURIComponent(n))),"object"==typeof n.valueOf()){if(!n.value)throw new Error("options.pathParameters["+t+'] is of type "object" but it does not contain a "value" property.');o=n.skipUrlEncoding?o.replace(e,n.value):o.replace(e,encodeURIComponent(n.value))}}))}this.url=o}if(e.queryParameters){var s=e.queryParameters;if("object"!=typeof s)throw new Error('options.queryParameters must be of type object. It should be a JSON object of "query-parameter-name" as the key and the "query-parameter-value" as the value. The "query-parameter-value" may be fo type "string" or an "object" of the form { value: "query-parameter-value", skipUrlEncoding: true }.');this.url&&-1===this.url.indexOf("?")&&(this.url+="?");var l=[];for(var u in this.query={},s){var c=s[u];if(c)if("string"==typeof c)l.push(u+"="+encodeURIComponent(c)),this.query[u]=encodeURIComponent(c);else if("object"==typeof c){if(!c.value)throw new Error("options.queryParameters["+u+'] is of type "object" but it does not contain a "value" property.');c.skipUrlEncoding?(l.push(u+"="+c.value),this.query[u]=c.value):(l.push(u+"="+encodeURIComponent(c.value)),this.query[u]=encodeURIComponent(c.value))}}this.url+=l.join("&")}if(e.headers)for(var p=e.headers,h=0,d=Object.keys(e.headers);h<d.length;h++){var m=d[h];this.headers.set(m,p[m])}return this.headers.get("accept-language")||this.headers.set("accept-language","en-US"),this.headers.get("x-ms-client-request-id")||e.disableClientRequestId||this.headers.set("x-ms-client-request-id",y()),this.headers.get("Content-Type")||this.headers.set("Content-Type","application/json; charset=utf-8"),this.body=e.body,null!=e.body&&(e.bodyIsStream?(this.headers.get("Transfer-Encoding")||this.headers.set("Transfer-Encoding","chunked"),"application/octet-stream"!==this.headers.get("Content-Type")&&this.headers.set("Content-Type","application/octet-stream")):(e.serializationMapper&&(this.body=new b(e.mappers).serialize(e.serializationMapper,e.body,"requestBody")),e.disableJsonStringifyOnBody||(this.body=JSON.stringify(e.body)))),this.abortSignal=e.abortSignal,this.onDownloadProgress=e.onDownloadProgress,this.onUploadProgress=e.onUploadProgress,this},R.prototype.clone=function(){var e=new R(this.url,this.method,this.body,this.query,this.headers&&this.headers.clone(),this.streamResponseBody,this.withCredentials,this.abortSignal,this.timeout,this.onUploadProgress,this.onDownloadProgress);return this.formData&&(e.formData=this.formData),this.operationSpec&&(e.operationSpec=this.operationSpec),this.shouldDeserialize&&(e.shouldDeserialize=this.shouldDeserialize),this.operationResponseGetter&&(e.operationResponseGetter=this.operationResponseGetter),e},R);function R(e,t,r,i,o,a,s,l,u,c,p,h){this.streamResponseBody=a,this.url=e||"",this.method=t||"GET",this.headers=o instanceof n?o:new n(o),this.body=r,this.query=i,this.formData=void 0,this.withCredentials=s||!1,this.abortSignal=l,this.timeout=u||0,this.onUploadProgress=c,this.onDownloadProgress=p,this.proxySettings=h}var N=function(e,t){return(N=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};function A(e,t){function r(){this.constructor=e}N(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var z=function(){return(z=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)};function M(e,t,r,i){return new(r=r||Promise)((function(n,o){function a(e){try{l(i.next(e))}catch(e){o(e)}}function s(e){try{l(i.throw(e))}catch(e){o(e)}}function l(e){e.done?n(e.value):new r((function(t){t(e.value)})).then(a,s)}l((i=i.apply(e,t||[])).next())}))}function k(e,t){var r,i,n,o,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,i&&(n=2&o[0]?i.return:o[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,o[1])).done)return n;switch(i=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,i=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(n=0<(n=a.trys).length&&n[n.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){a.label=o[1];break}if(6===o[0]&&a.label<n[1]){a.label=n[1],n=o;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(o);break}n[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],i=0}finally{r=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}var O,L=(A(D,O=Error),D.REQUEST_SEND_ERROR="REQUEST_SEND_ERROR",D.REQUEST_ABORTED_ERROR="REQUEST_ABORTED_ERROR",D.PARSE_ERROR="PARSE_ERROR",D);function D(e,t,r,i,n,o){var a=O.call(this,e)||this;return a.code=t,a.statusCode=r,a.request=i,a.response=n,a.body=o,Object.setPrototypeOf(a,D.prototype),a}var B,F=(q.prototype.sendRequest=function(e){var t=new XMLHttpRequest;if(e.proxySettings)throw new Error("HTTP proxy is not supported in browser environment");var r=e.abortSignal;if(r){var i=function(){t.abort()};r.addEventListener("abort",i),t.addEventListener("readystatechange",(function(){t.readyState===XMLHttpRequest.DONE&&r.removeEventListener("abort",i)}))}if(U(t.upload,e.onUploadProgress),U(t,e.onDownloadProgress),e.formData){for(var n=e.formData,o=new FormData,a=function(e,t){t&&t.hasOwnProperty("value")&&t.hasOwnProperty("options")?o.append(e,t.value,t.options):o.append(e,t)},s=0,l=Object.keys(n);s<l.length;s++){var u=l[s],c=n[u];if(Array.isArray(c))for(var p=0;p<c.length;p++)a(u,c[p]);else a(u,c)}e.body=o,e.formData=void 0;var h=e.headers.get("Content-Type");h&&-1!==h.indexOf("multipart/form-data")&&e.headers.remove("Content-Type")}t.open(e.method,e.url),t.timeout=e.timeout,t.withCredentials=e.withCredentials;for(var d=0,m=e.headers.headersArray();d<m.length;d++){var f=m[d];t.setRequestHeader(f.name,f.value)}return t.responseType=e.streamResponseBody?"blob":"text",t.send(void 0===e.body?null:e.body),e.streamResponseBody?new Promise((function(r,i){t.addEventListener("readystatechange",(function(){if(t.readyState===XMLHttpRequest.HEADERS_RECEIVED){var i=new Promise((function(r,i){t.addEventListener("load",(function(){r(t.response)})),V(e,t,i)}));r({request:e,status:t.status,headers:j(t),blobBody:i})}})),V(e,t,i)})):new Promise((function(r,i){t.addEventListener("load",(function(){return r({request:e,status:t.status,headers:j(t),bodyAsText:t.responseText})})),V(e,t,i)}))},q);function q(){}function U(e,t){t&&e.addEventListener("progress",(function(e){return t({loadedBytes:e.loaded})}))}function j(e){for(var t=new n,r=0,i=e.getAllResponseHeaders().trim().split(/[\r\n]+/);r<i.length;r++){var o=i[r],a=o.indexOf(":"),s=o.slice(0,a),l=o.slice(a+2);t.set(s,l)}return t}function V(e,t,r){t.addEventListener("error",(function(){return r(new L("Failed to send request to "+e.url,L.REQUEST_SEND_ERROR,void 0,e))})),t.addEventListener("abort",(function(){return r(new L("The request was aborted",L.REQUEST_ABORTED_ERROR,void 0,e))})),t.addEventListener("timeout",(function(){return r(new L("timeout of "+t.timeout+"ms exceeded",L.REQUEST_SEND_ERROR,void 0,e))}))}function G(e){return H(e.parameterPath,e.mapper)}function H(e,t){return"string"==typeof e?e:Array.isArray(e)?e.join("."):t.serializedName}function Z(e){var t=!1;for(var r in e.responses){var i=e.responses[r];if(i.bodyMapper&&i.bodyMapper.type.name===I.Stream){t=!0;break}}return t}(B=t.HttpPipelineLogLevel||(t.HttpPipelineLogLevel={}))[B.OFF=0]="OFF",B[B.ERROR=1]="ERROR",B[B.WARNING=2]="WARNING",B[B.INFO=3]="INFO";var W=new DOMParser,K="";try{K=W.parseFromString("INVALID","text/xml").getElementsByTagName("parsererror")[0].namespaceURI}catch(o){}var X=document.implementation.createDocument(null,null,null),Y=new XMLSerializer;function J(e,t){var r=function e(t,r){if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return(u=X.createElement(r)).textContent=t.toString(),[u];if(Array.isArray(t)){for(var i=[],n=0,o=t;n<o.length;n++)for(var a=0,s=e(o[n],r);a<s.length;a++){var l=s[a];i.push(l)}return i}if("object"!=typeof t)throw new Error("Illegal value passed to buildObject: "+t);for(var u=X.createElement(r),c=0,p=Object.keys(t);c<p.length;c++){var h=p[c];if("$"===h)for(var d=0,m=$(t[h]);d<m.length;d++){var f=m[d];u.attributes.setNamedItem(f)}else for(var y=0,g=e(t[h],h);y<g.length;y++)l=g[y],u.appendChild(l)}return[u]}(e,t&&t.rootName||"root")[0];return'<?xml version="1.0" encoding="UTF-8" standalone="yes"?>'+Y.serializeToString(r)}function $(e){for(var t=[],r=0,i=Object.keys(e);r<i.length;r++){var n=i[r],o=X.createAttribute(n);o.value=e[n].toString(),t.push(o)}return t}var Q=(ee.prototype.shouldLog=function(e){return this._options.shouldLog(e)},ee.prototype.log=function(e,t){this._options.log(e,t)},ee);function ee(e,t){this._nextPolicy=e,this._options=t}var te=(re.prototype.shouldLog=function(e){return!!this._logger&&e!==t.HttpPipelineLogLevel.OFF&&e<=this._logger.minimumLogLevel},re.prototype.log=function(e,t){this._logger&&this.shouldLog(e)&&this._logger.log(e,t)},re);function re(e){this._logger=e}function ie(e){return{create:function(t,r){return new se(t,e,r)}}}var ne,oe=["application/json","text/json"],ae=["application/xml","application/atom+xml"],se=(A(le,ne=Q),le.prototype.sendRequest=function(e){return M(this,void 0,void 0,(function(){var t=this;return k(this,(function(r){return[2,this._nextPolicy.sendRequest(e).then((function(e){return function(e,t,r){return function(e,t,r){function i(e){var t='Error "'+e+'" occurred while parsing the response body - '+r.bodyAsText+".",i=e.code||L.PARSE_ERROR,n=new L(t,i,r.status,r.request,r,r.bodyAsText);return Promise.reject(n)}if(!r.request.streamResponseBody&&r.bodyAsText){var n=r.bodyAsText,o=r.headers.get("Content-Type")||"",a=o?o.split(";").map((function(e){return e.toLowerCase()})):[];if(0===a.length||a.some((function(t){return-1!==e.indexOf(t)})))return new Promise((function(e){r.parsedBody=JSON.parse(n),e(r)})).catch(i);if(a.some((function(e){return-1!==t.indexOf(e)})))return function(e){try{var t=W.parseFromString(e,"application/xml");!function(e){if(K){var t=e.getElementsByTagNameNS(K,"parsererror");if(t.length)throw new Error(t.item(0).innerHTML)}}(t);var r=function e(t){var r,i={},n=t.childNodes.length,o=t.childNodes[0],a=o&&1===n&&o.nodeType===Node.TEXT_NODE&&o.nodeValue||void 0,s=function(e){return!!e.attributes}(r=t)&&r.hasAttributes()?r:void 0;if(s){i.$={};for(var l=0;l<s.attributes.length;l++){var u=s.attributes[l];i.$[u.nodeName]=u.nodeValue}a&&(i._=a)}else 0===n?i="":a&&(i=a);if(!a)for(l=0;l<n;l++){var c=t.childNodes[l];if(c.nodeType!==Node.TEXT_NODE){var p=e(c);i[c.nodeName]?Array.isArray(i[c.nodeName])?i[c.nodeName].push(p):i[c.nodeName]=[i[c.nodeName],p]:i[c.nodeName]=p}}return i}(t.childNodes[0]);return Promise.resolve(r)}catch(e){return Promise.reject(e)}}(n).then((function(e){return r.parsedBody=e,r})).catch(i)}return Promise.resolve(r)}(e,t,r).then((function(e){if(function(e){var t=e.request.shouldDeserialize;return void 0===t||("boolean"==typeof t?t:t(e))}(e)){var t=e.request.operationSpec;if(t&&t.responses){var i=e.status,n=Object.keys(t.responses),o=0===n.length||1===n.length&&"default"===n[0],a=function(e){var t,r=e.request,i=r.operationSpec;if(i){var n=r.operationResponseGetter;t=n?n(i,e):i.responses[e.status]}return t}(e);if(o?200<=i&&i<300:a){if(a){if(a.bodyMapper){y=e.parsedBody,t.isXML&&a.bodyMapper.type.name===I.Sequence&&(y="object"==typeof y?y[a.bodyMapper.xmlElementName]:[]);try{e.parsedBody=t.serializer.deserialize(a.bodyMapper,y,"operationRes.parsedBody")}catch(c){var s=new L("Error "+c+" occurred in deserializing the responseBody - "+e.bodyAsText);return s.request=f(e.request),s.response=m(e),Promise.reject(s)}}else"HEAD"===t.httpMethod&&(e.parsedBody=200<=r.status&&r.status<300);a.headersMapper&&(e.parsedHeaders=t.serializer.deserialize(a.headersMapper,e.headers.rawHeaders(),"operationRes.parsedHeaders"))}}else{var l=t.responses.default;if(l){var u=Z(t)?"Unexpected status code: "+i:e.bodyAsText,c=new L(u);c.statusCode=i,c.request=f(e.request),c.response=m(e);var p=e.parsedBody;try{if(p){var h=l.bodyMapper;if(h&&"CloudError"===h.serializedName)p.error&&(p=p.error),p.code&&(c.code=p.code),p.message&&(c.message=p.message);else{var d=p;p.error&&(d=p.error),c.code=d.code,d.message&&(c.message=d.message)}if(h){var y=p;t.isXML&&h.type.name===I.Sequence&&(y="object"==typeof p?p[h.xmlElementName]:[]),c.body=t.serializer.deserialize(h,y,"error.body")}}}catch(t){c.message='Error "'+t.message+'" occurred in deserializing the responseBody - "'+e.bodyAsText+'" for the default response.'}return Promise.reject(c)}}}}return Promise.resolve(e)}))}(t.jsonContentTypes,t.xmlContentTypes,e)}))]}))}))},le);function le(e,t,r){var i=ne.call(this,e,r)||this;return i.jsonContentTypes=t&&t.json||oe,i.xmlContentTypes=t&&t.xml||ae,i}var ue,ce=(A(pe,ue=Q),pe.prototype.sendRequest=function(e){var t=this;return this._nextPolicy.sendRequest(e.clone()).then((function(r){return he(t,e,r)})).catch((function(r){return he(t,e,r.response,void 0,r)}))},pe);function pe(e,t,r,i,n,o){var a=ue.call(this,e,t)||this;function s(e){return"number"==typeof e}return a.retryCount=s(r)?r:3,a.retryInterval=s(i)?i:3e4,a.minRetryInterval=s(n)?n:3e3,a.maxRetryInterval=s(o)?o:9e4,a}function he(e,t,r,i,n){i=function(e,t,r){t=t||{retryCount:0,retryInterval:0},r&&(t.error&&(r.innerError=t.error),t.error=r),t.retryCount++;var i=Math.pow(2,t.retryCount)-1;return i*=.8*e.retryInterval+Math.floor(Math.random()*(1.2*e.retryInterval-.8*e.retryInterval)),t.retryInterval=Math.min(e.minRetryInterval+i,e.maxRetryInterval),t}(e,i,n);var o=t.abortSignal&&t.abortSignal.aborted;if(!o&&function(e,t,r){if(null==t||t<500&&408!==t||501===t||505===t)return!1;if(!r)throw new Error("retryData for the ExponentialRetryPolicyFilter cannot be null.");return(r&&r.retryCount)<e.retryCount}(e,r&&r.status,i))return g(i.retryInterval).then((function(){return e._nextPolicy.sendRequest(t.clone())})).then((function(r){return he(e,t,r,i,void 0)})).catch((function(n){return he(e,t,r,i,n)}));if(o||n||!r){var a=i.error||new L("Failed to send the request.",L.REQUEST_SEND_ERROR,r&&r.status,r&&r.request,r);return Promise.reject(a)}return Promise.resolve(r)}var de,me=(A(fe,de=Q),fe.prototype.sendRequest=function(e){return e.headers.contains(this._requestIdHeaderName)||e.headers.set(this._requestIdHeaderName,y()),this._nextPolicy.sendRequest(e)},fe);function fe(e,t,r){var i=de.call(this,e,t)||this;return i._requestIdHeaderName=r,i}var ye=function(){return"x-ms-command-name"};function ge(){var e=[{key:"ms-rest-js",value:d.msRestVersion}],t=function(){var e=window.navigator;return[{key:"OS",value:(e.oscpu||e.platform).replace(" ","")}]}();return function(e,t,r){return void 0===t&&(t=" "),void 0===r&&(r="/"),e.map((function(e){var t=e.value?""+r+e.value:"";return e.key+t})).join(t)}(e.concat(t))}var ve,_e=(A(be,ve=Q),be.prototype.sendRequest=function(e){return this.addUserAgentHeader(e),this._nextPolicy.sendRequest(e)},be.prototype.addUserAgentHeader=function(e){e.headers||(e.headers=new n),!e.headers.get(this.headerKey)&&this.headerValue&&e.headers.set(this.headerKey,this.headerValue)},be);function be(e,t,r,i){var n=ve.call(this,e,t)||this;return n._nextPolicy=e,n._options=t,n.headerKey=r,n.headerValue=i,n}var xe=(we.prototype.any=function(){return 0<Object.keys(this._rawQuery).length},we.prototype.set=function(e,t){if(e)if(null!=t){var r=Array.isArray(t)?t:t.toString();this._rawQuery[e]=r}else delete this._rawQuery[e]},we.prototype.get=function(e){return e?this._rawQuery[e]:void 0},we.prototype.toString=function(){var e="";for(var t in this._rawQuery){e&&(e+="&");var r=this._rawQuery[t];if(Array.isArray(r)){for(var i=[],n=0,o=r;n<o.length;n++){var a=o[n];i.push(t+"="+a)}e+=i.join("&")}else e+=t+"="+r}return e},we.parse=function(e){var t=new we;if(e){e.startsWith("?")&&(e=e.substring(1));for(var r="ParameterName",i="",n="",o=0;o<e.length;++o){var a=e[o];switch(r){case"ParameterName":switch(a){case"=":r="ParameterValue";break;case"&":n=i="";break;default:i+=a}break;case"ParameterValue":switch(a){case"=":n=i="",r="Invalid";break;case"&":t.set(i,n),n=i="",r="ParameterName";break;default:n+=a}break;case"Invalid":"&"===a&&(r="ParameterName");break;default:throw new Error("Unrecognized URLQuery parse state: "+r)}}"ParameterValue"===r&&t.set(i,n)}return t},we);function we(){this._rawQuery={}}var Se=(Te.prototype.setScheme=function(e){e?this.set(e,"SCHEME"):this._scheme=void 0},Te.prototype.getScheme=function(){return this._scheme},Te.prototype.setHost=function(e){e?this.set(e,"SCHEME_OR_HOST"):this._host=void 0},Te.prototype.getHost=function(){return this._host},Te.prototype.setPort=function(e){null==e||""===e?this._port=void 0:this.set(e.toString(),"PORT")},Te.prototype.getPort=function(){return this._port},Te.prototype.setPath=function(e){e?-1!==e.indexOf("://")?this.set(e,"SCHEME"):this.set(e,"PATH"):this._path=void 0},Te.prototype.appendPath=function(e){if(e){var t=this.getPath();t&&(t.endsWith("/")||(t+="/"),e.startsWith("/")&&(e=e.substring(1)),e=t+e),this.set(e,"PATH")}},Te.prototype.getPath=function(){return this._path},Te.prototype.setQuery=function(e){this._query=e?xe.parse(e):void 0},Te.prototype.setQueryParameter=function(e,t){e&&(this._query||(this._query=new xe),this._query.set(e,t))},Te.prototype.getQueryParameterValue=function(e){return this._query?this._query.get(e):void 0},Te.prototype.getQuery=function(){return this._query?this._query.toString():void 0},Te.prototype.set=function(e,t){for(var r=new Ie(e,t);r.next();){var i=r.current();if(i)switch(i.type){case"SCHEME":this._scheme=i.text||void 0;break;case"HOST":this._host=i.text||void 0;break;case"PORT":this._port=i.text||void 0;break;case"PATH":var n=i.text||void 0;this._path&&"/"!==this._path&&"/"===n||(this._path=n);break;case"QUERY":this._query=xe.parse(i.text);break;default:throw new Error("Unrecognized URLTokenType: "+i.type)}}},Te.prototype.toString=function(){var e="";return this._scheme&&(e+=this._scheme+"://"),this._host&&(e+=this._host),this._port&&(e+=":"+this._port),this._path&&(this._path.startsWith("/")||(e+="/"),e+=this._path),this._query&&this._query.any()&&(e+="?"+this._query.toString()),e},Te.prototype.replaceAll=function(e,t){e&&(this.setScheme(_(this.getScheme(),e,t)),this.setHost(_(this.getHost(),e,t)),this.setPort(_(this.getPort(),e,t)),this.setPath(_(this.getPath(),e,t)),this.setQuery(_(this.getQuery(),e,t)))},Te.parse=function(e){var t=new Te;return t.set(e,"SCHEME_OR_HOST"),t},Te);function Te(){}var Ce=(Ee.scheme=function(e){return new Ee(e,"SCHEME")},Ee.host=function(e){return new Ee(e,"HOST")},Ee.port=function(e){return new Ee(e,"PORT")},Ee.path=function(e){return new Ee(e,"PATH")},Ee.query=function(e){return new Ee(e,"QUERY")},Ee);function Ee(e,t){this.text=e,this.type=t}var Ie=(Pe.prototype.current=function(){return this._currentToken},Pe.prototype.next=function(){if(Re(this))switch(this._currentState){case"SCHEME":!function(e){var t=function(e){return Me(e,(function(e){return function(e){var t=e.charCodeAt(0);return 48<=t&&t<=57||65<=t&&t<=90||97<=t&&t<=122}(e)}))}(e);e._currentToken=Ce.scheme(t),Re(e)?e._currentState="HOST":e._currentState="DONE"}(this);break;case"SCHEME_OR_HOST":!function(e){var t=ke(e,":","/","?");Re(e)?":"===Ne(e)?"://"===ze(e,3)?(e._currentToken=Ce.scheme(t),e._currentState="HOST"):(e._currentToken=Ce.host(t),e._currentState="PORT"):(e._currentToken=Ce.host(t),"/"===Ne(e)?e._currentState="PATH":e._currentState="QUERY"):(e._currentToken=Ce.host(t),e._currentState="DONE")}(this);break;case"HOST":!function(e){"://"===ze(e,3)&&Ae(e,3);var t=ke(e,":","/","?");e._currentToken=Ce.host(t),Re(e)?":"===Ne(e)?e._currentState="PORT":"/"===Ne(e)?e._currentState="PATH":e._currentState="QUERY":e._currentState="DONE"}(this);break;case"PORT":!function(e){":"===Ne(e)&&Ae(e);var t=ke(e,"/","?");e._currentToken=Ce.port(t),Re(e)?"/"===Ne(e)?e._currentState="PATH":e._currentState="QUERY":e._currentState="DONE"}(this);break;case"PATH":!function(e){var t=ke(e,"?");e._currentToken=Ce.path(t),Re(e)?e._currentState="QUERY":e._currentState="DONE"}(this);break;case"QUERY":!function(e){"?"===Ne(e)&&Ae(e);var t=function(e){var t="";return e._currentIndex<e._textLength&&(t=e._text.substring(e._currentIndex),e._currentIndex=e._textLength),t}(e);e._currentToken=Ce.query(t),e._currentState="DONE"}(this);break;default:throw new Error("Unrecognized URLTokenizerState: "+this._currentState)}else this._currentToken=void 0;return!!this._currentToken},Pe);function Pe(e,t){this._text=e,this._textLength=e?e.length:0,this._currentState=null!=t?t:"SCHEME_OR_HOST",this._currentIndex=0}function Re(e){return e._currentIndex<e._textLength}function Ne(e){return e._text[e._currentIndex]}function Ae(e,t){Re(e)&&(t=t||1,e._currentIndex+=t)}function ze(e,t){var r=e._currentIndex+t;return e._textLength<r&&(r=e._textLength),e._text.substring(e._currentIndex,r)}function Me(e,t){for(var r="";Re(e);){var i=Ne(e);if(!t(i))break;r+=i,Ae(e)}return r}function ke(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return Me(e,(function(e){return-1===t.indexOf(e)}))}var Oe,Le=(A(De,Oe=Q),De.prototype.sendRequest=function(e){var t=this;return this._nextPolicy.sendRequest(e).then((function(e){return function e(t,r,i){var n=r.request,o=r.status,a=r.headers.get("location");if(a&&(300===o||307===o||303===o&&"POST"===n.method)&&(!t.maxRetries||i<t.maxRetries)){var s=Se.parse(n.url);return s.setPath(a),n.url=s.toString(),303===o&&(n.method="GET"),t._nextPolicy.sendRequest(n).then((function(r){return e(t,r,i+1)}))}return Promise.resolve(r)}(t,e,0)}))},De);function De(e,t,r){void 0===r&&(r=20);var i=Oe.call(this,e,t)||this;return i.maxRetries=r,i}var Be,Fe=(A(qe,Be=Q),qe.prototype.sendRequest=function(e){var t=this;return this._nextPolicy.sendRequest(e.clone()).then((function(r){return function(e,t,r){if(409===r.status){var i=function(e){var t,r;if(e){try{r=JSON.parse(e)}catch(e){}if(r&&r.error&&r.error.message&&r.error.code&&"MissingSubscriptionRegistration"===r.error.code){var i=r.error.message.match(/.*'(.*)'/i);i&&(t=i.pop())}}return t}(r.bodyAsText);if(i){var n=function(e){var t=e.match(/.*\/subscriptions\/[a-f0-9-]+\//gi);if(!t||!t[0])throw new Error("Unable to extract subscriptionId from the given url - "+e+".");return t[0]}(t.url);return function(e,t,r,i){var n=t+"providers/"+r+"/register?api-version=2016-02-01",o=t+"providers/"+r+"?api-version=2016-02-01",a=Ue(i);return a.method="POST",a.url=n,e._nextPolicy.sendRequest(a).then((function(t){if(200!==t.status)throw new Error("Autoregistration of "+r+" failed. Please try registering manually.");return function e(t,r,i){var n=Ue(i);return n.url=r,n.method="GET",t._nextPolicy.sendRequest(n).then((function(n){var o=n.parsedBody;return!(!n.parsedBody||!o.registrationState||"Registered"!==o.registrationState)||g(1e3*t._retryTimeout).then((function(){return e(t,r,i)}))}))}(e,o,i)}))}(e,n,i,t).catch((function(){return!1})).then((function(i){return i?(t.headers.set("x-ms-client-request-id",y()),e._nextPolicy.sendRequest(t.clone())):r}))}}return Promise.resolve(r)}(t,e,r)}))},qe);function qe(e,t,r){void 0===r&&(r=30);var i=Be.call(this,e,t)||this;return i._retryTimeout=r,i}function Ue(e,t){void 0===t&&(t=!1);var r=e.clone();return t&&(r.url=e.url),r.headers.set("x-ms-client-request-id",y()),r.headers.set("Content-Type","application/json; charset=utf-8"),r}var je,Ve=(A(Ge,je=Q),Ge.prototype.signRequest=function(e){return this.authenticationProvider.signRequest(e)},Ge.prototype.sendRequest=function(e){var t=this;return this.signRequest(e).then((function(e){return t._nextPolicy.sendRequest(e)}))},Ge);function Ge(e,t,r){var i=je.call(this,e,t)||this;return i.authenticationProvider=r,i}var He,Ze,We,Ke=(A(Xe,He=Q),Xe.prototype.sendRequest=function(e){var t=this;return this._nextPolicy.sendRequest(e.clone()).then((function(r){return function e(t,r,i,n,o){return n=function(e,t,r){t=t||{retryCount:0,retryInterval:0},r&&(t.error&&(r.innerError=t.error),t.error=r),t.retryCount++;var i=Math.pow(2,t.retryCount)-1;return i*=.8*e.retryInterval+Math.floor(Math.random()*(1.2*e.retryInterval-.8*e.retryInterval)),t.retryInterval=Math.min(e.minRetryInterval+i,e.maxRetryInterval),t}(t,n,o),o&&o.code&&function(e,t){if(!t)throw new Error("retryData for the SystemErrorRetryPolicyFilter cannot be null.");return(t&&t.retryCount)<e.retryCount}(t,n)&&("ETIMEDOUT"===o.code||"ESOCKETTIMEDOUT"===o.code||"ECONNREFUSED"===o.code||"ECONNRESET"===o.code||"ENOENT"===o.code)?g(n.retryInterval).then((function(){return t._nextPolicy.sendRequest(r.clone())})).then((function(i){return e(t,r,i,n,o)})).catch((function(o){return e(t,r,i,n,o)})):null!=o?(o=n.error,Promise.reject(o)):Promise.resolve(i)}(t,e,r)}))},Xe);function Xe(e,t,r,i,n,o){var a=He.call(this,e,t)||this;return a.DEFAULT_CLIENT_RETRY_INTERVAL=3e4,a.DEFAULT_CLIENT_RETRY_COUNT=3,a.DEFAULT_CLIENT_MAX_RETRY_INTERVAL=9e4,a.DEFAULT_CLIENT_MIN_RETRY_INTERVAL=3e3,a.retryCount="number"==typeof r?r:a.DEFAULT_CLIENT_RETRY_COUNT,a.retryInterval="number"==typeof i?i:a.DEFAULT_CLIENT_RETRY_INTERVAL,a.minRetryInterval="number"==typeof n?n:a.DEFAULT_CLIENT_MIN_RETRY_INTERVAL,a.maxRetryInterval="number"==typeof o?o:a.DEFAULT_CLIENT_MAX_RETRY_INTERVAL,a}(We=Ze=Ze||{}).Csv=",",We.Ssv=" ",We.Tsv="\t",We.Pipes="|",We.Multi="Multi";var Ye,Je=(A($e,Ye=Q),$e.prototype.sendRequest=function(e){return e.proxySettings||(e.proxySettings=this.proxySettings),this._nextPolicy.sendRequest(e)},$e);function $e(e,t,r){var i=Ye.call(this,e,t)||this;return i.proxySettings=r,i}var Qe,et=d.HttpConstants.StatusCodes,tt=(A(rt,Qe=Q),rt.prototype.sendRequest=function(e){return M(this,void 0,void 0,(function(){var t=this;return k(this,(function(r){return[2,this._nextPolicy.sendRequest(e.clone()).then((function(r){return r.status!==et.TooManyRequests?r:t._handleResponse(e,r)}))]}))}))},rt.prototype._defaultResponseHandler=function(e,t){return M(this,void 0,void 0,(function(){var r,i,n=this;return k(this,(function(o){return(r=t.headers.get(d.HeaderConstants.RETRY_AFTER))&&(i=rt.parseRetryAfterHeader(r))?[2,g(i).then((function(t){return n._nextPolicy.sendRequest(e)}))]:[2,t]}))}))},rt.parseRetryAfterHeader=function(e){var t=Number(e);return Number.isNaN(t)?rt.parseDateRetryAfterHeader(e):1e3*t},rt.parseDateRetryAfterHeader=function(e){try{var t=Date.now(),r=Date.parse(e)-t;return Number.isNaN(r)?void 0:r}catch(e){return}},rt);function rt(e,t,r){var i=Qe.call(this,e,t)||this;return i._handleResponse=r||i._defaultResponseHandler,i}var it,nt,ot,at,st,lt,ut,ct,pt,ht,dt,mt,ft,yt,gt,vt,_t,bt,xt,wt,St,Tt,Ct,Et,It,Pt,Rt,Nt,At,zt,Mt,kt,Ot,Lt,Dt,Bt,Ft,qt,Ut,jt,Vt,Gt,Ht,Zt,Wt,Kt,Xt,Yt,Jt,$t,Qt,er,tr,rr,ir,nr,or,ar,sr,lr,ur,cr,pr,hr,dr,mr,fr,yr,gr,vr,_r,br,xr,wr,Sr,Tr,Cr,Er,Ir,Pr,Rr,Nr,Ar,zr,Mr,kr,Or,Lr,Dr,Br,Fr,qr,Ur,jr,Vr,Gr,Hr,Zr,Wr,Kr,Xr,Yr,Jr,$r,Qr=(ei.prototype.sendRequest=function(e){if(null==e||"object"!=typeof e)throw new Error("options cannot be null or undefined and it must be of type object.");var t;try{t=e instanceof P?(e.validateRequestProperties(),e):(t=new P).prepare(e)}catch(e){return Promise.reject(e)}var r=this._httpClient;if(this._requestPolicyFactories&&0<this._requestPolicyFactories.length)for(var i=this._requestPolicyFactories.length-1;0<=i;--i)r=this._requestPolicyFactories[i].create(r,this._requestPolicyOptions);return r.sendRequest(t)},ei.prototype.sendOperationRequest=function(e,t,r){"function"==typeof e.options&&(r=e.options,e.options=void 0);var i,n=new P;try{var o=t.baseUrl||this.baseUri;if(!o)throw new Error("If operationSpec.baseUrl is not specified, then the ServiceClient must have a baseUri string property that contains the base URL to use.");n.method=t.httpMethod,n.operationSpec=t;var a=Se.parse(o);if(t.path&&a.appendPath(t.path),t.urlParameters&&0<t.urlParameters.length)for(var s=0,l=t.urlParameters;s<l.length;s++){var u=l[s],c=ri(this,e,u,t.serializer);c=t.serializer.serialize(u.mapper,c,G(u)),u.skipEncoding||(c=encodeURIComponent(c)),a.replaceAll("{"+(u.mapper.serializedName||G(u))+"}",c)}if(t.queryParameters&&0<t.queryParameters.length)for(var p=0,h=t.queryParameters;p<h.length;p++){var d=h[p],m=ri(this,e,d,t.serializer);if(null!=m){if(m=t.serializer.serialize(d.mapper,m,G(d)),null!=d.collectionFormat)if(d.collectionFormat===Ze.Multi)if(0===m.length)m="";else for(var f in m){var y=m[f];m[f]=null==y?"":y.toString()}else m=m.join(d.collectionFormat);if(!d.skipEncoding)if(Array.isArray(m))for(var f in m)m[f]=encodeURIComponent(m[f]);else m=encodeURIComponent(m);a.setQueryParameter(d.mapper.serializedName||G(d),m)}}n.url=a.toString();var g=t.contentType||this.requestContentType;if(g&&n.headers.set("Content-Type",g),t.headerParameters)for(var v=0,_=t.headerParameters;v<_.length;v++){var b=_[v],x=ri(this,e,b,t.serializer);if(null!=x){x=t.serializer.serialize(b.mapper,x,G(b));var w=b.mapper.headerCollectionPrefix;if(w)for(var S=0,T=Object.keys(x);S<T.length;S++){var C=T[S];n.headers.set(w+C,x[C])}else n.headers.set(b.mapper.serializedName||G(b),x)}}var E=e.options;if(E){if(E.customHeaders)for(var R in E.customHeaders)n.headers.set(R,E.customHeaders[R]);E.abortSignal&&(n.abortSignal=E.abortSignal),E.timeout&&(n.timeout=E.timeout),E.onUploadProgress&&(n.onUploadProgress=E.onUploadProgress),E.onDownloadProgress&&(n.onDownloadProgress=E.onDownloadProgress)}n.withCredentials=this._withCredentials,function(e,t,r,i){if(i.requestBody&&i.requestBody.mapper){t.body=ri(e,r,i.requestBody,i.serializer);var n=i.requestBody.mapper,o=n.required,a=n.xmlName,s=n.xmlElementName,l=n.serializedName,u=n.type.name;try{if(null!=t.body||o){var c=G(i.requestBody);t.body=i.serializer.serialize(n,t.body,c);var p=u===I.Stream;i.isXML?u===I.Sequence?t.body=J(function(e,t){var r;return Array.isArray(e)||(e=[e]),(r={})[t]=e,r}(t.body,s||a||l),{rootName:a||l}):p||(t.body=J(t.body,{rootName:a||l})):p||(t.body=JSON.stringify(t.body))}}catch(e){throw new Error('Error "'+e.message+'" occurred in serializing the payload - '+JSON.stringify(l,void 0,"  ")+".")}}else if(i.formDataParameters&&0<i.formDataParameters.length){t.formData={};for(var h=0,d=i.formDataParameters;h<d.length;h++){var m=d[h],f=ri(e,r,m,i.serializer);if(null!=f){var y=m.mapper.serializedName||G(m);t.formData[y]=i.serializer.serialize(m.mapper,f,G(m))}}}}(this,n,e,t),null==n.streamResponseBody&&(n.streamResponseBody=Z(t)),i=this.sendRequest(n).then((function(e){return ni(e,t.responses[e.status])}))}catch(e){i=Promise.reject(e)}var N=r;return N&&i.then((function(e){return N(null,e._response.parsedBody,e._response.request,e._response)})).catch((function(e){return N(e)})),i},ei);function ei(t,r){if(r=r||{},t&&!t.signRequest)throw new Error("credentials argument needs to implement signRequest method");var i;if(this._withCredentials=r.withCredentials||!1,this._httpClient=r.httpClient||new F,this._requestPolicyOptions=new te(r.httpPipelineLogger),Array.isArray(r.requestPolicyFactories))i=r.requestPolicyFactories;else if(i=function(t,r){var i=[];r.generateClientRequestIdHeader&&i.push(function(e){return void 0===e&&(e="x-ms-client-request-id"),{create:function(t,r){return new me(t,r,e)}}}(r.clientRequestIdHeaderName)),t&&(function(e){return"function"==typeof e.create}(t)?i.push(t):i.push(function(e){return{create:function(t,r){return new Ve(t,r,e)}}}(t)));var n=ti(r.userAgentHeaderName,ye),o=ti(r.userAgent,ge);n&&o&&i.push(function(e){var t=e&&null!=e.key?e.key:"x-ms-command-name",r=e&&null!=e.value?e.value:ge();return{create:function(e,i){return new _e(e,i,t,r)}}}({key:n,value:o})),i.push(function(e){return void 0===e&&(e=20),{create:function(t,r){return new Le(t,r,e)}}}()),i.push(function(e){return void 0===e&&(e=30),{create:function(t,r){return new Fe(t,r,e)}}}(r.rpRegistrationRetryTimeout)),r.noRetryPolicy||(i.push({create:function(e,t){return new ce(e,t,void 0,void 0,void 0,void 0)}}),i.push({create:function(e,t){return new Ke(e,t,void 0,void 0,void 0,void 0)}}),i.push({create:function(e,t){return new tt(e,t)}})),i.push(ie(r.deserializationContentTypes));var a=r.proxySettings||function(t){if(t=t||function(){if(e)return e.env[d.HTTPS_PROXY]?e.env[d.HTTPS_PROXY]:e.env[d.HTTPS_PROXY.toLowerCase()]?e.env[d.HTTPS_PROXY.toLowerCase()]:e.env[d.HTTP_PROXY]?e.env[d.HTTP_PROXY]:e.env[d.HTTP_PROXY.toLowerCase()]?e.env[d.HTTP_PROXY.toLowerCase()]:void 0}()){var r=Se.parse(t);return{host:r.getScheme()+"://"+r.getHost(),port:Number.parseInt(r.getPort()||"80")}}}();return a&&i.push(function(e){return{create:function(t,r){return new Je(t,r,e)}}}(a)),i}(t,r),r.requestPolicyFactories){var n=r.requestPolicyFactories(i);n&&(i=n)}this._requestPolicyFactories=i}function ti(e,t){var r;return"string"==typeof e?r=e:(r=t(),"function"==typeof e&&(r=e(r))),r}function ri(e,t,r,i){return function e(t,r,i,n,o){var a;if("string"==typeof i&&(i=[i]),Array.isArray(i)){if(0<i.length){if(n.isConstant)a=n.defaultValue;else{var s=ii(r,i);s.propertyFound||(s=ii(t,i));var l=!1;s.propertyFound||(l=n.required||"options"===i[0]&&2===i.length),a=l?n.defaultValue:s.propertyValue}var u=H(i,n);o.serialize(n,a,u)}}else for(var c in n.required&&(a={}),i){var p=n.type.modelProperties[c],h=i[c],d=e(t,r,h,p,o),m=H(h,p);o.serialize(p,d,m),void 0!==d&&((a=a||{})[c]=d)}return a}(e,t,r.parameterPath,r.mapper,i)}function ii(e,t){for(var r={propertyFound:!1},i=0;i<t.length;++i){var n=t[i];if(null==e||!(n in e))break;e=e[n]}return i===t.length&&(r.propertyValue=e,r.propertyFound=!0),r}function ni(e,t){function r(t){return Object.defineProperty(t,"_response",{value:e})}var i=e.parsedHeaders,n=t&&t.bodyMapper;if(n){var o=n.type.name;if("Stream"===o)return r(z({},i,{blobBody:e.blobBody,readableStreamBody:e.readableStreamBody}));var a="Composite"===o&&n.type.modelProperties||{},s=Object.keys(a).some((function(e){return""===a[e].serializedName}));if("Sequence"===o||s){for(var l=(e.parsedBody||[]).slice(),u=0,c=Object.keys(a);u<c.length;u++){var p=c[u];a[p].serializedName&&(l[p]=e.parsedBody[p])}if(i)for(var h=0,d=Object.keys(i);h<d.length;h++)l[p=d[h]]=i[p];return r(l),l}if("Composite"===o||"Dictionary"===o)return r(z({},i,e.parsedBody))}return n||"HEAD"===e.request.method?r(z({},i,{body:e.parsedBody})):r(z({},i,e.parsedBody))}(nt=it=it||{}).Country="Country",nt.CountrySubdivision="CountrySubdivision",nt.CountrySecondarySubdivision="CountrySecondarySubdivision",nt.CountryTertiarySubdivision="CountryTertiarySubdivision",nt.Municipality="Municipality",nt.MunicipalitySubdivision="MunicipalitySubdivision",nt.Neighbourhood="Neighbourhood",nt.PostalCodeArea="PostalCodeArea",(at=ot=ot||{}).Zero="0",at.One="1",at.Two="2",at.Three="3",at.Four="4",(lt=st=st||{}).TURN="TURN",lt.ROADCHANGE="ROAD_CHANGE",lt.LOCATIONDEPARTURE="LOCATION_DEPARTURE",lt.LOCATIONARRIVAL="LOCATION_ARRIVAL",lt.DIRECTIONINFO="DIRECTION_INFO",lt.LOCATIONWAYPOINT="LOCATION_WAYPOINT",(ct=ut=ut||{}).LEFT="LEFT",ct.RIGHT="RIGHT",(ht=pt=pt||{}).ARRIVE="ARRIVE",ht.ARRIVELEFT="ARRIVE_LEFT",ht.ARRIVERIGHT="ARRIVE_RIGHT",ht.DEPART="DEPART",ht.STRAIGHT="STRAIGHT",ht.KEEPRIGHT="KEEP_RIGHT",ht.BEARRIGHT="BEAR_RIGHT",ht.TURNRIGHT="TURN_RIGHT",ht.SHARPRIGHT="SHARP_RIGHT",ht.KEEPLEFT="KEEP_LEFT",ht.BEARLEFT="BEAR_LEFT",ht.TURNLEFT="TURN_LEFT",ht.SHARPLEFT="SHARP_LEFT",ht.MAKEUTURN="MAKE_UTURN",ht.ENTERMOTORWAY="ENTER_MOTORWAY",ht.ENTERFREEWAY="ENTER_FREEWAY",ht.ENTERHIGHWAY="ENTER_HIGHWAY",ht.TAKEEXIT="TAKE_EXIT",ht.MOTORWAYEXITLEFT="MOTORWAY_EXIT_LEFT",ht.MOTORWAYEXITRIGHT="MOTORWAY_EXIT_RIGHT",ht.TAKEFERRY="TAKE_FERRY",ht.ROUNDABOUTCROSS="ROUNDABOUT_CROSS",ht.ROUNDABOUTRIGHT="ROUNDABOUT_RIGHT",ht.ROUNDABOUTLEFT="ROUNDABOUT_LEFT",ht.ROUNDABOUTBACK="ROUNDABOUT_BACK",ht.TRYMAKEUTURN="TRY_MAKE_UTURN",ht.FOLLOW="FOLLOW",ht.SWITCHPARALLELROAD="SWITCH_PARALLEL_ROAD",ht.SWITCHMAINROAD="SWITCH_MAIN_ROAD",ht.ENTRANCERAMP="ENTRANCE_RAMP",ht.WAYPOINTLEFT="WAYPOINT_LEFT",ht.WAYPOINTRIGHT="WAYPOINT_RIGHT",ht.WAYPOINTREACHED="WAYPOINT_REACHED",(mt=dt=dt||{}).Bus="Bus",mt.CableCar="CableCar",mt.Ferry="Ferry",mt.Funicular="Funicular",mt.Gondola="Gondola",mt.Rail="Rail",mt.Tram="Tram",mt.Subway="Subway",(yt=ft=ft||{}).Walk="Walk",yt.Bicycle="Bicycle",yt.Tram="Tram",yt.Subway="Subway",yt.Rail="Rail",yt.Bus="Bus",yt.Ferry="Ferry",yt.Cable="Cable",yt.Gondola="Gondola",yt.Funicular="Funicular",yt.PathWayWalk="PathWayWalk",yt.Wait="Wait",yt.WaitOnVehicle="WaitOnVehicle",(vt=gt=gt||{}).Depart="depart",vt.HardLeft="hardLeft",vt.Left="left",vt.SlightlyLeft="slightlyLeft",vt.Continue="continue",vt.SlightlyRight="slightlyRight",vt.Right="right",vt.HardRight="hardRight",vt.CircleClockwise="circleClockwise",vt.CircleCounterclockwise="circleCounterclockwise",vt.Elevator="elevator",vt.UturnLeft="uturnLeft",vt.UturnRight="uturnRight",(bt=_t=_t||{}).North="north",bt.Northeast="northeast",bt.East="east",bt.Southeast="southeast",bt.South="south",bt.Southwest="southwest",bt.West="west",bt.Northwest="northwest",(wt=xt=xt||{}).ScheduledTime="scheduledTime",wt.RealTime="realTime",(Tt=St=St||{}).Addr="Addr",Tt.Geo="Geo",Tt.PAD="PAD",Tt.POI="POI",Tt.Str="Str",Tt.Xstr="Xstr",(Et=Ct=Ct||{}).StandardHouseholdCountrySpecific="StandardHouseholdCountrySpecific",Et.IEC62196Type1="IEC62196Type1",Et.IEC62196Type1CCS="IEC62196Type1CCS",Et.IEC62196Type2CableAttached="IEC62196Type2CableAttached",Et.IEC62196Type2Outlet="IEC62196Type2Outlet",Et.IEC62196Type2CCS="IEC62196Type2CCS",Et.IEC62196Type3="IEC62196Type3",Et.Chademo="Chademo",Et.IEC60309AC1PhaseBlue="IEC60309AC1PhaseBlue",Et.IEC60309DCWhite="IEC60309DCWhite",Et.Tesla="Tesla",(It=It||{}).NextSevenDays="nextSevenDays",(Rt=Pt=Pt||{}).USHazmatClass1="USHazmatClass1",Rt.USHazmatClass2="USHazmatClass2",Rt.USHazmatClass3="USHazmatClass3",Rt.USHazmatClass4="USHazmatClass4",Rt.USHazmatClass5="USHazmatClass5",Rt.USHazmatClass6="USHazmatClass6",Rt.USHazmatClass7="USHazmatClass7",Rt.USHazmatClass8="USHazmatClass8",Rt.USHazmatClass9="USHazmatClass9",Rt.OtherHazmatExplosive="otherHazmatExplosive",Rt.OtherHazmatGeneral="otherHazmatGeneral",Rt.OtherHazmatHarmfulToWater="otherHazmatHarmfulToWater",(At=Nt=Nt||{}).Fastest="fastest",At.Shortest="shortest",At.Eco="eco",At.Thrilling="thrilling",(Mt=zt=zt||{}).Low="low",Mt.Normal="normal",Mt.High="high",(Ot=kt=kt||{}).Low="low",Ot.Normal="normal",Ot.High="high",(Dt=Lt=Lt||{}).Car="car",Dt.Truck="truck",Dt.Taxi="taxi",Dt.Bus="bus",Dt.Van="van",Dt.Motorcycle="motorcycle",Dt.Bicycle="bicycle",Dt.Pedestrian="pedestrian",(Ft=Bt=Bt||{}).TollRoads="tollRoads",Ft.Motorways="motorways",Ft.Ferries="ferries",Ft.UnpavedRoads="unpavedRoads",Ft.Carpools="carpools",Ft.AlreadyUsedRoads="alreadyUsedRoads",Ft.BorderCrossings="borderCrossings",(Ut=qt=qt||{}).Combustion="combustion",Ut.Electric="electric",(Vt=jt=jt||{}).CarTrain="carTrain",Vt.Country="country",Vt.Ferry="ferry",Vt.Motorway="motorway",Vt.Pedestrian="pedestrian",Vt.TollRoad="tollRoad",Vt.TollVignette="tollVignette",Vt.Traffic="traffic",Vt.TravelMode="travelMode",Vt.Tunnel="tunnel",(Ht=Gt=Gt||{}).Polyline="polyline",Ht.SummaryOnly="summaryOnly",Ht.None="none",(Wt=Zt=Zt||{}).None="none",Wt.All="all",(Xt=Kt=Kt||{}).AnyRoute="anyRoute",Xt.BetterRoute="betterRoute",(Jt=Yt=Yt||{}).Coded="coded",Jt.Text="text",Jt.Tagged="tagged",(Qt=$t=$t||{}).None="none",Qt.ZoneInfo="zoneInfo",Qt.Transitions="transitions",Qt.All="all",(tr=er=er||{}).Png="png",tr.Pbf="pbf",(ir=rr=rr||{}).All="All",ir.EnterAndExit="EnterAndExit",(or=nr=nr||{}).Basic="basic",or.Hybrid="hybrid",or.Labels="labels",(sr=ar=ar||{}).Basic="basic",sr.Hybrid="hybrid",sr.Labels="labels",sr.Terra="terra",(ur=lr=lr||{}).Main="main",ur.ShadedRelief="shaded_relief",(pr=cr=cr||{}).Position="position",pr.CountryCode="countryCode",(dr=hr=hr||{}).Agencies="agencies",dr.Alerts="alerts",dr.AlertDetails="alertDetails",dr.TransitTypes="transitTypes",(fr=mr=mr||{}).Stop="stop",fr.DocklessBike="docklessBike",fr.DocklessElectricBike="docklessElectricBike",fr.DocklessElectricScooter="docklessElectricScooter",fr.DocklessScooter="docklessScooter",fr.DocklessMoped="docklessMoped",fr.CarShare="carShare",fr.DocklessVehicle="docklessVehicle",fr.BikeDock="bikeDock",(gr=yr=yr||{}).Alerts="alerts",gr.AlertDetails="alertDetails",gr.Lines="lines",gr.Stops="stops",gr.Schedule="schedule",gr.Patterns="patterns",(_r=vr=vr||{}).StopId="stopId",_r.StopKey="stopKey",(xr=br=br||{}).Alerts="alerts",xr.AlertDetails="alertDetails",xr.Lines="lines",xr.LineGroups="lineGroups",(Sr=wr=wr||{}).Position="position",Sr.StopId="stopId",Sr.StopKey="stopKey",(Cr=Tr=Tr||{}).Position="position",Cr.StopId="stopId",Cr.StopKey="stopKey",(Ir=Er=Er||{}).Walk="walk",Ir.Bike="bike",Ir.PublicTransit="publicTransit",(Rr=Pr=Pr||{}).Bus="bus",Rr.CableCar="cableCar",Rr.Ferry="ferry",Rr.Funicular="funicular",Rr.Gondola="gondola",Rr.Rail="rail",Rr.Tram="tram",Rr.Subway="subway",(Ar=Nr=Nr||{}).AgencyId="agencyId",Ar.AgencyKey="agencyKey",Ar.AgencyName="agencyName",(Mr=zr=zr||{}).Arrival="arrival",Mr.Departure="departure",Mr.Last="last",(Or=kr=kr||{}).Optimal="optimal",Or.LeastWalk="leastWalk",Or.LeastTransfers="leastTransfers",(Dr=Lr=Lr||{}).PrivateBike="privateBike",Dr.DockedBike="dockedBike",(Fr=Br=Br||{}).Geometry="geometry",Fr.Schedule="schedule",(Ur=qr=qr||{}).Stops="stops",Ur.Line="line",Ur.LineAndStop="lineAndStop",Ur.Position="position",(Vr=jr=jr||{}).StopId="stopId",Vr.StopKey="stopKey",(Hr=Gr=Gr||{}).Main="main",Hr.Minor="minor",(Zr=Zr||{}).Main="main",(Kr=Wr=Wr||{}).Yes="yes",Kr.No="no",(Yr=Xr=Xr||{}).Yes="yes",Yr.No="no",($r=Jr=Jr||{}).Yes="yes",$r.No="no";var oi=Object.freeze({get EntityType(){return it},get MagnitudeOfDelay(){return ot},get GuidanceInstructionType(){return st},get DrivingSide(){return ut},get GuidanceManeuver(){return pt},get TransitType(){return dt},get LegType(){return ft},get RelativeDirection(){return gt},get AbsoluteDirection(){return _t},get ScheduleType(){return xt},get SearchIndexSet(){return St},get ConnectorSet(){return Ct},get OpeningHours(){return It},get VehicleLoadType(){return Pt},get RouteType(){return Nt},get Windingness(){return zt},get Hilliness(){return kt},get TravelMode(){return Lt},get Avoid(){return Bt},get VehicleEngineType(){return qt},get SectionType(){return jt},get RouteRepresentation(){return Gt},get ComputeTravelTimeFor(){return Zt},get AlternativeRouteType(){return Kt},get RouteInstructionsType(){return Yt},get TimezoneOptions(){return $t},get TileFormat(){return er},get GeofenceMode(){return rr},get StaticMapLayer(){return nr},get MapTileLayer(){return ar},get MapTileStyle(){return lr},get MetroAreaQueryType(){return cr},get MetroAreaDetailType(){return hr},get ObjectType(){return mr},get TransitLineDetailType(){return yr},get TransitStopQueryType(){return vr},get TransitStopDetailType(){return br},get OriginType(){return wr},get DestinationType(){return Tr},get ModeType(){return Er},get TransitTypeFilter(){return Pr},get AgencyType(){return Nr},get TimeType(){return zr},get TransitRouteType(){return kr},get BikeType(){return Lr},get TransitItineraryDetailType(){return Br},get RealTimeArrivalsQueryType(){return qr},get StopQueryType(){return jr},get Type(){return Gr},get Style(){return Zr},get Text(){return Wr},get Text1(){return Xr},get Text2(){return Jr}}),ai=(Object.defineProperty(si.prototype,"aborted",{get:function(){return this._aborted},enumerable:!0,configurable:!0}),Object.defineProperty(si,"none",{get:function(){return new si(void 0,0)},enumerable:!0,configurable:!0}),si.timeout=function(e){return new si(void 0,e)},si.prototype.withTimeout=function(e){var t=new si(this,e);return this.children.push(t),t},si.prototype.withValue=function(e,t){var r=new si(this,0,e,t);return this.children.push(r),r},si.prototype.getValue=function(e){for(var t=this;t;t=t.parent)if(t.key===e)return t.value},si.prototype.abort=function(){var e=this;this.aborted||(this.cancelTimer(),this.onabort&&this.onabort.call(this),this.abortEventListeners.forEach((function(t){t.call(e,void 0)})),this.children.forEach((function(e){return e.cancelByParent()})),this._aborted=!0)},si.prototype.addEventListener=function(e,t){this.abortEventListeners.push(t)},si.prototype.removeEventListener=function(e,t){var r=this.abortEventListeners.indexOf(t);-1<r&&this.abortEventListeners.splice(r,1)},si.prototype.cancelByParent=function(){this.abort()},si.prototype.cancelTimer=function(){this.timer&&clearTimeout(this.timer)},si);function si(e,t,r,i){var n=this;void 0===t&&(t=0),this._aborted=!1,this.children=[],this.abortEventListeners=[],this.parent=e,this.key=r,this.value=i,0<t&&(this.timer=setTimeout((function(){n.abort.call(n)}),t),this.timer&&"function"==typeof this.timer.unref&&this.timer.unref())}var li=(ui.prototype.create=function(e,t){throw new Error("Method should be implemented in children classes.")},ui);function ui(){}var ci,pi=(A(hi,ci=Q),hi.prototype.sendRequest=function(e){return M(this,void 0,void 0,(function(){var t,r;return k(this,(function(i){switch(i.label){case 0:return r=(t=this._nextPolicy).sendRequest,[4,this.signRequest(e)];case 1:return[2,r.apply(t,[i.sent()])]}}))}))},hi.prototype.signRequest=function(e){return e},hi);function hi(){return null!==ci&&ci.apply(this,arguments)||this}var di,mi=(A(fi,di=pi),fi.prototype.signRequest=function(e){return M(this,void 0,void 0,(function(){var t,r,i,n;return k(this,(function(o){switch(o.label){case 0:return[4,this.map.authentication.initialize()];case 1:if(o.sent(),(t=this.map.authentication.signRequest({url:e.url})).headers)for(r=0,i=Object.keys(t.headers);r<i.length;r++)n=i[r],e.headers.set(n,t.headers[n]);return e.url=t.url,[2,e]}}))}))},fi);function fi(e,t,r){var i=di.call(this,e,t)||this;return i.map=r,i}var yi,gi=(A(vi,yi=li),vi.prototype.create=function(e,t){return new mi(e,t,this.map)},vi);function vi(e){var t=yi.call(this)||this;return t.map=e,t}function _i(e){return new Promise((function(t,i){var n=[];e.on("error",(function(e){return i(e)})),e.on("data",(function(e){return n.push(e)})),e.on("end",(function(){return t(r.concat(n))}))}))}function bi(e){return M(this,void 0,void 0,(function(){var t;return k(this,(function(r){switch(r.label){case 0:return t=Uint8Array.bind,[4,new Response(e).arrayBuffer()];case 1:return[2,new(t.apply(Uint8Array,[void 0,r.sent()]))]}}))}))}function xi(e){for(var t=[1/0,1/0,-1/0,-1/0],r=0,i=e;r<i.length;r++){var n=i[r];switch(n.geometry.type){case"Point":wi(t,n.geometry.coordinates);break;case"MultiPoint":n.geometry.coordinates.forEach((function(e){return wi(t,e)}));break;case"LineString":Si(t,n.geometry.coordinates);break;case"MultiLineString":n.geometry.coordinates.forEach((function(e){return Si(t,e)}));break;case"Polygon":Ti(t,n.geometry.coordinates);break;case"MultiPolygon":n.geometry.coordinates.forEach((function(e){return Ti(t,e)}));break;default:throw new Error("The geometry type "+n.geometry.type+" isn't supported")}}return t}function wi(e,t){e[0]=Math.min(e[0],t[0]),e[1]=Math.min(e[1],t[1]),e[2]=Math.max(e[2],t[0]),e[3]=Math.max(e[3],t[1])}function Si(e,t){for(var r=0,i=t;r<i.length;r++){var n=i[r];e[0]=Math.min(e[0],n[0]),e[1]=Math.min(e[1],n[1]),e[2]=Math.max(e[2],n[0]),e[3]=Math.max(e[3],n[1])}}function Ti(e,t){for(var r=0,i=t;r<i.length;r++)for(var n=0,o=i[r];n<o.length;n++){var a=o[n];e[0]=Math.min(e[0],a[0]),e[1]=Math.min(e[1],a[1]),e[2]=Math.max(e[2],a[0]),e[3]=Math.max(e[3],a[1])}}var Ci,Ei=(A(Ii,Ci=pi),Ii.prototype.signRequest=function(e){return e.url=function(e,t,r){var i=new RegExp("([?&]+"+t+"=)[^&]*","g"),n=!1;return e=e.replace(i,(function(e,t){return n=!0,t+r})),n||(e.includes("?")?e+="&"+t+"="+r:e+="?"+t+"="+r),e}(e.url,"subscription-key",this.subscriptionKey),e},Ii);function Ii(e,t,r){var i=Ci.call(this,e,t)||this;return i.subscriptionKey=r,i}var Pi,Ri=(A(Ni,Pi=li),Ni.prototype.create=function(e,t){return new Ei(e,t,this.subscriptionKey)},Ni);function Ni(e){var t=Pi.call(this)||this;return t.subscriptionKey=e,t}var Ai,zi="ServiceModule",Mi=(A(ki,Ai=pi),ki.prototype.signRequest=function(e){return e.headers||(e.headers=new n),e.headers.set("authorization",this.authorizationScheme+" "+this.tokenCredential.token),e.headers.set("x-ms-client-id",this.tokenCredential.clientId),e},ki);function ki(e,t,r){var i=Ai.call(this,e,t)||this;return i.tokenCredential=r,i.authorizationScheme="Bearer",i}var Oi,Li=(A(Di,Oi=li),Di.prototype.create=function(e,t){return new Mi(e,t,this)},Di);function Di(e,t){var r=Oi.call(this)||this;return r.clientId=e,r.token=t,r}var Bi,Fi=(qi.prototype.toServiceClientOptions=function(){return{httpClient:this.options.HTTPClient,httpPipelineLogger:this.options.logger,requestPolicyFactories:this.factories}},qi);function qi(e,t){void 0===t&&(t={}),this.factories=e,this.options=t}(Bi=t.RetryPolicyType||(t.RetryPolicyType={})).EXPONENTIAL="exponential",Bi.FIXED="fixed";var Ui,ji={maxRetryDelayInMs:12e4,maxTries:4,retryDelayInMs:4e3,retryPolicyType:t.RetryPolicyType.EXPONENTIAL},Vi=(A(Gi,Ui=Q),Gi.prototype.sendRequest=function(e){return M(this,void 0,void 0,(function(){return k(this,(function(t){return[2,this.attemptSendRequest(e,1)]}))}))},Gi.prototype.attemptSendRequest=function(e,r){return M(this,void 0,void 0,(function(){var i,n,o;return k(this,(function(a){switch(a.label){case 0:i=e.clone(),a.label=1;case 1:return a.trys.push([1,3,,4]),this.logf(t.HttpPipelineLogLevel.INFO,"RetryPolicy: =====> Try="+r),[4,this._nextPolicy.sendRequest(i)];case 2:return n=a.sent(),this.shouldRetry(r,n)?[3,4]:[2,n];case 3:if(o=a.sent(),this.logf(t.HttpPipelineLogLevel.ERROR,"RetryPolicy: Caught error, message: "+o.message+", code: "+o.code),!this.shouldRetry(r,n,o))throw o;return[3,4];case 4:return[4,this.delay(r)];case 5:return a.sent(),[4,this.attemptSendRequest(e,++r)];case 6:return[2,a.sent()]}}))}))},Gi.prototype.shouldRetry=function(e,r,i){if(e>=this.retryOptions.maxTries)return this.logf(t.HttpPipelineLogLevel.INFO,"RetryPolicy: Attempt(s) "+e+" >= maxTries "+this.retryOptions.maxTries+", no further try."),!1;if(i)for(var n=0,o=["ETIMEDOUT","ESOCKETTIMEDOUT","ECONNREFUSED","ECONNRESET","ENOENT","ENOTFOUND","TIMEOUT","REQUEST_SEND_ERROR"];n<o.length;n++){var a=o[n];if(i.name.toUpperCase().includes(a)||i.message.toUpperCase().includes(a)||i.code&&i.code.toUpperCase().includes(a))return this.logf(t.HttpPipelineLogLevel.INFO,"RetryPolicy: Network error "+a+" found, will retry."),!0}if(r||i){var s=r?r.status:i?i.statusCode:0;if(503===s||500===s)return this.logf(t.HttpPipelineLogLevel.INFO,"RetryPolicy: Will retry for status code "+s+"."),!0}return!1},Gi.prototype.logf=function(e,t){},Gi.prototype.delay=function(e){return M(this,void 0,void 0,(function(){var r;return k(this,(function(i){switch(r=0,this.retryOptions.retryPolicyType){case t.RetryPolicyType.EXPONENTIAL:r=Math.min((Math.pow(2,e)-1)*this.retryOptions.retryDelayInMs,this.retryOptions.maxRetryDelayInMs);break;case t.RetryPolicyType.FIXED:r=this.retryOptions.retryDelayInMs}return this.logf(t.HttpPipelineLogLevel.INFO,"RetryPolicy: Delay for "+r+"ms"),[2,g(r)]}))}))},Gi);function Gi(e,t,r){void 0===r&&(r=ji);var i=Ui.call(this,e,t)||this;return i.retryOptions={retryPolicyType:"string"==typeof r.retryPolicyType?r.retryPolicyType:ji.retryPolicyType,maxTries:"number"==typeof r.maxTries&&1<=r.maxTries?Math.floor(r.maxTries):ji.maxTries,retryDelayInMs:"number"==typeof r.retryDelayInMs&&0<=r.retryDelayInMs?Math.min(r.retryDelayInMs,"number"==typeof r.maxRetryDelayInMs?r.maxRetryDelayInMs:ji.maxRetryDelayInMs):ji.retryDelayInMs,maxRetryDelayInMs:"number"==typeof r.maxRetryDelayInMs&&0<=r.maxRetryDelayInMs?r.maxRetryDelayInMs:ji.maxRetryDelayInMs},i}var Hi=(Zi.prototype.create=function(e,t){return new Vi(e,t,this.retryOptions)},Zi);function Zi(e){this.retryOptions=e}var Wi,Ki={logWarningIfTryOverThreshold:3e3},Xi=(A(Yi,Wi=Q),Yi.prototype.sendRequest=function(e){return M(this,void 0,void 0,(function(){var r,i,n,o,a,s,l,u,c,p;return k(this,(function(h){switch(h.label){case 0:this.tryCount++,this.requestStartTime=new Date,1===this.tryCount&&(this.operationStartTime=this.requestStartTime),r=e.url,this.log(t.HttpPipelineLogLevel.INFO,"'"+r+"'==> OUTGOING REQUEST (Try number="+this.tryCount+")."),h.label=1;case 1:return h.trys.push([1,3,,4]),[4,this._nextPolicy.sendRequest(e)];case 2:return i=h.sent(),n=new Date,o=n.getTime()-this.requestStartTime.getTime(),a=n.getTime()-this.operationStartTime.getTime(),s=t.HttpPipelineLogLevel.INFO,l="",this.shouldLog(t.HttpPipelineLogLevel.INFO)&&(l="Successfully Received Response. "),o>=this.loggingOptions.logWarningIfTryOverThreshold&&this.shouldLog(t.HttpPipelineLogLevel.WARNING)&&(s=t.HttpPipelineLogLevel.WARNING,l="SLOW OPERATION. Duration > "+this.loggingOptions.logWarningIfTryOverThreshold+" ms. "),(400<=i.status&&i.status<=499&&404!==i.status&&409!==i.status&&412!==i.status&&416!==i.status||500<=i.status&&i.status<=509)&&(u="REQUEST ERROR: HTTP request failed with status code: "+i.status+". ",l=u,s=t.HttpPipelineLogLevel.ERROR),c="Request try:"+this.tryCount+", status:"+i.status+" request duration:"+o+" ms, operation duration:"+a+" ms\n",this.log(s,l+c),[2,i];case 3:throw p=h.sent(),this.log(t.HttpPipelineLogLevel.ERROR,"Unexpected failure attempting to make request. Error message: "+p.message),p;case 4:return[2]}}))}))},Yi);function Yi(e,t,r){void 0===r&&(r=Ki);var i=Wi.call(this,e,t)||this;return i.tryCount=0,i.operationStartTime=new Date,i.requestStartTime=new Date,i.loggingOptions=r,i}var Ji=($i.prototype.create=function(e,t){return new Xi(e,t,this.loggingOptions)},$i);function $i(e){this.loggingOptions=e}var Qi=(en.prototype.getOperationStatus=function(){return this._pollState.state},en.prototype.isFinished=function(){return sn(this._pollState.state)},en.prototype.pollUntilFinished=function(){return M(this,void 0,void 0,(function(){return k(this,(function(e){switch(e.label){case 0:return this.isFinished()?[3,3]:[4,g(1e3*function(e,t){var r=30;if(null!=e.longRunningOperationRetryTimeout)r=e.longRunningOperationRetryTimeout;else{var i=t.headers.get("retry-after");if(i){var n=parseInt(i);Number.isNaN(n)||(r=n)}}return r}(this._azureServiceClient,this._pollState.mostRecentResponse))];case 1:return e.sent(),[4,this.sendPollRequest()];case 2:return e.sent(),[3,0];case 3:return[2,this.isFinalStatusAcceptable()]}}))}))},en.prototype.shouldDoFinalGetResourceRequest=function(){var e=this._pollState.initialResponse.request.method;return!this._pollState.resource&&("PUT"===e||"PATCH"===e||"POST"===e)},en.prototype.getMostRecentResponse=function(){return this._pollState.mostRecentResponse},en.prototype.getOperationResponse=function(){return M(this,void 0,void 0,(function(){var e,t,r;return k(this,(function(i){switch(i.label){case 0:return this.shouldDoFinalGetResourceRequest()?[4,this.doFinalGetResourceRequest()]:[3,2];case 1:i.sent(),i.label=2;case 2:return e=this._pollState.mostRecentResponse,t=z({},e,{headers:e.headers.clone()}),(r=this._pollState.resource)?"string"==typeof r.valueOf()?(t.bodyAsText=r,t.parsedBody=JSON.parse(r)):(t.bodyAsText=JSON.stringify(r),t.parsedBody=r):(t.bodyAsText=e.bodyAsText,t.parsedBody=e.parsedBody),[2,t]}}))}))},en.prototype.getRestError=function(){var e=new L("");if(e.request=f(this._pollState.mostRecentRequest),e.response=this._pollState.mostRecentResponse,e.message='Long running operation failed with status: "'+this._pollState.state+'".',e.body=this._pollState.resource,e.body){var t=e.body.error;t&&(t.message&&(e.message='Long running operation failed with error: "'+t.message+'".'),t.code&&(e.code=t.code))}return e},en.prototype.updateState=function(e,t){var r=this;return this.updateOperationStatus(e,t).then((function(e){r._pollState.state=rn(e.parsedBody)||"Succeeded",r._pollState.mostRecentResponse=e,r._pollState.mostRecentRequest=e.request,r._pollState.resource=nn(e)})).catch((function(e){var t;if(!e.response||!e.response.status)throw e;if(t=e.response.status,"DELETE"!==r._pollState.initialResponse.request.method||t<400||499<t)throw e}))},en.prototype.updateOperationStatus=function(e,t){var r=e.replace(" ","%20"),i=new P(r,"GET"),n=this._pollState;i.operationSpec=n.mostRecentRequest.operationSpec,i.shouldDeserialize=t,i.operationResponseGetter=tn;var o=n.options;if(o&&o.customHeaders)for(var a=o.customHeaders,s=0,l=Object.keys(a);s<l.length;s++){var u=l[s];i.headers.set(u,a[u])}return this._azureServiceClient.sendRequest(i)},en.prototype.getPollState=function(){return this._pollState},en);function en(e,t){this._azureServiceClient=e,this._pollState=t}function tn(e,t){var r=t.status,i=e.responses,n=i[r];return n||(200===r?n=i[201]||i[202]:201<=r&&r<=299&&(n={})),n}function rn(e){var t;return e&&(e.provisioningState?t=e.provisioningState:e.properties&&(t=e.properties.provisioningState)),t}function nn(e){var t;try{e.parsedBody?t=e.parsedBody:e.bodyAsText&&0<e.bodyAsText.length&&(t=JSON.parse(e.bodyAsText))}catch(t){var r=new L('Error "'+t+'" occurred in parsing the responseBody " +\n      "while creating the PollingState for Long Running Operation- "'+e.bodyAsText+'"');throw r.request=e.request,r.response=e,r}return t}function on(e,t){var r;switch(null==t&&(t=nn(e)),e.status){case 202:r="InProgress";break;case 204:r="Succeeded";break;case 201:r=rn(t)||"InProgress";break;case 200:r=rn(t)||(mn(e)||cn(e)?"InProgress":"Succeeded");break;default:r="Failed"}return r}var an=["Succeeded","Failed","Canceled","Cancelled"];function sn(e){for(var t=!1,r=0,i=an;r<i.length;r++)if(ln(e,i[r])){t=!0;break}return t}function ln(e,t){return(e&&e.toLowerCase())===(t&&t.toLowerCase())}function un(e,t){var r;switch(t.pollStrategyType){case"AzureAsyncOperation":r=new yn(e,t);break;case"Location":r=new hn(e,t);break;case"GetResource":r=new _n(e,t);break;default:throw new Error('Unrecognized LRO poll strategy type: "'+t.pollStrategyType+'"')}return r}function cn(e){return e.headers.get("location")}var pn,hn=(A(dn,pn=Qi),dn.prototype.locationStrategyShouldDeserialize=function(e){var t=!1,r=this._pollState.initialResponse.request.method,i=e.status;return 200!==i&&(201!==i||"PUT"!==r&&"PATCH"!==r)&&(204!==i||"DELETE"!==r&&"POST"!==r)||(t=!0),t},dn.prototype.sendPollRequest=function(){var e=this._pollState;return this.updateOperationStatus(e.locationHeaderValue,this.locationStrategyShouldDeserialize.bind(this)).then((function(t){var r=cn(t);r&&(e.locationHeaderValue=r),e.mostRecentResponse=t,e.mostRecentRequest=t.request;var i=e.initialResponse,n=i.request.method,o=i.status,a=t.status;if(202===a)e.state="InProgress";else if(200===a||201===a&&("PUT"===n||"PATCH"===n)||204===a&&("DELETE"===n||"POST"===n))e.state="Succeeded",e.resource=nn(t);else{if(404!==a||"POST"!==n||200!==o&&201!==o&&202!==o){if(400<=a&&a<=499){var s=t.bodyAsText,l=s;try{l=JSON.parse(s).message}catch(t){}throw new L(l,void 0,a,f(t.request),t,s)}throw new Error("The response with status code "+a+' from polling for long running operation url "'+e.locationHeaderValue+'" is not valid.')}e.state="Failed",e.resource=nn(t)}}))},dn.prototype.isFinalStatusAcceptable=function(){var e=this._pollState,t=e.initialResponse,r=t.status;return ln(e.state,"Succeeded")||"POST"===t.request.method&&404===e.mostRecentResponse.status&&(200===r||201===r||202===r)},dn.prototype.shouldDoFinalGetResourceRequest=function(){var e=this._pollState,t=e.initialResponse,r=t.request.method,i=t.status;return("POST"!==r||404!==e.mostRecentResponse.status||200!==i&&201!==i&&202!==i)&&(pn.prototype.shouldDoFinalGetResourceRequest.call(this)||"POST"===r&&201===i)},dn.prototype.doFinalGetResourceRequest=function(){var e,t=this._pollState,r=t.initialResponse,i=r.status,n=r.request;return e="POST"!==n.method||200!==i&&201!==i&&202!==i?n.url:t.locationHeaderValue,this.updateState(e,!0)},dn);function dn(){return null!==pn&&pn.apply(this,arguments)||this}function mn(e){return e.headers.get("azure-asyncoperation")}var fn,yn=(A(gn,fn=Qi),gn.prototype.sendPollRequest=function(){var e=this._pollState;return this.updateOperationStatus(e.azureAsyncOperationHeaderValue,!1).then((function(t){var r=t.status,i=t.parsedBody;if(200!==r&&201!==r&&202!==r&&204!==r){var n=new L("Invalid status code ("+r+') with response body "'+t.bodyAsText+'" occurred when polling for operation status.');throw n.statusCode=r,n.request=f(t.request),n.response=t,n.body=i,n}if(!i)throw new Error("The response from long running operation does not contain a body.");if(!i.status)throw new Error('The response "'+t.bodyAsText+'" from long running operation does not contain the status property.');var o=mn(t);o&&(e.azureAsyncOperationHeaderValue=o),e.state=i.status,e.mostRecentResponse=t,e.mostRecentRequest=t.request,e.resource=nn(t)}))},gn.prototype.shouldDoFinalGetResourceRequest=function(){var e=this._pollState,t=e.initialResponse,r=t.request.method,i=!1;if("PUT"===r||"PATCH"===r)i=!0;else if(e.locationHeaderValue){var n=t.status;"POST"===r?i=200===n||201===n:"DELETE"===r&&(i=200===n||202===n)}return i},gn.prototype.doFinalGetResourceRequest=function(){var e=this._pollState,t=e.locationHeaderValue,r=e.initialResponse,i=r.request,n=i.url;if(t){var o=i.method,a=r.status;("POST"!==o||200!==a&&201!==a&&202!==a)&&("DELETE"!==o||200!==a&&202!==a)||(n=t)}return this.updateState(n,!0)},gn.prototype.isFinalStatusAcceptable=function(){var e=this._pollState,t=e.initialResponse,r=t.status;return ln(e.state,"Succeeded")||"POST"===t.request.method&&(200===r||201===r)},gn);function gn(){return null!==fn&&fn.apply(this,arguments)||this}var vn,_n=(A(bn,vn=Qi),bn.prototype.sendPollRequest=function(){var e=this._pollState;return this.updateOperationStatus(e.initialResponse.request.url,!1).then((function(t){var r=t.status,i=t.parsedBody;if(200!==r&&201!==r&&202!==r&&204!==r){var n=new L('Invalid status code with response body "'+t.bodyAsText+'" occurred when polling for operation status.');throw n.statusCode=r,n.request=f(t.request),n.response=t,n.body=i,n}if(!t.parsedBody)throw new Error("The response from long running operation does not contain a body.");e.state=rn(t.parsedBody)||"Succeeded",e.mostRecentResponse=t,e.mostRecentRequest=t.request,e.resource=nn(t)}))},bn.prototype.isFinalStatusAcceptable=function(){return ln(this._pollState.state,"Succeeded")},bn.prototype.doFinalGetResourceRequest=function(){return this.sendPollRequest()},bn);function bn(){return null!==vn&&vn.apply(this,arguments)||this}var xn=(wn.prototype.getInitialResponse=function(){return this._initialResponse},wn.prototype.getMostRecentResponse=function(){var e=this._lroPollStrategy;return e?e.getMostRecentResponse():this._initialResponse},wn.prototype.isFinished=function(){var e=this._lroPollStrategy;return!e||e.isFinished()},wn.prototype.isFinalStatusAcceptable=function(){var e,t=this._lroPollStrategy;return t?t.isFinished()&&(e=t.isFinalStatusAcceptable()):e=!0,e},wn.prototype.getOperationStatus=function(){var e=this._lroPollStrategy;return e?e.getOperationStatus():"Succeeded"},wn.prototype.getOperationResponse=function(){var e,t=this._lroPollStrategy;if(t)if(t.isFinished()){if(!t.isFinalStatusAcceptable())throw t.getRestError();e=t.getOperationResponse()}else e=Promise.resolve(void 0);else e=Promise.resolve(this._initialResponse);return e},wn.prototype.poll=function(){var e=this._lroPollStrategy;return e?e.sendPollRequest().then((function(){return e.getOperationStatus()})):Promise.resolve("Succeeded")},wn.prototype.pollUntilFinished=function(){return M(this,void 0,void 0,(function(){var e;return k(this,(function(t){return[2,(e=this._lroPollStrategy)?e.pollUntilFinished().then((function(t){if(t)return e.getOperationResponse().then(Tn);throw e.getRestError()})):Promise.resolve(Tn(this._initialResponse))]}))}))},wn.prototype.getPollState=function(){var e=this._lroPollStrategy;return e?e.getPollState():void 0},wn);function wn(e,t){this._lroPollStrategy=e,this._initialResponse=t}function Sn(e,t,r){var i=function(e,t,r){var i,n,o=e.request.method,a=e.status;if(mn(e))i="AzureAsyncOperation";else if(cn(e))i="Location";else if("PUT"===o||"PATCH"===o)i="GetResource";else if(201!==a&&202!==a&&!sn(on(e)))throw new Error("Can't determine long running operation polling strategy.");if(i){var s=nn(e);n=un(t,{pollStrategyType:i,options:r,initialResponse:e,mostRecentResponse:e,mostRecentRequest:e.request,azureAsyncOperationHeaderValue:mn(e),locationHeaderValue:cn(e),resource:s,state:on(e,s)})}else n=void 0;return n}(t,e,r);return new xn(i,t)}function Tn(e){var t=e.request,r=t.operationResponseGetter,i=t.operationSpec;return ni(e,r&&i&&r(i,e))}var Cn,En=(A(In,Cn=Qr),In.prototype.sendLRORequest=function(e,t,r){var i=this;return this.sendOperationRequest(e,t).then((function(e){return Sn(i,e._response,r)}))},In.prototype.sendLongRunningRequest=function(e,t){return this.beginLongRunningRequest(e,t).then((function(e){return e.pollUntilFinished()})).then((function(e){return e._response}))},In.prototype.beginLongRunningRequest=function(e,t){var r=this;return this.sendRequest(e).then((function(e){return Sn(r,e,t)}))},In.prototype.restoreLROPoller=function(e){return function(e,t){var r=un(e,t);return new xn(r,t.initialResponse)}(this,e)},In);function In(e,t){var r=Cn.call(this,e,t=function(e){return null==(e=e||{}).generateClientRequestIdHeader&&(e.generateClientRequestIdHeader=!0),e.userAgent||(e.userAgent=Pn()),e}(t))||this;r.acceptLanguage="en-us";var i=e.environment;return i&&!r.baseUri&&(r.baseUri=i.resourceManagerEndpointUrl),null!=t.acceptLanguage&&(r.acceptLanguage=t.acceptLanguage),null!=t.longRunningOperationRetryTimeout&&(r.longRunningOperationRetryTimeout=t.longRunningOperationRetryTimeout),r}function Pn(){return"ms-rest-azure-js/1.3.7 "+ge()}var Rn={serializedName:"CloudError",type:{name:"Composite",className:"CloudError",modelProperties:{code:{required:!0,serializedName:"code",type:{name:"String"}},message:{required:!0,serializedName:"message",type:{name:"String"}},target:{serializedName:"target",type:{name:"String"}},details:{serializedName:"details",type:{name:"Sequence",element:{serializedName:"CloudErrorElementType",type:{name:"Composite",className:"CloudError"}}}},innerError:{required:!1,serializedName:"innererror",type:{name:"Object"}},additionalInfo:{required:!1,serializedName:"additionalInfo",type:{name:"Composite",className:"AdditionalInfoElement",modelProperties:{type:{required:!0,serializedName:"type",type:{name:"String"}},info:{required:!1,serializedName:"info",type:{name:"Object"}}}}}}}},Nn={serializedName:"BatchResponse_summary",type:{name:"Composite",className:"BatchResponseSummary",modelProperties:{successfulRequests:{readOnly:!0,serializedName:"successfulRequests",type:{name:"Number"}},totalRequests:{readOnly:!0,serializedName:"totalRequests",type:{name:"Number"}}}}},An={serializedName:"BatchResponse",type:{name:"Composite",className:"BatchResponse",modelProperties:{summary:{readOnly:!0,serializedName:"summary",type:{name:"Composite",className:"BatchResponseSummary"}},batchItems:{readOnly:!0,serializedName:"batchItems",type:{name:"Sequence",element:{type:{name:"Object"}}}}}}},zn={serializedName:"BatchRequestBody_batchItemsItem",type:{name:"Composite",className:"BatchRequestBodyBatchItemsItem",modelProperties:{query:{serializedName:"query",type:{name:"String"}}}}},Mn={serializedName:"BatchRequestBody",type:{name:"Composite",className:"BatchRequestBody",modelProperties:{batchItems:{serializedName:"batchItems",type:{name:"Sequence",element:{type:{name:"Composite",className:"BatchRequestBodyBatchItemsItem"}}}}}}},kn={serializedName:"GeoJSONGeometry",type:{name:"Composite",polymorphicDiscriminator:{serializedName:"type",clientName:"type"},uberParent:"GeoJSONGeometry",className:"GeoJSONGeometry",modelProperties:{type:{required:!0,serializedName:"type",type:{name:"String"}}}}},On={serializedName:"LineString",type:{name:"Composite",polymorphicDiscriminator:kn.type.polymorphicDiscriminator,uberParent:"GeoJSONGeometry",className:"LineString",modelProperties:z(z({},kn.type.modelProperties),{coordinates:{required:!0,serializedName:"coordinates",type:{name:"Sequence",element:{type:{name:"Sequence",element:{type:{name:"Number"}}}}}}})}},Ln={serializedName:"SearchPolygonResponse",type:{name:"Composite",className:"SearchPolygonResponse",modelProperties:{additionalData:{readOnly:!0,serializedName:"additionalData",type:{name:"Sequence",element:{type:{name:"Composite",className:"SearchPolygonResult"}}}}}}},Dn={serializedName:"SearchFuzzyResponse",type:{name:"Composite",className:"SearchFuzzyResponse",modelProperties:{summary:{serializedName:"summary",type:{name:"Composite",className:"SearchFuzzySummary"}},results:{readOnly:!0,serializedName:"results",type:{name:"Sequence",element:{type:{name:"Composite",className:"SearchFuzzyResult"}}}}}}},Bn={serializedName:"SearchPoiResponse",type:{name:"Composite",className:"SearchPoiResponse",modelProperties:{summary:{serializedName:"summary",type:{name:"Composite",className:"SearchPoiSummary"}},results:{readOnly:!0,serializedName:"results",type:{name:"Sequence",element:{type:{name:"Composite",className:"SearchPoiResult"}}}}}}},Fn={serializedName:"SearchNearbyResponse",type:{name:"Composite",className:"SearchNearbyResponse",modelProperties:{summary:{serializedName:"summary",type:{name:"Composite",className:"SearchNearbySummary"}},results:{readOnly:!0,serializedName:"results",type:{name:"Sequence",element:{type:{name:"Composite",className:"SearchNearbyResult"}}}}}}},qn={serializedName:"SearchPoiCategoryResponse",type:{name:"Composite",className:"SearchPoiCategoryResponse",modelProperties:{summary:{serializedName:"summary",type:{name:"Composite",className:"SearchPoiCategorySummary"}},results:{readOnly:!0,serializedName:"results",type:{name:"Sequence",element:{type:{name:"Composite",className:"SearchPoiCategoryResult"}}}}}}},Un={serializedName:"SearchAddressResponse",type:{name:"Composite",className:"SearchAddressResponse",modelProperties:{summary:{serializedName:"summary",type:{name:"Composite",className:"SearchAddressSummary"}},results:{readOnly:!0,serializedName:"results",type:{name:"Sequence",element:{type:{name:"Composite",className:"SearchAddressResult"}}}}}}},jn={serializedName:"SearchAddressReverseResponse",type:{name:"Composite",className:"SearchAddressReverseResponse",modelProperties:{summary:{serializedName:"summary",type:{name:"Composite",className:"SearchAddressReverseSummary"}},addresses:{readOnly:!0,serializedName:"addresses",type:{name:"Sequence",element:{type:{name:"Composite",className:"SearchAddressReverseResult"}}}}}}},Vn={serializedName:"SearchAddressReverseCrossStreetResponse",type:{name:"Composite",className:"SearchAddressReverseCrossStreetResponse",modelProperties:{summary:{serializedName:"summary",type:{name:"Composite",className:"SearchAddressReverseCrossStreetSummary"}},addresses:{readOnly:!0,serializedName:"addresses",type:{name:"Sequence",element:{type:{name:"Composite",className:"SearchAddressReverseCrossStreetResult"}}}}}}},Gn={serializedName:"SearchAddressStructuredResponse",type:{name:"Composite",className:"SearchAddressStructuredResponse",modelProperties:{summary:{serializedName:"summary",type:{name:"Composite",className:"SearchAddressStructuredSummary"}},results:{readOnly:!0,serializedName:"results",type:{name:"Sequence",element:{type:{name:"Composite",className:"SearchAddressStructuredResult"}}}}}}},Hn={serializedName:"SearchGeometryResponse",type:{name:"Composite",className:"SearchGeometryResponse",modelProperties:{summary:{serializedName:"summary",type:{name:"Composite",className:"SearchGeometrySummary"}},results:{readOnly:!0,serializedName:"results",type:{name:"Sequence",element:{type:{name:"Composite",className:"SearchGeometryResult"}}}}}}},Zn={serializedName:"SearchAlongRouteResponse",type:{name:"Composite",className:"SearchAlongRouteResponse",modelProperties:{summary:{serializedName:"summary",type:{name:"Composite",className:"SearchAlongRouteSummary"}},results:{readOnly:!0,serializedName:"results",type:{name:"Sequence",element:{type:{name:"Composite",className:"SearchAlongRouteResult"}}}}}}},Wn={serializedName:"SearchInsideGeometryRequestBody",type:{name:"Composite",className:"SearchInsideGeometryRequestBody",modelProperties:{geometry:{serializedName:"geometry",type:{name:"Object"}}}}},Kn={serializedName:"SearchAlongRouteRequestBody",type:{name:"Composite",className:"SearchAlongRouteRequestBody",modelProperties:{route:{serializedName:"route",type:{name:"Composite",className:"LineString"}}}}},Xn={serializedName:"MultiPoint",type:{name:"Composite",polymorphicDiscriminator:kn.type.polymorphicDiscriminator,uberParent:"GeoJSONGeometry",className:"MultiPoint",modelProperties:z(z({},kn.type.modelProperties),{coordinates:{required:!0,serializedName:"coordinates",type:{name:"Sequence",element:{type:{name:"Sequence",element:{type:{name:"Number"}}}}}}})}},Yn={serializedName:"Point",type:{name:"Composite",polymorphicDiscriminator:kn.type.polymorphicDiscriminator,uberParent:"GeoJSONGeometry",className:"Point",modelProperties:z(z({},kn.type.modelProperties),{coordinates:{required:!0,serializedName:"coordinates",type:{name:"Sequence",element:{type:{name:"Number"}}}}})}},Jn={serializedName:"MultiPolygon",type:{name:"Composite",polymorphicDiscriminator:kn.type.polymorphicDiscriminator,uberParent:"GeoJSONGeometry",className:"MultiPolygon",modelProperties:z(z({},kn.type.modelProperties),{coordinates:{required:!0,serializedName:"coordinates",type:{name:"Sequence",element:{type:{name:"Sequence",element:{type:{name:"Sequence",element:{type:{name:"Sequence",element:{type:{name:"Number"}}}}}}}}}}})}},$n={serializedName:"GeoJSONGeometryCollection",type:{name:"Composite",className:"GeoJSONGeometryCollection",modelProperties:{type:{serializedName:"type",type:{name:"String"}},geometries:{required:!0,serializedName:"geometries",type:{name:"Sequence",element:{type:{name:"Composite",className:"GeoJSONGeometry"}}}}}}},Qn={serializedName:"Coordinate",type:{name:"Composite",className:"Coordinate",modelProperties:{latitude:{readOnly:!0,serializedName:"latitude",type:{name:"Number"}},longitude:{readOnly:!0,serializedName:"longitude",type:{name:"Number"}}}}},eo={serializedName:"RouteDirectionsRequestBody_supportingPoints",type:{name:"Composite",className:"RouteDirectionsRequestBodySupportingPoints",modelProperties:z({},$n.type.modelProperties)}},to={serializedName:"RouteDirectionsRequestBody",type:{name:"Composite",className:"RouteDirectionsRequestBody",modelProperties:{supportingPoints:{serializedName:"supportingPoints",type:{name:"Composite",className:"RouteDirectionsRequestBodySupportingPoints"}},avoidVignette:{serializedName:"avoidVignette",type:{name:"Sequence",element:{type:{name:"String"}}}},allowVignette:{serializedName:"allowVignette",type:{name:"Sequence",element:{type:{name:"String"}}}},avoidAreas:{serializedName:"avoidAreas",type:{name:"Composite",className:"MultiPolygon"}}}}},ro={serializedName:"RouteDirectionsResponse",type:{name:"Composite",className:"RouteDirectionsResponse",modelProperties:{formatVersion:{readOnly:!0,serializedName:"formatVersion",type:{name:"String"}},copyright:{readOnly:!0,serializedName:"copyright",type:{name:"String"}},privacy:{readOnly:!0,serializedName:"privacy",type:{name:"String"}},routes:{readOnly:!0,serializedName:"routes",type:{name:"Sequence",element:{type:{name:"Composite",className:"RouteDirectionsResult"}}}},optimizedWaypoints:{readOnly:!0,serializedName:"optimizedWaypoints",type:{name:"Sequence",element:{type:{name:"Composite",className:"RouteOptimizedWaypoint"}}}},report:{serializedName:"report",type:{name:"Composite",className:"RouteResponseReport"}}}}},io={serializedName:"RouteRangeResponse",type:{name:"Composite",className:"RouteRangeResponse",modelProperties:{formatVersion:{readOnly:!0,serializedName:"formatVersion",type:{name:"String"}},copyright:{readOnly:!0,serializedName:"copyright",type:{name:"String"}},privacy:{readOnly:!0,serializedName:"privacy",type:{name:"String"}},reachableRange:{serializedName:"reachableRange",type:{name:"Composite",className:"RouteRange"}},report:{serializedName:"report",type:{name:"Composite",className:"RouteResponseReport"}}}}},no={serializedName:"RouteMatrixResponse",type:{name:"Composite",className:"RouteMatrixResponse",modelProperties:{formatVersion:{readOnly:!0,serializedName:"formatVersion",type:{name:"String"}},matrix:{readOnly:!0,serializedName:"matrix",type:{name:"Sequence",element:{type:{name:"Sequence",element:{type:{name:"Composite",className:"RouteMatrixResult"}}}}}},summary:{serializedName:"summary",type:{name:"Composite",className:"RouteMatrixSummary"}}}}},oo={serializedName:"RouteMatrixRequestBody",type:{name:"Composite",className:"RouteMatrixRequestBody",modelProperties:{origins:{serializedName:"origins",type:{name:"Composite",className:"MultiPoint"}},destinations:{serializedName:"destinations",type:{name:"Composite",className:"MultiPoint"}}}}},ao={serializedName:"TimezoneByIdResult",type:{name:"Composite",className:"TimezoneByIdResult",modelProperties:{version:{readOnly:!0,serializedName:"Version",type:{name:"String"}},referenceUtcTimestamp:{readOnly:!0,serializedName:"ReferenceUtcTimestamp",type:{name:"DateTime"}},timeZones:{serializedName:"TimeZones",type:{name:"Sequence",element:{type:{name:"Composite",className:"TimezoneById"}}}},count:{readOnly:!0,serializedName:"Count",type:{name:"Number"}}}}},so={serializedName:"TimezoneByCoordinatesResult",type:{name:"Composite",className:"TimezoneByCoordinatesResult",modelProperties:{version:{readOnly:!0,serializedName:"Version",type:{name:"String"}},referenceUtcTimestamp:{readOnly:!0,serializedName:"ReferenceUtcTimestamp",type:{name:"DateTime"}},timeZones:{serializedName:"TimeZones",type:{name:"Sequence",element:{type:{name:"Composite",className:"TimeZoneByCoordinates"}}}},count:{readOnly:!0,serializedName:"Count",type:{name:"Number"}}}}},lo={serializedName:"TimezoneIanaVersionResult",type:{name:"Composite",className:"TimezoneIanaVersionResult",modelProperties:{version:{readOnly:!0,serializedName:"version",type:{name:"String"}}}}},uo={serializedName:"CopyrightBoundingResult",type:{name:"Composite",className:"CopyrightBoundingResult",modelProperties:{formatVersion:{readOnly:!0,serializedName:"formatVersion",type:{name:"String"}},generalCopyrights:{readOnly:!0,serializedName:"generalCopyrights",type:{name:"Sequence",element:{type:{name:"String"}}}},regions:{readOnly:!0,serializedName:"regions",type:{name:"Sequence",element:{type:{name:"Composite",className:"Region"}}}}}}},co={serializedName:"CopyrightCaptionResult",type:{name:"Composite",className:"CopyrightCaptionResult",modelProperties:{formatVersion:{readOnly:!0,serializedName:"formatVersion",type:{name:"String"}},copyrightsCaption:{readOnly:!0,serializedName:"copyrightsCaption",type:{name:"String"}}}}},po={serializedName:"CopyrightWorldResult",type:{name:"Composite",className:"CopyrightWorldResult",modelProperties:{formatVersion:{readOnly:!0,serializedName:"formatVersion",type:{name:"String"}},generalCopyrights:{readOnly:!0,serializedName:"generalCopyrights",type:{name:"Sequence",element:{type:{name:"String"}}}},regions:{readOnly:!0,serializedName:"regions",type:{name:"Sequence",element:{type:{name:"Composite",className:"Region"}}}}}}},ho={serializedName:"CopyrightTileResult",type:{name:"Composite",className:"CopyrightTileResult",modelProperties:{formatVersion:{readOnly:!0,serializedName:"formatVersion",type:{name:"String"}},generalCopyrights:{readOnly:!0,serializedName:"generalCopyrights",type:{name:"Sequence",element:{type:{name:"String"}}}},regions:{readOnly:!0,serializedName:"regions",type:{name:"Sequence",element:{type:{name:"Composite",className:"Region"}}}}}}},mo={serializedName:"Polygon",type:{name:"Composite",polymorphicDiscriminator:kn.type.polymorphicDiscriminator,uberParent:"GeoJSONGeometry",className:"Polygon",modelProperties:z(z({},kn.type.modelProperties),{coordinates:{required:!0,serializedName:"coordinates",type:{name:"Sequence",element:{type:{name:"Sequence",element:{type:{name:"Sequence",element:{type:{name:"Number"}}}}}}}}})}},fo={serializedName:"MetroAreaResponse",type:{name:"Composite",className:"MetroAreaResponse",modelProperties:{results:{serializedName:"results",type:{name:"Sequence",element:{type:{name:"Composite",className:"MetroAreaResult"}}}}}}},yo={serializedName:"MetroAreaInfoResponse",type:{name:"Composite",className:"MetroAreaInfoResponse",modelProperties:{metroName:{serializedName:"metroName",type:{name:"String"}},transitTypes:{serializedName:"transitTypes",type:{name:"Sequence",element:{type:{name:"Composite",className:"TransitTypeResult"}}}},agencies:{serializedName:"agencies",type:{name:"Sequence",element:{type:{name:"Composite",className:"Agency"}}}},alerts:{serializedName:"alerts",type:{name:"Sequence",element:{type:{name:"Composite",className:"Alert"}}}}}}},go={serializedName:"NearbyTransitResponse",type:{name:"Composite",className:"NearbyTransitResponse",modelProperties:{results:{serializedName:"results",type:{name:"Sequence",element:{type:{name:"Composite",className:"TransitObjectResult"}}}}}}},vo={serializedName:"TransitStopInfoResponse",type:{name:"Composite",className:"TransitStopInfoResponse",modelProperties:{stop:{serializedName:"stop",type:{name:"Composite",className:"Stop"}},lines:{serializedName:"lines",type:{name:"Sequence",element:{type:{name:"Composite",className:"Line"}}}},lineGroups:{serializedName:"lineGroups",type:{name:"Sequence",element:{type:{name:"Composite",className:"LineGroup"}}}},alerts:{serializedName:"alerts",type:{name:"Sequence",element:{type:{name:"Composite",className:"Alert"}}}}}}},_o={serializedName:"TransitRouteResponse",type:{name:"Composite",className:"TransitRouteResponse",modelProperties:{results:{serializedName:"results",type:{name:"Sequence",element:{type:{name:"Composite",className:"ItineraryResult"}}}}}}},bo={serializedName:"TransitItineraryResponse",type:{name:"Composite",className:"TransitItineraryResponse",modelProperties:{departureTime:{serializedName:"departureTime",type:{name:"String"}},arrivalTime:{serializedName:"arrivalTime",type:{name:"String"}},legs:{serializedName:"legs",type:{name:"Sequence",element:{type:{name:"Composite",className:"Leg"}}}}}}},xo={serializedName:"CarShareResponse",type:{name:"Composite",className:"CarShareResponse",modelProperties:{name:{serializedName:"name",type:{name:"String"}},model:{serializedName:"model",type:{name:"String"}},seatCount:{serializedName:"seatCount",type:{name:"Number"}},fuelLevel:{serializedName:"fuelLevel",type:{name:"Number"}},batteryLevel:{serializedName:"batteryLevel",type:{name:"Number"}},pricing:{serializedName:"pricing",type:{name:"Composite",className:"Pricing"}},position:{serializedName:"position",type:{name:"Composite",className:"Coordinate"}},operatorInfo:{serializedName:"operatorInfo",type:{name:"Composite",className:"OperatorInfo"}}}}},wo={serializedName:"TransitDockInfoResponse",type:{name:"Composite",className:"TransitDockInfoResponse",modelProperties:{availableVehicles:{serializedName:"availableVehicles",type:{name:"Number"}},vacantLocations:{serializedName:"vacantLocations",type:{name:"Number"}},position:{serializedName:"position",type:{name:"Composite",className:"Coordinate"}},lastUpdated:{serializedName:"lastUpdated",type:{name:"DateTime"}},operatorInfo:{serializedName:"operatorInfo",type:{name:"Composite",className:"OperatorInfo"}}}}},So={serializedName:"TransitLineInfoResponse",type:{name:"Composite",className:"TransitLineInfoResponse",modelProperties:{lineGroup:{serializedName:"lineGroup",type:{name:"Composite",className:"LineGroup"}},lines:{serializedName:"lines",type:{name:"Sequence",element:{type:{name:"Composite",className:"Line"}}}},stops:{serializedName:"stops",type:{name:"Sequence",element:{type:{name:"Composite",className:"Stop"}}}},patterns:{serializedName:"patterns",type:{name:"Sequence",element:{type:{name:"Composite",className:"Pattern"}}}},schedule:{serializedName:"schedule",type:{name:"Composite",className:"LineArrival"}}}}},To={serializedName:"RealTimeArrivalsResponse",type:{name:"Composite",className:"RealTimeArrivalsResponse",modelProperties:{results:{serializedName:"results",type:{name:"Sequence",element:{type:{name:"Composite",className:"RealTimeArrivalResult"}}}}}}},Co={serializedName:"GeoJSONFeatureCollection",type:{name:"Composite",className:"GeoJSONFeatureCollection",modelProperties:{type:{required:!0,serializedName:"type",type:{name:"String"}},features:{required:!0,serializedName:"features",type:{name:"Sequence",element:{type:{name:"Composite",className:"GeoJSONFeatureCollectionFeaturesItem"}}}}}}},Eo={serializedName:"MultiLineString",type:{name:"Composite",polymorphicDiscriminator:kn.type.polymorphicDiscriminator,uberParent:"GeoJSONGeometry",className:"MultiLineString",modelProperties:z(z({},kn.type.modelProperties),{coordinates:{required:!0,serializedName:"coordinates",type:{name:"Sequence",element:{type:{name:"Sequence",element:{type:{name:"Sequence",element:{type:{name:"Number"}}}}}}}}})}},Io={serializedName:"GeofenceResponse",type:{name:"Composite",className:"GeofenceResponse",modelProperties:{geometries:{readOnly:!0,serializedName:"geometries",type:{name:"Sequence",element:{type:{name:"Composite",className:"GeofenceGeometry"}}}},expiredGeofenceGeometryId:{readOnly:!0,serializedName:"expiredGeofenceGeometryId",type:{name:"Sequence",element:{type:{name:"String"}}}},invalidPeriodGeofenceGeometryId:{readOnly:!0,serializedName:"invalidPeriodGeofenceGeometryId",type:{name:"Sequence",element:{type:{name:"String"}}}},isEventPublished:{readOnly:!0,serializedName:"isEventPublished",type:{name:"Boolean"}}}}},Po={serializedName:"BufferRequestBody",type:{name:"Composite",className:"BufferRequestBody",modelProperties:{geometries:{serializedName:"geometries",type:{name:"Composite",className:"GeoJSONFeatureCollection"}},distances:{serializedName:"distances",type:{name:"Sequence",element:{type:{name:"Number"}}}}}}},Ro={serializedName:"BufferResponse",type:{name:"Composite",className:"BufferResponse",modelProperties:{summary:{readOnly:!0,serializedName:"summary",type:{name:"Composite",className:"BufferResponseSummary"}},result:{serializedName:"result",type:{name:"Composite",className:"GeoJSONFeatureCollection"}}}}},No={serializedName:"GetClosestPointResponse",type:{name:"Composite",className:"GetClosestPointResponse",modelProperties:{summary:{serializedName:"summary",type:{name:"Composite",className:"GetClosestPointSummary"}},result:{serializedName:"result",type:{name:"Sequence",element:{type:{name:"Composite",className:"ClosestPointResultEntry"}}}}}}},Ao={serializedName:"PostClosestPointResponse",type:{name:"Composite",className:"PostClosestPointResponse",modelProperties:{summary:{serializedName:"summary",type:{name:"Composite",className:"PostClosestPointSummary"}},result:{serializedName:"result",type:{name:"Sequence",element:{type:{name:"Composite",className:"ClosestPointResultEntry"}}}}}}},zo={serializedName:"GetPointInPolygonResponse",type:{name:"Composite",className:"GetPointInPolygonResponse",modelProperties:{summary:{serializedName:"summary",type:{name:"Composite",className:"GetPointInPolygonSummary"}},result:{serializedName:"result",type:{name:"Composite",className:"PointInPolygonResult"}}}}},Mo={serializedName:"PostPointInPolygonResponse",type:{name:"Composite",className:"PostPointInPolygonResponse",modelProperties:{summary:{serializedName:"summary",type:{name:"Composite",className:"PostPointInPolygonSummary"}},result:{serializedName:"result",type:{name:"Composite",className:"PointInPolygonResult"}}}}},ko={serializedName:"GreatCircleDistanceResponse",type:{name:"Composite",className:"GreatCircleDistanceResponse",modelProperties:{summary:{readOnly:!0,serializedName:"summary",type:{name:"Composite",className:"GreatCircleDistanceResponseSummary"}},result:{readOnly:!0,serializedName:"result",type:{name:"Composite",className:"GreatCircleDistanceResponseResult"}}}}},Oo={serializedName:"search-postsearchfuzzybatchpreview-headers",type:{name:"Composite",className:"SearchPostSearchFuzzyBatchPreviewHeaders",modelProperties:{location:{serializedName:"location",type:{name:"String"}}}}},Lo={serializedName:"search-postsearchaddressbatchpreview-headers",type:{name:"Composite",className:"SearchPostSearchAddressBatchPreviewHeaders",modelProperties:{location:{serializedName:"location",type:{name:"String"}}}}},Do={serializedName:"search-postsearchaddressreversebatchpreview-headers",type:{name:"Composite",className:"SearchPostSearchAddressReverseBatchPreviewHeaders",modelProperties:{location:{serializedName:"location",type:{name:"String"}}}}},Bo={serializedName:"route-postroutematrixpreview-headers",type:{name:"Composite",className:"RoutePostRouteMatrixPreviewHeaders",modelProperties:{location:{serializedName:"location",type:{name:"String"}}}}},Fo={serializedName:"route-postroutedirectionsbatchpreview-headers",type:{name:"Composite",className:"RoutePostRouteDirectionsBatchPreviewHeaders",modelProperties:{location:{serializedName:"location",type:{name:"String"}}}}},qo={serializedName:"spatial-getgeofence-headers",type:{name:"Composite",className:"SpatialGetGeofenceHeaders",modelProperties:{xCorrelationId:{serializedName:"x-correlation-id",type:{name:"String"}}}}},Uo={serializedName:"spatial-postgeofence-headers",type:{name:"Composite",className:"SpatialPostGeofenceHeaders",modelProperties:{xCorrelationId:{serializedName:"x-correlation-id",type:{name:"String"}}}}},jo={GeoJSONGeometry:kn,"GeoJSONGeometry.LineString":On,"GeoJSONGeometry.MultiPoint":Xn,"GeoJSONGeometry.Point":Yn,"GeoJSONGeometry.MultiPolygon":Jn,"GeoJSONGeometry.Polygon":mo,"GeoJSONGeometry.MultiLineString":Eo},Vo=Object.freeze({discriminators:jo,BatchRequestBody:Mn,BatchRequestBodyBatchItemsItem:zn,BatchResponse:An,BatchResponseSummary:Nn,CloudError:Rn,CoordinateAbbreviated:{serializedName:"CoordinateAbbreviated",type:{name:"Composite",className:"CoordinateAbbreviated",modelProperties:{lat:{readOnly:!0,serializedName:"lat",type:{name:"Number"}},lon:{readOnly:!0,serializedName:"lon",type:{name:"Number"}}}}},DataSources:{serializedName:"DataSources",type:{name:"Composite",className:"DataSources",modelProperties:{geometry:{serializedName:"geometry",type:{name:"Composite",className:"DataSourcesGeometry"}}}}},DataSourcesGeometry:{serializedName:"DataSourcesGeometry",type:{name:"Composite",className:"DataSourcesGeometry",modelProperties:{id:{readOnly:!0,serializedName:"id",type:{name:"String"}}}}},GeoJSONGeometry:kn,LineString:On,MultiLineString:Eo,MultiPoint:Xn,MultiPolygon:Jn,Point:Yn,Polygon:mo,SearchAddressResponse:Un,SearchAddressResult:{serializedName:"SearchAddressResult",type:{name:"Composite",className:"SearchAddressResult",modelProperties:{type:{readOnly:!0,serializedName:"type",type:{name:"String"}},id:{readOnly:!0,serializedName:"id",type:{name:"String"}},score:{serializedName:"score",type:{name:"Number"}},address:{serializedName:"address",type:{name:"Composite",className:"SearchResultAddress"}},position:{serializedName:"position",type:{name:"Composite",className:"CoordinateAbbreviated"}},viewport:{serializedName:"viewport",type:{name:"Composite",className:"SearchResultViewport"}},entryPoints:{serializedName:"entryPoints",type:{name:"Sequence",element:{type:{name:"Composite",className:"SearchResultEntryPoint"}}}},dataSources:{serializedName:"dataSources",type:{name:"Composite",className:"DataSources"}}}}},SearchAddressReverseCrossStreetResponse:Vn,SearchAddressReverseCrossStreetResult:{serializedName:"SearchAddressReverseCrossStreetResult",type:{name:"Composite",className:"SearchAddressReverseCrossStreetResult",modelProperties:{address:{serializedName:"address",type:{name:"Composite",className:"SearchResultAddress"}},position:{readOnly:!0,serializedName:"position",type:{name:"String"}}}}},SearchAddressReverseCrossStreetSummary:{serializedName:"SearchAddressReverseCrossStreetSummary",type:{name:"Composite",className:"SearchAddressReverseCrossStreetSummary",modelProperties:{queryTime:{readOnly:!0,serializedName:"queryTime",type:{name:"Number"}},numResults:{readOnly:!0,serializedName:"numResults",type:{name:"Number"}}}}},SearchAddressReverseResponse:jn,SearchAddressReverseResult:{serializedName:"SearchAddressReverseResult",type:{name:"Composite",className:"SearchAddressReverseResult",modelProperties:{address:{serializedName:"address",type:{name:"Composite",className:"SearchResultAddress"}},position:{readOnly:!0,serializedName:"position",type:{name:"String"}},matchType:{readOnly:!0,serializedName:"matchType",type:{name:"String"}}}}},SearchAddressReverseSummary:{serializedName:"SearchAddressReverseSummary",type:{name:"Composite",className:"SearchAddressReverseSummary",modelProperties:{queryTime:{readOnly:!0,serializedName:"queryTime",type:{name:"Number"}},numResults:{readOnly:!0,serializedName:"numResults",type:{name:"Number"}}}}},SearchAddressStructuredResponse:Gn,SearchAddressStructuredResult:{serializedName:"SearchAddressStructuredResult",type:{name:"Composite",className:"SearchAddressStructuredResult",modelProperties:{type:{readOnly:!0,serializedName:"type",type:{name:"String"}},id:{readOnly:!0,serializedName:"id",type:{name:"String"}},score:{serializedName:"score",type:{name:"Number"}},dist:{serializedName:"dist",type:{name:"Number"}},address:{serializedName:"address",type:{name:"Composite",className:"SearchResultAddress"}},position:{serializedName:"position",type:{name:"Composite",className:"CoordinateAbbreviated"}},viewport:{serializedName:"viewport",type:{name:"Composite",className:"SearchResultViewport"}},entryPoints:{serializedName:"entryPoints",type:{name:"Sequence",element:{type:{name:"Composite",className:"SearchResultEntryPoint"}}}},addressRanges:{serializedName:"addressRanges",type:{name:"Composite",className:"SearchResultAddressRanges"}}}}},SearchAddressStructuredSummary:{serializedName:"SearchAddressStructuredSummary",type:{name:"Composite",className:"SearchAddressStructuredSummary",modelProperties:{query:{readOnly:!0,serializedName:"query",type:{name:"String"}},queryType:{readOnly:!0,serializedName:"queryType",type:{name:"String"}},queryTime:{readOnly:!0,serializedName:"queryTime",type:{name:"Number"}},numResults:{readOnly:!0,serializedName:"numResults",type:{name:"Number"}},limit:{readOnly:!0,serializedName:"limit",type:{name:"Number"}},offset:{readOnly:!0,serializedName:"offset",type:{name:"Number"}},totalResults:{readOnly:!0,serializedName:"totalResults",type:{name:"Number"}},fuzzyLevel:{readOnly:!0,serializedName:"fuzzyLevel",type:{name:"Number"}},geoBias:{serializedName:"geoBias",type:{name:"Composite",className:"SearchSummaryGeoBias"}}}}},SearchAddressSummary:{serializedName:"SearchAddressSummary",type:{name:"Composite",className:"SearchAddressSummary",modelProperties:{query:{readOnly:!0,serializedName:"query",type:{name:"String"}},queryType:{readOnly:!0,serializedName:"queryType",type:{name:"String"}},queryTime:{readOnly:!0,serializedName:"queryTime",type:{name:"Number"}},numResults:{readOnly:!0,serializedName:"numResults",type:{name:"Number"}},offset:{readOnly:!0,serializedName:"offset",type:{name:"Number"}},totalResults:{readOnly:!0,serializedName:"totalResults",type:{name:"Number"}},fuzzyLevel:{readOnly:!0,serializedName:"fuzzyLevel",type:{name:"Number"}}}}},SearchAlongRouteRequestBody:Kn,SearchAlongRouteResponse:Zn,SearchAlongRouteResult:{serializedName:"SearchAlongRouteResult",type:{name:"Composite",className:"SearchAlongRouteResult",modelProperties:{type:{readOnly:!0,serializedName:"type",type:{name:"String"}},id:{readOnly:!0,serializedName:"id",type:{name:"String"}},score:{serializedName:"score",type:{name:"Number"}},info:{readOnly:!0,serializedName:"info",type:{name:"String"}},entityType:{serializedName:"entityType",type:{name:"Enum",allowedValues:["Country","CountrySubdivision","CountrySecondarySubdivision","CountryTertiarySubdivision","Municipality","MunicipalitySubdivision","Neighbourhood","PostalCodeArea"]}},poi:{serializedName:"poi",type:{name:"Composite",className:"SearchResultPoi"}},address:{serializedName:"address",type:{name:"Composite",className:"SearchResultAddress"}},position:{serializedName:"position",type:{name:"Composite",className:"CoordinateAbbreviated"}},viewport:{serializedName:"viewport",type:{name:"Composite",className:"SearchResultViewport"}},entryPoints:{serializedName:"entryPoints",type:{name:"Sequence",element:{type:{name:"Composite",className:"SearchResultEntryPoint"}}}},dist:{serializedName:"dist",type:{name:"Number"}},detourTime:{readOnly:!0,serializedName:"detourTime",type:{name:"Number"}}}}},SearchAlongRouteSummary:{serializedName:"SearchAlongRouteSummary",type:{name:"Composite",className:"SearchAlongRouteSummary",modelProperties:{query:{readOnly:!0,serializedName:"query",type:{name:"String"}},queryType:{readOnly:!0,serializedName:"queryType",type:{name:"String"}},queryTime:{readOnly:!0,serializedName:"queryTime",type:{name:"Number"}},numResults:{readOnly:!0,serializedName:"numResults",type:{name:"Number"}},offset:{readOnly:!0,serializedName:"offset",type:{name:"Number"}},totalResults:{readOnly:!0,serializedName:"totalResults",type:{name:"Number"}},fuzzyLevel:{readOnly:!0,serializedName:"fuzzyLevel",type:{name:"Number"}}}}},SearchFuzzyResponse:Dn,SearchFuzzyResult:{serializedName:"SearchFuzzyResult",type:{name:"Composite",className:"SearchFuzzyResult",modelProperties:{type:{readOnly:!0,serializedName:"type",type:{name:"String"}},id:{readOnly:!0,serializedName:"id",type:{name:"String"}},score:{serializedName:"score",type:{name:"Number"}},info:{readOnly:!0,serializedName:"info",type:{name:"String"}},entityType:{serializedName:"entityType",type:{name:"Enum",allowedValues:["Country","CountrySubdivision","CountrySecondarySubdivision","CountryTertiarySubdivision","Municipality","MunicipalitySubdivision","Neighbourhood","PostalCodeArea"]}},poi:{serializedName:"poi",type:{name:"Composite",className:"SearchResultPoi"}},address:{serializedName:"address",type:{name:"Composite",className:"SearchResultAddress"}},position:{serializedName:"position",type:{name:"Composite",className:"CoordinateAbbreviated"}},viewport:{serializedName:"viewport",type:{name:"Composite",className:"SearchResultViewport"}},entryPoints:{serializedName:"entryPoints",type:{name:"Sequence",element:{type:{name:"Composite",className:"SearchResultEntryPoint"}}}},addressRanges:{serializedName:"addressRanges",type:{name:"Composite",className:"SearchResultAddressRanges"}},dataSources:{serializedName:"dataSources",type:{name:"Composite",className:"DataSources"}}}}},SearchFuzzySummary:{serializedName:"SearchFuzzySummary",type:{name:"Composite",className:"SearchFuzzySummary",modelProperties:{query:{readOnly:!0,serializedName:"query",type:{name:"String"}},queryType:{readOnly:!0,serializedName:"queryType",type:{name:"String"}},queryTime:{readOnly:!0,serializedName:"queryTime",type:{name:"Number"}},numResults:{readOnly:!0,serializedName:"numResults",type:{name:"Number"}},offset:{readOnly:!0,serializedName:"offset",type:{name:"Number"}},totalResults:{readOnly:!0,serializedName:"totalResults",type:{name:"Number"}},fuzzyLevel:{readOnly:!0,serializedName:"fuzzyLevel",type:{name:"Number"}}}}},SearchGeometryResponse:Hn,SearchGeometryResult:{serializedName:"SearchGeometryResult",type:{name:"Composite",className:"SearchGeometryResult",modelProperties:{type:{readOnly:!0,serializedName:"type",type:{name:"String"}},id:{readOnly:!0,serializedName:"id",type:{name:"String"}},score:{serializedName:"score",type:{name:"Number"}},info:{readOnly:!0,serializedName:"info",type:{name:"String"}},entityType:{serializedName:"entityType",type:{name:"Enum",allowedValues:["Country","CountrySubdivision","CountrySecondarySubdivision","CountryTertiarySubdivision","Municipality","MunicipalitySubdivision","Neighbourhood","PostalCodeArea"]}},poi:{serializedName:"poi",type:{name:"Composite",className:"SearchResultPoi"}},address:{serializedName:"address",type:{name:"Composite",className:"SearchResultAddress"}},position:{serializedName:"position",type:{name:"Composite",className:"CoordinateAbbreviated"}},viewport:{serializedName:"viewport",type:{name:"Composite",className:"SearchResultViewport"}},entryPoints:{serializedName:"entryPoints",type:{name:"Sequence",element:{type:{name:"Composite",className:"SearchResultEntryPoint"}}}}}}},SearchGeometrySummary:{serializedName:"SearchGeometrySummary",type:{name:"Composite",className:"SearchGeometrySummary",modelProperties:{query:{readOnly:!0,serializedName:"query",type:{name:"String"}},queryType:{readOnly:!0,serializedName:"queryType",type:{name:"String"}},queryTime:{readOnly:!0,serializedName:"queryTime",type:{name:"Number"}},numResults:{readOnly:!0,serializedName:"numResults",type:{name:"Number"}},offset:{readOnly:!0,serializedName:"offset",type:{name:"Number"}},totalResults:{readOnly:!0,serializedName:"totalResults",type:{name:"Number"}},fuzzyLevel:{readOnly:!0,serializedName:"fuzzyLevel",type:{name:"Number"}}}}},SearchInsideGeometryRequestBody:Wn,SearchNearbyResponse:Fn,SearchNearbyResult:{serializedName:"SearchNearbyResult",type:{name:"Composite",className:"SearchNearbyResult",modelProperties:{type:{readOnly:!0,serializedName:"type",type:{name:"String"}},id:{readOnly:!0,serializedName:"id",type:{name:"String"}},score:{serializedName:"score",type:{name:"Number"}},dist:{serializedName:"dist",type:{name:"Number"}},info:{readOnly:!0,serializedName:"info",type:{name:"String"}},poi:{serializedName:"poi",type:{name:"Composite",className:"SearchResultPoi"}},address:{serializedName:"address",type:{name:"Composite",className:"SearchResultAddress"}},position:{serializedName:"position",type:{name:"Composite",className:"CoordinateAbbreviated"}},viewport:{serializedName:"viewport",type:{name:"Composite",className:"SearchResultViewport"}},entryPoints:{serializedName:"entryPoints",type:{name:"Sequence",element:{type:{name:"Composite",className:"SearchResultEntryPoint"}}}}}}},SearchNearbySummary:{serializedName:"SearchNearbySummary",type:{name:"Composite",className:"SearchNearbySummary",modelProperties:{queryType:{readOnly:!0,serializedName:"queryType",type:{name:"String"}},queryTime:{readOnly:!0,serializedName:"queryTime",type:{name:"Number"}},numResults:{readOnly:!0,serializedName:"numResults",type:{name:"Number"}},offset:{readOnly:!0,serializedName:"offset",type:{name:"Number"}},totalResults:{readOnly:!0,serializedName:"totalResults",type:{name:"Number"}},fuzzyLevel:{readOnly:!0,serializedName:"fuzzyLevel",type:{name:"Number"}},geoBias:{serializedName:"geoBias",type:{name:"Composite",className:"SearchSummaryGeoBias"}}}}},SearchPoiCategoryResponse:qn,SearchPoiCategoryResult:{serializedName:"SearchPoiCategoryResult",type:{name:"Composite",className:"SearchPoiCategoryResult",modelProperties:{type:{readOnly:!0,serializedName:"type",type:{name:"String"}},id:{readOnly:!0,serializedName:"id",type:{name:"String"}},score:{serializedName:"score",type:{name:"Number"}},dist:{serializedName:"dist",type:{name:"Number"}},info:{readOnly:!0,serializedName:"info",type:{name:"String"}},entityType:{serializedName:"entityType",type:{name:"Enum",allowedValues:["Country","CountrySubdivision","CountrySecondarySubdivision","CountryTertiarySubdivision","Municipality","MunicipalitySubdivision","Neighbourhood","PostalCodeArea"]}},poi:{serializedName:"poi",type:{name:"Composite",className:"SearchResultPoi"}},address:{serializedName:"address",type:{name:"Composite",className:"SearchResultAddress"}},position:{serializedName:"position",type:{name:"Composite",className:"CoordinateAbbreviated"}},viewport:{serializedName:"viewport",type:{name:"Composite",className:"SearchResultViewport"}},entryPoints:{serializedName:"entryPoints",type:{name:"Sequence",element:{type:{name:"Composite",className:"SearchResultEntryPoint"}}}}}}},SearchPoiCategorySummary:{serializedName:"SearchPoiCategorySummary",type:{name:"Composite",className:"SearchPoiCategorySummary",modelProperties:{query:{readOnly:!0,serializedName:"query",type:{name:"String"}},queryType:{readOnly:!0,serializedName:"queryType",type:{name:"String"}},queryTime:{readOnly:!0,serializedName:"queryTime",type:{name:"Number"}},numResults:{readOnly:!0,serializedName:"numResults",type:{name:"Number"}},offset:{readOnly:!0,serializedName:"offset",type:{name:"Number"}},totalResults:{readOnly:!0,serializedName:"totalResults",type:{name:"Number"}},fuzzyLevel:{readOnly:!0,serializedName:"fuzzyLevel",type:{name:"Number"}},geoBias:{serializedName:"geoBias",type:{name:"Composite",className:"SearchSummaryGeoBias"}}}}},SearchPoiResponse:Bn,SearchPoiResult:{serializedName:"SearchPoiResult",type:{name:"Composite",className:"SearchPoiResult",modelProperties:{type:{readOnly:!0,serializedName:"type",type:{name:"String"}},id:{readOnly:!0,serializedName:"id",type:{name:"String"}},score:{serializedName:"score",type:{name:"Number"}},dist:{serializedName:"dist",type:{name:"Number"}},info:{readOnly:!0,serializedName:"info",type:{name:"String"}},entityType:{serializedName:"entityType",type:{name:"Enum",allowedValues:["Country","CountrySubdivision","CountrySecondarySubdivision","CountryTertiarySubdivision","Municipality","MunicipalitySubdivision","Neighbourhood","PostalCodeArea"]}},poi:{serializedName:"poi",type:{name:"Composite",className:"SearchResultPoi"}},address:{serializedName:"address",type:{name:"Composite",className:"SearchResultAddress"}},position:{serializedName:"position",type:{name:"Composite",className:"CoordinateAbbreviated"}},viewport:{serializedName:"viewport",type:{name:"Composite",className:"SearchResultViewport"}},entryPoints:{serializedName:"entryPoints",type:{name:"Sequence",element:{type:{name:"Composite",className:"SearchResultEntryPoint"}}}}}}},SearchPoiSummary:{serializedName:"SearchPoiSummary",type:{name:"Composite",className:"SearchPoiSummary",modelProperties:{query:{readOnly:!0,serializedName:"query",type:{name:"String"}},queryType:{readOnly:!0,serializedName:"queryType",type:{name:"String"}},queryTime:{readOnly:!0,serializedName:"queryTime",type:{name:"Number"}},numResults:{readOnly:!0,serializedName:"numResults",type:{name:"Number"}},offset:{readOnly:!0,serializedName:"offset",type:{name:"Number"}},totalResults:{readOnly:!0,serializedName:"totalResults",type:{name:"Number"}},fuzzyLevel:{readOnly:!0,serializedName:"fuzzyLevel",type:{name:"Number"}},geoBias:{serializedName:"geoBias",type:{name:"Composite",className:"SearchSummaryGeoBias"}}}}},SearchPolygonResponse:Ln,SearchPolygonResult:{serializedName:"SearchPolygonResult",type:{name:"Composite",className:"SearchPolygonResult",modelProperties:{providerID:{readOnly:!0,serializedName:"providerID",type:{name:"String"}},error:{readOnly:!0,serializedName:"error",type:{name:"String"}},geometryData:{serializedName:"geometryData",type:{name:"Object"}}}}},SearchPostSearchAddressBatchPreviewHeaders:Lo,SearchPostSearchAddressReverseBatchPreviewHeaders:Do,SearchPostSearchFuzzyBatchPreviewHeaders:Oo,SearchResultAddress:{serializedName:"SearchResultAddress",type:{name:"Composite",className:"SearchResultAddress",modelProperties:{buildingNumber:{readOnly:!0,serializedName:"buildingNumber",type:{name:"String"}},street:{readOnly:!0,serializedName:"street",type:{name:"String"}},crossStreet:{readOnly:!0,serializedName:"crossStreet",type:{name:"String"}},streetNumber:{readOnly:!0,serializedName:"streetNumber",type:{name:"String"}},routeNumbers:{readOnly:!0,serializedName:"routeNumbers",type:{name:"Sequence",element:{type:{name:"Number"}}}},streetName:{readOnly:!0,serializedName:"streetName",type:{name:"String"}},streetNameAndNumber:{readOnly:!0,serializedName:"streetNameAndNumber",type:{name:"String"}},municipality:{readOnly:!0,serializedName:"municipality",type:{name:"String"}},municipalitySubdivision:{readOnly:!0,serializedName:"municipalitySubdivision",type:{name:"String"}},countryTertiarySubdivision:{readOnly:!0,serializedName:"countryTertiarySubdivision",type:{name:"String"}},countrySecondarySubdivision:{readOnly:!0,serializedName:"countrySecondarySubdivision",type:{name:"String"}},countrySubdivision:{readOnly:!0,serializedName:"countrySubdivision",type:{name:"String"}},postalCode:{readOnly:!0,serializedName:"postalCode",type:{name:"String"}},extendedPostalCode:{readOnly:!0,serializedName:"extendedPostalCode",type:{name:"String"}},countryCode:{readOnly:!0,serializedName:"countryCode",type:{name:"String"}},country:{readOnly:!0,serializedName:"country",type:{name:"String"}},countryCodeISO3:{readOnly:!0,serializedName:"countryCodeISO3",type:{name:"String"}},freeformAddress:{readOnly:!0,serializedName:"freeformAddress",type:{name:"String"}},countrySubdivisionName:{readOnly:!0,serializedName:"countrySubdivisionName",type:{name:"String"}},localName:{readOnly:!0,serializedName:"localName",type:{name:"String"}}}}},SearchResultAddressRanges:{serializedName:"SearchResultAddressRanges",type:{name:"Composite",className:"SearchResultAddressRanges",modelProperties:{rangeLeft:{serializedName:"rangeLeft",type:{name:"String"}},rangeRight:{serializedName:"rangeRight",type:{name:"String"}},from:{serializedName:"from",type:{name:"Composite",className:"CoordinateAbbreviated"}},to:{serializedName:"to",type:{name:"Composite",className:"CoordinateAbbreviated"}}}}},SearchResultEntryPoint:{serializedName:"SearchResultEntryPoint",type:{name:"Composite",className:"SearchResultEntryPoint",modelProperties:{type:{readOnly:!0,serializedName:"type",type:{name:"String"}},position:{serializedName:"position",type:{name:"Composite",className:"CoordinateAbbreviated"}}}}},SearchResultPoi:{serializedName:"SearchResultPoi",type:{name:"Composite",className:"SearchResultPoi",modelProperties:{name:{readOnly:!0,serializedName:"name",type:{name:"String"}},phone:{readOnly:!0,serializedName:"phone",type:{name:"String"}},url:{readOnly:!0,serializedName:"url",type:{name:"String"}},categories:{readOnly:!0,serializedName:"categories",type:{name:"Sequence",element:{type:{name:"String"}}}},classifications:{readOnly:!0,serializedName:"classifications",type:{name:"Sequence",element:{type:{name:"Composite",className:"SearchResultPoiClassification"}}}},brands:{readOnly:!0,serializedName:"brands",type:{name:"Sequence",element:{type:{name:"Composite",className:"SearchResultPoiBrand"}}}}}}},SearchResultPoiBrand:{serializedName:"SearchResultPoiBrand",type:{name:"Composite",className:"SearchResultPoiBrand",modelProperties:{name:{readOnly:!0,serializedName:"name",type:{name:"String"}}}}},SearchResultPoiClassification:{serializedName:"SearchResultPoiClassification",type:{name:"Composite",className:"SearchResultPoiClassification",modelProperties:{code:{readOnly:!0,serializedName:"code",type:{name:"String"}},names:{readOnly:!0,serializedName:"names",type:{name:"Sequence",element:{type:{name:"Composite",className:"SearchResultPoiClassificationName"}}}}}}},SearchResultPoiClassificationName:{serializedName:"SearchResultPoiClassificationName",type:{name:"Composite",className:"SearchResultPoiClassificationName",modelProperties:{nameLocale:{readOnly:!0,serializedName:"nameLocale",type:{name:"String"}},name:{readOnly:!0,serializedName:"name",type:{name:"String"}}}}},SearchResultViewport:{serializedName:"SearchResultViewport",type:{name:"Composite",className:"SearchResultViewport",modelProperties:{topLeftPoint:{serializedName:"topLeftPoint",type:{name:"Composite",className:"CoordinateAbbreviated"}},btmRightPoint:{serializedName:"btmRightPoint",type:{name:"Composite",className:"CoordinateAbbreviated"}}}}},SearchSummaryGeoBias:{serializedName:"SearchSummaryGeoBias",type:{name:"Composite",className:"SearchSummaryGeoBias",modelProperties:{lat:{readOnly:!0,serializedName:"lat",type:{name:"Number"}},lon:{readOnly:!0,serializedName:"lon",type:{name:"Number"}}}}}}),Go={parameterPath:["options","accelerationEfficiency"],mapper:{serializedName:"accelerationEfficiency",type:{name:"Number"}}},Ho={parameterPath:"acceptLanguage",mapper:{serializedName:"accept-language",defaultValue:"en-US",type:{name:"String"}}},Zo={parameterPath:["options","acceptLanguage"],mapper:{serializedName:"Accept-Language",type:{name:"String"}}},Wo={parameterPath:["options","agency"],mapper:{serializedName:"agency",type:{name:"Sequence",element:{type:{name:"String"}}}},collectionFormat:Ze.Csv},Ko={parameterPath:["options","agencyType"],mapper:{serializedName:"agencyType",type:{name:"Enum",allowedValues:["agencyId","agencyKey","agencyName"]}}},Xo={parameterPath:["options","alternativeType"],mapper:{serializedName:"alternativeType",type:{name:"Enum",allowedValues:["anyRoute","betterRoute"]}}},Yo={parameterPath:"apiVersion",mapper:{required:!0,serializedName:"api-version",type:{name:"String"}}},Jo={parameterPath:["options","arriveAt"],mapper:{serializedName:"arriveAt",type:{name:"DateTime"}}},$o={parameterPath:["options","auxiliaryPowerInkW"],mapper:{serializedName:"auxiliaryPowerInkW",type:{name:"String"}}},Qo={parameterPath:["options","auxiliaryPowerInLitersPerHour"],mapper:{serializedName:"auxiliaryPowerInLitersPerHour",type:{name:"Number"}}},ea={parameterPath:["options","avoid"],mapper:{serializedName:"avoid",type:{name:"Enum",allowedValues:["tollRoads","motorways","ferries","unpavedRoads","carpools","alreadyUsedRoads","borderCrossings"]}}},ta={parameterPath:["options","brandSet"],mapper:{serializedName:"brandSet",type:{name:"Sequence",element:{type:{name:"String"}}}},collectionFormat:Ze.Csv},ra={parameterPath:["options","btmRight"],mapper:{serializedName:"btmRight",type:{name:"String"}}},ia={parameterPath:["options","computeBestOrder"],mapper:{serializedName:"computeBestOrder",type:{name:"Boolean"}}},na={parameterPath:["options","computeTravelTimeFor"],mapper:{serializedName:"computeTravelTimeFor",type:{name:"Enum",allowedValues:["none","all"]}}},oa={parameterPath:["options","connectorSet"],mapper:{serializedName:"connectorSet",type:{name:"Sequence",element:{type:{name:"Enum",allowedValues:["StandardHouseholdCountrySpecific","IEC62196Type1","IEC62196Type1CCS","IEC62196Type2CableAttached","IEC62196Type2Outlet","IEC62196Type2CCS","IEC62196Type3","Chademo","IEC60309AC1PhaseBlue","IEC60309DCWhite","Tesla"]}}}},collectionFormat:Ze.Csv},aa={parameterPath:["options","constantSpeedConsumptionInkWhPerHundredkm"],mapper:{serializedName:"constantSpeedConsumptionInkWhPerHundredkm",type:{name:"String"}}},sa={parameterPath:["options","constantSpeedConsumptionInLitersPerHundredkm"],mapper:{serializedName:"constantSpeedConsumptionInLitersPerHundredkm",type:{name:"Number"}}},la={parameterPath:["options","countrySet"],mapper:{serializedName:"countrySet",type:{name:"Sequence",element:{type:{name:"String"}}}},collectionFormat:Ze.Csv},ua={parameterPath:["options","currentChargeInkWh"],mapper:{serializedName:"currentChargeInkWh",type:{name:"String"}}},ca={parameterPath:["options","currentFuelInLiters"],mapper:{serializedName:"currentFuelInLiters",type:{name:"Number"}}},pa={parameterPath:["options","decelerationEfficiency"],mapper:{serializedName:"decelerationEfficiency",type:{name:"Number"}}},ha={parameterPath:["options","departAt"],mapper:{serializedName:"departAt",type:{name:"DateTime"}}},da={parameterPath:"detailType",mapper:{required:!0,serializedName:"detailType",type:{name:"Sequence",element:{type:{name:"Enum",allowedValues:["agencies","alerts","alertDetails","transitTypes"]}}}},collectionFormat:Ze.Csv},ma={parameterPath:["options","detailType"],mapper:{serializedName:"detailType",type:{name:"Sequence",element:{type:{name:"Enum",allowedValues:["alerts","alertDetails","lines","stops","schedule","patterns"]}}}},collectionFormat:Ze.Csv},fa={parameterPath:["options","detailType"],mapper:{serializedName:"detailType",type:{name:"Sequence",element:{type:{name:"Enum",allowedValues:["alerts","alertDetails","lines","lineGroups"]}}}},collectionFormat:Ze.Csv},ya={parameterPath:["options","detailType"],mapper:{serializedName:"detailType",type:{name:"Sequence",element:{type:{name:"Enum",allowedValues:["geometry","schedule"]}}}},collectionFormat:Ze.Csv},ga={parameterPath:"deviceId",mapper:{required:!0,serializedName:"deviceId",type:{name:"String"}}},va={parameterPath:["options","downhillEfficiency"],mapper:{serializedName:"downhillEfficiency",type:{name:"Number"}}},_a={parameterPath:["options","extendedPostalCodesFor"],mapper:{serializedName:"extendedPostalCodesFor",type:{name:"String"}}},ba={parameterPath:"format",mapper:{required:!0,isConstant:!0,serializedName:"format",defaultValue:"json",type:{name:"String"}}},xa={parameterPath:"format",mapper:{required:!0,isConstant:!0,serializedName:"format",defaultValue:"png",type:{name:"String"}}},wa={parameterPath:["options","fuelEnergyDensityInMJoulesPerLiter"],mapper:{serializedName:"fuelEnergyDensityInMJoulesPerLiter",type:{name:"Number"}}},Sa={parameterPath:["options","heading"],mapper:{serializedName:"heading",constraints:{InclusiveMaximum:360,InclusiveMinimum:-360},type:{name:"Number"}}},Ta={parameterPath:["options","hilliness"],mapper:{serializedName:"hilliness",type:{name:"Enum",allowedValues:["low","normal","high"]}}},Ca={parameterPath:["options","idxSet"],mapper:{serializedName:"idxSet",type:{name:"Sequence",element:{type:{name:"Enum",allowedValues:["Addr","Geo","PAD","POI","Str","Xstr"]}}}},collectionFormat:Ze.Csv},Ea={parameterPath:["options","instructionsType"],mapper:{serializedName:"instructionsType",type:{name:"Enum",allowedValues:["coded","text","tagged"]}}},Ia={parameterPath:["options","isAsync"],mapper:{serializedName:"isAsync",type:{name:"Boolean"}}},Pa={parameterPath:["options","language"],mapper:{serializedName:"language",type:{name:"String"}}},Ra={parameterPath:["options","lat"],mapper:{serializedName:"lat",type:{name:"Number"}}},Na={parameterPath:"lat",mapper:{required:!0,serializedName:"lat",type:{name:"Number"}}},Aa={parameterPath:["options","limit"],mapper:{serializedName:"limit",constraints:{InclusiveMaximum:100,InclusiveMinimum:1},type:{name:"Number"}}},za={parameterPath:["options","limit"],mapper:{serializedName:"limit",type:{name:"Number"}}},Ma={parameterPath:["options","lon"],mapper:{serializedName:"lon",type:{name:"Number"}}},ka={parameterPath:"lon",mapper:{required:!0,serializedName:"lon",type:{name:"Number"}}},Oa={parameterPath:["options","maxAlternatives"],mapper:{serializedName:"maxAlternatives",constraints:{InclusiveMaximum:5,InclusiveMinimum:0},type:{name:"Number"}}},La={parameterPath:["options","maxChargeInkWh"],mapper:{serializedName:"maxChargeInkWh",type:{name:"String"}}},Da={parameterPath:"metroId",mapper:{required:!0,serializedName:"metroId",type:{name:"Number"}}},Ba={parameterPath:["options","minDeviationDistance"],mapper:{serializedName:"minDeviationDistance",type:{name:"Number"}}},Fa={parameterPath:["options","minDeviationTime"],mapper:{serializedName:"minDeviationTime",type:{name:"Number"}}},qa={parameterPath:["options","mode"],mapper:{serializedName:"mode",type:{name:"Enum",allowedValues:["All","EnterAndExit"]}}},Ua={parameterPath:["options","modeType"],mapper:{serializedName:"modeType",type:{name:"Sequence",element:{type:{name:"Enum",allowedValues:["walk","bike","publicTransit"]}}}},collectionFormat:Ze.Csv},ja={parameterPath:["options","numberOfClosestPoints"],mapper:{serializedName:"numberOfClosestPoints",type:{name:"Number"}}},Va={parameterPath:["options","objectType"],mapper:{serializedName:"objectType",type:{name:"Sequence",element:{type:{name:"Enum",allowedValues:["stop","docklessBike","docklessElectricBike","docklessElectricScooter","docklessScooter","docklessMoped","carShare","docklessVehicle","bikeDock"]}}}},collectionFormat:Ze.Csv},Ga={parameterPath:["options","ofs"],mapper:{serializedName:"ofs",constraints:{InclusiveMaximum:1900,InclusiveMinimum:0},type:{name:"Number"}}},Ha={parameterPath:["options","openingHours"],mapper:{serializedName:"openingHours",type:{name:"Enum",allowedValues:["nextSevenDays"]}}},Za={parameterPath:["options","options"],mapper:{serializedName:"options",type:{name:"Enum",allowedValues:["none","zoneInfo","transitions","all"]}}},Wa={parameterPath:["options","path"],mapper:{serializedName:"path",type:{name:"Sequence",element:{type:{name:"String"}}}},collectionFormat:Ze.Multi},Ka={parameterPath:["options","pins"],mapper:{serializedName:"pins",type:{name:"Sequence",element:{type:{name:"String"}}}},collectionFormat:Ze.Multi},Xa={parameterPath:"query",mapper:{required:!0,serializedName:"query",type:{name:"String"}}},Ya={parameterPath:["options","radius"],mapper:{serializedName:"radius",type:{name:"Number"}}},Ja={parameterPath:["options","report"],mapper:{serializedName:"report",type:{name:"String"}}},$a={parameterPath:["options","routeRepresentation"],mapper:{serializedName:"routeRepresentation",type:{name:"Enum",allowedValues:["polyline","summaryOnly","none"]}}},Qa={parameterPath:["options","routeType"],mapper:{serializedName:"routeType",type:{name:"Enum",allowedValues:["fastest","shortest","eco","thrilling"]}}},es={parameterPath:["options","searchBuffer"],mapper:{serializedName:"searchBuffer",constraints:{InclusiveMaximum:500,InclusiveMinimum:0},type:{name:"Number"}}},ts={parameterPath:["options","sectionType"],mapper:{serializedName:"sectionType",type:{name:"Enum",allowedValues:["carTrain","country","ferry","motorway","pedestrian","tollRoad","tollVignette","traffic","travelMode","tunnel"]}}},rs={parameterPath:["options","text"],mapper:{serializedName:"text",type:{name:"String"}}},is={parameterPath:["options","timeStamp"],mapper:{serializedName:"timeStamp",type:{name:"DateTime"}}},ns={parameterPath:["options","topLeft"],mapper:{serializedName:"topLeft",type:{name:"String"}}},os={parameterPath:["options","traffic"],mapper:{serializedName:"traffic",type:{name:"Boolean"}}},as={parameterPath:["options","transitionsFrom"],mapper:{serializedName:"transitionsFrom",type:{name:"DateTime"}}},ss={parameterPath:["options","transitionsYears"],mapper:{serializedName:"transitionsYears",type:{name:"Number"}}},ls={parameterPath:["options","transitType"],mapper:{serializedName:"transitType",type:{name:"Sequence",element:{type:{name:"Enum",allowedValues:["bus","cableCar","ferry","funicular","gondola","rail","tram","subway"]}}}},collectionFormat:Ze.Csv},us={parameterPath:["options","travelMode"],mapper:{serializedName:"travelMode",type:{name:"Enum",allowedValues:["car","truck","taxi","bus","van","motorcycle","bicycle","pedestrian"]}}},cs={parameterPath:["options","typeahead"],mapper:{serializedName:"typeahead",type:{name:"Boolean"}}},ps={parameterPath:"udid",mapper:{required:!0,serializedName:"udid",type:{name:"String"}}},hs={parameterPath:["options","uphillEfficiency"],mapper:{serializedName:"uphillEfficiency",type:{name:"Number"}}},ds={parameterPath:["options","userTime"],mapper:{serializedName:"userTime",type:{name:"String"}}},ms={parameterPath:["options","vehicleAxleWeight"],mapper:{serializedName:"vehicleAxleWeight",type:{name:"Number"}}},fs={parameterPath:["options","vehicleCommercial"],mapper:{serializedName:"vehicleCommercial",type:{name:"Boolean"}}},ys={parameterPath:["options","vehicleEngineType"],mapper:{serializedName:"vehicleEngineType",type:{name:"Enum",allowedValues:["combustion","electric"]}}},gs={parameterPath:["options","vehicleHeading"],mapper:{serializedName:"vehicleHeading",constraints:{InclusiveMaximum:359,InclusiveMinimum:0},type:{name:"Number"}}},vs={parameterPath:["options","vehicleHeight"],mapper:{serializedName:"vehicleHeight",type:{name:"Number"}}},_s={parameterPath:["options","vehicleLength"],mapper:{serializedName:"vehicleLength",type:{name:"Number"}}},bs={parameterPath:["options","vehicleLoadType"],mapper:{serializedName:"vehicleLoadType",type:{name:"Enum",allowedValues:["USHazmatClass1","USHazmatClass2","USHazmatClass3","USHazmatClass4","USHazmatClass5","USHazmatClass6","USHazmatClass7","USHazmatClass8","USHazmatClass9","otherHazmatExplosive","otherHazmatGeneral","otherHazmatHarmfulToWater"]}}},xs={parameterPath:["options","vehicleMaxSpeed"],mapper:{serializedName:"vehicleMaxSpeed",type:{name:"Number"}}},ws={parameterPath:["options","vehicleWeight"],mapper:{serializedName:"vehicleWeight",type:{name:"Number"}}},Ss={parameterPath:["options","vehicleWidth"],mapper:{serializedName:"vehicleWidth",type:{name:"Number"}}},Ts={parameterPath:["options","view"],mapper:{serializedName:"view",type:{name:"String"}}},Cs={parameterPath:["options","windingness"],mapper:{serializedName:"windingness",type:{name:"Enum",allowedValues:["low","normal","high"]}}},Es={parameterPath:"xTileIndex",mapper:{required:!0,serializedName:"x",type:{name:"Number"}}},Is={parameterPath:"yTileIndex",mapper:{required:!0,serializedName:"y",type:{name:"Number"}}},Ps={parameterPath:"zoom",mapper:{required:!0,serializedName:"zoom",type:{name:"Number"}}},Rs=(Ns.prototype.getSearchPolygon=function(e,t,r){return this.client.sendOperationRequest({geometries:e,options:t},zs,r)},Ns.prototype.getSearchFuzzy=function(e,t,r){return this.client.sendOperationRequest({query:e,options:t},Ms,r)},Ns.prototype.getSearchPOI=function(e,t,r){return this.client.sendOperationRequest({query:e,options:t},ks,r)},Ns.prototype.getSearchNearby=function(e,t,r,i){return this.client.sendOperationRequest({lat:e,lon:t,options:r},Os,i)},Ns.prototype.getSearchPOICategory=function(e,t,r){return this.client.sendOperationRequest({query:e,options:t},Ls,r)},Ns.prototype.getSearchAddress=function(e,t,r){return this.client.sendOperationRequest({query:e,options:t},Ds,r)},Ns.prototype.getSearchAddressReverse=function(e,t,r){return this.client.sendOperationRequest({query:e,options:t},Bs,r)},Ns.prototype.getSearchAddressReverseCrossStreet=function(e,t,r){return this.client.sendOperationRequest({query:e,options:t},Fs,r)},Ns.prototype.getSearchAddressStructured=function(e,t,r){return this.client.sendOperationRequest({countryCode:e,options:t},qs,r)},Ns.prototype.postSearchInsideGeometry=function(e,t,r,i){return this.client.sendOperationRequest({query:e,searchInsideGeometryRequestBody:t,options:r},Us,i)},Ns.prototype.postSearchAlongRoute=function(e,t,r,i,n){return this.client.sendOperationRequest({query:e,maxDetourTime:t,searchAlongRouteRequestBody:r,options:i},js,n)},Ns.prototype.postSearchFuzzyBatchPreview=function(e,t){return this.beginPostSearchFuzzyBatchPreview(e,t).then((function(e){return e.pollUntilFinished()}))},Ns.prototype.postSearchAddressBatchPreview=function(e,t){return this.beginPostSearchAddressBatchPreview(e,t).then((function(e){return e.pollUntilFinished()}))},Ns.prototype.postSearchAddressReverseBatchPreview=function(e,t){return this.beginPostSearchAddressReverseBatchPreview(e,t).then((function(e){return e.pollUntilFinished()}))},Ns.prototype.beginPostSearchFuzzyBatchPreview=function(e,t){return this.client.sendLRORequest({searchFuzzyBatchRequestBody:e,options:t},Vs,t)},Ns.prototype.beginPostSearchAddressBatchPreview=function(e,t){return this.client.sendLRORequest({searchAddressBatchRequestBody:e,options:t},Gs,t)},Ns.prototype.beginPostSearchAddressReverseBatchPreview=function(e,t){return this.client.sendLRORequest({searchAddressReverseBatchRequestBody:e,options:t},Hs,t)},Ns);function Ns(e){this.client=e}var As=new b(Vo),zs={httpMethod:"GET",path:"search/polygon/{format}",urlParameters:[ba],queryParameters:[Yo,{parameterPath:"geometries",mapper:{required:!0,serializedName:"geometries",type:{name:"String"}}}],headerParameters:[Ho],responses:{200:{bodyMapper:Ln},default:{bodyMapper:Rn}},serializer:As},Ms={httpMethod:"GET",path:"search/fuzzy/{format}",urlParameters:[ba],queryParameters:[Yo,Xa,cs,Aa,Ga,la,Ra,Ma,Ya,ns,ra,Pa,_a,{parameterPath:["options","minFuzzyLevel"],mapper:{serializedName:"minFuzzyLevel",constraints:{InclusiveMaximum:4,InclusiveMinimum:1},type:{name:"Number"}}},{parameterPath:["options","maxFuzzyLevel"],mapper:{serializedName:"maxFuzzyLevel",constraints:{InclusiveMaximum:4,InclusiveMinimum:1},type:{name:"Number"}}},Ca,ta,oa,Ts,Ha],headerParameters:[Ho],responses:{200:{bodyMapper:Dn},default:{bodyMapper:Rn}},serializer:As},ks={httpMethod:"GET",path:"search/poi/{format}",urlParameters:[ba],queryParameters:[Yo,Xa,cs,Aa,Ga,la,Ra,Ma,Ya,ns,ra,Pa,_a,ta,oa,Ts,Ha],headerParameters:[Ho],responses:{200:{bodyMapper:Bn},default:{bodyMapper:Rn}},serializer:As},Os={httpMethod:"GET",path:"search/nearby/{format}",urlParameters:[ba],queryParameters:[Yo,Na,ka,Aa,Ga,la,Ya,Pa,_a,ta,oa,Ts],headerParameters:[Ho],responses:{200:{bodyMapper:Fn},default:{bodyMapper:Rn}},serializer:As},Ls={httpMethod:"GET",path:"search/poi/category/{format}",urlParameters:[ba],queryParameters:[Yo,Xa,cs,Aa,la,Ra,Ma,Ya,ns,ra,Pa,_a,ta,oa,Ts,Ha],headerParameters:[Ho],responses:{200:{bodyMapper:qn},default:{bodyMapper:Rn}},serializer:As},Ds={httpMethod:"GET",path:"search/address/{format}",urlParameters:[ba],queryParameters:[Yo,Xa,cs,Aa,{parameterPath:["options","ofs"],mapper:{serializedName:"ofs",constraints:{InclusiveMinimum:0},type:{name:"Number"}}},la,Ra,Ma,Ya,ns,ra,Pa,_a,Ts],headerParameters:[Ho],responses:{200:{bodyMapper:Un},default:{bodyMapper:Rn}},serializer:As},Bs={httpMethod:"GET",path:"search/address/reverse/{format}",urlParameters:[ba],queryParameters:[Yo,Xa,Pa,{parameterPath:["options","returnSpeedLimit"],mapper:{serializedName:"returnSpeedLimit",type:{name:"Boolean"}}},Sa,Ya,{parameterPath:["options","number"],mapper:{serializedName:"number",type:{name:"String"}}},{parameterPath:["options","returnRoadUse"],mapper:{serializedName:"returnRoadUse",type:{name:"Boolean"}}},{parameterPath:["options","roadUse"],mapper:{serializedName:"roadUse",type:{name:"String"}}},{parameterPath:["options","allowFreeformNewline"],mapper:{serializedName:"allowFreeformNewline",type:{name:"Boolean"}}},{parameterPath:["options","returnMatchType"],mapper:{serializedName:"returnMatchType",type:{name:"Boolean"}}},{parameterPath:["options","entityType"],mapper:{serializedName:"entityType",type:{name:"Enum",allowedValues:["Country","CountrySubdivision","CountrySecondarySubdivision","CountryTertiarySubdivision","Municipality","MunicipalitySubdivision","Neighbourhood","PostalCodeArea"]}}},Ts],headerParameters:[Ho],responses:{200:{bodyMapper:jn},default:{bodyMapper:Rn}},serializer:As},Fs={httpMethod:"GET",path:"search/address/reverse/crossStreet/{format}",urlParameters:[ba],queryParameters:[Yo,Xa,Sa,Ya,Pa,Ts],headerParameters:[Ho],responses:{200:{bodyMapper:Vn},default:{bodyMapper:Rn}},serializer:As},qs={httpMethod:"GET",path:"search/address/structured/{format}",urlParameters:[ba],queryParameters:[Yo,Pa,{parameterPath:"countryCode",mapper:{required:!0,serializedName:"countryCode",type:{name:"String"}}},za,{parameterPath:["options","ofs"],mapper:{serializedName:"ofs",type:{name:"Number"}}},{parameterPath:["options","streetNumber"],mapper:{serializedName:"streetNumber",type:{name:"String"}}},{parameterPath:["options","streetName"],mapper:{serializedName:"streetName",type:{name:"String"}}},{parameterPath:["options","crossStreet"],mapper:{serializedName:"crossStreet",type:{name:"String"}}},{parameterPath:["options","municipality"],mapper:{serializedName:"municipality",type:{name:"String"}}},{parameterPath:["options","municipalitySubdivision"],mapper:{serializedName:"municipalitySubdivision",type:{name:"String"}}},{parameterPath:["options","countryTertiarySubdivision"],mapper:{serializedName:"countryTertiarySubdivision",type:{name:"String"}}},{parameterPath:["options","countrySecondarySubdivision"],mapper:{serializedName:"countrySecondarySubdivision",type:{name:"String"}}},{parameterPath:["options","countrySubdivision"],mapper:{serializedName:"countrySubdivision",type:{name:"String"}}},{parameterPath:["options","postalCode"],mapper:{serializedName:"postalCode",type:{name:"String"}}},_a,Ts],headerParameters:[Ho],responses:{200:{bodyMapper:Gn},default:{bodyMapper:Rn}},serializer:As},Us={httpMethod:"POST",path:"search/geometry/{format}",urlParameters:[ba],queryParameters:[Yo,Xa,Aa,Pa,_a,Ca,Ts,Ha],headerParameters:[Ho],requestBody:{parameterPath:"searchInsideGeometryRequestBody",mapper:z(z({},Wn),{required:!0})},responses:{200:{bodyMapper:Hn},default:{bodyMapper:Rn}},serializer:As},js={httpMethod:"POST",path:"search/alongRoute/{format}",urlParameters:[ba],queryParameters:[Yo,Xa,{parameterPath:"maxDetourTime",mapper:{required:!0,serializedName:"maxDetourTime",constraints:{InclusiveMaximum:3600},type:{name:"Number"}}},{parameterPath:["options","limit"],mapper:{serializedName:"limit",constraints:{InclusiveMaximum:20},type:{name:"Number"}}},ta,oa,Ts,Ha],headerParameters:[Ho],requestBody:{parameterPath:"searchAlongRouteRequestBody",mapper:z(z({},Kn),{required:!0})},responses:{200:{bodyMapper:Zn},default:{bodyMapper:Rn}},serializer:As},Vs={httpMethod:"POST",path:"search/fuzzy/batch/{format}",urlParameters:[ba],queryParameters:[Yo],headerParameters:[Ho],requestBody:{parameterPath:"searchFuzzyBatchRequestBody",mapper:z(z({},Mn),{required:!0})},responses:{200:{bodyMapper:An,headersMapper:Oo},202:{headersMapper:Oo},default:{bodyMapper:Rn}},serializer:As},Gs={httpMethod:"POST",path:"search/address/batch/{format}",urlParameters:[ba],queryParameters:[Yo],headerParameters:[Ho],requestBody:{parameterPath:"searchAddressBatchRequestBody",mapper:z(z({},Mn),{required:!0})},responses:{200:{bodyMapper:An,headersMapper:Lo},202:{headersMapper:Lo},default:{bodyMapper:Rn}},serializer:As},Hs={httpMethod:"POST",path:"search/address/reverse/batch/{format}",urlParameters:[ba],queryParameters:[Yo],headerParameters:[Ho],requestBody:{parameterPath:"searchAddressReverseBatchRequestBody",mapper:z(z({},Mn),{required:!0})},responses:{200:{bodyMapper:An,headersMapper:Do},202:{headersMapper:Do},default:{bodyMapper:Rn}},serializer:As},Zs=Object.freeze({discriminators:jo,BatchRequestBody:Mn,BatchRequestBodyBatchItemsItem:zn,BatchResponse:An,BatchResponseSummary:Nn,CloudError:Rn,Coordinate:Qn,GeoJSONGeometry:kn,GeoJSONGeometryCollection:$n,LineString:On,MultiLineString:Eo,MultiPoint:Xn,MultiPolygon:Jn,Point:Yn,Polygon:mo,RouteDirectionsRequestBody:to,RouteDirectionsRequestBodySupportingPoints:eo,RouteDirectionsResponse:ro,RouteDirectionsResult:{serializedName:"RouteDirectionsResult",type:{name:"Composite",className:"RouteDirectionsResult",modelProperties:{summary:{serializedName:"summary",type:{name:"Composite",className:"RouteDirectionsSummary"}},legs:{readOnly:!0,serializedName:"legs",type:{name:"Sequence",element:{type:{name:"Composite",className:"RouteResultLeg"}}}},sections:{readOnly:!0,serializedName:"sections",type:{name:"Sequence",element:{type:{name:"Composite",className:"RouteResultSection"}}}},guidance:{serializedName:"guidance",type:{name:"Composite",className:"RouteResultGuidance"}}}}},RouteDirectionsSummary:{serializedName:"RouteDirectionsSummary",type:{name:"Composite",className:"RouteDirectionsSummary",modelProperties:{lengthInMeters:{readOnly:!0,serializedName:"lengthInMeters",type:{name:"Number"}},travelTimeInSeconds:{readOnly:!0,serializedName:"travelTimeInSeconds",type:{name:"Number"}},trafficDelayInSeconds:{readOnly:!0,serializedName:"trafficDelayInSeconds",type:{name:"Number"}},departureTime:{readOnly:!0,serializedName:"departureTime",type:{name:"String"}},arrivalTime:{readOnly:!0,serializedName:"arrivalTime",type:{name:"String"}}}}},RouteMatrixRequestBody:oo,RouteMatrixResponse:no,RouteMatrixResult:{serializedName:"RouteMatrixResult",type:{name:"Composite",className:"RouteMatrixResult",modelProperties:{statusCode:{readOnly:!0,serializedName:"statusCode",type:{name:"Number"}},response:{serializedName:"response",type:{name:"Composite",className:"RouteMatrixResultResponse"}}}}},RouteMatrixResultResponse:{serializedName:"RouteMatrixResultResponse",type:{name:"Composite",className:"RouteMatrixResultResponse",modelProperties:{routeSummary:{serializedName:"routeSummary",type:{name:"Composite",className:"RouteResultLegSummary"}}}}},RouteMatrixSummary:{serializedName:"RouteMatrixSummary",type:{name:"Composite",className:"RouteMatrixSummary",modelProperties:{successfulRoutes:{readOnly:!0,serializedName:"successfulRoutes",type:{name:"Number"}},totalRoutes:{readOnly:!0,serializedName:"totalRoutes",type:{name:"Number"}}}}},RouteOptimizedWaypoint:{serializedName:"RouteOptimizedWaypoint",type:{name:"Composite",className:"RouteOptimizedWaypoint",modelProperties:{providedIndex:{readOnly:!0,serializedName:"providedIndex",type:{name:"Number"}},optimizedIndex:{readOnly:!0,serializedName:"optimizedIndex",type:{name:"Number"}}}}},RoutePostRouteDirectionsBatchPreviewHeaders:Fo,RoutePostRouteMatrixPreviewHeaders:Bo,RouteRange:{serializedName:"RouteRange",type:{name:"Composite",className:"RouteRange",modelProperties:{center:{serializedName:"center",type:{name:"Composite",className:"Coordinate"}},boundary:{readOnly:!0,serializedName:"boundary",type:{name:"Sequence",element:{type:{name:"Composite",className:"Coordinate"}}}}}}},RouteRangeResponse:io,RouteResponseReport:{serializedName:"RouteResponseReport",type:{name:"Composite",className:"RouteResponseReport",modelProperties:{effectiveSettings:{readOnly:!0,serializedName:"effectiveSettings",type:{name:"Sequence",element:{type:{name:"Composite",className:"RouteResponseReportEffectiveSetting"}}}}}}},RouteResponseReportEffectiveSetting:{serializedName:"RouteResponseReportEffectiveSetting",type:{name:"Composite",className:"RouteResponseReportEffectiveSetting",modelProperties:{key:{readOnly:!0,serializedName:"key",type:{name:"String"}},value:{readOnly:!0,serializedName:"value",type:{name:"String"}}}}},RouteResultGuidance:{serializedName:"RouteResultGuidance",type:{name:"Composite",className:"RouteResultGuidance",modelProperties:{instructions:{readOnly:!0,serializedName:"instructions",type:{name:"Sequence",element:{type:{name:"Composite",className:"RouteResultInstruction"}}}},instructionGroups:{readOnly:!0,serializedName:"instructionGroups",type:{name:"Sequence",element:{type:{name:"Composite",className:"RouteResultInstructionGroup"}}}}}}},RouteResultInstruction:{serializedName:"RouteResultInstruction",type:{name:"Composite",className:"RouteResultInstruction",modelProperties:{routeOffsetInMeters:{readOnly:!0,serializedName:"routeOffsetInMeters",type:{name:"Number"}},travelTimeInSeconds:{readOnly:!0,serializedName:"travelTimeInSeconds",type:{name:"Number"}},point:{serializedName:"point",type:{name:"Composite",className:"Coordinate"}},instructionType:{serializedName:"instructionType",type:{name:"Enum",allowedValues:["TURN","ROAD_CHANGE","LOCATION_DEPARTURE","LOCATION_ARRIVAL","DIRECTION_INFO","LOCATION_WAYPOINT"]}},street:{readOnly:!0,serializedName:"street",type:{name:"String"}},countryCode:{readOnly:!0,serializedName:"countryCode",type:{name:"String"}},possibleCombineWithNext:{readOnly:!0,serializedName:"possibleCombineWithNext",type:{name:"Boolean"}},drivingSide:{readOnly:!0,serializedName:"drivingSide",type:{name:"Enum",allowedValues:["LEFT","RIGHT"]}},maneuver:{readOnly:!0,serializedName:"maneuver",type:{name:"Enum",allowedValues:["ARRIVE","ARRIVE_LEFT","ARRIVE_RIGHT","DEPART","STRAIGHT","KEEP_RIGHT","BEAR_RIGHT","TURN_RIGHT","SHARP_RIGHT","KEEP_LEFT","BEAR_LEFT","TURN_LEFT","SHARP_LEFT","MAKE_UTURN","ENTER_MOTORWAY","ENTER_FREEWAY","ENTER_HIGHWAY","TAKE_EXIT","MOTORWAY_EXIT_LEFT","MOTORWAY_EXIT_RIGHT","TAKE_FERRY","ROUNDABOUT_CROSS","ROUNDABOUT_RIGHT","ROUNDABOUT_LEFT","ROUNDABOUT_BACK","TRY_MAKE_UTURN","FOLLOW","SWITCH_PARALLEL_ROAD","SWITCH_MAIN_ROAD","ENTRANCE_RAMP","WAYPOINT_LEFT","WAYPOINT_RIGHT","WAYPOINT_REACHED"]}},message:{readOnly:!0,serializedName:"message",type:{name:"String"}}}}},RouteResultInstructionGroup:{serializedName:"RouteResultInstructionGroup",type:{name:"Composite",className:"RouteResultInstructionGroup",modelProperties:{firstInstructionIndex:{readOnly:!0,serializedName:"firstInstructionIndex",type:{name:"Number"}},lastInstructionIndex:{readOnly:!0,serializedName:"lastInstructionIndex",type:{name:"Number"}},groupLengthInMeters:{readOnly:!0,serializedName:"groupLengthInMeters",type:{name:"Number"}},groupMessage:{readOnly:!0,serializedName:"groupMessage",type:{name:"String"}}}}},RouteResultLeg:{serializedName:"RouteResultLeg",type:{name:"Composite",className:"RouteResultLeg",modelProperties:{summary:{serializedName:"summary",type:{name:"Composite",className:"RouteResultLegSummary"}},points:{readOnly:!0,serializedName:"points",type:{name:"Sequence",element:{type:{name:"Composite",className:"Coordinate"}}}}}}},RouteResultLegSummary:{serializedName:"RouteResultLegSummary",type:{name:"Composite",className:"RouteResultLegSummary",modelProperties:{lengthInMeters:{readOnly:!0,serializedName:"lengthInMeters",type:{name:"Number"}},travelTimeInSeconds:{readOnly:!0,serializedName:"travelTimeInSeconds",type:{name:"Number"}},trafficDelayInSeconds:{readOnly:!0,serializedName:"trafficDelayInSeconds",type:{name:"Number"}},departureTime:{readOnly:!0,serializedName:"departureTime",type:{name:"String"}},arrivalTime:{readOnly:!0,serializedName:"arrivalTime",type:{name:"String"}},noTrafficTravelTimeInSeconds:{readOnly:!0,serializedName:"noTrafficTravelTimeInSeconds",type:{name:"Number"}},historicTrafficTravelTimeInSeconds:{readOnly:!0,serializedName:"historicTrafficTravelTimeInSeconds",type:{name:"Number"}},liveTrafficIncidentsTravelTimeInSeconds:{readOnly:!0,serializedName:"liveTrafficIncidentsTravelTimeInSeconds",type:{name:"Number"}},fuelConsumptionInLiters:{readOnly:!0,serializedName:"fuelConsumptionInLiters",type:{name:"Number"}},batteryConsumptionInkWh:{readOnly:!0,serializedName:"batteryConsumptionInkWh",type:{name:"Number"}}}}},RouteResultSection:{serializedName:"RouteResultSection",type:{name:"Composite",className:"RouteResultSection",modelProperties:{startPointIndex:{readOnly:!0,serializedName:"startPointIndex",type:{name:"Number"}},endPointIndex:{readOnly:!0,serializedName:"endPointIndex",type:{name:"Number"}},sectionType:{readOnly:!0,serializedName:"sectionType",type:{name:"String"}},travelMode:{readOnly:!0,serializedName:"travelMode",type:{name:"String"}},simpleCategory:{readOnly:!0,serializedName:"simpleCategory",type:{name:"String"}},effectiveSpeedInKmh:{readOnly:!0,serializedName:"effectiveSpeedInKmh",type:{name:"Number"}},delayInSeconds:{readOnly:!0,serializedName:"delayInSeconds",type:{name:"Number"}},magnitudeOfDelay:{readOnly:!0,serializedName:"magnitudeOfDelay",type:{name:"Enum",allowedValues:["0","1","2","3","4"]}},tec:{serializedName:"tec",type:{name:"Composite",className:"RouteResultSectionTec"}}}}},RouteResultSectionTec:{serializedName:"RouteResultSectionTec",type:{name:"Composite",className:"RouteResultSectionTec",modelProperties:{effectCode:{readOnly:!0,serializedName:"effectCode",type:{name:"Number"}},causes:{serializedName:"causes",type:{name:"Sequence",element:{type:{name:"Composite",className:"RouteResultSectionTecCause"}}}}}}},RouteResultSectionTecCause:{serializedName:"RouteResultSectionTecCause",type:{name:"Composite",className:"RouteResultSectionTecCause",modelProperties:{mainCauseCode:{readOnly:!0,serializedName:"mainCauseCode",type:{name:"Number"}},subCauseCode:{readOnly:!0,serializedName:"subCauseCode",type:{name:"Number"}}}}}}),Ws=(Ks.prototype.postRouteMatrixPreview=function(e,t){return this.beginPostRouteMatrixPreview(e,t).then((function(e){return e.pollUntilFinished()}))},Ks.prototype.getRouteDirections=function(e,t,r){return this.client.sendOperationRequest({query:e,options:t},Ys,r)},Ks.prototype.postRouteDirections=function(e,t,r,i){return this.client.sendOperationRequest({query:e,routeDirectionsRequestBody:t,options:r},Js,i)},Ks.prototype.getRouteRange=function(e,t,r){return this.client.sendOperationRequest({query:e,options:t},$s,r)},Ks.prototype.postRouteDirectionsBatchPreview=function(e,t){return this.beginPostRouteDirectionsBatchPreview(e,t).then((function(e){return e.pollUntilFinished()}))},Ks.prototype.beginPostRouteMatrixPreview=function(e,t){return this.client.sendLRORequest({routeMatrixBody:e,options:t},Qs,t)},Ks.prototype.beginPostRouteDirectionsBatchPreview=function(e,t){return this.client.sendLRORequest({routeDirectionsBatchRequestBody:e,options:t},el,t)},Ks);function Ks(e){this.client=e}var Xs=new b(Zs),Ys={httpMethod:"GET",path:"route/directions/{format}",urlParameters:[ba],queryParameters:[Yo,Xa,Oa,Xo,Ba,Jo,ha,Fa,Ea,Pa,ia,$a,na,gs,Ja,ts,ms,Ss,vs,_s,xs,ws,fs,Cs,Ta,us,ea,os,Qa,bs,ys,sa,ca,Qo,wa,Go,pa,hs,va,aa,ua,La,$o],headerParameters:[Ho],responses:{200:{bodyMapper:ro},default:{bodyMapper:Rn}},serializer:Xs},Js={httpMethod:"POST",path:"route/directions/{format}",urlParameters:[ba],queryParameters:[Yo,Xa,Oa,Xo,Ba,Fa,Ea,Pa,ia,$a,na,gs,Ja,ts,Jo,ha,ms,_s,vs,Ss,xs,ws,fs,Cs,Ta,us,ea,os,Qa,bs,ys,sa,ca,Qo,wa,Go,pa,hs,va,aa,ua,La,$o],headerParameters:[Ho],requestBody:{parameterPath:"routeDirectionsRequestBody",mapper:z(z({},to),{required:!0})},responses:{200:{bodyMapper:ro},default:{bodyMapper:Rn}},serializer:Xs},$s={httpMethod:"GET",path:"route/range/{format}",urlParameters:[ba],queryParameters:[Yo,Xa,{parameterPath:["options","fuelBudgetInLiters"],mapper:{serializedName:"fuelBudgetInLiters",type:{name:"Number"}}},{parameterPath:["options","energyBudgetInkWh"],mapper:{serializedName:"energyBudgetInkWh",type:{name:"Number"}}},{parameterPath:["options","timeBudgetInSec"],mapper:{serializedName:"timeBudgetInSec",type:{name:"Number"}}},ha,Qa,os,ea,us,Ta,Cs,ms,Ss,vs,_s,xs,ws,fs,bs,ys,sa,ca,Qo,wa,Go,pa,hs,va,aa,ua,La,$o],headerParameters:[Ho],responses:{200:{bodyMapper:io},default:{bodyMapper:Rn}},serializer:Xs},Qs={httpMethod:"POST",path:"route/matrix/{format}",urlParameters:[ba],queryParameters:[Yo,{parameterPath:["options","waitForResults"],mapper:{serializedName:"waitForResults",type:{name:"Boolean"}}},na,ts,Jo,ha,ms,_s,vs,Ss,xs,ws,Cs,Ta,us,ea,os,Qa,bs],headerParameters:[Ho],requestBody:{parameterPath:"routeMatrixBody",mapper:z(z({},oo),{required:!0})},responses:{200:{bodyMapper:no,headersMapper:Bo},202:{headersMapper:Bo},default:{bodyMapper:Rn}},serializer:Xs},el={httpMethod:"POST",path:"route/directions/batch/{format}",urlParameters:[ba],queryParameters:[Yo],headerParameters:[Ho],requestBody:{parameterPath:"routeDirectionsBatchRequestBody",mapper:z(z({},Mn),{required:!0})},responses:{200:{bodyMapper:An,headersMapper:Fo},202:{headersMapper:Fo},default:{bodyMapper:Rn}},serializer:Xs},tl=Object.freeze({discriminators:jo,CloudError:Rn,Country:{serializedName:"Country",type:{name:"Composite",className:"Country",modelProperties:{name:{readOnly:!0,serializedName:"Name",type:{name:"String"}},code:{readOnly:!0,serializedName:"Code",type:{name:"String"}}}}},IanaId:{serializedName:"IanaId",type:{name:"Composite",className:"IanaId",modelProperties:{id:{readOnly:!0,serializedName:"id",type:{name:"String"}},isAlias:{readOnly:!0,serializedName:"isAlias",type:{name:"Boolean"}},aliasOf:{readOnly:!0,serializedName:"aliasOf",type:{name:"String"}},hasZone1970Location:{readOnly:!0,serializedName:"hasZone1970Location",type:{name:"Boolean"}}}}},Names:{serializedName:"Names",type:{name:"Composite",className:"Names",modelProperties:{iSO6391LanguageCode:{readOnly:!0,serializedName:"ISO6391LanguageCode",type:{name:"String"}},generic:{readOnly:!0,serializedName:"Generic",type:{name:"String"}},standard:{readOnly:!0,serializedName:"Standard",type:{name:"String"}},daylight:{readOnly:!0,serializedName:"Daylight",type:{name:"String"}}}}},ReferenceTimeByCoordinates:{serializedName:"ReferenceTimeByCoordinates",type:{name:"Composite",className:"ReferenceTimeByCoordinates",modelProperties:{tag:{readOnly:!0,serializedName:"Tag",type:{name:"String"}},standardOffset:{readOnly:!0,serializedName:"StandardOffset",type:{name:"String"}},daylightSavings:{readOnly:!0,serializedName:"DaylightSavings",type:{name:"String"}},wallTime:{readOnly:!0,serializedName:"WallTime",type:{name:"String"}},posixTzValidYear:{readOnly:!0,serializedName:"PosixTzValidYear",type:{name:"Number"}},posixTz:{readOnly:!0,serializedName:"PosixTz",type:{name:"String"}},sunrise:{readOnly:!0,serializedName:"Sunrise",type:{name:"String"}},sunset:{readOnly:!0,serializedName:"Sunset",type:{name:"String"}}}}},ReferenceTimeById:{serializedName:"ReferenceTimeById",type:{name:"Composite",className:"ReferenceTimeById",modelProperties:{tag:{readOnly:!0,serializedName:"Tag",type:{name:"String"}},standardOffset:{readOnly:!0,serializedName:"StandardOffset",type:{name:"String"}},daylightSavings:{readOnly:!0,serializedName:"DaylightSavings",type:{name:"String"}},wallTime:{readOnly:!0,serializedName:"WallTime",type:{name:"String"}},posixTzValidYear:{readOnly:!0,serializedName:"PosixTzValidYear",type:{name:"Number"}},posixTz:{readOnly:!0,serializedName:"PosixTz",type:{name:"String"}}}}},RepresentativePoint:{serializedName:"RepresentativePoint",type:{name:"Composite",className:"RepresentativePoint",modelProperties:{latitude:{readOnly:!0,serializedName:"Latitude",type:{name:"Number"}},longitude:{readOnly:!0,serializedName:"Longitude",type:{name:"Number"}}}}},TimeTransition:{serializedName:"TimeTransition",type:{name:"Composite",className:"TimeTransition",modelProperties:{tag:{readOnly:!0,serializedName:"Tag",type:{name:"String"}},standardOffset:{readOnly:!0,serializedName:"StandardOffset",type:{name:"String"}},daylightSavings:{readOnly:!0,serializedName:"DaylightSavings",type:{name:"String"}},utcStart:{readOnly:!0,serializedName:"UtcStart",type:{name:"DateTime"}},utcEnd:{readOnly:!0,serializedName:"UtcEnd",type:{name:"DateTime"}}}}},TimeZoneByCoordinates:{serializedName:"TimeZoneByCoordinates",type:{name:"Composite",className:"TimeZoneByCoordinates",modelProperties:{id:{readOnly:!0,serializedName:"Id",type:{name:"String"}},aliases:{readOnly:!0,serializedName:"Aliases",type:{name:"Sequence",element:{type:{name:"String"}}}},countries:{readOnly:!0,serializedName:"Countries",type:{name:"Sequence",element:{type:{name:"Composite",className:"Country"}}}},names:{serializedName:"Names",type:{name:"Composite",className:"Names"}},referenceTime:{serializedName:"ReferenceTime",type:{name:"Composite",className:"ReferenceTimeByCoordinates"}},representativePoint:{serializedName:"RepresentativePoint",type:{name:"Composite",className:"RepresentativePoint"}},timeTransitions:{readOnly:!0,serializedName:"TimeTransitions",type:{name:"Sequence",element:{type:{name:"Composite",className:"TimeTransition"}}}}}}},TimezoneByCoordinatesResult:so,TimezoneById:{serializedName:"TimezoneById",type:{name:"Composite",className:"TimezoneById",modelProperties:{id:{readOnly:!0,serializedName:"Id",type:{name:"String"}},aliases:{readOnly:!0,serializedName:"Aliases",type:{name:"Sequence",element:{type:{name:"String"}}}},countries:{readOnly:!0,serializedName:"Countries",type:{name:"Sequence",element:{type:{name:"Composite",className:"Country"}}}},names:{serializedName:"Names",type:{name:"Composite",className:"Names"}},referenceTime:{serializedName:"ReferenceTime",type:{name:"Composite",className:"ReferenceTimeById"}},representativePoint:{serializedName:"RepresentativePoint",type:{name:"Composite",className:"RepresentativePoint"}},timeTransitions:{readOnly:!0,serializedName:"TimeTransitions",type:{name:"Sequence",element:{type:{name:"Composite",className:"TimeTransition"}}}}}}},TimezoneByIdResult:ao,TimezoneEnumWindow:{serializedName:"TimezoneEnumWindow",type:{name:"Composite",className:"TimezoneEnumWindow",modelProperties:{windowsId:{readOnly:!0,serializedName:"WindowsId",type:{name:"String"}},territory:{readOnly:!0,serializedName:"Territory",type:{name:"String"}},ianaIds:{serializedName:"IanaIds",type:{name:"Sequence",element:{type:{name:"String"}}}}}}},TimezoneIanaVersionResult:lo}),rl=(il.prototype.getTimezoneByID=function(e,t,r){return this.client.sendOperationRequest({query:e,options:t},ol,r)},il.prototype.getTimezoneByCoordinates=function(e,t,r){return this.client.sendOperationRequest({query:e,options:t},al,r)},il.prototype.getTimezoneEnumWindows=function(e,t){return this.client.sendOperationRequest({options:e},sl,t)},il.prototype.getTimezoneEnumIANA=function(e,t){return this.client.sendOperationRequest({options:e},ll,t)},il.prototype.getTimezoneIANAVersion=function(e,t){return this.client.sendOperationRequest({options:e},ul,t)},il.prototype.getTimezoneWindowsToIANA=function(e,t,r){return this.client.sendOperationRequest({query:e,options:t},cl,r)},il);function il(e){this.client=e}var nl=new b(tl),ol={httpMethod:"GET",path:"timezone/byId/{format}",urlParameters:[ba],queryParameters:[Yo,Za,is,as,ss,Xa],headerParameters:[Zo],responses:{200:{bodyMapper:ao},default:{bodyMapper:Rn}},serializer:nl},al={httpMethod:"GET",path:"timezone/byCoordinates/{format}",urlParameters:[ba],queryParameters:[Yo,Za,is,as,ss,Xa],headerParameters:[Zo],responses:{200:{bodyMapper:so},default:{bodyMapper:Rn}},serializer:nl},sl={httpMethod:"GET",path:"timezone/enumWindows/{format}",urlParameters:[ba],queryParameters:[Yo],headerParameters:[Ho],responses:{200:{bodyMapper:{serializedName:"parsedResponse",type:{name:"Sequence",element:{type:{name:"Composite",className:"TimezoneEnumWindow"}}}}},default:{bodyMapper:Rn}},serializer:nl},ll={httpMethod:"GET",path:"timezone/enumIana/{format}",urlParameters:[ba],queryParameters:[Yo],headerParameters:[Ho],responses:{200:{bodyMapper:{serializedName:"parsedResponse",type:{name:"Sequence",element:{type:{name:"Composite",className:"IanaId"}}}}},default:{bodyMapper:Rn}},serializer:nl},ul={httpMethod:"GET",path:"timezone/ianaVersion/{format}",urlParameters:[ba],queryParameters:[Yo],headerParameters:[Ho],responses:{200:{bodyMapper:lo},default:{bodyMapper:Rn}},serializer:nl},cl={httpMethod:"GET",path:"timezone/windowsToIana/{format}",urlParameters:[ba],queryParameters:[Yo,Xa,{parameterPath:["options","territory"],mapper:{serializedName:"territory",type:{name:"String"}}}],headerParameters:[Ho],responses:{200:{bodyMapper:{serializedName:"parsedResponse",type:{name:"Sequence",element:{type:{name:"Composite",className:"IanaId"}}}}},default:{bodyMapper:Rn}},serializer:nl},pl=Object.freeze({discriminators:jo,CloudError:Rn,CopyrightBoundingResult:uo,CopyrightCaptionResult:co,CopyrightTileResult:ho,CopyrightWorldResult:po,Region:{serializedName:"Region",type:{name:"Composite",className:"Region",modelProperties:{copyrights:{readOnly:!0,serializedName:"copyrights",type:{name:"Sequence",element:{type:{name:"String"}}}},country:{readOnly:!0,serializedName:"country",type:{name:"Composite",className:"RegionCountry"}}}}},RegionCountry:{serializedName:"Region_country",type:{name:"Composite",className:"RegionCountry",modelProperties:{iSO3:{readOnly:!0,serializedName:"ISO3",type:{name:"String"}},label:{readOnly:!0,serializedName:"label",type:{name:"String"}}}}}}),hl=(dl.prototype.getMapImage=function(e,t){return this.client.sendOperationRequest({options:e},fl,t)},dl.prototype.getMapTile=function(e,t,r,i,n,o,a,s){return this.client.sendOperationRequest({format:e,layer:t,style:r,zoom:i,xTileIndex:n,yTileIndex:o,options:a},yl,s)},dl.prototype.getCopyrightCaption=function(e,t){return this.client.sendOperationRequest({options:e},gl,t)},dl.prototype.getMapImageryTile=function(e,t,r,i,n){return this.client.sendOperationRequest({zoom:e,xTileIndex:t,yTileIndex:r,options:i},vl,n)},dl.prototype.getCopyrightFromBoundingBox=function(e,t,r,i){return this.client.sendOperationRequest({mincoordinates:e,maxcoordinates:t,options:r},_l,i)},dl.prototype.getCopyrightForTile=function(e,t,r,i,n){return this.client.sendOperationRequest({zoom:e,xTileIndex:t,yTileIndex:r,options:i},bl,n)},dl.prototype.getCopyrightForWorld=function(e,t){return this.client.sendOperationRequest({options:e},xl,t)},dl);function dl(e){this.client=e}var ml=new b(pl),fl={httpMethod:"GET",path:"map/static/{format}",urlParameters:[xa],queryParameters:[Yo,Ka,Wa,{parameterPath:["options","layer"],mapper:{serializedName:"layer",type:{name:"Enum",allowedValues:["basic","hybrid","labels"]}}},{parameterPath:["options","style"],mapper:{serializedName:"style",type:{name:"String"}}},{parameterPath:["options","zoom"],mapper:{serializedName:"zoom",constraints:{InclusiveMaximum:20,InclusiveMinimum:0},type:{name:"Number"}}},{parameterPath:["options","center"],mapper:{serializedName:"center",type:{name:"String"}}},{parameterPath:["options","bbox"],mapper:{serializedName:"bbox",type:{name:"String"}}},{parameterPath:["options","height"],mapper:{serializedName:"height",constraints:{InclusiveMaximum:8192,InclusiveMinimum:1},type:{name:"Number"}}},{parameterPath:["options","width"],mapper:{serializedName:"width",constraints:{InclusiveMaximum:8192,InclusiveMinimum:1},type:{name:"Number"}}},Pa,Ts],headerParameters:[Ho],responses:{200:{bodyMapper:{serializedName:"parsedResponse",type:{name:"Stream"}}},default:{bodyMapper:Rn}},serializer:ml},yl={httpMethod:"GET",path:"map/tile/{format}",urlParameters:[{parameterPath:"format",mapper:{required:!0,serializedName:"format",type:{name:"Enum",allowedValues:["png","pbf"]}}}],queryParameters:[Yo,{parameterPath:"layer",mapper:{required:!0,serializedName:"layer",type:{name:"Enum",allowedValues:["basic","hybrid","labels","terra"]}}},{parameterPath:"style",mapper:{required:!0,serializedName:"style",type:{name:"Enum",allowedValues:["main","shaded_relief"]}}},Ps,Es,Is,{parameterPath:["options","tileSize"],mapper:{serializedName:"tileSize",type:{name:"Number"}}},Pa,Ts],headerParameters:[Ho],responses:{200:{bodyMapper:{serializedName:"parsedResponse",type:{name:"Stream"}}},default:{bodyMapper:Rn}},serializer:ml},gl={httpMethod:"GET",path:"map/copyright/caption/{format}",urlParameters:[ba],queryParameters:[Yo],headerParameters:[Ho],responses:{200:{bodyMapper:co},default:{bodyMapper:Rn}},serializer:ml},vl={httpMethod:"GET",path:"map/imagery/{format}",urlParameters:[xa],queryParameters:[Yo,{parameterPath:"style",mapper:{required:!0,isConstant:!0,serializedName:"style",defaultValue:"satellite",type:{name:"String"}}},Ps,Es,Is],headerParameters:[Ho],responses:{200:{bodyMapper:{serializedName:"parsedResponse",type:{name:"Stream"}}},default:{bodyMapper:Rn}},serializer:ml},_l={httpMethod:"GET",path:"map/copyright/bounding/{format}",urlParameters:[ba],queryParameters:[Yo,{parameterPath:"mincoordinates",mapper:{required:!0,serializedName:"mincoordinates",type:{name:"String"}}},{parameterPath:"maxcoordinates",mapper:{required:!0,serializedName:"maxcoordinates",type:{name:"String"}}},rs],headerParameters:[Ho],responses:{200:{bodyMapper:uo},default:{bodyMapper:Rn}},serializer:ml},bl={httpMethod:"GET",path:"map/copyright/tile/{format}",urlParameters:[ba],queryParameters:[Yo,Ps,Es,Is,rs],headerParameters:[Ho],responses:{200:{bodyMapper:ho},default:{bodyMapper:Rn}},serializer:ml},xl={httpMethod:"GET",path:"map/copyright/world/{format}",urlParameters:[ba],queryParameters:[Yo,rs],headerParameters:[Ho],responses:{200:{bodyMapper:po},default:{bodyMapper:Rn}},serializer:ml},wl=Object.freeze({discriminators:jo,Agency:{serializedName:"Agency",type:{name:"Composite",className:"Agency",modelProperties:{agencyId:{serializedName:"agencyId",type:{name:"String"}},agencyKey:{serializedName:"agencyKey",type:{name:"String"}},agencyName:{serializedName:"agencyName",type:{name:"String"}},transitType:{serializedName:"transitType",type:{name:"Composite",className:"TransitTypeResult"}}}}},Alert:{serializedName:"Alert",type:{name:"Composite",className:"Alert",modelProperties:{alertSummary:{serializedName:"alertSummary",type:{name:"String"}},publicationDate:{serializedName:"publicationDate",type:{name:"DateTime"}},category:{serializedName:"category",type:{name:"String"}},alertLevel:{serializedName:"alertLevel",type:{name:"String"}},details:{serializedName:"details",type:{name:"Composite",className:"AlertDetail"}}}}},AlertDescription:{serializedName:"AlertDescription",type:{name:"Composite",className:"AlertDescription",modelProperties:{data:{serializedName:"data",type:{name:"String"}},format:{serializedName:"format",type:{name:"String"}},sourceUrl:{serializedName:"sourceUrl",type:{name:"String"}}}}},AlertDetail:{serializedName:"AlertDetail",type:{name:"Composite",className:"AlertDetail",modelProperties:{agencyId:{serializedName:"agencyId",type:{name:"String"}},agencyName:{serializedName:"agencyName",type:{name:"String"}},title:{serializedName:"title",type:{name:"String"}},description:{serializedName:"description",type:{name:"Composite",className:"AlertDescription"}},activeFrom:{serializedName:"activeFrom",type:{name:"DateTime"}},activeTo:{serializedName:"activeTo",type:{name:"DateTime"}},effect:{serializedName:"effect",type:{name:"String"}}}}},CarShareResponse:xo,CloudError:Rn,Coordinate:Qn,Direction:{serializedName:"Direction",type:{name:"Composite",className:"Direction",modelProperties:{relativeDirection:{serializedName:"relativeDirection",type:{name:"Enum",allowedValues:["depart","hardLeft","left","slightlyLeft","continue","slightlyRight","right","hardRight","circleClockwise","circleCounterclockwise","elevator","uturnLeft","uturnRight"]}},absoluteDirection:{serializedName:"absoluteDirection",type:{name:"Enum",allowedValues:["north","northeast","east","southeast","south","southwest","west","northwest"]}}}}},GeoJSONGeometry:kn,ItineraryResult:{serializedName:"ItineraryResult",type:{name:"Composite",className:"ItineraryResult",modelProperties:{itineraryId:{serializedName:"itineraryId",type:{name:"String"}},departureTime:{serializedName:"departureTime",type:{name:"DateTime"}},arrivalTime:{serializedName:"arrivalTime",type:{name:"DateTime"}},travelTimeInSeconds:{serializedName:"travelTimeInSeconds",type:{name:"Number"}},numberOfLegs:{serializedName:"numberOfLegs",type:{name:"Number"}},legs:{serializedName:"legs",type:{name:"Sequence",element:{type:{name:"Composite",className:"RouteItineraryLeg"}}}}}}},Leg:{serializedName:"Leg",type:{name:"Composite",className:"Leg",modelProperties:{legType:{serializedName:"legType",type:{name:"Enum",allowedValues:["Walk","Bicycle","Tram","Subway","Rail","Bus","Ferry","Cable","Gondola","Funicular","PathWayWalk","Wait","WaitOnVehicle"]}},legStartTime:{serializedName:"legStartTime",type:{name:"String"}},legEndTime:{serializedName:"legEndTime",type:{name:"String"}},steps:{serializedName:"steps",type:{name:"Sequence",element:{type:{name:"Composite",className:"Step"}}}},origin:{serializedName:"origin",type:{name:"Composite",className:"LegPoint"}},destination:{serializedName:"destination",type:{name:"Composite",className:"LegPoint"}},geometry:{serializedName:"geometry",type:{name:"Composite",className:"LineString"}},lineGroup:{serializedName:"lineGroup",type:{name:"Composite",className:"LineGroup"}},line:{serializedName:"line",type:{name:"Composite",className:"Line"}},stops:{serializedName:"stops",type:{name:"Sequence",element:{type:{name:"Composite",className:"Stop"}}}},departures:{serializedName:"departures",type:{name:"Sequence",element:{type:{name:"Composite",className:"LineArrival"}}}},waitOnVehicle:{serializedName:"waitOnVehicle",type:{name:"String"}}}}},LegPoint:{serializedName:"LegPoint",type:{name:"Composite",className:"LegPoint",modelProperties:{position:{serializedName:"position",type:{name:"Composite",className:"Coordinate"}}}}},Line:{serializedName:"Line",type:{name:"Composite",className:"Line",modelProperties:{lineId:{serializedName:"lineId",type:{name:"String"}},lineGroupId:{serializedName:"lineGroupId",type:{name:"String"}},direction:{serializedName:"direction",type:{name:"String"}},agencyId:{serializedName:"agencyId",type:{name:"String"}},agencyName:{serializedName:"agencyName",type:{name:"String"}},lineNumber:{serializedName:"lineNumber",type:{name:"String"}},origin:{serializedName:"origin",type:{name:"String"}},lineDestination:{serializedName:"lineDestination",type:{name:"String"}},mostFrequentPatternId:{serializedName:"mostFrequentPatternId",type:{name:"String"}},transitType:{serializedName:"transitType",type:{name:"Enum",allowedValues:["Bus","CableCar","Ferry","Funicular","Gondola","Rail","Tram","Subway"]}}}}},LineArrival:{serializedName:"LineArrival",type:{name:"Composite",className:"LineArrival",modelProperties:{lineId:{serializedName:"lineId",type:{name:"String"}},stopId:{serializedName:"stopId",type:{name:"String"}},scheduleTime:{serializedName:"scheduleTime",type:{name:"DateTime"}},scheduleType:{serializedName:"scheduleType",type:{name:"Enum",allowedValues:["scheduledTime","realTime"]}}}}},LineGroup:{serializedName:"LineGroup",type:{name:"Composite",className:"LineGroup",modelProperties:{lineGroupId:{serializedName:"lineGroupId",type:{name:"String"}},agencyId:{serializedName:"agencyId",type:{name:"String"}},agencyName:{serializedName:"agencyName",type:{name:"String"}},lineNumber:{serializedName:"lineNumber",type:{name:"String"}},caption1:{serializedName:"caption1",type:{name:"String"}},caption2:{serializedName:"caption2",type:{name:"String"}},color:{serializedName:"color",type:{name:"String"}},transitType:{serializedName:"transitType",type:{name:"Enum",allowedValues:["Bus","CableCar","Ferry","Funicular","Gondola","Rail","Tram","Subway"]}}}}},LineString:On,MetroAreaInfoResponse:yo,MetroAreaResponse:fo,MetroAreaResult:{serializedName:"MetroAreaResult",type:{name:"Composite",className:"MetroAreaResult",modelProperties:{metroId:{serializedName:"metroId",type:{name:"Number"}},metroName:{serializedName:"metroName",type:{name:"String"}},geometry:{serializedName:"geometry",type:{name:"Composite",className:"Polygon"}},viewport:{serializedName:"viewport",type:{name:"Composite",className:"ResultViewport"}}}}},MultiLineString:Eo,MultiPoint:Xn,MultiPolygon:Jn,NearbyTransitResponse:go,OperatorInfo:{serializedName:"OperatorInfo",type:{name:"Composite",className:"OperatorInfo",modelProperties:{id:{serializedName:"id",type:{name:"String"}},name:{serializedName:"name",type:{name:"String"}},description:{serializedName:"description",type:{name:"String"}},siteUrl:{serializedName:"siteUrl",type:{name:"String"}}}}},Pattern:{serializedName:"Pattern",type:{name:"Composite",className:"Pattern",modelProperties:{patternId:{serializedName:"patternId",type:{name:"String"}},lineId:{serializedName:"lineId",type:{name:"String"}},stopIds:{serializedName:"stopIds",type:{name:"Sequence",element:{type:{name:"String"}}}},geometry:{serializedName:"geometry",type:{name:"Composite",className:"LineString"}}}}},Point:Yn,Polygon:mo,Pricing:{serializedName:"Pricing",type:{name:"Composite",className:"Pricing",modelProperties:{currency:{serializedName:"currency",type:{name:"String"}},usagePrice:{serializedName:"usagePrice",type:{name:"String"}},reservationPrice:{serializedName:"reservationPrice",type:{name:"String"}}}}},RealTimeArrivalResult:{serializedName:"RealTimeArrivalResult",type:{name:"Composite",className:"RealTimeArrivalResult",modelProperties:{arrivalMinutes:{serializedName:"arrivalMinutes",type:{name:"Number"}},scheduleType:{serializedName:"scheduleType",type:{name:"Enum",allowedValues:["scheduledTime","realTime"]}},patternId:{serializedName:"patternId",type:{name:"String"}},line:{serializedName:"line",type:{name:"Composite",className:"Line"}},stop:{serializedName:"stop",type:{name:"Composite",className:"Stop"}}}}},RealTimeArrivalsResponse:To,ResultViewport:{serializedName:"ResultViewport",type:{name:"Composite",className:"ResultViewport",modelProperties:{topLeftPoint:{serializedName:"topLeftPoint",type:{name:"Composite",className:"Coordinate"}},btmRightPoint:{serializedName:"btmRightPoint",type:{name:"Composite",className:"Coordinate"}}}}},RouteItineraryLeg:{serializedName:"RouteItineraryLeg",type:{name:"Composite",className:"RouteItineraryLeg",modelProperties:{legType:{serializedName:"legType",type:{name:"Enum",allowedValues:["Walk","Bicycle","Tram","Subway","Rail","Bus","Ferry","Cable","Gondola","Funicular","PathWayWalk","Wait","WaitOnVehicle"]}},legStartTime:{serializedName:"legStartTime",type:{name:"String"}},legEndTime:{serializedName:"legEndTime",type:{name:"String"}},caption:{serializedName:"caption",type:{name:"String"}},lengthInMeters:{serializedName:"lengthInMeters",type:{name:"Number"}}}}},Step:{serializedName:"Step",type:{name:"Composite",className:"Step",modelProperties:{direction:{serializedName:"direction",type:{name:"Composite",className:"Direction"}},streetName:{serializedName:"streetName",type:{name:"String"}}}}},Stop:{serializedName:"Stop",type:{name:"Composite",className:"Stop",modelProperties:{stopId:{serializedName:"stopId",type:{name:"String"}},stopKey:{serializedName:"stopKey",type:{name:"String"}},stopName:{serializedName:"stopName",type:{name:"String"}},stopCode:{serializedName:"stopCode",type:{name:"String"}},position:{serializedName:"position",type:{name:"Composite",className:"Coordinate"}},mainTransitType:{serializedName:"mainTransitType",type:{name:"String"}},mainAgencyId:{serializedName:"mainAgencyId",type:{name:"String"}},mainAgencyName:{serializedName:"mainAgencyName",type:{name:"String"}}}}},TransitDockInfoResponse:wo,TransitItineraryResponse:bo,TransitLineInfoResponse:So,TransitObjectResult:{serializedName:"TransitObjectResult",type:{name:"Composite",className:"TransitObjectResult",modelProperties:{id:{serializedName:"id",type:{name:"String"}},type:{serializedName:"type",type:{name:"String"}},objectDetails:{serializedName:"objectDetails",type:{name:"Object"}},position:{serializedName:"position",type:{name:"Composite",className:"Coordinate"}},viewport:{serializedName:"viewport",type:{name:"Composite",className:"ResultViewport"}}}}},TransitRouteResponse:_o,TransitStopInfoResponse:vo,TransitTypeResult:{serializedName:"TransitTypeResult",type:{name:"Composite",className:"TransitTypeResult",modelProperties:{transitType:{serializedName:"transitType",type:{name:"Enum",allowedValues:["Bus","CableCar","Ferry","Funicular","Gondola","Rail","Tram","Subway"]}},captionOverride:{serializedName:"captionOverride",type:{name:"String"}}}}}}),Sl=(Tl.prototype.getMetroAreaPreview=function(e,t,r){return this.client.sendOperationRequest({query:e,options:t},El,r)},Tl.prototype.getMetroAreaInfoPreview=function(e,t,r,i){return this.client.sendOperationRequest({query:e,detailType:t,options:r},Il,i)},Tl.prototype.getNearbyTransitPreview=function(e,t,r,i){return this.client.sendOperationRequest({metroId:e,query:t,options:r},Pl,i)},Tl.prototype.getTransitDockInfoPreview=function(e,t,r){return this.client.sendOperationRequest({query:e,options:t},Rl,r)},Tl.prototype.getCarShareInfoPreview=function(e,t,r){return this.client.sendOperationRequest({query:e,options:t},Nl,r)},Tl.prototype.getTransitLineInfoPreview=function(e,t,r,i){return this.client.sendOperationRequest({metroId:e,query:t,options:r},Al,i)},Tl.prototype.getTransitStopInfoPreview=function(e,t,r,i){return this.client.sendOperationRequest({metroId:e,query:t,options:r},zl,i)},Tl.prototype.getTransitRoutePreview=function(e,t,r,i,n){return this.client.sendOperationRequest({metroId:e,origin:t,destination:r,options:i},Ml,n)},Tl.prototype.getTransitItineraryPreview=function(e,t,r){return this.client.sendOperationRequest({query:e,options:t},kl,r)},Tl.prototype.getRealTimeArrivalsPreview=function(e,t,r,i){return this.client.sendOperationRequest({metroId:e,query:t,options:r},Ol,i)},Tl);function Tl(e){this.client=e}var Cl=new b(wl),El={httpMethod:"GET",path:"mobility/metroArea/id/{format}",urlParameters:[ba],queryParameters:[Yo,Xa,{parameterPath:["options","queryType"],mapper:{serializedName:"queryType",type:{name:"Enum",allowedValues:["position","countryCode"]}}},Pa],headerParameters:[Ho],responses:{200:{bodyMapper:fo},default:{bodyMapper:Rn}},serializer:Cl},Il={httpMethod:"GET",path:"mobility/metroArea/info/{format}",urlParameters:[ba],queryParameters:[Yo,{parameterPath:"query",mapper:{required:!0,serializedName:"query",type:{name:"Number"}}},da,Pa],headerParameters:[Ho],responses:{200:{bodyMapper:yo},default:{bodyMapper:Rn}},serializer:Cl},Pl={httpMethod:"GET",path:"mobility/transit/nearby/{format}",urlParameters:[ba],queryParameters:[Yo,Da,Xa,za,Ya,Va,Pa],headerParameters:[Ho],responses:{200:{bodyMapper:go},default:{bodyMapper:Rn}},serializer:Cl},Rl={httpMethod:"GET",path:"mobility/transit/dock/{format}",urlParameters:[ba],queryParameters:[Yo,Xa,Pa],headerParameters:[Ho],responses:{200:{bodyMapper:wo},default:{bodyMapper:Rn}},serializer:Cl},Nl={httpMethod:"GET",path:"mobility/transit/carShare/{format}",urlParameters:[ba],queryParameters:[Yo,Xa,Pa],headerParameters:[Ho],responses:{200:{bodyMapper:xo},default:{bodyMapper:Rn}},serializer:Cl},Al={httpMethod:"GET",path:"mobility/transit/line/{format}",urlParameters:[ba],queryParameters:[Yo,Da,Xa,ma,Pa],headerParameters:[Ho],responses:{200:{bodyMapper:So},default:{bodyMapper:Rn}},serializer:Cl},zl={httpMethod:"GET",path:"mobility/transit/stop/{format}",urlParameters:[ba],queryParameters:[Yo,Da,Xa,{parameterPath:["options","queryType"],mapper:{serializedName:"queryType",type:{name:"Enum",allowedValues:["stopId","stopKey"]}}},fa,Pa],headerParameters:[Ho],responses:{200:{bodyMapper:vo},default:{bodyMapper:Rn}},serializer:Cl},Ml={httpMethod:"GET",path:"mobility/transit/route/{format}",urlParameters:[ba],queryParameters:[Yo,Da,{parameterPath:"origin",mapper:{required:!0,serializedName:"origin",type:{name:"String"}}},{parameterPath:["options","originType"],mapper:{serializedName:"originType",type:{name:"Enum",allowedValues:["position","stopId","stopKey"]}}},{parameterPath:"destination",mapper:{required:!0,serializedName:"destination",type:{name:"String"}}},{parameterPath:["options","destinationType"],mapper:{serializedName:"destinationType",type:{name:"Enum",allowedValues:["position","stopId","stopKey"]}}},Ua,ls,Wo,Ko,{parameterPath:["options","time"],mapper:{serializedName:"time",type:{name:"String"}}},{parameterPath:["options","timeType"],mapper:{serializedName:"timeType",type:{name:"Enum",allowedValues:["arrival","departure","last"]}}},{parameterPath:["options","routeType"],mapper:{serializedName:"routeType",type:{name:"Enum",allowedValues:["optimal","leastWalk","leastTransfers"]}}},{parameterPath:["options","bikeType"],mapper:{serializedName:"bikeType",type:{name:"Enum",allowedValues:["privateBike","dockedBike"]}}},Pa],headerParameters:[Ho],responses:{200:{bodyMapper:_o},default:{bodyMapper:Rn}},serializer:Cl},kl={httpMethod:"GET",path:"mobility/transit/itinerary/{format}",urlParameters:[ba],queryParameters:[Yo,Xa,ya,Pa],headerParameters:[Ho],responses:{200:{bodyMapper:bo},default:{bodyMapper:Rn}},serializer:Cl},Ol={httpMethod:"GET",path:"mobility/realtime/arrivals/{format}",urlParameters:[ba],queryParameters:[Yo,Da,Xa,{parameterPath:["options","queryType"],mapper:{serializedName:"queryType",type:{name:"Enum",allowedValues:["stops","line","lineAndStop","position"]}}},{parameterPath:["options","stopQueryType"],mapper:{serializedName:"stopQueryType",type:{name:"Enum",allowedValues:["stopId","stopKey"]}}},za,{parameterPath:["options","maxMinutesInFuture"],mapper:{serializedName:"maxMinutesInFuture",type:{name:"Number"}}},ls,Wo,Ko,{parameterPath:["options","timeoutInSeconds"],mapper:{serializedName:"timeoutInSeconds",type:{name:"Number"}}},Pa],headerParameters:[Ho],responses:{200:{bodyMapper:To},default:{bodyMapper:Rn}},serializer:Cl},Ll=Object.freeze({discriminators:jo,BufferRequestBody:Po,BufferResponse:Ro,BufferResponseSummary:{serializedName:"BufferResponse_summary",type:{name:"Composite",className:"BufferResponseSummary",modelProperties:{udid:{readOnly:!0,serializedName:"udid",type:{name:"String"}},information:{readOnly:!0,serializedName:"information",type:{name:"String"}}}}},ClosestPointResultEntry:{serializedName:"ClosestPointResultEntry",type:{name:"Composite",className:"ClosestPointResultEntry",modelProperties:{distanceInMeters:{readOnly:!0,serializedName:"distanceInMeters",type:{name:"Number"}},position:{serializedName:"position",type:{name:"Composite",className:"SpatialCoordinate"}},geometryId:{readOnly:!0,serializedName:"geometryId",type:{name:"String"}}}}},CloudError:Rn,GeofenceGeometry:{serializedName:"GeofenceGeometry",type:{name:"Composite",className:"GeofenceGeometry",modelProperties:{deviceId:{readOnly:!0,serializedName:"deviceId",type:{name:"String"}},udId:{readOnly:!0,serializedName:"udId",type:{name:"String"}},geometryId:{readOnly:!0,serializedName:"geometryId",type:{name:"String"}},distance:{readOnly:!0,serializedName:"distance",type:{name:"Number"}},nearestLat:{readOnly:!0,serializedName:"nearestLat",type:{name:"Number"}},nearestLon:{readOnly:!0,serializedName:"nearestLon",type:{name:"Number"}}}}},GeofenceResponse:Io,GeoJSONFeatureCollection:Co,GeoJSONFeatureCollectionFeaturesItem:{serializedName:"GeoJSONFeatureCollection_featuresItem",type:{name:"Composite",className:"GeoJSONFeatureCollectionFeaturesItem",modelProperties:{type:{serializedName:"type",type:{name:"String"}},geometry:{serializedName:"geometry",type:{name:"Composite",className:"GeoJSONGeometry"}},properties:{serializedName:"properties",type:{name:"Object"}}}}},GeoJSONGeometry:kn,GetClosestPointResponse:No,GetClosestPointSummary:{serializedName:"GetClosestPointSummary",type:{name:"Composite",className:"GetClosestPointSummary",modelProperties:{sourcePoint:{serializedName:"sourcePoint",type:{name:"Composite",className:"SpatialCoordinate"}},udid:{readOnly:!0,serializedName:"udid",type:{name:"String"}},information:{readOnly:!0,serializedName:"information",type:{name:"String"}}}}},GetPointInPolygonResponse:zo,GetPointInPolygonSummary:{serializedName:"GetPointInPolygonSummary",type:{name:"Composite",className:"GetPointInPolygonSummary",modelProperties:{sourcePoint:{serializedName:"sourcePoint",type:{name:"Composite",className:"SpatialCoordinate"}},udid:{readOnly:!0,serializedName:"udid",type:{name:"String"}},information:{readOnly:!0,serializedName:"information",type:{name:"String"}}}}},GreatCircleDistanceResponse:ko,GreatCircleDistanceResponseResult:{serializedName:"GreatCircleDistanceResponse_result",type:{name:"Composite",className:"GreatCircleDistanceResponseResult",modelProperties:{distanceInMeters:{readOnly:!0,serializedName:"distanceInMeters",type:{name:"Number"}}}}},GreatCircleDistanceResponseSummary:{serializedName:"GreatCircleDistanceResponse_summary",type:{name:"Composite",className:"GreatCircleDistanceResponseSummary",modelProperties:{sourcePoint:{serializedName:"sourcePoint",type:{name:"Composite",className:"SpatialCoordinate"}},targetPoint:{serializedName:"targetPoint",type:{name:"Composite",className:"SpatialCoordinate"}}}}},LineString:On,MultiLineString:Eo,MultiPoint:Xn,MultiPolygon:Jn,Point:Yn,PointInPolygonResult:{serializedName:"PointInPolygonResult",type:{name:"Composite",className:"PointInPolygonResult",modelProperties:{pointInPolygons:{readOnly:!0,serializedName:"pointInPolygons",type:{name:"Boolean"}},intersectingGeometries:{readOnly:!0,serializedName:"intersectingGeometries",type:{name:"Sequence",element:{type:{name:"String"}}}}}}},Polygon:mo,PostClosestPointResponse:Ao,PostClosestPointSummary:{serializedName:"PostClosestPointSummary",type:{name:"Composite",className:"PostClosestPointSummary",modelProperties:{sourcePoint:{serializedName:"sourcePoint",type:{name:"Composite",className:"SpatialCoordinate"}},udid:{readOnly:!0,serializedName:"udid",type:{name:"String"}},information:{readOnly:!0,serializedName:"information",type:{name:"String"}}}}},PostPointInPolygonResponse:Mo,PostPointInPolygonSummary:{serializedName:"PostPointInPolygonSummary",type:{name:"Composite",className:"PostPointInPolygonSummary",modelProperties:{sourcePoint:{serializedName:"sourcePoint",type:{name:"Composite",className:"SpatialCoordinate"}},udid:{readOnly:!0,serializedName:"udid",type:{name:"String"}},information:{readOnly:!0,serializedName:"information",type:{name:"String"}}}}},SpatialCoordinate:{serializedName:"SpatialCoordinate",type:{name:"Composite",className:"SpatialCoordinate",modelProperties:{lat:{readOnly:!0,serializedName:"lat",type:{name:"Number"}},lon:{readOnly:!0,serializedName:"lon",type:{name:"Number"}}}}},SpatialGetGeofenceHeaders:qo,SpatialPostGeofenceHeaders:Uo}),Dl=(Bl.prototype.getGeofence=function(e,t,r,i,n,o){return this.client.sendOperationRequest({deviceId:e,udId:t,lat:r,lon:i,options:n},Ul,o)},Bl.prototype.postGeofence=function(e,t,r,i,n,o){return this.client.sendOperationRequest({deviceId:e,lat:t,lon:r,searchGeofenceRequestBody:i,options:n},jl,o)},Bl.prototype.postBuffer=function(e,t,r){return this.client.sendOperationRequest({bufferRequestBody:e,options:t},Vl,r)},Bl.prototype.getBuffer=function(e,t,r,i){return this.client.sendOperationRequest({udid:e,distances:t,options:r},Gl,i)},Bl.prototype.postClosestPoint=function(e,t,r,i,n){return this.client.sendOperationRequest({lat:e,lon:t,closestPointRequestBody:r,options:i},Hl,n)},Bl.prototype.getClosestPoint=function(e,t,r,i,n){return this.client.sendOperationRequest({udid:e,lat:t,lon:r,options:i},Zl,n)},Bl.prototype.postPointInPolygon=function(e,t,r,i,n){return this.client.sendOperationRequest({lat:e,lon:t,pointInPolygonRequestBody:r,options:i},Wl,n)},Bl.prototype.getPointInPolygon=function(e,t,r,i,n){return this.client.sendOperationRequest({udid:e,lat:t,lon:r,options:i},Kl,n)},Bl.prototype.getGreatCircleDistance=function(e,t,r){return this.client.sendOperationRequest({query:e,options:t},Xl,r)},Bl);function Bl(e){this.client=e}var Fl,ql=new b(Ll),Ul={httpMethod:"GET",path:"spatial/geofence/{format}",urlParameters:[ba],queryParameters:[Yo,ga,{parameterPath:"udId",mapper:{required:!0,serializedName:"udId",type:{name:"String"}}},Na,ka,ds,es,Ia,qa],headerParameters:[Ho],responses:{200:{bodyMapper:Io,headersMapper:qo},default:{bodyMapper:Rn}},serializer:ql},jl={httpMethod:"POST",path:"spatial/geofence/{format}",urlParameters:[ba],queryParameters:[Yo,ga,Na,ka,ds,es,Ia,qa],headerParameters:[Ho],requestBody:{parameterPath:"searchGeofenceRequestBody",mapper:z(z({},Co),{required:!0})},responses:{200:{bodyMapper:Io,headersMapper:Uo},default:{bodyMapper:Rn}},serializer:ql},Vl={httpMethod:"POST",path:"spatial/buffer/{format}",urlParameters:[ba],queryParameters:[Yo],headerParameters:[Ho],requestBody:{parameterPath:"bufferRequestBody",mapper:z(z({},Po),{required:!0})},responses:{200:{bodyMapper:Ro},default:{bodyMapper:Rn}},serializer:ql},Gl={httpMethod:"GET",path:"spatial/buffer/{format}",urlParameters:[ba],queryParameters:[Yo,ps,{parameterPath:"distances",mapper:{required:!0,serializedName:"distances",type:{name:"String"}}}],headerParameters:[Ho],responses:{200:{bodyMapper:Ro},default:{bodyMapper:Rn}},serializer:ql},Hl={httpMethod:"POST",path:"spatial/closestPoint/{format}",urlParameters:[ba],queryParameters:[Yo,Na,ka,ja],headerParameters:[Ho],requestBody:{parameterPath:"closestPointRequestBody",mapper:z(z({},Co),{required:!0})},responses:{200:{bodyMapper:Ao},default:{bodyMapper:Rn}},serializer:ql},Zl={httpMethod:"GET",path:"spatial/closestPoint/{format}",urlParameters:[ba],queryParameters:[Yo,ps,Na,ka,ja],headerParameters:[Ho],responses:{200:{bodyMapper:No},default:{bodyMapper:Rn}},serializer:ql},Wl={httpMethod:"POST",path:"spatial/pointInPolygon/{format}",urlParameters:[ba],queryParameters:[Yo,Na,ka],headerParameters:[Ho],requestBody:{parameterPath:"pointInPolygonRequestBody",mapper:z(z({},Co),{required:!0})},responses:{200:{bodyMapper:Mo},default:{bodyMapper:Rn}},serializer:ql},Kl={httpMethod:"GET",path:"spatial/pointInPolygon/{format}",urlParameters:[ba],queryParameters:[Yo,ps,Na,ka],headerParameters:[Ho],responses:{200:{bodyMapper:zo},default:{bodyMapper:Rn}},serializer:ql},Xl={httpMethod:"GET",path:"spatial/greatCircleDistance/{format}",urlParameters:[ba],queryParameters:[Yo,Xa],headerParameters:[Ho],responses:{200:{bodyMapper:ko},default:{bodyMapper:Rn}},serializer:ql},Yl=(A(Jl,Fl=Q),Jl.prototype.sendRequest=function(e){return M(this,void 0,void 0,(function(){return k(this,(function(t){return e.headers||(e.headers=new n),e.headers.set("Ms-Am-Request-Origin",zi),e.headers.set("Map-Agent",zi+"/2.0.5 (Web)"),[2,this._nextPolicy.sendRequest(e)]}))}))},Jl);function Jl(e,t){return Fl.call(this,e,t)||this}var $l=(Ql.prototype.create=function(e,t){return new Yl(e,t)},Ql);function Ql(){}var eu,tu=(A(ru,eu=En),ru);function ru(e,t){var r=this;if(null==e)throw new Error("'credentials' cannot be null.");if(!(t=t||{}).userAgent){var i=Pn();t.userAgent="/ "+i}return(r=eu.call(this,e,t)||this).apiVersion="1.0",r.acceptLanguage="en-US",r.longRunningOperationRetryTimeout=30,r.baseUri=t.baseUri||r.baseUri||"https://atlas.microsoft.com",r.requestContentType="application/json; charset=utf-8",r.credentials=e,null!==t.acceptLanguage&&void 0!==t.acceptLanguage&&(r.acceptLanguage=t.acceptLanguage),null!==t.longRunningOperationRetryTimeout&&void 0!==t.longRunningOperationRetryTimeout&&(r.longRunningOperationRetryTimeout=t.longRunningOperationRetryTimeout),r}var iu=(nu.newPipeline=function(e,t){void 0===t&&(t={});var r=[ie(),new Hi(t.retryOptions),new Ji,e];return new Fi(r,{HTTPClient:t.httpClient,logger:t.logger})},nu);function nu(e,t){this.pipeline=e,/^\w+:\/\//.test(t)?this.mapsUrl=t:this.mapsUrl="https://"+t;var r=this.pipeline.toServiceClientOptions();r.requestPolicyFactories.push(new $l),this.mapsClientContext=new tu({signRequest:Promise.resolve},z(z({},r),{baseUri:this.mapsUrl})),this.mapsClientContext.apiVersion="1.0",this.mapsClientContext.longRunningOperationRetryTimeout=5}var ou,au=(A(su,ou=iu),su.prototype.getMapImageryTile=function(e,t,r,i){return M(this,void 0,void 0,(function(){var n,o,a,s,l,u;return k(this,(function(c){switch(c.label){case 0:return[4,this.renderContext.getMapImageryTile(t,r,i,{abortSignal:e})];case 1:return(n=c.sent()).readableStreamBody?(a=(o=Object).assign,[4,_i(n.readableStreamBody)]):[3,3];case 2:return[2,a.apply(o,[c.sent(),{rawResponse:n._response}])];case 3:return n.blobBody?(l=(s=Object).assign,u=bi,[4,n.blobBody]):[3,6];case 4:return[4,u.apply(void 0,[c.sent()])];case 5:return[2,l.apply(s,[c.sent(),{rawResponse:n._response}])];case 6:return[2]}}))}))},su.prototype.getMapTile=function(e,t,r,i,n,o,a,s){return void 0===s&&(s={}),M(this,void 0,void 0,(function(){var l,u,c,p,h,d;return k(this,(function(m){switch(m.label){case 0:return[4,this.renderContext.getMapTile(t,r,i,n,o,a,z(z({},s),{abortSignal:e}))];case 1:return(l=m.sent()).readableStreamBody?(c=(u=Object).assign,[4,_i(l.readableStreamBody)]):[3,3];case 2:return[2,c.apply(u,[m.sent(),{rawResponse:l._response}])];case 3:return l.blobBody?(h=(p=Object).assign,d=bi,[4,l.blobBody]):[3,6];case 4:return[4,d.apply(void 0,[m.sent()])];case 5:return[2,h.apply(p,[m.sent(),{rawResponse:l._response}])];case 6:return[2]}}))}))},su.prototype.getMapImage=function(e,t){return M(this,void 0,void 0,(function(){var r,i,n,o,a,s;return k(this,(function(l){switch(l.label){case 0:return[4,this.renderContext.getMapImage(z(z(z(z({},t),t.center&&{center:this.centerToString(t.center)}),t.bbox&&{bbox:this.bboxToString(t.bbox)}),{abortSignal:e}))];case 1:return(r=l.sent()).readableStreamBody?(n=(i=Object).assign,[4,_i(r.readableStreamBody)]):[3,3];case 2:return[2,n.apply(i,[l.sent(),{rawResponse:r._response}])];case 3:return r.blobBody?(a=(o=Object).assign,s=bi,[4,r.blobBody]):[3,6];case 4:return[4,s.apply(void 0,[l.sent()])];case 5:return[2,a.apply(o,[l.sent(),{rawResponse:r._response}])];case 6:return[2]}}))}))},su.prototype.centerToString=function(e){if(e.length<2)throw new Error("The center must contain both longitude and latitude, e.g. [longitude, latitude]");return e[0]+","+e[1]},su.prototype.bboxToString=function(e){if(e.length<4)throw new Error("The bbox must contain at least four values, e.g. [south lon, west lat, north lon, east lat]");return e.length<6?e[0]+","+e[1]+","+e[2]+","+e[3]:e[0]+","+e[1]+","+e[3]+","+e[4]},su);function su(e,t){void 0===t&&(t="https://atlas.microsoft.com");var r=ou.call(this,e,t)||this;return r.renderContext=new hl(r.mapsClientContext),r}var lu=(uu.prototype.getFeatures=function(){var e=this.response.routes.map((function(e,t){var r=e.legs.map((function(e){return e.points.map((function(e){return[e.longitude,e.latitude]}))})),i=z(z({},e),{legSummaries:e.legs.map((function(e){return e.summary})),resultIndex:t});return delete i.legs,{type:"Feature",geometry:{type:"MultiLineString",coordinates:r},properties:i}}));return{type:"FeatureCollection",features:e,bbox:xi(e)}},uu);function uu(e){this.response=e}var cu=(pu.prototype.getFeatures=function(){var e={type:"Feature",geometry:{type:"Polygon",coordinates:[this.response.reachableRange.boundary.map((function(e){return[e.longitude,e.latitude]}))]},properties:{}};return{type:"FeatureCollection",features:[e,{type:"Feature",geometry:{type:"Point",coordinates:[this.response.reachableRange.center.longitude,this.response.reachableRange.center.latitude]},properties:{}}],bbox:xi([e])}},pu);function pu(e){this.response=e}var hu,du=(A(mu,hu=iu),mu.prototype.calculateRouteDirections=function(e,t,r){return void 0===r&&(r={}),M(this,void 0,void 0,(function(){var i,n,o;return k(this,(function(a){switch(a.label){case 0:if(t.length<2)throw new Error("The coordinates must contain at least two positions");return i=t.map((function(e){if(e.length<2)throw new Error("The coordinate must contain both longitude and latitude, e.g. [longitude, latitude]");return e[1]+","+e[0]})).join(":"),r.postBody?[4,this.routeContext.postRouteDirections(i,r.postBody,z(z({},r),{abortSignal:e}))]:[3,2];case 1:return o=a.sent(),[3,4];case 2:return[4,this.routeContext.getRouteDirections(i,z(z({},r),{abortSignal:e}))];case 3:o=a.sent(),a.label=4;case 4:return[2,z(z({},n=o),{rawResponse:n._response,geojson:new lu(n)})]}}))}))},mu.prototype.calculateRouteRange=function(e,t,r){return void 0===r&&(r={}),M(this,void 0,void 0,(function(){var i,n;return k(this,(function(o){switch(o.label){case 0:if(t.length<2)throw new Error("The center must contain both longitude and latitude, e.g. [longitude, latitude]");return i=t[1]+","+t[0],[4,this.routeContext.getRouteRange(i,z(z({},r),{abortSignal:e}))];case 1:return n=o.sent(),[2,z(z({},n),{rawResponse:n._response,geojson:new cu(n)})]}}))}))},mu.prototype.calculateRouteMatrix=function(e,t,r){return void 0===r&&(r={}),M(this,void 0,void 0,(function(){var i;return k(this,(function(n){switch(n.label){case 0:return[4,this.routeContext.postRouteMatrixPreview(t,z(z({},r),{abortSignal:e}))];case 1:return i=n.sent(),[2,z(z({},i),{rawResponse:i._response})]}}))}))},mu);function mu(e,t){void 0===t&&(t="https://atlas.microsoft.com");var r=hu.call(this,e,t)||this;return r.routeContext=new Ws(r.mapsClientContext),r}var fu=(yu.prototype.getFeatures=function(){for(var e=[],t=0;t<this.response.results.length;t++){var r=this.response.results[t],i=z(z({},r),{resultIndex:t});delete i.position;var n={type:"Feature",geometry:{type:"Point",coordinates:[r.position.lon,r.position.lat]},properties:i};r.id&&(n.id=r.id),r.viewport&&(n.bbox=[r.viewport.topLeftPoint.lon,r.viewport.btmRightPoint.lat,r.viewport.btmRightPoint.lon,r.viewport.topLeftPoint.lat]),e.push(n)}return{type:"FeatureCollection",features:e,bbox:xi(e)}},yu);function yu(e){this.response=e}var gu=(vu.prototype.getFeatures=function(){for(var e=[],t=0,r=this.response.additionalData;t<r.length;t++)for(var i=r[t],n=0,o=i.geometryData.features;n<o.length;n++){var a=o[n],s=z(z({},a.properties),i);delete s.geometryData,e.push({type:"Feature",geometry:a.geometry,properties:s})}return{type:"FeatureCollection",features:e,bbox:xi(e)}},vu);function vu(e){this.response=e}var _u=(bu.prototype.getFeatures=function(){for(var e=[],t=0;t<this.response.addresses.length;t++){var r=this.response.addresses[t],i=z(z({},r),{resultIndex:t});delete i.position;var n=r.position.split(",").map(Number.parseFloat),o=n[0],a={type:"Feature",geometry:{type:"Point",coordinates:[n[1],o]},properties:i};e.push(a)}return{type:"FeatureCollection",features:e,bbox:xi(e)}},bu);function bu(e){this.response=e}var xu,wu=(A(Su,xu=iu),Su.prototype.searchFuzzy=function(e,t,r){return void 0===r&&(r={}),M(this,void 0,void 0,(function(){var i;return k(this,(function(n){switch(n.label){case 0:if(Array.isArray(t)){if(!(1<t.length))throw new Error("The query must contain both longitude and latitude, e.g. [longitude, latitude]");t=t[1]+","+t[0]}return[4,this.searchContext.getSearchFuzzy(t,z(z({},r),{abortSignal:e}))];case 1:return i=n.sent(),[2,z(z({},i),{rawResponse:i._response,geojson:new fu(i)})]}}))}))},Su.prototype.searchPOI=function(e,t,r){return void 0===r&&(r={}),M(this,void 0,void 0,(function(){var i;return k(this,(function(n){switch(n.label){case 0:return[4,this.searchContext.getSearchPOI(t,z(z({},r),{abortSignal:e}))];case 1:return i=n.sent(),[2,z(z({},i),{rawResponse:i._response,geojson:new fu(i)})]}}))}))},Su.prototype.searchNearby=function(e,t,r){return void 0===r&&(r={}),M(this,void 0,void 0,(function(){var i,n,o;return k(this,(function(a){switch(a.label){case 0:if(t.length<2)throw new Error("The query must contain both longitude and latitude, e.g. [longitude, latitude]");return i=t[0],n=t[1],[4,this.searchContext.getSearchNearby(n,i,z(z({},r),{abortSignal:e}))];case 1:return o=a.sent(),[2,z(z({},o),{rawResponse:o._response,geojson:new fu(o)})]}}))}))},Su.prototype.searchPOICategory=function(e,t,r){return void 0===r&&(r={}),M(this,void 0,void 0,(function(){var i;return k(this,(function(n){switch(n.label){case 0:return[4,this.searchContext.getSearchPOICategory(t,z(z({},r),{abortSignal:e}))];case 1:return i=n.sent(),[2,z(z({},i),{rawResponse:i._response,geojson:new fu(i)})]}}))}))},Su.prototype.searchAddress=function(e,t,r){return void 0===r&&(r={}),M(this,void 0,void 0,(function(){var i;return k(this,(function(n){switch(n.label){case 0:return[4,this.searchContext.getSearchAddress(t,z(z({},r),{abortSignal:e}))];case 1:return i=n.sent(),[2,z(z({},i),{rawResponse:i._response,geojson:new fu(i)})]}}))}))},Su.prototype.searchAddressReverse=function(e,t,r){return void 0===r&&(r={}),M(this,void 0,void 0,(function(){var i,n;return k(this,(function(o){switch(o.label){case 0:if(t.length<2)throw new Error("The position must contain both longitude and latitude, e.g. [longitude, latitude]");return i=t[1]+","+t[0],[4,this.searchContext.getSearchAddressReverse(i,z(z({},r),{abortSignal:e}))];case 1:return n=o.sent(),[2,z(z({},n),{rawResponse:n._response,geojson:new _u(n)})]}}))}))},Su.prototype.searchAddressReverseCrossStreet=function(e,t,r){return void 0===r&&(r={}),M(this,void 0,void 0,(function(){var i,n;return k(this,(function(o){switch(o.label){case 0:if(t.length<2)throw new Error("The position must contain both longitude and latitude, e.g. [longitude, latitude]");return i=t[1]+","+t[0],[4,this.searchContext.getSearchAddressReverseCrossStreet(i,z(z({},r),{abortSignal:e}))];case 1:return n=o.sent(),[2,z(z({},n),{rawResponse:n._response,geojson:new _u(n)})]}}))}))},Su.prototype.searchAddressStructured=function(e,t,r){return void 0===r&&(r={}),M(this,void 0,void 0,(function(){var i;return k(this,(function(n){switch(n.label){case 0:return[4,this.searchContext.getSearchAddressStructured(t,z(z({},r),{abortSignal:e}))];case 1:return i=n.sent(),[2,z(z({},i),{rawResponse:i._response,geojson:new fu(i)})]}}))}))},Su.prototype.searchInsideGeometry=function(e,t,r,i){return void 0===i&&(i={}),M(this,void 0,void 0,(function(){var n;return k(this,(function(o){switch(o.label){case 0:return[4,this.searchContext.postSearchInsideGeometry(t,r,z(z({},i),{abortSignal:e}))];case 1:return n=o.sent(),[2,z(z({},n),{rawResponse:n._response,geojson:new fu(n)})]}}))}))},Su.prototype.searchAlongRoute=function(e,t,r,i,n){return void 0===n&&(n={}),M(this,void 0,void 0,(function(){var o;return k(this,(function(a){switch(a.label){case 0:return[4,this.searchContext.postSearchAlongRoute(t,r,i,z(z({},n),{abortSignal:e}))];case 1:return o=a.sent(),[2,z(z({},o),{rawResponse:o._response,geojson:new fu(o)})]}}))}))},Su.prototype.searchPolygon=function(e,t){return M(this,void 0,void 0,(function(){var r,i;return k(this,(function(n){switch(n.label){case 0:if(t.length<1)throw new Error("At least one geometry UUID must be specified");return r=t.join(","),[4,this.searchContext.getSearchPolygon(r,{abortSignal:e})];case 1:return i=n.sent(),[2,z(z({},i),{rawResponse:i._response,geojson:new gu(i)})]}}))}))},Su);function Su(e,t){void 0===t&&(t="https://atlas.microsoft.com");var r=xu.call(this,e,t)||this;return r.searchContext=new Rs(r.mapsClientContext),r}var Tu=(Cu.prototype.getFeatures=function(){var e=this.response.result.map((function(e){var t=z({},e);return delete t.position,{type:"Feature",geometry:{type:"Point",coordinates:[e.position.lon,e.position.lat]},properties:t}}));return{type:"FeatureCollection",bbox:xi(e),features:e}},Cu);function Cu(e){this.response=e}var Eu=(Iu.prototype.getFeatures=function(){var e=this.response.geometries.map((function(e){var t=z({},e);return delete t.nearestLat,delete t.nearestLon,{type:"Feature",geometry:{type:"Point",coordinates:[e.nearestLon,e.nearestLat]},properties:t}}));return{type:"FeatureCollection",bbox:xi(e),features:e}},Iu);function Iu(e){this.response=e}var Pu=(Ru.prototype.getFeatures=function(){var e=z(z({},this.response.result),this.response.summary);delete e.sourcePoint;var t=[{type:"Feature",geometry:{type:"Point",coordinates:[this.response.summary.sourcePoint.lon,this.response.summary.sourcePoint.lat]},properties:e}];return{type:"FeatureCollection",bbox:xi(t),features:t}},Ru);function Ru(e){this.response=e}var Nu,Au=(A(zu,Nu=iu),zu.prototype.getBuffer=function(e,t,r){return M(this,void 0,void 0,(function(){var i,n,o;return k(this,(function(a){switch(a.label){case 0:if(r.length<1)throw new Error("At least one distance must be specified");return"string"!=typeof t?[3,2]:[4,this.spatialContext.getBuffer(t,r.join(";"),{abortSignal:e})];case 1:return n=a.sent(),[3,4];case 2:return[4,this.spatialContext.postBuffer({geometries:t,distances:r},{abortSignal:e})];case 3:n=a.sent(),a.label=4;case 4:return(i=n).result&&i.result.features&&((o=i.result).bbox=xi(o.features)),[2,z(z({},i),{rawResponse:i._response})]}}))}))},zu.prototype.getClosestPoint=function(e,t,r,i){return void 0===i&&(i={}),M(this,void 0,void 0,(function(){var n,o,a,s;return k(this,(function(l){switch(l.label){case 0:if(t.length<2)throw new Error("The position must contain both longitude and latitude, e.g. [longitude, latitude]");return n=t[0],o=t[1],"string"!=typeof r?[3,2]:[4,this.spatialContext.getClosestPoint(r,o,n,z(z({},i),{abortSignal:e}))];case 1:return s=l.sent(),[3,4];case 2:return[4,this.spatialContext.postClosestPoint(o,n,r,z(z({},i),{abortSignal:e}))];case 3:s=l.sent(),l.label=4;case 4:return[2,z(z({},a=s),{rawResponse:a._response,geojson:new Tu(a)})]}}))}))},zu.prototype.getGeofence=function(e,t,r,i,n){return void 0===n&&(n={}),M(this,void 0,void 0,(function(){var o,a,s,l;return k(this,(function(u){switch(u.label){case 0:if(i.length<2)throw new Error("The position must contain both longitude and latitude, e.g. [longitude, latitude]");return o=i[0],a=i[1],"string"!=typeof r?[3,2]:[4,this.spatialContext.getGeofence(t,r,a,o,z(z({},n),{abortSignal:e}))];case 1:return l=u.sent(),[3,4];case 2:return[4,this.spatialContext.postGeofence(t,a,o,r,z(z({},n),{abortSignal:e}))];case 3:l=u.sent(),u.label=4;case 4:return[2,z(z({},s=l),{rawResponse:s._response,geojson:new Eu(s)})]}}))}))},zu.prototype.getGreatCircleDistance=function(e,t){return M(this,void 0,void 0,(function(){var r,i;return k(this,(function(n){switch(n.label){case 0:if(t.length<2)throw new Error("The coordinates must contain at least two positions");return r=t.map((function(e){if(e.length<2)throw new Error("The coordinate must contain both longitude and latitude, e.g. [longitude, latitude]");return e[1]+","+e[0]})).join(":"),[4,this.spatialContext.getGreatCircleDistance(r,{abortSignal:e})];case 1:return i=n.sent(),[2,z(z({},i),{rawResponse:i._response})]}}))}))},zu.prototype.getPointInPolygon=function(e,t,r){return M(this,void 0,void 0,(function(){var i,n,o,a;return k(this,(function(s){switch(s.label){case 0:if(r.length<2)throw new Error("The position must contain both longitude and latitude, e.g. [longitude, latitude]");return i=r[0],n=r[1],"string"!=typeof t?[3,2]:[4,this.spatialContext.getPointInPolygon(t,n,i,{abortSignal:e})];case 1:return a=s.sent(),[3,4];case 2:return[4,this.spatialContext.postPointInPolygon(n,i,t,{abortSignal:e})];case 3:a=s.sent(),s.label=4;case 4:return[2,z(z({},o=a),{rawResponse:o._response,geojson:new Pu(o)})]}}))}))},zu);function zu(e,t){void 0===t&&(t="https://atlas.microsoft.com");var r=Nu.call(this,e,t)||this;return r.spatialContext=new Dl(r.mapsClientContext),r}var Mu,ku=(A(Ou,Mu=iu),Ou.prototype.getTimezoneByCoordinates=function(e,t,r){return void 0===r&&(r={}),M(this,void 0,void 0,(function(){var i,n;return k(this,(function(o){switch(o.label){case 0:if(t.length<2)throw new Error("The coordinate must contain both longitude and latitude, e.g. [longitude, latitude]");return i=t[1]+","+t[0],[4,this.timezoneContext.getTimezoneByCoordinates(i,z(z({},r),{abortSignal:e}))];case 1:return n=o.sent(),[2,z(z({},n),{rawResponse:n._response})]}}))}))},Ou.prototype.getTimezoneById=function(e,t,r){return void 0===r&&(r={}),M(this,void 0,void 0,(function(){var i;return k(this,(function(n){switch(n.label){case 0:return[4,this.timezoneContext.getTimezoneByID(t,z(z({},r),{abortSignal:e}))];case 1:return i=n.sent(),[2,z(z({},i),{rawResponse:i._response})]}}))}))},Ou);function Ou(e,t){void 0===t&&(t="https://atlas.microsoft.com");var r=Mu.call(this,e,t)||this;return r.timezoneContext=new rl(r.mapsClientContext),r}var Lu=(Du.prototype.getFeatures=function(){var e=z({},this.response);delete e.position,delete e._response;var t=[{type:"Feature",geometry:{type:"Point",coordinates:[this.response.position.longitude,this.response.position.latitude]},properties:e}];return{type:"FeatureCollection",features:t,bbox:xi(t)}},Du);function Du(e){this.response=e}var Bu=(Fu.prototype.getFeatures=function(){var e=this.response.results.map((function(e){var t=z({},e);return delete t.geometry,{type:"Feature",geometry:e.geometry,properties:t}}));return{type:"FeatureCollection",features:e,bbox:xi(e)}},Fu);function Fu(e){this.response=e}var qu=(Uu.prototype.getFeatures=function(){var e=this.response.results.map((function(e){var t=z({},e);return delete t.position,{type:"Feature",geometry:{type:"Point",coordinates:[e.position.longitude,e.position.latitude]},properties:t}}));return{type:"FeatureCollection",features:e,bbox:xi(e)}},Uu);function Uu(e){this.response=e}var ju=(Vu.prototype.getFeatures=function(){var e=this.response.results.map((function(e){var t=z(z({},e),{stop:z({},e.stop)});return delete t.stop.position,{type:"Feature",geometry:{type:"Point",coordinates:[e.stop.position.longitude,e.stop.position.latitude]},properties:t}}));return{type:"FeatureCollection",features:e,bbox:xi(e)}},Vu);function Vu(e){this.response=e}var Gu=(Hu.prototype.getFeatures=function(){var e=z({},this.response);delete e.position,delete e._response;var t=[{type:"Feature",geometry:{type:"Point",coordinates:[this.response.position.longitude,this.response.position.latitude]},properties:e}];return{type:"FeatureCollection",features:t,bbox:xi(t)}},Hu);function Hu(e){this.response=e}var Zu=(Wu.prototype.getFeatures=function(){var e=this.response.legs.filter((function(e){return e.legType!==ft.Wait})).filter((function(e){return e.geometry||e.origin&&e.destination||e.stops})).map((function(e){var t;if(e.geometry)t=e.geometry.coordinates;else if(e.origin&&e.destination)t=[[e.origin.position.longitude,e.origin.position.latitude],[e.destination.position.longitude,e.destination.position.latitude]];else if(e.stops){var r=e.stops[0],i=e.stops[e.stops.length-1];t=[[r.position.longitude,r.position.latitude],[i.position.longitude,i.position.latitude]]}var n=z({},e);return delete n.geometry,delete n.origin,delete n.destination,{type:"Feature",geometry:{type:"LineString",coordinates:t},properties:n}}));return{type:"FeatureCollection",features:e,bbox:xi(e)}},Wu);function Wu(e){this.response=e}var Ku=(Xu.prototype.getFeatures=function(){var e=[];if(this.response.patterns)for(var t=0,r=this.response.patterns;t<r.length;t++){var i=r[t];delete(a=z({},i)).geometry,e.push({type:"Feature",geometry:i.geometry,properties:a})}if(this.response.stops)for(var n=0,o=this.response.stops;n<o.length;n++){var a,s=o[n];delete(a=z({},s)).position,e.push({type:"Feature",geometry:{type:"Point",coordinates:[s.position.longitude,s.position.latitude]},properties:a})}return{type:"FeatureCollection",features:e,bbox:xi(e)}},Xu);function Xu(e){this.response=e}var Yu=(Ju.prototype.getFeatures=function(){var e=z(z({},this.response),{stop:z({},this.response.stop)});delete e.stop.position,delete e._response;var t=[{type:"Feature",geometry:{type:"Point",coordinates:[this.response.stop.position.longitude,this.response.stop.position.latitude]},properties:e}];return{type:"FeatureCollection",features:t,bbox:xi(t)}},Ju);function Ju(e){this.response=e}var $u,Qu=(A(ec,$u=iu),ec.prototype.getCarShareInfo=function(e,t,r){return void 0===r&&(r={}),M(this,void 0,void 0,(function(){var i;return k(this,(function(n){switch(n.label){case 0:return t=decodeURIComponent(t),[4,this.mobilityContext.getCarShareInfoPreview(t,z(z({},r),{abortSignal:e}))];case 1:return i=n.sent(),[2,z(z({},i),{rawResponse:i._response,geojson:new Lu(i)})]}}))}))},ec.prototype.getMetroArea=function(e,t,r){return void 0===r&&(r={}),M(this,void 0,void 0,(function(){var i;return k(this,(function(n){switch(n.label){case 0:if(Array.isArray(t)&&t.length<2)throw new Error("The query must contain both longitude and latitude, e.g. [longitude, latitude]");return t="string"==typeof t?t:t[1]+","+t[0],[4,this.mobilityContext.getMetroAreaPreview(t,z(z({},r),{abortSignal:e}))];case 1:return i=n.sent(),[2,z(z({},i),{rawResponse:i._response,geojson:new Bu(i)})]}}))}))},ec.prototype.getMetroAreaInfo=function(e,t,r,i){return void 0===i&&(i={}),M(this,void 0,void 0,(function(){var n;return k(this,(function(o){switch(o.label){case 0:return[4,this.mobilityContext.getMetroAreaInfoPreview(t,r,z(z({},i),{abortSignal:e}))];case 1:return n=o.sent(),[2,z(z({},n),{rawResponse:n._response})]}}))}))},ec.prototype.getNearbyTransit=function(e,t,r,i){return void 0===i&&(i={}),M(this,void 0,void 0,(function(){var n,o;return k(this,(function(a){switch(a.label){case 0:if(r.length<2)throw new Error("The location must contain both longitude and latitude, e.g. [longitude, latitude]");return n=r[1]+","+r[0],[4,this.mobilityContext.getNearbyTransitPreview(t,n,z(z({},i),{abortSignal:e}))];case 1:return o=a.sent(),[2,z(z({},o),{rawResponse:o._response,geojson:new qu(o)})]}}))}))},ec.prototype.getRealTimeArrivals=function(e,t,r,i){return void 0===i&&(i={}),M(this,void 0,void 0,(function(){var n;return k(this,(function(o){switch(o.label){case 0:if(Array.isArray(r)){if(0===r.length)throw new Error("The specified query array must contain at least one element");r="number"==typeof r[0]?r[1]+","+r[0]:r.join(",")}return r=decodeURIComponent(r),[4,this.mobilityContext.getRealTimeArrivalsPreview(t,r,z(z({},i),{abortSignal:e}))];case 1:return n=o.sent(),[2,z(z({},n),{rawResponse:n._response,geojson:new ju(n)})]}}))}))},ec.prototype.getTransitDockInfo=function(e,t,r){return void 0===r&&(r={}),M(this,void 0,void 0,(function(){var i;return k(this,(function(n){switch(n.label){case 0:return t=decodeURIComponent(t),[4,this.mobilityContext.getTransitDockInfoPreview(t,z(z({},r),{abortSignal:e}))];case 1:return i=n.sent(),[2,z(z({},i),{rawResponse:i._response,geojson:new Gu(i)})]}}))}))},ec.prototype.getTransitItinerary=function(e,t,r){return void 0===r&&(r={}),M(this,void 0,void 0,(function(){var i;return k(this,(function(n){switch(n.label){case 0:return t=decodeURIComponent(t),[4,this.mobilityContext.getTransitItineraryPreview(t,z(z({},r),{abortSignal:e}))];case 1:return i=n.sent(),[2,z(z({},i),{rawResponse:i._response,geojson:new Zu(i)})]}}))}))},ec.prototype.getTransitLineInfo=function(e,t,r,i){return void 0===i&&(i={}),M(this,void 0,void 0,(function(){var n;return k(this,(function(o){switch(o.label){case 0:return r=decodeURIComponent(r),[4,this.mobilityContext.getTransitLineInfoPreview(t,r,z(z({},i),{abortSignal:e}))];case 1:return n=o.sent(),[2,z(z({},n),{rawResponse:n._response,geojson:new Ku(n)})]}}))}))},ec.prototype.getTransitRoute=function(e,t,r,i,n){return void 0===n&&(n={}),M(this,void 0,void 0,(function(){var o;return k(this,(function(a){switch(a.label){case 0:if(Array.isArray(r)){if(r.length<2)throw new Error("The origin must contain both longitude and latitude, e.g. [longitude, latitude]");r=r[1]+","+r[0]}if(Array.isArray(i)){if(i.length<2)throw new Error("The destination must contain both longitude and latitude, e.g. [longitude, latitude]");i=i[1]+","+i[0]}return r=decodeURIComponent(r),i=decodeURIComponent(i),[4,this.mobilityContext.getTransitRoutePreview(t,r,i,z(z({},n),{abortSignal:e}))];case 1:return o=a.sent(),[2,z(z({},o),{rawResponse:o._response})]}}))}))},ec.prototype.getTransitStopInfo=function(e,t,r,i){return void 0===i&&(i={}),M(this,void 0,void 0,(function(){var n;return k(this,(function(o){switch(o.label){case 0:return r=decodeURIComponent(r),[4,this.mobilityContext.getTransitStopInfoPreview(t,r,z(z({},i),{abortSignal:e}))];case 1:return n=o.sent(),[2,z(z({},n),{rawResponse:n._response,geojson:new Yu(n)})]}}))}))},ec);function ec(e,t){void 0===t&&(t="https://atlas.microsoft.com");var r=$u.call(this,e,t)||this;return r.mobilityContext=new Sl(r.mapsClientContext),r}String.prototype.startsWith||Object.defineProperty(String.prototype,"startsWith",{value:function(e,t){return this.substring(!t||t<0?0:+t,e.length)===e}}),t.Aborter=ai,t.BaseRequestPolicy=Q,t.Credential=li,t.CredentialPolicy=pi,t.HttpHeaders=n,t.LoggingPolicyFactory=Ji,t.MapControlCredential=gi,t.MapControlCredentialPolicy=mi,t.MapsURL=iu,t.MobilityURL=Qu,t.Models=oi,t.Pipeline=Fi,t.RenderURL=au,t.RequestPolicyOptions=te,t.RestError=L,t.RetryPolicyFactory=Hi,t.RouteURL=du,t.SearchURL=wu,t.SpatialURL=Au,t.SubscriptionKeyCredential=Ri,t.SubscriptionKeyCredentialPolicy=Ei,t.TimezoneURL=ku,t.TokenCredential=Li,t.TokenCredentialPolicy=Mi,t.WebResource=P,t.deserializationPolicy=ie,Object.defineProperty(t,"__esModule",{value:!0})}(t)}).call(this,r(4),r(10).Buffer)},function(e,t){var r;r=function(){return this}();try{r=r||new Function("return this")()}catch(e){"object"==typeof window&&(r=window)}e.exports=r},function(e,t){var r=n.prototype,i="WGS 84";function n(e){void 0!==e&&(i=e),this.setEllipsoid(i)}function o(e,t){var r=Math.pow(10,t);return Math.round(e*r)/r}r.convertLatLngToUtm=function(e,t,r){if(this.status)return"No ecclipsoid data associated with unknown datum: "+i;if(!Number.isInteger(r))return"Precision is not integer number.";e=parseFloat(e);var n=t=parseFloat(t),a=this.toRadians(e),s=this.toRadians(n);n>=8&&n<=13&&e>54.5&&e<58||e>=56&&e<64&&n>=3&&n<12?ZoneNumber=32:(ZoneNumber=(n+180)/6+1,e>=72&&e<84&&(n>=0&&n<9?ZoneNumber=31:n>=9&&n<21?ZoneNumber=33:n>=21&&n<33?ZoneNumber=35:n>=33&&n<42&&(ZoneNumber=37))),ZoneNumber=parseInt(ZoneNumber);var l=6*(ZoneNumber-1)-180+3,u=this.toRadians(l),c=this.getUtmLetterDesignator(e),p=this.eccSquared/(1-this.eccSquared),h=this.a/Math.sqrt(1-this.eccSquared*Math.sin(a)*Math.sin(a)),d=Math.tan(a)*Math.tan(a),m=p*Math.cos(a)*Math.cos(a),f=Math.cos(a)*(s-u),y=this.a*((1-this.eccSquared/4-3*this.eccSquared*this.eccSquared/64-5*this.eccSquared*this.eccSquared*this.eccSquared/256)*a-(3*this.eccSquared/8+3*this.eccSquared*this.eccSquared/32+45*this.eccSquared*this.eccSquared*this.eccSquared/1024)*Math.sin(2*a)+(15*this.eccSquared*this.eccSquared/256+45*this.eccSquared*this.eccSquared*this.eccSquared/1024)*Math.sin(4*a)-35*this.eccSquared*this.eccSquared*this.eccSquared/3072*Math.sin(6*a)),g=parseFloat(.9996*h*(f+(1-d+m)*f*f*f/6+(5-18*d+d*d+72*m-58*p)*f*f*f*f*f/120)+5e5),v=parseFloat(.9996*(y+h*Math.tan(a)*(f*f/2+(5-d+9*m+4*m*m)*f*f*f*f/24+(61-58*d+d*d+600*m-330*p)*f*f*f*f*f*f/720)));return e<0&&(v+=1e7),v=o(v,r),{Easting:g=o(g,r),Northing:v,ZoneNumber:parseInt(ZoneNumber),ZoneLetter:c}},r.convertUtmToLatLng=function(e,t,r,i){var n=(1-Math.sqrt(1-this.eccSquared))/(1+Math.sqrt(1-this.eccSquared)),o=e-5e5,a=t,s=r;if(void 0===e)return"Please pass the UTMEasting!";if(void 0===t)return"Please pass the UTMNorthing!";if(void 0===r)return"Please pass the UTMZoneNumber!";if(void 0===i)return"Please pass the UTMZoneLetter!";-1!==["N","P","Q","R","S","T","U","V","W","X","Y","Z"].indexOf(i)||(0,a-=1e7);var l=6*(s-1)-180+3,u=this.eccSquared/(1-this.eccSquared),c=a/.9996/(this.a*(1-this.eccSquared/4-3*this.eccSquared*this.eccSquared/64-5*this.eccSquared*this.eccSquared*this.eccSquared/256)),p=c+(3*n/2-27*n*n*n/32)*Math.sin(2*c)+(21*n*n/16-55*n*n*n*n/32)*Math.sin(4*c)+151*n*n*n/96*Math.sin(6*c),h=(this.toDegrees(p),this.a/Math.sqrt(1-this.eccSquared*Math.sin(p)*Math.sin(p))),d=Math.tan(p)*Math.tan(p),m=u*Math.cos(p)*Math.cos(p),f=this.a*(1-this.eccSquared)/Math.pow(1-this.eccSquared*Math.sin(p)*Math.sin(p),1.5),y=o/(.9996*h),g=p-h*Math.tan(p)/f*(y*y/2-(5+3*d+10*m-4*m*m-9*u)*y*y*y*y/24+(61+90*d+298*m+45*d*d-252*u-3*m*m)*y*y*y*y*y*y/720);g=this.toDegrees(g);var v=(y-(1+2*d+m)*y*y*y/6+(5-2*m+28*d-3*m*m+8*u+24*d*d)*y*y*y*y*y/120)/Math.cos(p);return{lat:g,lng:v=l+this.toDegrees(v)}},r.getUtmLetterDesignator=function(e){return 84>=(e=parseFloat(e))&&e>=72?"X":72>e&&e>=64?"W":64>e&&e>=56?"V":56>e&&e>=48?"U":48>e&&e>=40?"T":40>e&&e>=32?"S":32>e&&e>=24?"R":24>e&&e>=16?"Q":16>e&&e>=8?"P":8>e&&e>=0?"N":0>e&&e>=-8?"M":-8>e&&e>=-16?"L":-16>e&&e>=-24?"K":-24>e&&e>=-32?"J":-32>e&&e>=-40?"H":-40>e&&e>=-48?"G":-48>e&&e>=-56?"F":-56>e&&e>=-64?"E":-64>e&&e>=-72?"D":-72>e&&e>=-80?"C":"Z"},r.setEllipsoid=function(e){switch(e){case"Airy":this.a=6377563,this.eccSquared=.00667054;break;case"Australian National":this.a=6378160,this.eccSquared=.006694542;break;case"Bessel 1841":this.a=6377397,this.eccSquared=.006674372;break;case"Bessel 1841 Nambia":this.a=6377484,this.eccSquared=.006674372;break;case"Clarke 1866":this.a=6378206,this.eccSquared=.006768658;break;case"Clarke 1880":this.a=6378249,this.eccSquared=.006803511;break;case"Everest":this.a=6377276,this.eccSquared=.006637847;break;case"Fischer 1960 Mercury":this.a=6378166,this.eccSquared=.006693422;break;case"Fischer 1968":this.a=6378150,this.eccSquared=.006693422;break;case"GRS 1967":this.a=6378160,this.eccSquared=.006694605;break;case"GRS 1980":this.a=6378137,this.eccSquared=.00669438;break;case"Helmert 1906":this.a=6378200,this.eccSquared=.006693422;break;case"Hough":this.a=6378270,this.eccSquared=.00672267;break;case"International":this.a=6378388,this.eccSquared=.00672267;break;case"Krassovsky":this.a=6378245,this.eccSquared=.006693422;break;case"Modified Airy":this.a=6377340,this.eccSquared=.00667054;break;case"Modified Everest":this.a=6377304,this.eccSquared=.006637847;break;case"Modified Fischer 1960":this.a=6378155,this.eccSquared=.006693422;break;case"South American 1969":this.a=6378160,this.eccSquared=.006694542;break;case"WGS 60":this.a=6378165,this.eccSquared=.006693422;break;case"WGS 66":this.a=6378145,this.eccSquared=.006694542;break;case"WGS 72":this.a=6378135,this.eccSquared=.006694318;break;case"ED50":this.a=6378388,this.eccSquared=.00672267;break;case"WGS 84":case"EUREF89":case"ETRS89":this.a=6378137,this.eccSquared=.00669438;break;default:this.status=!0}},r.toDegrees=function(e){return e/Math.PI*180},r.toRadians=function(e){return e*Math.PI/180},e.exports=n},function(e,t){var r,i,n=e.exports={};function o(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function s(e){if(r===setTimeout)return setTimeout(e,0);if((r===o||!r)&&setTimeout)return r=setTimeout,setTimeout(e,0);try{return r(e,0)}catch(t){try{return r.call(null,e,0)}catch(t){return r.call(this,e,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:o}catch(e){r=o}try{i="function"==typeof clearTimeout?clearTimeout:a}catch(e){i=a}}();var l,u=[],c=!1,p=-1;function h(){c&&l&&(c=!1,l.length?u=l.concat(u):p=-1,u.length&&d())}function d(){if(!c){var e=s(h);c=!0;for(var t=u.length;t;){for(l=u,u=[];++p<t;)l&&l[p].run();p=-1,t=u.length}l=null,c=!1,function(e){if(i===clearTimeout)return clearTimeout(e);if((i===a||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(e);try{i(e)}catch(t){try{return i.call(null,e)}catch(t){return i.call(this,e)}}}(e)}}function m(e,t){this.fun=e,this.array=t}function f(){}n.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];u.push(new m(e,t)),1!==u.length||c||s(d)},m.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.browser=!0,n.env={},n.argv=[],n.version="",n.versions={},n.on=f,n.addListener=f,n.once=f,n.off=f,n.removeListener=f,n.removeAllListeners=f,n.emit=f,n.prependListener=f,n.prependOnceListener=f,n.listeners=function(e){return[]},n.binding=function(e){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(e){throw new Error("process.chdir is not supported")},n.umask=function(){return 0}},function(e,t,r){"use strict";(function(e){var i=r(6),n=r(7),o=setTimeout;function a(e){return Boolean(e&&void 0!==e.length)}function s(){}function l(e){if(!(this instanceof l))throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],m(e,this)}function u(e,t){for(;3===e._state;)e=e._value;0!==e._state?(e._handled=!0,l._immediateFn((function(){var r=1===e._state?t.onFulfilled:t.onRejected;if(null!==r){var i;try{i=r(e._value)}catch(e){return void p(t.promise,e)}c(t.promise,i)}else(1===e._state?c:p)(t.promise,e._value)}))):e._deferreds.push(t)}function c(e,t){try{if(t===e)throw new TypeError("A promise cannot be resolved with itself.");if(t&&("object"==typeof t||"function"==typeof t)){var r=t.then;if(t instanceof l)return e._state=3,e._value=t,void h(e);if("function"==typeof r)return void m((i=r,n=t,function(){i.apply(n,arguments)}),e)}e._state=1,e._value=t,h(e)}catch(t){p(e,t)}var i,n}function p(e,t){e._state=2,e._value=t,h(e)}function h(e){2===e._state&&0===e._deferreds.length&&l._immediateFn((function(){e._handled||l._unhandledRejectionFn(e._value)}));for(var t=0,r=e._deferreds.length;t<r;t++)u(e,e._deferreds[t]);e._deferreds=null}function d(e,t,r){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.promise=r}function m(e,t){var r=!1;try{e((function(e){r||(r=!0,c(t,e))}),(function(e){r||(r=!0,p(t,e))}))}catch(e){if(r)return;r=!0,p(t,e)}}l.prototype.catch=function(e){return this.then(null,e)},l.prototype.then=function(e,t){var r=new this.constructor(s);return u(this,new d(e,t,r)),r},l.prototype.finally=i.a,l.all=function(e){return new l((function(t,r){if(!a(e))return r(new TypeError("Promise.all accepts an array"));var i=Array.prototype.slice.call(e);if(0===i.length)return t([]);var n=i.length;function o(e,a){try{if(a&&("object"==typeof a||"function"==typeof a)){var s=a.then;if("function"==typeof s)return void s.call(a,(function(t){o(e,t)}),r)}i[e]=a,0==--n&&t(i)}catch(e){r(e)}}for(var s=0;s<i.length;s++)o(s,i[s])}))},l.allSettled=n.a,l.resolve=function(e){return e&&"object"==typeof e&&e.constructor===l?e:new l((function(t){t(e)}))},l.reject=function(e){return new l((function(t,r){r(e)}))},l.race=function(e){return new l((function(t,r){if(!a(e))return r(new TypeError("Promise.race accepts an array"));for(var i=0,n=e.length;i<n;i++)l.resolve(e[i]).then(t,r)}))},l._immediateFn="function"==typeof e&&function(t){e(t)}||function(e){o(e,0)},l._unhandledRejectionFn=function(e){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",e)},t.a=l}).call(this,r(8).setImmediate)},function(e,t,r){"use strict";t.a=function(e){var t=this.constructor;return this.then((function(r){return t.resolve(e()).then((function(){return r}))}),(function(r){return t.resolve(e()).then((function(){return t.reject(r)}))}))}},function(e,t,r){"use strict";t.a=function(e){return new this((function(t,r){if(!e||void 0===e.length)return r(new TypeError(typeof e+" "+e+" is not iterable(cannot read property Symbol(Symbol.iterator))"));var i=Array.prototype.slice.call(e);if(0===i.length)return t([]);var n=i.length;function o(e,r){if(r&&("object"==typeof r||"function"==typeof r)){var a=r.then;if("function"==typeof a)return void a.call(r,(function(t){o(e,t)}),(function(r){i[e]={status:"rejected",reason:r},0==--n&&t(i)}))}i[e]={status:"fulfilled",value:r},0==--n&&t(i)}for(var a=0;a<i.length;a++)o(a,i[a])}))}},function(e,t,r){(function(e){var i=void 0!==e&&e||"undefined"!=typeof self&&self||window,n=Function.prototype.apply;function o(e,t){this._id=e,this._clearFn=t}t.setTimeout=function(){return new o(n.call(setTimeout,i,arguments),clearTimeout)},t.setInterval=function(){return new o(n.call(setInterval,i,arguments),clearInterval)},t.clearTimeout=t.clearInterval=function(e){e&&e.close()},o.prototype.unref=o.prototype.ref=function(){},o.prototype.close=function(){this._clearFn.call(i,this._id)},t.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},t.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},t._unrefActive=t.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout((function(){e._onTimeout&&e._onTimeout()}),t))},r(9),t.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==e&&e.setImmediate||this&&this.setImmediate,t.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==e&&e.clearImmediate||this&&this.clearImmediate}).call(this,r(2))},function(e,t,r){(function(e,t){!function(e,r){"use strict";if(!e.setImmediate){var i,n,o,a,s,l=1,u={},c=!1,p=e.document,h=Object.getPrototypeOf&&Object.getPrototypeOf(e);h=h&&h.setTimeout?h:e,"[object process]"==={}.toString.call(e.process)?i=function(e){t.nextTick((function(){m(e)}))}:!function(){if(e.postMessage&&!e.importScripts){var t=!0,r=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=r,t}}()?e.MessageChannel?((o=new MessageChannel).port1.onmessage=function(e){m(e.data)},i=function(e){o.port2.postMessage(e)}):p&&"onreadystatechange"in p.createElement("script")?(n=p.documentElement,i=function(e){var t=p.createElement("script");t.onreadystatechange=function(){m(e),t.onreadystatechange=null,n.removeChild(t),t=null},n.appendChild(t)}):i=function(e){setTimeout(m,0,e)}:(a="setImmediate$"+Math.random()+"$",s=function(t){t.source===e&&"string"==typeof t.data&&0===t.data.indexOf(a)&&m(+t.data.slice(a.length))},e.addEventListener?e.addEventListener("message",s,!1):e.attachEvent("onmessage",s),i=function(t){e.postMessage(a+t,"*")}),h.setImmediate=function(e){"function"!=typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),r=0;r<t.length;r++)t[r]=arguments[r+1];var n={callback:e,args:t};return u[l]=n,i(l),l++},h.clearImmediate=d}function d(e){delete u[e]}function m(e){if(c)setTimeout(m,0,e);else{var t=u[e];if(t){c=!0;try{!function(e){var t=e.callback,r=e.args;switch(r.length){case 0:t();break;case 1:t(r[0]);break;case 2:t(r[0],r[1]);break;case 3:t(r[0],r[1],r[2]);break;default:t.apply(void 0,r)}}(t)}finally{d(e),c=!1}}}}}("undefined"==typeof self?void 0===e?this:e:self)}).call(this,r(2),r(4))},function(e,t,r){"use strict";(function(e){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <http://feross.org>
 * @license  MIT
 */
var i=r(11),n=r(12),o=r(13);function a(){return l.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function s(e,t){if(a()<t)throw new RangeError("Invalid typed array length");return l.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=l.prototype:(null===e&&(e=new l(t)),e.length=t),e}function l(e,t,r){if(!(l.TYPED_ARRAY_SUPPORT||this instanceof l))return new l(e,t,r);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return p(this,e)}return u(this,e,t,r)}function u(e,t,r,i){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,r,i){if(t.byteLength,r<0||t.byteLength<r)throw new RangeError("'offset' is out of bounds");if(t.byteLength<r+(i||0))throw new RangeError("'length' is out of bounds");t=void 0===r&&void 0===i?new Uint8Array(t):void 0===i?new Uint8Array(t,r):new Uint8Array(t,r,i);l.TYPED_ARRAY_SUPPORT?(e=t).__proto__=l.prototype:e=h(e,t);return e}(e,t,r,i):"string"==typeof t?function(e,t,r){"string"==typeof r&&""!==r||(r="utf8");if(!l.isEncoding(r))throw new TypeError('"encoding" must be a valid string encoding');var i=0|m(t,r),n=(e=s(e,i)).write(t,r);n!==i&&(e=e.slice(0,n));return e}(e,t,r):function(e,t){if(l.isBuffer(t)){var r=0|d(t.length);return 0===(e=s(e,r)).length||t.copy(e,0,0,r),e}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||(i=t.length)!=i?s(e,0):h(e,t);if("Buffer"===t.type&&o(t.data))return h(e,t.data)}var i;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function c(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function p(e,t){if(c(t),e=s(e,t<0?0:0|d(t)),!l.TYPED_ARRAY_SUPPORT)for(var r=0;r<t;++r)e[r]=0;return e}function h(e,t){var r=t.length<0?0:0|d(t.length);e=s(e,r);for(var i=0;i<r;i+=1)e[i]=255&t[i];return e}function d(e){if(e>=a())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+a().toString(16)+" bytes");return 0|e}function m(e,t){if(l.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var r=e.length;if(0===r)return 0;for(var i=!1;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":case void 0:return q(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return U(e).length;default:if(i)return q(e).length;t=(""+t).toLowerCase(),i=!0}}function f(e,t,r){var i=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return R(this,t,r);case"utf8":case"utf-8":return E(this,t,r);case"ascii":return I(this,t,r);case"latin1":case"binary":return P(this,t,r);case"base64":return C(this,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return N(this,t,r);default:if(i)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),i=!0}}function y(e,t,r){var i=e[t];e[t]=e[r],e[r]=i}function g(e,t,r,i,n){if(0===e.length)return-1;if("string"==typeof r?(i=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),r=+r,isNaN(r)&&(r=n?0:e.length-1),r<0&&(r=e.length+r),r>=e.length){if(n)return-1;r=e.length-1}else if(r<0){if(!n)return-1;r=0}if("string"==typeof t&&(t=l.from(t,i)),l.isBuffer(t))return 0===t.length?-1:v(e,t,r,i,n);if("number"==typeof t)return t&=255,l.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?n?Uint8Array.prototype.indexOf.call(e,t,r):Uint8Array.prototype.lastIndexOf.call(e,t,r):v(e,[t],r,i,n);throw new TypeError("val must be string, number or Buffer")}function v(e,t,r,i,n){var o,a=1,s=e.length,l=t.length;if(void 0!==i&&("ucs2"===(i=String(i).toLowerCase())||"ucs-2"===i||"utf16le"===i||"utf-16le"===i)){if(e.length<2||t.length<2)return-1;a=2,s/=2,l/=2,r/=2}function u(e,t){return 1===a?e[t]:e.readUInt16BE(t*a)}if(n){var c=-1;for(o=r;o<s;o++)if(u(e,o)===u(t,-1===c?0:o-c)){if(-1===c&&(c=o),o-c+1===l)return c*a}else-1!==c&&(o-=o-c),c=-1}else for(r+l>s&&(r=s-l),o=r;o>=0;o--){for(var p=!0,h=0;h<l;h++)if(u(e,o+h)!==u(t,h)){p=!1;break}if(p)return o}return-1}function _(e,t,r,i){r=Number(r)||0;var n=e.length-r;i?(i=Number(i))>n&&(i=n):i=n;var o=t.length;if(o%2!=0)throw new TypeError("Invalid hex string");i>o/2&&(i=o/2);for(var a=0;a<i;++a){var s=parseInt(t.substr(2*a,2),16);if(isNaN(s))return a;e[r+a]=s}return a}function b(e,t,r,i){return j(q(t,e.length-r),e,r,i)}function x(e,t,r,i){return j(function(e){for(var t=[],r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}(t),e,r,i)}function w(e,t,r,i){return x(e,t,r,i)}function S(e,t,r,i){return j(U(t),e,r,i)}function T(e,t,r,i){return j(function(e,t){for(var r,i,n,o=[],a=0;a<e.length&&!((t-=2)<0);++a)r=e.charCodeAt(a),i=r>>8,n=r%256,o.push(n),o.push(i);return o}(t,e.length-r),e,r,i)}function C(e,t,r){return 0===t&&r===e.length?i.fromByteArray(e):i.fromByteArray(e.slice(t,r))}function E(e,t,r){r=Math.min(e.length,r);for(var i=[],n=t;n<r;){var o,a,s,l,u=e[n],c=null,p=u>239?4:u>223?3:u>191?2:1;if(n+p<=r)switch(p){case 1:u<128&&(c=u);break;case 2:128==(192&(o=e[n+1]))&&(l=(31&u)<<6|63&o)>127&&(c=l);break;case 3:o=e[n+1],a=e[n+2],128==(192&o)&&128==(192&a)&&(l=(15&u)<<12|(63&o)<<6|63&a)>2047&&(l<55296||l>57343)&&(c=l);break;case 4:o=e[n+1],a=e[n+2],s=e[n+3],128==(192&o)&&128==(192&a)&&128==(192&s)&&(l=(15&u)<<18|(63&o)<<12|(63&a)<<6|63&s)>65535&&l<1114112&&(c=l)}null===c?(c=65533,p=1):c>65535&&(c-=65536,i.push(c>>>10&1023|55296),c=56320|1023&c),i.push(c),n+=p}return function(e){var t=e.length;if(t<=4096)return String.fromCharCode.apply(String,e);var r="",i=0;for(;i<t;)r+=String.fromCharCode.apply(String,e.slice(i,i+=4096));return r}(i)}t.Buffer=l,t.SlowBuffer=function(e){+e!=e&&(e=0);return l.alloc(+e)},t.INSPECT_MAX_BYTES=50,l.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}(),t.kMaxLength=a(),l.poolSize=8192,l._augment=function(e){return e.__proto__=l.prototype,e},l.from=function(e,t,r){return u(null,e,t,r)},l.TYPED_ARRAY_SUPPORT&&(l.prototype.__proto__=Uint8Array.prototype,l.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&l[Symbol.species]===l&&Object.defineProperty(l,Symbol.species,{value:null,configurable:!0})),l.alloc=function(e,t,r){return function(e,t,r,i){return c(t),t<=0?s(e,t):void 0!==r?"string"==typeof i?s(e,t).fill(r,i):s(e,t).fill(r):s(e,t)}(null,e,t,r)},l.allocUnsafe=function(e){return p(null,e)},l.allocUnsafeSlow=function(e){return p(null,e)},l.isBuffer=function(e){return!(null==e||!e._isBuffer)},l.compare=function(e,t){if(!l.isBuffer(e)||!l.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var r=e.length,i=t.length,n=0,o=Math.min(r,i);n<o;++n)if(e[n]!==t[n]){r=e[n],i=t[n];break}return r<i?-1:i<r?1:0},l.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},l.concat=function(e,t){if(!o(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return l.alloc(0);var r;if(void 0===t)for(t=0,r=0;r<e.length;++r)t+=e[r].length;var i=l.allocUnsafe(t),n=0;for(r=0;r<e.length;++r){var a=e[r];if(!l.isBuffer(a))throw new TypeError('"list" argument must be an Array of Buffers');a.copy(i,n),n+=a.length}return i},l.byteLength=m,l.prototype._isBuffer=!0,l.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)y(this,t,t+1);return this},l.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)y(this,t,t+3),y(this,t+1,t+2);return this},l.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)y(this,t,t+7),y(this,t+1,t+6),y(this,t+2,t+5),y(this,t+3,t+4);return this},l.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?E(this,0,e):f.apply(this,arguments)},l.prototype.equals=function(e){if(!l.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===l.compare(this,e)},l.prototype.inspect=function(){var e="",r=t.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,r).match(/.{2}/g).join(" "),this.length>r&&(e+=" ... ")),"<Buffer "+e+">"},l.prototype.compare=function(e,t,r,i,n){if(!l.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===r&&(r=e?e.length:0),void 0===i&&(i=0),void 0===n&&(n=this.length),t<0||r>e.length||i<0||n>this.length)throw new RangeError("out of range index");if(i>=n&&t>=r)return 0;if(i>=n)return-1;if(t>=r)return 1;if(this===e)return 0;for(var o=(n>>>=0)-(i>>>=0),a=(r>>>=0)-(t>>>=0),s=Math.min(o,a),u=this.slice(i,n),c=e.slice(t,r),p=0;p<s;++p)if(u[p]!==c[p]){o=u[p],a=c[p];break}return o<a?-1:a<o?1:0},l.prototype.includes=function(e,t,r){return-1!==this.indexOf(e,t,r)},l.prototype.indexOf=function(e,t,r){return g(this,e,t,r,!0)},l.prototype.lastIndexOf=function(e,t,r){return g(this,e,t,r,!1)},l.prototype.write=function(e,t,r,i){if(void 0===t)i="utf8",r=this.length,t=0;else if(void 0===r&&"string"==typeof t)i=t,r=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(r)?(r|=0,void 0===i&&(i="utf8")):(i=r,r=void 0)}var n=this.length-t;if((void 0===r||r>n)&&(r=n),e.length>0&&(r<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");i||(i="utf8");for(var o=!1;;)switch(i){case"hex":return _(this,e,t,r);case"utf8":case"utf-8":return b(this,e,t,r);case"ascii":return x(this,e,t,r);case"latin1":case"binary":return w(this,e,t,r);case"base64":return S(this,e,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return T(this,e,t,r);default:if(o)throw new TypeError("Unknown encoding: "+i);i=(""+i).toLowerCase(),o=!0}},l.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function I(e,t,r){var i="";r=Math.min(e.length,r);for(var n=t;n<r;++n)i+=String.fromCharCode(127&e[n]);return i}function P(e,t,r){var i="";r=Math.min(e.length,r);for(var n=t;n<r;++n)i+=String.fromCharCode(e[n]);return i}function R(e,t,r){var i=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>i)&&(r=i);for(var n="",o=t;o<r;++o)n+=F(e[o]);return n}function N(e,t,r){for(var i=e.slice(t,r),n="",o=0;o<i.length;o+=2)n+=String.fromCharCode(i[o]+256*i[o+1]);return n}function A(e,t,r){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>r)throw new RangeError("Trying to access beyond buffer length")}function z(e,t,r,i,n,o){if(!l.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>n||t<o)throw new RangeError('"value" argument is out of bounds');if(r+i>e.length)throw new RangeError("Index out of range")}function M(e,t,r,i){t<0&&(t=65535+t+1);for(var n=0,o=Math.min(e.length-r,2);n<o;++n)e[r+n]=(t&255<<8*(i?n:1-n))>>>8*(i?n:1-n)}function k(e,t,r,i){t<0&&(t=4294967295+t+1);for(var n=0,o=Math.min(e.length-r,4);n<o;++n)e[r+n]=t>>>8*(i?n:3-n)&255}function O(e,t,r,i,n,o){if(r+i>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function L(e,t,r,i,o){return o||O(e,0,r,4),n.write(e,t,r,i,23,4),r+4}function D(e,t,r,i,o){return o||O(e,0,r,8),n.write(e,t,r,i,52,8),r+8}l.prototype.slice=function(e,t){var r,i=this.length;if((e=~~e)<0?(e+=i)<0&&(e=0):e>i&&(e=i),(t=void 0===t?i:~~t)<0?(t+=i)<0&&(t=0):t>i&&(t=i),t<e&&(t=e),l.TYPED_ARRAY_SUPPORT)(r=this.subarray(e,t)).__proto__=l.prototype;else{var n=t-e;r=new l(n,void 0);for(var o=0;o<n;++o)r[o]=this[o+e]}return r},l.prototype.readUIntLE=function(e,t,r){e|=0,t|=0,r||A(e,t,this.length);for(var i=this[e],n=1,o=0;++o<t&&(n*=256);)i+=this[e+o]*n;return i},l.prototype.readUIntBE=function(e,t,r){e|=0,t|=0,r||A(e,t,this.length);for(var i=this[e+--t],n=1;t>0&&(n*=256);)i+=this[e+--t]*n;return i},l.prototype.readUInt8=function(e,t){return t||A(e,1,this.length),this[e]},l.prototype.readUInt16LE=function(e,t){return t||A(e,2,this.length),this[e]|this[e+1]<<8},l.prototype.readUInt16BE=function(e,t){return t||A(e,2,this.length),this[e]<<8|this[e+1]},l.prototype.readUInt32LE=function(e,t){return t||A(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},l.prototype.readUInt32BE=function(e,t){return t||A(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},l.prototype.readIntLE=function(e,t,r){e|=0,t|=0,r||A(e,t,this.length);for(var i=this[e],n=1,o=0;++o<t&&(n*=256);)i+=this[e+o]*n;return i>=(n*=128)&&(i-=Math.pow(2,8*t)),i},l.prototype.readIntBE=function(e,t,r){e|=0,t|=0,r||A(e,t,this.length);for(var i=t,n=1,o=this[e+--i];i>0&&(n*=256);)o+=this[e+--i]*n;return o>=(n*=128)&&(o-=Math.pow(2,8*t)),o},l.prototype.readInt8=function(e,t){return t||A(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},l.prototype.readInt16LE=function(e,t){t||A(e,2,this.length);var r=this[e]|this[e+1]<<8;return 32768&r?4294901760|r:r},l.prototype.readInt16BE=function(e,t){t||A(e,2,this.length);var r=this[e+1]|this[e]<<8;return 32768&r?4294901760|r:r},l.prototype.readInt32LE=function(e,t){return t||A(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},l.prototype.readInt32BE=function(e,t){return t||A(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},l.prototype.readFloatLE=function(e,t){return t||A(e,4,this.length),n.read(this,e,!0,23,4)},l.prototype.readFloatBE=function(e,t){return t||A(e,4,this.length),n.read(this,e,!1,23,4)},l.prototype.readDoubleLE=function(e,t){return t||A(e,8,this.length),n.read(this,e,!0,52,8)},l.prototype.readDoubleBE=function(e,t){return t||A(e,8,this.length),n.read(this,e,!1,52,8)},l.prototype.writeUIntLE=function(e,t,r,i){(e=+e,t|=0,r|=0,i)||z(this,e,t,r,Math.pow(2,8*r)-1,0);var n=1,o=0;for(this[t]=255&e;++o<r&&(n*=256);)this[t+o]=e/n&255;return t+r},l.prototype.writeUIntBE=function(e,t,r,i){(e=+e,t|=0,r|=0,i)||z(this,e,t,r,Math.pow(2,8*r)-1,0);var n=r-1,o=1;for(this[t+n]=255&e;--n>=0&&(o*=256);)this[t+n]=e/o&255;return t+r},l.prototype.writeUInt8=function(e,t,r){return e=+e,t|=0,r||z(this,e,t,1,255,0),l.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},l.prototype.writeUInt16LE=function(e,t,r){return e=+e,t|=0,r||z(this,e,t,2,65535,0),l.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):M(this,e,t,!0),t+2},l.prototype.writeUInt16BE=function(e,t,r){return e=+e,t|=0,r||z(this,e,t,2,65535,0),l.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):M(this,e,t,!1),t+2},l.prototype.writeUInt32LE=function(e,t,r){return e=+e,t|=0,r||z(this,e,t,4,4294967295,0),l.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):k(this,e,t,!0),t+4},l.prototype.writeUInt32BE=function(e,t,r){return e=+e,t|=0,r||z(this,e,t,4,4294967295,0),l.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):k(this,e,t,!1),t+4},l.prototype.writeIntLE=function(e,t,r,i){if(e=+e,t|=0,!i){var n=Math.pow(2,8*r-1);z(this,e,t,r,n-1,-n)}var o=0,a=1,s=0;for(this[t]=255&e;++o<r&&(a*=256);)e<0&&0===s&&0!==this[t+o-1]&&(s=1),this[t+o]=(e/a>>0)-s&255;return t+r},l.prototype.writeIntBE=function(e,t,r,i){if(e=+e,t|=0,!i){var n=Math.pow(2,8*r-1);z(this,e,t,r,n-1,-n)}var o=r-1,a=1,s=0;for(this[t+o]=255&e;--o>=0&&(a*=256);)e<0&&0===s&&0!==this[t+o+1]&&(s=1),this[t+o]=(e/a>>0)-s&255;return t+r},l.prototype.writeInt8=function(e,t,r){return e=+e,t|=0,r||z(this,e,t,1,127,-128),l.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},l.prototype.writeInt16LE=function(e,t,r){return e=+e,t|=0,r||z(this,e,t,2,32767,-32768),l.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):M(this,e,t,!0),t+2},l.prototype.writeInt16BE=function(e,t,r){return e=+e,t|=0,r||z(this,e,t,2,32767,-32768),l.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):M(this,e,t,!1),t+2},l.prototype.writeInt32LE=function(e,t,r){return e=+e,t|=0,r||z(this,e,t,4,2147483647,-2147483648),l.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):k(this,e,t,!0),t+4},l.prototype.writeInt32BE=function(e,t,r){return e=+e,t|=0,r||z(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),l.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):k(this,e,t,!1),t+4},l.prototype.writeFloatLE=function(e,t,r){return L(this,e,t,!0,r)},l.prototype.writeFloatBE=function(e,t,r){return L(this,e,t,!1,r)},l.prototype.writeDoubleLE=function(e,t,r){return D(this,e,t,!0,r)},l.prototype.writeDoubleBE=function(e,t,r){return D(this,e,t,!1,r)},l.prototype.copy=function(e,t,r,i){if(r||(r=0),i||0===i||(i=this.length),t>=e.length&&(t=e.length),t||(t=0),i>0&&i<r&&(i=r),i===r)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("sourceStart out of bounds");if(i<0)throw new RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length),e.length-t<i-r&&(i=e.length-t+r);var n,o=i-r;if(this===e&&r<t&&t<i)for(n=o-1;n>=0;--n)e[n+t]=this[n+r];else if(o<1e3||!l.TYPED_ARRAY_SUPPORT)for(n=0;n<o;++n)e[n+t]=this[n+r];else Uint8Array.prototype.set.call(e,this.subarray(r,r+o),t);return o},l.prototype.fill=function(e,t,r,i){if("string"==typeof e){if("string"==typeof t?(i=t,t=0,r=this.length):"string"==typeof r&&(i=r,r=this.length),1===e.length){var n=e.charCodeAt(0);n<256&&(e=n)}if(void 0!==i&&"string"!=typeof i)throw new TypeError("encoding must be a string");if("string"==typeof i&&!l.isEncoding(i))throw new TypeError("Unknown encoding: "+i)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<r)throw new RangeError("Out of range index");if(r<=t)return this;var o;if(t>>>=0,r=void 0===r?this.length:r>>>0,e||(e=0),"number"==typeof e)for(o=t;o<r;++o)this[o]=e;else{var a=l.isBuffer(e)?e:q(new l(e,i).toString()),s=a.length;for(o=0;o<r-t;++o)this[o+t]=a[o%s]}return this};var B=/[^+\/0-9A-Za-z-_]/g;function F(e){return e<16?"0"+e.toString(16):e.toString(16)}function q(e,t){var r;t=t||1/0;for(var i=e.length,n=null,o=[],a=0;a<i;++a){if((r=e.charCodeAt(a))>55295&&r<57344){if(!n){if(r>56319){(t-=3)>-1&&o.push(239,191,189);continue}if(a+1===i){(t-=3)>-1&&o.push(239,191,189);continue}n=r;continue}if(r<56320){(t-=3)>-1&&o.push(239,191,189),n=r;continue}r=65536+(n-55296<<10|r-56320)}else n&&(t-=3)>-1&&o.push(239,191,189);if(n=null,r<128){if((t-=1)<0)break;o.push(r)}else if(r<2048){if((t-=2)<0)break;o.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;o.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return o}function U(e){return i.toByteArray(function(e){if((e=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}(e).replace(B,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function j(e,t,r,i){for(var n=0;n<i&&!(n+r>=t.length||n>=e.length);++n)t[n+r]=e[n];return n}}).call(this,r(2))},function(e,t,r){"use strict";t.byteLength=function(e){var t=u(e),r=t[0],i=t[1];return 3*(r+i)/4-i},t.toByteArray=function(e){var t,r,i=u(e),a=i[0],s=i[1],l=new o(function(e,t,r){return 3*(t+r)/4-r}(0,a,s)),c=0,p=s>0?a-4:a;for(r=0;r<p;r+=4)t=n[e.charCodeAt(r)]<<18|n[e.charCodeAt(r+1)]<<12|n[e.charCodeAt(r+2)]<<6|n[e.charCodeAt(r+3)],l[c++]=t>>16&255,l[c++]=t>>8&255,l[c++]=255&t;2===s&&(t=n[e.charCodeAt(r)]<<2|n[e.charCodeAt(r+1)]>>4,l[c++]=255&t);1===s&&(t=n[e.charCodeAt(r)]<<10|n[e.charCodeAt(r+1)]<<4|n[e.charCodeAt(r+2)]>>2,l[c++]=t>>8&255,l[c++]=255&t);return l},t.fromByteArray=function(e){for(var t,r=e.length,n=r%3,o=[],a=0,s=r-n;a<s;a+=16383)o.push(c(e,a,a+16383>s?s:a+16383));1===n?(t=e[r-1],o.push(i[t>>2]+i[t<<4&63]+"==")):2===n&&(t=(e[r-2]<<8)+e[r-1],o.push(i[t>>10]+i[t>>4&63]+i[t<<2&63]+"="));return o.join("")};for(var i=[],n=[],o="undefined"!=typeof Uint8Array?Uint8Array:Array,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0,l=a.length;s<l;++s)i[s]=a[s],n[a.charCodeAt(s)]=s;function u(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=e.indexOf("=");return-1===r&&(r=t),[r,r===t?0:4-r%4]}function c(e,t,r){for(var n,o,a=[],s=t;s<r;s+=3)n=(e[s]<<16&16711680)+(e[s+1]<<8&65280)+(255&e[s+2]),a.push(i[(o=n)>>18&63]+i[o>>12&63]+i[o>>6&63]+i[63&o]);return a.join("")}n["-".charCodeAt(0)]=62,n["_".charCodeAt(0)]=63},function(e,t){
/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */
t.read=function(e,t,r,i,n){var o,a,s=8*n-i-1,l=(1<<s)-1,u=l>>1,c=-7,p=r?n-1:0,h=r?-1:1,d=e[t+p];for(p+=h,o=d&(1<<-c)-1,d>>=-c,c+=s;c>0;o=256*o+e[t+p],p+=h,c-=8);for(a=o&(1<<-c)-1,o>>=-c,c+=i;c>0;a=256*a+e[t+p],p+=h,c-=8);if(0===o)o=1-u;else{if(o===l)return a?NaN:1/0*(d?-1:1);a+=Math.pow(2,i),o-=u}return(d?-1:1)*a*Math.pow(2,o-i)},t.write=function(e,t,r,i,n,o){var a,s,l,u=8*o-n-1,c=(1<<u)-1,p=c>>1,h=23===n?Math.pow(2,-24)-Math.pow(2,-77):0,d=i?0:o-1,m=i?1:-1,f=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,a=c):(a=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-a))<1&&(a--,l*=2),(t+=a+p>=1?h/l:h*Math.pow(2,1-p))*l>=2&&(a++,l/=2),a+p>=c?(s=0,a=c):a+p>=1?(s=(t*l-1)*Math.pow(2,n),a+=p):(s=t*Math.pow(2,p-1)*Math.pow(2,n),a=0));n>=8;e[r+d]=255&s,d+=m,s/=256,n-=8);for(a=a<<n|s,u+=n;u>0;e[r+d]=255&a,d+=m,a/=256,u-=8);e[r+d-m]|=128*f}},function(e,t){var r={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==r.call(e)}},function(e,t,r){"use strict";r.r(t);var i=r(5),n={debug:!1,atlasApiUrl:"https://atlas.microsoft.com/sdk/javascript/service/2/atlas-service.min.js",attlasUrl:"https://atlas.microsoft.com/sdk/javascript/mapcontrol/2/atlas.min.js",attlasCSS:"https://atlas.microsoft.com/sdk/javascript/mapcontrol/2/atlas.min.css"},o={loadedModules:[],deepClone:function(e){return JSON.parse(JSON.stringify(e))},logger:{log:function(){n.debug&&console.log.apply(null,Array.prototype.slice.call(arguments,0))},info:function(){n.debug&&console.info.apply(null,Array.prototype.slice.call(arguments,0))},warn:function(){n.debug&&console.warn.apply(null,Array.prototype.slice.call(arguments,0))},debug:function(){n.debug&&console.debug.apply(null,Array.prototype.slice.call(arguments,0))},error:function(){n.debug&&console.error.apply(null,Array.prototype.slice.call(arguments,0))}}},a={toMapLocation:function(e){if(!e)return null},toMapPoint:function(e){if(!e)return null},toMapTypeId:function(e){return e?Array.isArray(e)?e.map((function(e){return Microsoft.Maps.MapTypeId[e]})):void 0:null},toNavigationBarOrientation:function(e){if(!e)return null}},s=r(0),l=r(1);function u(e,t,r,i,n,o,a,s){var l,u="function"==typeof e?e.options:e;if(t&&(u.render=t,u.staticRenderFns=r,u._compiled=!0),i&&(u.functional=!0),o&&(u._scopeId="data-v-"+o),a?(l=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),n&&n.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(a)},u._ssrRegister=l):n&&(l=s?function(){n.call(this,(u.functional?this.parent:this).$root.$options.shadowRoot)}:n),l)if(u.functional){u._injectStyles=l;var c=u.render;u.render=function(e,t){return l.call(t),c(e,t)}}else{var p=u.beforeCreate;u.beforeCreate=p?[].concat(p,l):[l]}return{exports:e,options:u}}var c=u({data:()=>({__item:null,___itemMap:null,__itemHandlers:[],itemType:null,initialized:!1,allowedEvents:[],map:null,pushpin:null,queryTranslate:[{key:"Paihuano",q:"Paiguano, Coquimbo"},{key:"Isla de Pascua",q:"Isla de Pascua, Valparaíso"},{key:"Llay Llay",q:"Llaillay"},{key:"Cerrillos",q:"Cerrillos, Santiago"},{key:"Independencia",q:"Independencia, Santiago"},{key:"La Reina",q:"La Reina, Santiago"},{key:"San Joaquín",q:"San Joaquín, Santiago"},{key:"San Miguel",q:"San Miguel, Santiago"},{key:"San Pedro",q:"San Pedro, Santiago"},{key:"San Ramón",q:"San Ramón, Santiago"},{key:"Til til",q:"Tiltil"},{key:"San Vicente",q:"San Vicente, O'Higgins"},{key:"Portezuelo",q:"Portezuelo, Nuble"},{key:"Trehuaco",q:"Treguaco, Nuble"}],positionTranslate:[{key:"Retiro",lat:-36.051019,lon:-71.758976},{key:"Coelemu",lat:-36.489525,lon:-72.7024357},{key:"Cabo de Hornos",lat:-55.733524,lon:-67.381401}]}),computed:{},methods:{getItem(){return this.__item},getItemMap(){return this.___item_map},setItem(e){return this.__item=e,e},doMap(e,t,r){return t.hasOwnProperty("zoom")||(t.zoom=10),t.hasOwnProperty("view")||(t.view="Auto"),t.hasOwnProperty("center")||(t.center=[-70.6553139,-33.4402043]),t.authOptions={},t.authOptions={authType:"subscriptionKey",subscriptionKey:r},this.map=new s.Map(e,{center:t.center,zoom:t.zoom,view:t.view,authOptions:{authType:t.authOptions.authType,subscriptionKey:r}}),this.$store.state.map=this.map,this.map},addControls(e,t=null,r=null){null==t&&(t={mapStyles:["road","satellite_road_labels"]}),null==r&&((r=[])[0]="top-right",r[1]="bottom-right"),e.controls.add(new s.control.StyleControl(t),{position:r[0]}),e.controls.add(new s.control.ZoomControl,{position:r[1]})},getAttachedEventListeners(){let e=this.$listeners||{},t=this.itemType+"-",r=[];for(var i in e)e.hasOwnProperty(i)&&r.push(i.replace(t,""));return r},async registerEvents(e,t){var i=new(r(3));let n=this,a=this.itemType,s=n.getAttachedEventListeners(),l=this.$store.state.map,u=n.getItem();if(null!=l){let r=async function(e){return o.logger.log(e),{meta:e.primitive&&e.primitive.metadata,location:{longitude:e.target.options.position[0],latitude:e.target.options.position[1]},targetType:e.targetType,address:await n.toMapForCoordinates(e.target.options.position[1],e.target.options.position[0]),utm:i.convertLatLngToUtm(e.target.options.position[1],e.target.options.position[0],-1)}};return n.__itemHandlers||(n.__itemHandlers=[]),new Promise((i,c)=>{n.allowedEvents.reduce((function(e,t){return s.filter((function(e){return e===t||e&&e.name===t})).forEach((function(i){var n=typeof i;"undefined"===n?o.logger.log("no user-defined "+a+" event handler for event: "+t):"string"===n?(o.logger.log("setting up default handler for "+a+" event: "+i),e.push({name:t,transform:r,delay:0,once:!1})):"object"===n?e.push({name:t,transform:i.transform,delay:i.delay||0,once:i.once||!1}):o.logger.warn("unknown "+a+" event handler type: ",i)})),e}),[]).forEach(e=>{l.events.add(e.name,u,(function(t){e.transform(t).then(t=>{n.$emit(n.itemType+"-"+e.name,o.deepClone(t))})}))}),l.markers.add(u),n.addControls(l,e,t),i(u)})}},unRegisterEvents(){let e=this;return new Promise((t,r)=>{let i=e.__itemHandlers||[];for(;i.length;)i.pop();t()})},async doPushPin(e,t){let r=t.typePushping;return delete t.typePushping,t.hasOwnProperty("position")||(t.position=[-70.6553139,-33.4402043]),t.htmlContent=s.getImageTemplate(r),this.pushpin=new s.HtmlMarker(t),this.$store.state.pushpin=this.pushpin,this.pushpin},createQuery(e){let t=e.comuna,r=e.calle,i=e.numero;this.$store.state.map;this.queryTranslate.forEach(r=>{-1!=r.key.indexOf(e.comuna)&&(t=r.q)});var n=t;return r&&!/^\s*$/.test(r)||(n=r+", "+t,i&&!/^\s*$/.test(i)||(n=r+" "+i+", "+t)),n},getSearchService(){let e=l.MapsURL.newPipeline(new l.SubscriptionKeyCredential(s.getSubscriptionKey()));return new l.SearchURL(e)},searchAddressReverse(e){return this.getSearchService().searchAddressReverse(l.Aborter.timeout(3e3),e,{view:"Auto"})},searchAddress(e){return this.getSearchService().searchAddress(l.Aborter.timeout(3e3),e)},setCameraAndMarker(e,t,r,i){t.setOptions({position:r}),e.setCamera({zoom:i,center:r})},findPosition(e){var t={};return this.positionTranslate.forEach(r=>{if(-1!=r.key.indexOf(e.comuna))return t=r,!1}),t},async toMapForAddress(e,t=null){let i=this.$store.state.map,n=this.$store.state.pushpin,o=[],a=this.createQuery(e);return new Promise((t,s)=>{null!=n?this.searchAddress(a).then(a=>{let s={},l=a.results.filter(e=>"Geography"==e.type&&-1!=e.id.indexOf("CL"));l.length>0&&(o=[l[0].position.lon,l[0].position.lat],s=l[0].address);let u=this.findPosition(e);u.key&&(o=[u.lon,u.lat]),this.setCameraAndMarker(i,n,o,14);var c=new(r(3));c=c.convertLatLngToUtm(o[1],o[0],-1),t({location:{latitude:o[1],longitude:o[0]},address:this.direccionNormalizada(s),utm:c})}).catch(e=>{t({location:{},address:{},utm:{}})}):t({location:{},address:{},utm:{}})})},toMapCenter(e){let t=this.$store.state.map,r=this.$store.state.puhspin;this.setCameraAndMarker(t,r,[e.longitude,e.latitude],15)},direccionNormalizada(e){var t={calle:"Sin Calle",numero:"S/N",comuna:e.municipality,casilla:""};return e.streetName&&(t.calle=e.streetName),e.streetNumber&&(t.numero=e.streetNumber),e.municipalitySubdivision&&(t.comuna=e.municipalitySubdivision),e.extendedPostalCode&&(t.casilla=e.extendedPostalCode),t},async toMapForCoordinates(e,t){this.$store.state.map;let i=this.$store.state.pushpin;return new Promise((n,o)=>{if(null!=i){var a=new(r(3));a=a.convertLatLngToUtm(e,t,-1),this.searchAddressReverse([t,e]).then(r=>{let o=r.addresses[0].address;-1!=o.country.toLowerCase().indexOf("chile")?(i.setOptions({position:[t,e]}),n({direction:this.direccionNormalizada(o),huso:a})):n({})})}else n({})})}}},void 0,void 0,!1,null,null,null).exports;const p=Object.freeze(["click","dblclick","mapresize","maptypechanged","mousedown","mousemove","mouseout","mouseover","mouseup","mousewheel","rightclick","viewchange","viewchangeend","viewchangestart"]);var h=u({name:"azure-map",mixins:[c],props:{credentials_key:{type:String,required:!0},map_options:{type:Object,required:!1},name:{type:String,required:!0}},data:()=>({itemType:"map",rendering:!1,apiLoaded:!1,allowedEvents:p}),computed:{mapOptions(){if(!this.apiLoaded)return{};let e=this.options,t={};for(var r in e)if(e.hasOwnProperty(r))switch(r){case"navigationBarOrientation":case"mapTypeId":case"supportedMapTypes":default:t[r]=e[r]}return t}},provide(){return{getMap:this.getItem,loadModule:this.loadModule}},mounted(){let e=document.createElement("script");e.setAttribute("src",n.attlasUrl),document.head.appendChild(e),e=document.createElement("script"),e.setAttribute("src",n.atlasApiUrl),document.head.appendChild(e)},methods:{libLoaded:()=>!(!window.atlas||!window.atlas.Map),getInitCallbackFnName(){return"mapInitializeCallback_"+this._uid},loadApi(){let e=this;return o.logger.log("loading api..."),new Promise((t,r)=>{if(e.libLoaded())o.logger.log("api already loaded!"),e.apiLoaded=!0,t();else{let r=document.createElement("link");r.type="text/css",r.rel="stylesheet",document.head.append(r),r.href=n.attlasCSS;let i=document.createElement("script");i.type="text/javascript",i.src=n.atlasApiUrl,i.async=!0,i.defer=!0,document.body.append(i),e.apiLoaded=!0,t()}})},loadModule(e){let t=this,r=(e||"").toLowerCase().trim();return new Promise((e,i)=>{if(r)if(t.libLoaded()){let t=o.loadedModules;t||(t=[],o.loadedModules=t),t.item.indexOf(r)>-1?(o.logger.log("Map module "+r+" already loaded, resolving..."),e()):e()}else i("This function can only be called after the Azure Map library has been loaded");else i("A module name must be specified")})},draw(){this.render()},render(){let e=this;return new Promise((t,r)=>{e.rendering=this;let i=e.getItem();i&&e.destroy(),Promise.all([e.loadApi(),e.$nextTick()]).then(()=>{i=e.setItem(this.doMap(this.name,this.map_options,this.credentials_key)),i.events.add("ready",(function(){e.initialized=!0})),t()}).catch((function(e){r(e)})).finally(()=>{e.rendering=!1})})},destroy(){this.initialized=!1;let e=this.getItem();e&&"function"==typeof e.dispose&&(e.dispose(),this.setItem(null))}},mounted(){o.logger.log("mounted lifecycle hook, rendering map..."),this.draw(),this.registerEvents()},beforeDestroy(){o.logger.log("beforeDestroy lifecycle hook, destroying map...");let e=this;e.destroying=!0,e.unRegisterEvents().then(e.destroy).finally(()=>{e.destroying=!1})},activated(){o.logger.log("map activated lifecycle hook, checking criteria for rendering map..."),this.rendering||this.getItem()?o.logger.log("map component activated from initial mounted stated, no action performed here since already performed in mounted hook"):(o.logger.log("map component activated from deactivated state, rendering map..."),this.draw())},deactivated(){o.logger.log("deactivated lifecyle hook, destroying map..."),this.unRegisterEvents().then(this.destroy)}},(function(){var e=this.$createElement,t=this._self._c||e;return t("div",{ref:"mapContainer"},[t("div",{staticStyle:{display:"none"}},[this.initialized?this._t("default"):this._e()],2)])}),[],!1,null,null,null).exports;const d=Object.freeze(["changed","click","dblclick","drag","dragend","dragstart","mousedown","mouseout","mouseover","mouseup"]);var m=u({name:"azure-map-pushpin",mixins:[c],props:{options:{type:Object,required:!1,default:()=>{}},metadata:{type:Object,required:!1,default:()=>null},location:{type:Object,required:!0,validator:e=>e&&"number"==typeof e.latitude&&"number"==typeof e.longitude},county:{type:String,required:!1,default:()=>null},styles:{type:Object,required:!1},position:{type:Array,required:!1}},data:()=>({itemType:"push-pin",initialized:!0,allowedEvents:d}),computed:{innerOptions(){let e=this.options,t={};for(var r in e)if(e.hasOwnProperty(r))switch(r){case"anchor":case"textOffset":t[r]=a.toMapPoint(e[r]);break;default:t[r]=o.deepClone(e[r])}return t}},watch:{metadata:{deep:!0,handler(e){let t=this.getItem();t&&(t.metadata=o.deepClone(e))}},location(e){let t=this.getItem();t&&t.setLocation(a.toMapLocation(e))},innerOptions(e){let t=this.getItem();t&&t.setOptions(e)}},methods:{hasIconTemplate(){return!!(this.$slots&&this.$slots.default&&this.$slots.default.length)},async render(){let e=this.getItem();e&&this.destroy();let t=null;if(e=this.setItem(await this.doPushPin(this.location,this.options)),""!=this.county){let e={};e.comuna=this.county,e.calle=null,e.numero=null,t=await this.toMapForAddress(e,!0),this.location.latitude=t.location.latitude,this.location.longitude=t.location.longitude}e.metadata=o.deepClone(this.metadata),this.updateIcon()},updateIcon(){if(this.hasIconTemplate()){let e=this.getItem();if(e){let t=this.$refs.pinTemplate.innerHTML;e.setOptions({icon:t})}}},destroy(){this.getItem();this.setItem(null)}},async mounted(){o.logger.log("mounted lifecycle hook, rendering push-pin"+this._uid+"..."),await this.render(),await this.registerEvents(this.styles,this.position)},beforeUpdate(){o.logger.log("beforeUpdate lifecycle hook, pin "+this._uid)},updated(){o.logger.log("updated lifecycle hook, pin "+this._uid+" updating icon..."),this.updateIcon()},beforeDestroy(){o.logger.log("beforeDestroy lifecycle hook, destroying push-pin "+this._uid+"..."),this.destroy()}},(function(){var e=this.$createElement;return(this._self._c||e)("div",{ref:"pinTemplate"},[this.initialized?this._t("default",null,{metadata:this.metadata}):this._e()],2)}),[],!1,null,null,null).exports;const f=Object.freeze(["click","infoboxChanged","mouseenter","mouseleave"]);var y=u({name:"azure-map-infobox",mixins:[c],props:{options:{required:!1,type:Object,default:()=>{}}},data:()=>({itemType:"infobox",allowedEvents:f}),inject:["getMap"],watch:{options(e){let t=this.getItem();if(t){let r=this.convertOptions(e||{});t.setOptions(r)}}},methods:{hasHtmlTemplate(){return!!(this.$slots&&this.$slots.default&&this.$slots.default.length)},convertOptions(e){let t=(e?o.deepClone(e):o.deepClone(this.options))||{};for(var r in t)if(t.hasOwnProperty(r))switch(r){case"location":"object"==typeof t.location&&(t.location=a.toMapLocation(t.location));break;case"offset":"object"==typeof t.offset&&(t.offset=a.toMapPoint(t.offset))}return t},setCustomHtml(){if(this.hasHtmlTemplate()){let e=this.getItem();if(e){let t=this.$refs.infoboxContainer.innerHTML;e.setHtmlContent(t)}}},render(){let e=this.getMap(),t=this.getItem();if(e){t&&this.destroy();let r=this.convertOptions(),i=r&&r.location;"object"!=typeof i&&(i=e.getCenter(),r.location=i,r.visible=!1),t=this.setItem(new Microsoft.Maps.Infobox(i,r)),this.setCustomHtml(),t.setMap(e)}else o.logger.error("infobox render error: map not found!")},destroy(){let e=this.getItem();try{if(e){this.getMap()&&e.setMap(null)}}finally{this.setItem(null)}}},mounted(){o.logger.log("mounted lifecycle hook, rendering infobox"+this._uid+"..."),this.render()},updated(){o.logger.log("updated lifecycle hook, infobox "+this._uid+" updating infobox HTML..."),this.setCustomHtml()},beforeDestroy(){o.logger.log("beforeDestroy lifecycle hook, destroying infobox "+this._uid+"..."),this.destroy()}},(function(){var e=this.$createElement;return(this._self._c||e)("div",{ref:"infoboxContainer"},[this._t("default")],2)}),[],!1,null,null,null).exports;window.Promise||(window.Promise=i.a);t.default={mixins:{componentBase:c},components:{map:h,pushpin:m,infobox:y},services:{conversions:a},install(e,t){t&&Object.assign(n,t),o.logger.log("registering azure-map component..."),e.component(h.name,e.extend(h)),o.logger.log("registering azure-map-pushpin component..."),e.component(m.name,e.extend(m)),o.logger.log("registering azure-map-infobox component..."),e.component(y.name,e.extend(y)),o.logger.log("azure map vue plugin installed!")}}}])}));